Namespace(adj_path='./data/graphs/concepts_graph_multihot_1931_1931_824.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=8, dataset_type='TimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=2, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=True, input_dim=9, input_graph=False, label_cnt=3, lr=0.001, lstm_layers=3, mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, relation_num=1, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
relation encoding shape: torch.Size([1931, 1931, 824]) torch.float32
relation mask shape: torch.Size([1931, 1931]) torch.float32
14002
ReRaLSTM(
  (rnn1): LSTM(9, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=824, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 2.985187013507326, grad_norm: 0.00042628505147173366, ic: 0.0050760169213908204
Epoch 0: 2022-04-20 17:05:56.021775: train loss: 1.6286762685864662
Eval step 0: eval loss: 1.1448581199427668
Eval: 2022-04-20 17:05:57.653693: total loss: 1.0784502320679408, mse:0.608474453185389, ic :0.004591336466394748, sharpe5:7.344418848752975, irr5:200.81491088867188, ndcg5:0.836481107468606, pnl5:2.774489641189575 
train 1, step: 0, loss: 1.506069381049274, grad_norm: 2.51779862714709e-06, ic: 0.01304417665983549
Epoch 1: 2022-04-20 17:06:34.123211: train loss: 1.6283700295388306
Eval step 0: eval loss: 1.1448818899661206
Eval: 2022-04-20 17:06:35.719863: total loss: 1.078450444510782, mse:0.6084703650118995, ic :0.00759348805213362, sharpe5:7.4164416325092315, irr5:207.66722106933594, ndcg5:0.8602094441986319, pnl5:2.769430637359619 
train 2, step: 0, loss: 1.6450392083988599, grad_norm: 7.87534315833055e-06, ic: 0.0009207637886861893
Epoch 2: 2022-04-20 17:07:12.224411: train loss: 1.6297449317290846
Eval step 0: eval loss: 1.144837690571344
Eval: 2022-04-20 17:07:13.896661: total loss: 1.07844979968984, mse:0.6084777403420705, ic :0.008642238855517919, sharpe5:7.822405516505241, irr5:216.13809204101562, ndcg5:0.8471845132137638, pnl5:3.843196392059326 
train 3, step: 0, loss: 1.3181480479464636, grad_norm: 7.643345828845262e-08, ic: 0.005171258313635777
Epoch 3: 2022-04-20 17:07:50.345995: train loss: 1.6266790325574325
Eval step 0: eval loss: 1.1449001350651271
Eval: 2022-04-20 17:07:51.986019: total loss: 1.0784502874289683, mse:0.6084669583664237, ic :0.008133145049581814, sharpe5:7.979907823204994, irr5:219.61358642578125, ndcg5:0.8441868632062975, pnl5:3.8840603828430176 
train 4, step: 0, loss: 1.6805806366848557, grad_norm: 1.0602476935957097e-05, ic: 0.054161405536144416
Epoch 4: 2022-04-20 17:08:28.442604: train loss: 1.6282533111280157
Eval step 0: eval loss: 1.1448755941220972
Eval: 2022-04-20 17:08:30.058194: total loss: 1.0784509018253439, mse:0.6084718088826916, ic :-0.005505327480383435, sharpe5:-1.3994779367744923, irr5:-14.940605163574219, ndcg5:0.8392728112716187, pnl5:0.8023216128349304 
train 5, step: 0, loss: 2.0264555958314454, grad_norm: 1.475038963711019e-06, ic: -0.006015422206898023
Epoch 5: 2022-04-20 17:09:06.538950: train loss: 1.6380093660908335
Eval step 0: eval loss: 1.144736571607131
Eval: 2022-04-20 17:09:08.112123: total loss: 1.0784490481556, mse:0.6084952168881186, ic :0.00037428949103533, sharpe5:2.1942896519601343, irr5:26.327346801757812, ndcg5:0.8504619925147139, pnl5:1.3026620149612427 
train 6, step: 0, loss: 1.4259443233315023, grad_norm: 1.0674899286617953e-07, ic: 0.0051954720787386974
Epoch 6: 2022-04-20 17:09:44.598301: train loss: 1.628196743337333
Eval step 0: eval loss: 1.1448639018403393
Eval: 2022-04-20 17:09:46.230252: total loss: 1.0784502962656317, mse:0.6084734688193575, ic :-0.00046865625880969993, sharpe5:2.04734576806426, irr5:22.648237228393555, ndcg5:0.8635309355434603, pnl5:1.144728422164917 
train 7, step: 0, loss: 1.273485924586777, grad_norm: 3.3931667394384285e-09, ic: 0.00487603475346458
Epoch 7: 2022-04-20 17:10:22.793081: train loss: 1.6288517204432331
Eval step 0: eval loss: 1.1449059169626998
Eval: 2022-04-20 17:10:24.390255: total loss: 1.0784509091996168, mse:0.6084663939121215, ic :0.0015924260192815357, sharpe5:5.287573385238647, irr5:126.85881042480469, ndcg5:0.849190639916566, pnl5:1.9757386445999146 
train 8, step: 0, loss: 1.968616302303714, grad_norm: 4.839463964877399e-07, ic: 0.014822051761321828
Epoch 8: 2022-04-20 17:11:00.950807: train loss: 1.627133422960599
Eval step 0: eval loss: 1.1448547792908361
Eval: 2022-04-20 17:11:02.569340: total loss: 1.0784501844499041, mse:0.608474997598939, ic :0.0026601934236730102, sharpe5:7.088384190201759, irr5:194.76950073242188, ndcg5:0.8453527983163497, pnl5:2.7815184593200684 
train 9, step: 0, loss: 2.5600874642540683, grad_norm: 2.8557828138094972e-05, ic: 0.0025335176022941355
Epoch 9: 2022-04-20 17:11:39.138079: train loss: 1.6302859606041622
Eval step 0: eval loss: 1.1449012914446417
Eval: 2022-04-20 17:11:40.824093: total loss: 1.0784508231805003, mse:0.6084671595383024, ic :0.002537906232515567, sharpe5:6.659752142429351, irr5:184.18411254882812, ndcg5:0.8484005966980684, pnl5:2.3643150329589844 
train 10, step: 0, loss: 2.0177675043050156, grad_norm: 2.1653985078288367e-05, ic: -0.001311348468806886
Epoch 10: 2022-04-20 17:12:17.444887: train loss: 1.6276650040539722
Eval step 0: eval loss: 1.1446793950644694
Eval: 2022-04-20 17:12:19.083763: total loss: 1.0784491547871164, mse:0.6085054756653717, ic :0.01069617467086167, sharpe5:1.7252172698825596, irr5:10.38976001739502, ndcg5:0.8407472450030319, pnl5:1.503305196762085 
train 11, step: 0, loss: 1.3689965271325033, grad_norm: 3.960200020090766e-06, ic: -0.025192309394254542
Epoch 11: 2022-04-20 17:12:55.637485: train loss: 1.629741811083267
Eval step 0: eval loss: 1.1449147825389776
Eval: 2022-04-20 17:12:57.290304: total loss: 1.0784510499738726, mse:0.6084649426176222, ic :0.015355795143732618, sharpe5:7.5445034202933305, irr5:201.4077606201172, ndcg5:0.8672509490718044, pnl5:3.4256460666656494 
train 12, step: 0, loss: 2.0133202684113995, grad_norm: 5.028235744031224e-07, ic: 0.01828618287787525
Epoch 12: 2022-04-20 17:13:33.962529: train loss: 1.6285169303786131
Eval step 0: eval loss: 1.1449033472304453
Eval: 2022-04-20 17:13:35.720173: total loss: 1.0784508561275392, mse:0.6084668260856791, ic :0.013313480751026813, sharpe5:7.3758287850022315, irr5:197.32757568359375, ndcg5:0.8448334952947831, pnl5:3.7614402770996094 
train 13, step: 0, loss: 1.9607876676001357, grad_norm: 7.824091120346125e-06, ic: 0.018545180730753286
Epoch 13: 2022-04-20 17:14:12.372878: train loss: 1.626273359852354
Eval step 0: eval loss: 1.1445248256693639
Eval: 2022-04-20 17:14:14.010192: total loss: 1.0784482273027447, mse:0.608532201857986, ic :0.007110209865533181, sharpe5:7.220376772284507, irr5:202.5279083251953, ndcg5:0.8511230400077159, pnl5:2.8518378734588623 
train 14, step: 0, loss: 1.6803465145157146, grad_norm: 1.2761832033795352e-05, ic: 0.024335854462472224
Epoch 14: 2022-04-20 17:14:50.693747: train loss: 1.6272461909346285
Eval step 0: eval loss: 1.1448664715725938
Eval: 2022-04-20 17:14:52.346307: total loss: 1.0784495012876343, mse:0.608472455404503, ic :0.009572387344174517, sharpe5:7.086375516951084, irr5:195.5051727294922, ndcg5:0.8566233719845731, pnl5:3.065730333328247 
train 15, step: 0, loss: 1.8141979096140826, grad_norm: 6.917736778439587e-09, ic: 0.05083453471650862
Epoch 15: 2022-04-20 17:15:29.054217: train loss: 1.6318292863287651
Eval step 0: eval loss: 1.144816233307019
Eval: 2022-04-20 17:15:30.660717: total loss: 1.0784500006657345, mse:0.6084817281547897, ic :-0.012030561202226115, sharpe5:-1.7744109642505645, irr5:-14.166399955749512, ndcg5:0.8436656064110593, pnl5:0.8409731984138489 
train 16, step: 0, loss: 1.894388435417438, grad_norm: 6.923042742088514e-06, ic: -0.013351575442306543
Epoch 16: 2022-04-20 17:16:07.368626: train loss: 1.6297192788738157
Eval step 0: eval loss: 1.1449161958917176
Eval: 2022-04-20 17:16:09.010147: total loss: 1.078451094079586, mse:0.6084647321506996, ic :0.00026782811431849056, sharpe5:6.267810661196708, irr5:170.50291442871094, ndcg5:0.8442967451204662, pnl5:3.020796537399292 
train 17, step: 0, loss: 1.802834762730098, grad_norm: 2.1499741515599168e-07, ic: 0.015290017455673856
Epoch 17: 2022-04-20 17:16:45.713229: train loss: 1.6308621218821477
Eval step 0: eval loss: 1.1449056599894742
Eval: 2022-04-20 17:16:47.318565: total loss: 1.078450931886602, mse:0.6084664898893094, ic :0.0046526679573008585, sharpe5:4.466117780506611, irr5:74.28182220458984, ndcg5:0.8534414263546813, pnl5:1.773406744003296 
train 18, step: 0, loss: 1.2144781918449197, grad_norm: 2.6801583124424296e-06, ic: 0.0006767518671218341
Epoch 18: 2022-04-20 17:17:24.030576: train loss: 1.6278801516436006
Eval step 0: eval loss: 1.1449167098381685
Eval: 2022-04-20 17:17:25.681490: total loss: 1.0784510853736706, mse:0.6084646146846829, ic :0.007014075546374048, sharpe5:7.042656722366809, irr5:186.90216064453125, ndcg5:0.8519784410183984, pnl5:2.784259080886841 
train 19, step: 0, loss: 1.4678394941692001, grad_norm: 5.363988115402609e-06, ic: 0.029902553005841853
Epoch 19: 2022-04-20 17:18:02.354494: train loss: 1.626547364495099
Eval step 0: eval loss: 1.1460936472107097
Eval: 2022-04-20 17:18:03.978327: total loss: 1.0783829129877474, mse:0.608103912295267, ic :0.01749836846284107, sharpe5:7.511403587758541, irr5:202.98504638671875, ndcg5:0.8275325662251451, pnl5:3.1893630027770996 
train 20, step: 0, loss: 1.5899073469555807, grad_norm: 0.001133986193294305, ic: 0.050310838731763174
Epoch 20: 2022-04-20 17:18:40.675620: train loss: 1.6288613859775476
Eval step 0: eval loss: 1.1453720663936582
Eval: 2022-04-20 17:18:42.282724: total loss: 1.078279107481868, mse:0.6081929468523645, ic :0.021154297021326478, sharpe5:7.611765359938144, irr5:208.31219482421875, ndcg5:0.8527214374115477, pnl5:2.9631547927856445 
train 21, step: 0, loss: 1.585521564907114, grad_norm: 0.0027669503632292347, ic: 0.039904004299804084
Epoch 21: 2022-04-20 17:19:18.972947: train loss: 1.6266382303205693
Eval step 0: eval loss: 1.149032264530294
Eval: 2022-04-20 17:19:20.624924: total loss: 1.0787033797767964, mse:0.6078243073698888, ic :0.01675576147151913, sharpe5:7.481987662911415, irr5:195.74342346191406, ndcg5:0.8414135955376567, pnl5:3.3689069747924805 
train 22, step: 0, loss: 1.1669929898610099, grad_norm: 0.004688504459798541, ic: 0.08039815543250195
Epoch 22: 2022-04-20 17:19:57.394749: train loss: 1.6279227465584931
Eval step 0: eval loss: 1.150434695908164
Eval: 2022-04-20 17:19:59.022501: total loss: 1.0791110532575783, mse:0.6078184485419648, ic :0.0185938112200849, sharpe5:7.346997442245483, irr5:177.4649200439453, ndcg5:0.8527465105002474, pnl5:3.100227117538452 
train 23, step: 0, loss: 1.5193356662991098, grad_norm: 0.0026209320668755787, ic: 0.04182319609337437
Epoch 23: 2022-04-20 17:20:35.718024: train loss: 1.62631450938521
Eval step 0: eval loss: 1.1531094017252153
Eval: 2022-04-20 17:20:37.327589: total loss: 1.0794492332167318, mse:0.6074690085564398, ic :0.027525837882555956, sharpe5:4.807912428975105, irr5:75.69971466064453, ndcg5:0.8503730183644819, pnl5:2.1679651737213135 
train 24, step: 0, loss: 1.5345914515578178, grad_norm: 0.04880245816758473, ic: 0.05778217852223503
Epoch 24: 2022-04-20 17:21:13.961863: train loss: 1.6291925926755029
Eval step 0: eval loss: 1.146222390796658
Eval: 2022-04-20 17:21:15.573295: total loss: 1.077943391581132, mse:0.6078472137307166, ic :0.03312366106661572, sharpe5:3.4715958438813685, irr5:37.9183464050293, ndcg5:0.865214468868537, pnl5:1.1188867092132568 
train 25, step: 0, loss: 1.7581810918555614, grad_norm: 0.1451963675474956, ic: 0.043416464177271026
Epoch 25: 2022-04-20 17:21:52.156809: train loss: 1.6278934556896991
Eval step 0: eval loss: 1.1446061576952173
Eval: 2022-04-20 17:21:53.803831: total loss: 1.0783408136905956, mse:0.608302404985139, ic :0.05838269891961262, sharpe5:6.7465403535962105, irr5:182.7220916748047, ndcg5:0.8425372175473095, pnl5:2.635460138320923 
train 26, step: 0, loss: 1.8694662818637693, grad_norm: 6.630422708340004e-06, ic: 0.04368977892518841
Epoch 26: 2022-04-20 17:22:30.527772: train loss: 1.6258323452648524
Eval step 0: eval loss: 1.1518367418261954
Eval: 2022-04-20 17:22:32.146229: total loss: 1.0791706163961878, mse:0.6075861936521252, ic :0.024141633617161463, sharpe5:4.403466755747795, irr5:81.2791519165039, ndcg5:0.8534388800682227, pnl5:1.9828708171844482 
train 27, step: 0, loss: 1.6410659799139473, grad_norm: 0.008263132393884504, ic: 0.05732069910508841
Epoch 27: 2022-04-20 17:23:08.800357: train loss: 1.6269552377704077
Eval step 0: eval loss: 1.1544554274801
Eval: 2022-04-20 17:23:10.422010: total loss: 1.0799928619315249, mse:0.6077219319365547, ic :0.026971384043576914, sharpe5:5.7705554866790765, irr5:110.5771713256836, ndcg5:0.837183807171498, pnl5:2.0744597911834717 
train 28, step: 0, loss: 2.1512490754868616, grad_norm: 0.022887645644342047, ic: 0.08179145661599366
Epoch 28: 2022-04-20 17:23:47.239099: train loss: 1.6280100985338797
Eval step 0: eval loss: 1.151044750345372
Eval: 2022-04-20 17:23:48.861796: total loss: 1.0789680070887917, mse:0.6075068897332978, ic :0.027329766628615866, sharpe5:8.83314795076847, irr5:227.75477600097656, ndcg5:0.8503033510923773, pnl5:2.724489688873291 
train 29, step: 0, loss: 1.4203364903204272, grad_norm: 0.001566032819124935, ic: 0.08765491666920922
Epoch 29: 2022-04-20 17:24:25.558721: train loss: 1.6250637638199579
Eval step 0: eval loss: 1.146096730889415
Eval: 2022-04-20 17:24:27.184690: total loss: 1.0781309825968415, mse:0.6077407416335151, ic :0.030089025305264964, sharpe5:8.626583315134049, irr5:114.01161193847656, ndcg5:0.857673050518616, pnl5:1.68489408493042 
train 30, step: 0, loss: 1.6720349245772894, grad_norm: 0.000177218462425836, ic: 0.07303684827100593
Epoch 30: 2022-04-20 17:25:03.968088: train loss: 1.6279229395604093
Eval step 0: eval loss: 1.1479081351555818
Eval: 2022-04-20 17:25:05.590658: total loss: 1.0765471799142987, mse:0.6045608809608312, ic :0.07090170233193191, sharpe5:12.20751090824604, irr5:235.7216339111328, ndcg5:0.8361506720503472, pnl5:2.5517754554748535 
train 31, step: 0, loss: 1.522099474159979, grad_norm: 0.01745040215266684, ic: 0.10968502078194764
Epoch 31: 2022-04-20 17:25:42.326380: train loss: 1.62010172322612
Eval step 0: eval loss: 1.1375938723192551
Eval: 2022-04-20 17:25:43.985034: total loss: 1.0726531928172565, mse:0.5875804812311314, ic :0.13992891766969445, sharpe5:11.997901337742805, irr5:389.2893981933594, ndcg5:0.8602981321645163, pnl5:3.040850877761841 
train 32, step: 0, loss: 1.3467074602214324, grad_norm: 0.0003121246966511167, ic: 0.17522322942907342
Epoch 32: 2022-04-20 17:26:57.659880: train loss: 1.6134605898583902
Eval step 0: eval loss: 1.1356904716383789
Eval: 2022-04-20 17:26:59.370531: total loss: 1.070138617555867, mse:0.5819046864378441, ic :0.14984803401342978, sharpe5:12.425461651682854, irr5:407.4206848144531, ndcg5:0.8496487043728669, pnl5:4.816560745239258 
train 33, step: 0, loss: 1.3651519265026524, grad_norm: 0.0035703304984169345, ic: 0.19612592020853822
Epoch 33: 2022-04-20 17:28:12.848963: train loss: 1.6132990766088833
Eval step 0: eval loss: 1.135200423697454
Eval: 2022-04-20 17:28:14.588751: total loss: 1.0700637971626672, mse:0.5817763967838406, ic :0.14750789135705925, sharpe5:12.412958405613898, irr5:406.9003601074219, ndcg5:0.8463855441241523, pnl5:4.2603230476379395 
train 34, step: 0, loss: 2.1871077701314707, grad_norm: 0.010340768111910429, ic: 0.19598620581065945
Epoch 34: 2022-04-20 17:28:51.337233: train loss: 1.6144306100672032
Eval step 0: eval loss: 1.1346449760706532
Eval: 2022-04-20 17:28:53.045790: total loss: 1.0709561334117228, mse:0.5828549000538535, ic :0.14135327134725614, sharpe5:11.870639330148697, irr5:384.70220947265625, ndcg5:0.8531706379474752, pnl5:3.389484167098999 
train 35, step: 0, loss: 1.8717644708012877, grad_norm: 0.11498034094825632, ic: 0.10116579684019417
Epoch 35: 2022-04-20 17:29:29.793652: train loss: 1.6174299042671931
Eval step 0: eval loss: 1.135450715619038
Eval: 2022-04-20 17:29:31.420070: total loss: 1.0704716328067303, mse:0.5824593593300806, ic :0.14333139189504718, sharpe5:12.085846889019011, irr5:388.35662841796875, ndcg5:0.8274980419518774, pnl5:3.7142536640167236 
train 36, step: 0, loss: 1.6091802356494476, grad_norm: 0.002294985086515284, ic: 0.032516585984656614
Epoch 36: 2022-04-20 17:30:08.137609: train loss: 1.6180667692621775
Eval step 0: eval loss: 1.1403772778106702
Eval: 2022-04-20 17:30:09.758518: total loss: 1.0735017650280922, mse:0.5838208166011689, ic :0.1406393131872726, sharpe5:12.057354660630226, irr5:388.13165283203125, ndcg5:0.8440374922200559, pnl5:3.0423004627227783 
train 37, step: 0, loss: 1.5676005888267381, grad_norm: 0.01426891694090278, ic: 0.16178129906324074
Epoch 37: 2022-04-20 17:30:46.494202: train loss: 1.6146486851782833
Eval step 0: eval loss: 1.134428090668377
Eval: 2022-04-20 17:30:48.142126: total loss: 1.0700577489609047, mse:0.5821724292234193, ic :0.14750198227494915, sharpe5:12.331933246850967, irr5:406.153076171875, ndcg5:0.8472117554216576, pnl5:4.296195983886719 
train 38, step: 0, loss: 1.8613464108849906, grad_norm: 0.0007324306685363971, ic: 0.04700036071082727
Epoch 38: 2022-04-20 17:31:24.884573: train loss: 1.6159684222377004
Eval step 0: eval loss: 1.1339239092000526
Eval: 2022-04-20 17:31:26.559755: total loss: 1.070108195153981, mse:0.5823333935379874, ic :0.14807933379632643, sharpe5:12.367976800203323, irr5:404.7898864746094, ndcg5:0.852844192456672, pnl5:5.0508832931518555 
train 39, step: 0, loss: 1.5509439179316504, grad_norm: 0.0001859350576689077, ic: 0.16060641475871776
Epoch 39: 2022-04-20 17:32:03.255140: train loss: 1.619772189100686
Eval step 0: eval loss: 1.1365583987073218
Eval: 2022-04-20 17:32:04.905527: total loss: 1.0705574089926986, mse:0.5817963791878356, ic :0.14882041706153723, sharpe5:12.303088188171387, irr5:409.0250244140625, ndcg5:0.8610712945245843, pnl5:4.7278666496276855 
