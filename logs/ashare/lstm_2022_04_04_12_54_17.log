Namespace(adj_path='./data/concepts_graph_1931_233_3.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=8, dataset_type='TimeDataset', dout=0.3, epochs=40, gnn_layers=2, gpu=0, hidden_dim=128, input_dim=9, input_graph=False, label_cnt=3, lr=0.001, lstm_layers=3, mask_adj=False, mask_type='soft', model_type='BaseLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, relation_num=1, seed=10086, shuffle=True, side_info=False, sparse_adj_path=None, stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
33245
BaseLSTM(
  (rnn1): LSTM(9, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (predict): Linear(in_features=128, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 2.985248540521978, grad_norm: 0.00012270928116657045, ic: -0.005318861933452306
Epoch 0: 2022-04-04 00:54:49.651765: train loss: 1.628940900319103
Eval step 0: eval loss: 1.147585376784422
Eval: 2022-04-04 00:54:51.455809: total loss: 1.078642352360862, mse:0.6081191968069355, ic :0.005719450411333904, sharpe5:7.570127601921558, irr5:213.34085083007812, ndcg5:0.8673757088128712, pnl5:2.679420232772827 
train 1, step: 0, loss: 1.5097566885723712, grad_norm: 0.020068755330231364, ic: 0.03580654748593423
Epoch 1: 2022-04-04 00:55:17.430668: train loss: 1.6285144338377044
Eval step 0: eval loss: 1.148564059313532
Eval: 2022-04-04 00:55:19.322904: total loss: 1.0787973236822177, mse:0.6080530659492721, ic :0.006256845791983622, sharpe5:7.170330207645892, irr5:203.90069580078125, ndcg5:0.8477634748498816, pnl5:2.695709228515625 
train 2, step: 0, loss: 1.653695234175349, grad_norm: 0.06336963633114981, ic: 0.03883705467073699
Epoch 2: 2022-04-04 00:55:45.056875: train loss: 1.6294259296164784
Eval step 0: eval loss: 1.1472104528484968
Eval: 2022-04-04 00:55:46.878401: total loss: 1.0785876932622098, mse:0.6081456981992656, ic :0.004983234654545178, sharpe5:7.086442677676677, irr5:201.3794403076172, ndcg5:0.8336321541034377, pnl5:2.8830339908599854 
train 3, step: 0, loss: 1.3161978886045258, grad_norm: 0.0018185540684623016, ic: 0.0851110363406537
Epoch 3: 2022-04-04 00:56:12.555185: train loss: 1.627163865818415
Eval step 0: eval loss: 1.1495568753700414
Eval: 2022-04-04 00:56:14.365922: total loss: 1.0789893495394454, mse:0.6080122564150451, ic :0.007326481892127909, sharpe5:7.093994475603103, irr5:200.1964111328125, ndcg5:0.8465779341382771, pnl5:2.8846065998077393 
train 4, step: 0, loss: 1.6937556257827178, grad_norm: 0.09602318425537093, ic: 0.0409346578630462
Epoch 4: 2022-04-04 00:56:40.096158: train loss: 1.6278371689355373
Eval step 0: eval loss: 1.1501260710644035
Eval: 2022-04-04 00:56:41.880831: total loss: 1.0790901982831713, mse:0.6079781426400704, ic :0.01035528366276387, sharpe5:7.14405475616455, irr5:203.10520935058594, ndcg5:0.8578116928101499, pnl5:2.8850655555725098 
train 5, step: 0, loss: 2.0316960240144994, grad_norm: 0.012920744735943313, ic: 0.03226932527603514
Epoch 5: 2022-04-04 00:57:07.454174: train loss: 1.6374209320571578
Eval step 0: eval loss: 1.1499712446960726
Eval: 2022-04-04 00:57:09.262379: total loss: 1.080041850023889, mse:0.6086674244321859, ic :0.008028343474879745, sharpe5:7.117307760715485, irr5:202.02935791015625, ndcg5:0.8412232453421497, pnl5:2.7635715007781982 
train 6, step: 0, loss: 1.4225342668566328, grad_norm: 0.00013279763463019758, ic: 0.11798233688217152
Epoch 6: 2022-04-04 00:57:35.534416: train loss: 1.6280884683090406
Eval step 0: eval loss: 1.1493318953111635
Eval: 2022-04-04 00:57:37.429265: total loss: 1.0788969077378334, mse:0.6079791454284427, ic :0.007741713186848686, sharpe5:7.1640610849857325, irr5:203.7025604248047, ndcg5:0.8381395489377104, pnl5:2.9651403427124023 
train 7, step: 0, loss: 1.2746313907141944, grad_norm: 0.0006838480383107494, ic: 0.08161678061698475
Epoch 7: 2022-04-04 00:58:03.068393: train loss: 1.6286071586934
Eval step 0: eval loss: 1.1506075104022762
Eval: 2022-04-04 00:58:04.874896: total loss: 1.0791697553010786, mse:0.6079337344919569, ic :0.007485497004757982, sharpe5:7.044695192277431, irr5:200.6104278564453, ndcg5:0.8508975588808076, pnl5:2.8768723011016846 
train 8, step: 0, loss: 1.9740835830982604, grad_norm: 0.006653268076183862, ic: 0.08083907774493113
Epoch 8: 2022-04-04 00:58:30.600225: train loss: 1.6265315404773772
Eval step 0: eval loss: 1.1478526289388855
Eval: 2022-04-04 00:58:32.383422: total loss: 1.078620609087559, mse:0.6080575980172412, ic :0.008273142002783332, sharpe5:7.233626353740692, irr5:204.55775451660156, ndcg5:0.8545328643232508, pnl5:2.734668493270874 
train 9, step: 0, loss: 2.570644156798776, grad_norm: 0.19318461698145045, ic: 0.07814749636338555
Epoch 9: 2022-04-04 00:58:58.075314: train loss: 1.6290535456086963
Eval step 0: eval loss: 1.1443810491497268
Eval: 2022-04-04 00:58:59.884235: total loss: 1.0814922145224395, mse:0.6109145929712945, ic :0.008535799536024707, sharpe5:6.9747118243575095, irr5:197.960693359375, ndcg5:0.850608147356201, pnl5:2.610203504562378 
train 10, step: 0, loss: 2.0063145407431118, grad_norm: 0.2436141613920725, ic: 0.031124869711628235
Epoch 10: 2022-04-04 00:59:25.634641: train loss: 1.62695400734722
Eval step 0: eval loss: 1.1493171193507006
Eval: 2022-04-04 00:59:27.448056: total loss: 1.0788776076677942, mse:0.6079633304836258, ic :0.014032001116821888, sharpe5:6.9525525686144825, irr5:196.7533416748047, ndcg5:0.8447397370286303, pnl5:2.4698338508605957 
train 11, step: 0, loss: 1.370177258525367, grad_norm: 0.021063552502828348, ic: 0.113179892832473
Epoch 11: 2022-04-04 00:59:53.115033: train loss: 1.6283306710285679
Eval step 0: eval loss: 1.1524455113972765
Eval: 2022-04-04 00:59:54.895581: total loss: 1.0795058404767255, mse:0.607752320806039, ic :0.02234951070517577, sharpe5:7.272345457971095, irr5:200.11474609375, ndcg5:0.8477514596236719, pnl5:2.6982510089874268 
train 12, step: 0, loss: 2.0145365626763545, grad_norm: 0.0035332028968637678, ic: 0.11572248588567162
Epoch 12: 2022-04-04 01:00:21.269692: train loss: 1.6276913443992578
Eval step 0: eval loss: 1.1513749609400696
Eval: 2022-04-04 01:00:23.126975: total loss: 1.0792674161121254, mse:0.6078500947436178, ic :0.02212542687084732, sharpe5:7.147761366069316, irr5:197.1044464111328, ndcg5:0.8566488382142823, pnl5:2.566730260848999 
train 13, step: 0, loss: 1.9768356457909029, grad_norm: 0.07244590651752635, ic: 0.05150990099970698
Epoch 13: 2022-04-04 01:00:48.870263: train loss: 1.6248614956324656
Eval step 0: eval loss: 1.142154761611078
Eval: 2022-04-04 01:00:50.671366: total loss: 1.0805618968114137, mse:0.610798869852071, ic :0.01629563746376552, sharpe5:7.023636048138141, irr5:194.51243591308594, ndcg5:0.8348391210914076, pnl5:2.64632248878479 
train 14, step: 0, loss: 1.6690678323306498, grad_norm: 0.03714003628585192, ic: 0.11005715764712266
Epoch 14: 2022-04-04 01:01:17.055026: train loss: 1.6260152408827515
Eval step 0: eval loss: 1.1506107225675941
Eval: 2022-04-04 01:01:18.829854: total loss: 1.078949886336567, mse:0.6075984057658446, ic :0.0324299494907713, sharpe5:7.167265408337116, irr5:198.94085693359375, ndcg5:0.8479138508386258, pnl5:3.1044046878814697 
train 15, step: 0, loss: 1.8100645915949318, grad_norm: 0.0018475969794817524, ic: 0.06509407839382786
Epoch 15: 2022-04-04 01:01:45.192762: train loss: 1.6306656412895442
Eval step 0: eval loss: 1.1515165531872902
Eval: 2022-04-04 01:01:46.894758: total loss: 1.0788564690979687, mse:0.6072186964872842, ic :0.04113928465964166, sharpe5:7.129482297599315, irr5:198.76686096191406, ndcg5:0.8532061741619648, pnl5:2.9540252685546875 
train 16, step: 0, loss: 1.8819539855030545, grad_norm: 0.0120494053188451, ic: -0.02755972157405792
Epoch 16: 2022-04-04 01:02:12.594248: train loss: 1.6281509925656361
Eval step 0: eval loss: 1.1472662160384184
Eval: 2022-04-04 01:02:14.377821: total loss: 1.0778521085579529, mse:0.6073554646041447, ic :0.04438602379033652, sharpe5:7.09635881692171, irr5:200.62054443359375, ndcg5:0.8502046641124548, pnl5:3.00955867767334 
train 17, step: 0, loss: 1.803277091302096, grad_norm: 0.0032896416673052656, ic: 0.019047889999309717
Epoch 17: 2022-04-04 01:02:40.098904: train loss: 1.630450337575931
Eval step 0: eval loss: 1.1517103109992763
Eval: 2022-04-04 01:02:41.932045: total loss: 1.079115256600514, mse:0.607569448626624, ic :0.03351732933579914, sharpe5:7.2102307730913155, irr5:201.7878875732422, ndcg5:0.8430884970261701, pnl5:3.0218706130981445 
train 18, step: 0, loss: 1.2027640113218583, grad_norm: 0.017584003136794004, ic: 0.03483412522268634
Epoch 18: 2022-04-04 01:03:07.670001: train loss: 1.6267984359415073
Eval step 0: eval loss: 1.1441460471350569
Eval: 2022-04-04 01:03:09.470062: total loss: 1.0775889417741986, mse:0.6078601044692263, ic :0.035232100024961126, sharpe5:7.040887841284275, irr5:196.13967895507812, ndcg5:0.8537503065655405, pnl5:2.3854215145111084 
train 19, step: 0, loss: 1.4651419327736084, grad_norm: 0.05439321610085235, ic: 0.027855910524817208
Epoch 19: 2022-04-04 01:03:39.291747: train loss: 1.6249702341383587
Eval step 0: eval loss: 1.1520911453193867
Eval: 2022-04-04 01:03:41.205380: total loss: 1.0788367993669836, mse:0.607095714359678, ic :0.043322942026569576, sharpe5:7.300074797272682, irr5:202.9096221923828, ndcg5:0.8422279904440944, pnl5:2.0814895629882812 
train 20, step: 0, loss: 1.6030145692170148, grad_norm: 0.012107564929026909, ic: 0.04516850692299882
Epoch 20: 2022-04-04 01:04:07.981007: train loss: 1.626950090994097
Eval step 0: eval loss: 1.147098669495428
Eval: 2022-04-04 01:04:09.761129: total loss: 1.0777879894240676, mse:0.607492628702483, ic :0.04258984477403736, sharpe5:7.857283689379692, irr5:217.97947692871094, ndcg5:0.8531756545510126, pnl5:2.9129436016082764 
train 21, step: 0, loss: 1.5802616674218397, grad_norm: 0.015151927746497689, ic: 0.024873251880758843
Epoch 21: 2022-04-04 01:04:35.858124: train loss: 1.6249385935794056
Eval step 0: eval loss: 1.1470626932438654
Eval: 2022-04-04 01:04:37.704867: total loss: 1.0783479947608774, mse:0.6081074835234273, ic :0.03938718636488501, sharpe5:6.766017436981201, irr5:191.99493408203125, ndcg5:0.846671840048251, pnl5:2.884643077850342 
train 22, step: 0, loss: 1.167508016477999, grad_norm: 0.006092073669833678, ic: 0.09205580073867306
Epoch 22: 2022-04-04 01:05:08.990315: train loss: 1.6259855499585707
Eval step 0: eval loss: 1.14727572404776
Eval: 2022-04-04 01:05:10.914523: total loss: 1.0783141670755587, mse:0.6080728031584268, ic :0.04178970352655838, sharpe5:0.6663574273511768, irr5:5.16497802734375, ndcg5:0.8471931946890155, pnl5:1.0566933155059814 
train 23, step: 0, loss: 1.5212927795474966, grad_norm: 0.0012209541202113366, ic: 0.06827050815104495
Epoch 23: 2022-04-04 01:05:41.689120: train loss: 1.6245988319581781
Eval step 0: eval loss: 1.1503830442898493
Eval: 2022-04-04 01:05:43.776664: total loss: 1.0781249516665996, mse:0.6069699045990216, ic :0.047768310824311204, sharpe5:7.60033621251583, irr5:217.7733612060547, ndcg5:0.8349262479318056, pnl5:2.755415439605713 
train 24, step: 0, loss: 1.530599991186321, grad_norm: 0.05231425141346689, ic: 0.07723896415690264
Epoch 24: 2022-04-04 01:06:15.160031: train loss: 1.6282164169941629
Eval step 0: eval loss: 1.1444337286609432
Eval: 2022-04-04 01:06:17.084401: total loss: 1.0779349662012985, mse:0.6081670415498683, ic :0.04112886661041602, sharpe5:-0.9144892904162406, irr5:-13.787778854370117, ndcg5:0.8474823176456514, pnl5:0.9116770625114441 
train 25, step: 0, loss: 1.7488262717448604, grad_norm: 0.20822427974857535, ic: 0.05442071511908184
Epoch 25: 2022-04-04 01:06:47.606465: train loss: 1.6267791566694119
Eval step 0: eval loss: 1.1501237583053745
Eval: 2022-04-04 01:06:49.548306: total loss: 1.0781646026809224, mse:0.6071027928836493, ic :0.04673048642806281, sharpe5:-0.5825630119442939, irr5:-8.111197471618652, ndcg5:0.8460339688579417, pnl5:1.0971295833587646 
train 26, step: 0, loss: 1.8698260551608858, grad_norm: 0.00047060085834926867, ic: -0.018285092400489603
Epoch 26: 2022-04-04 01:07:20.901665: train loss: 1.6246205440485306
Eval step 0: eval loss: 1.147042906305506
Eval: 2022-04-04 01:07:22.883047: total loss: 1.0798506988281875, mse:0.6095264588460387, ic :0.03953478613523291, sharpe5:7.355651716589927, irr5:212.34555053710938, ndcg5:0.8415012390426106, pnl5:2.9566457271575928 
train 27, step: 0, loss: 1.6238424693277669, grad_norm: 0.005590470442232676, ic: 0.04224725646778908
Epoch 27: 2022-04-04 01:07:53.481572: train loss: 1.62557659407347
Eval step 0: eval loss: 1.1540834587362672
Eval: 2022-04-04 01:07:55.526138: total loss: 1.07983446169179, mse:0.6064128028788137, ic :0.057577986393847036, sharpe5:9.377539549469947, irr5:275.5480041503906, ndcg5:0.8463005508334717, pnl5:2.913738965988159 
train 28, step: 0, loss: 2.138263123718785, grad_norm: 0.042734083840052534, ic: 0.093595057839864
Epoch 28: 2022-04-04 01:08:26.921954: train loss: 1.6265505209095255
Eval step 0: eval loss: 1.1436553567610683
Eval: 2022-04-04 01:08:28.868808: total loss: 1.07954183134417, mse:0.6097451861091179, ic :0.03611656300664283, sharpe5:8.274800164103507, irr5:240.53790283203125, ndcg5:0.8436600673216047, pnl5:2.262035369873047 
train 29, step: 0, loss: 1.4171594026410212, grad_norm: 0.009633966744039867, ic: 0.07267885342774702
Epoch 29: 2022-04-04 01:08:59.378615: train loss: 1.6227362578378
Eval step 0: eval loss: 1.1554763821047955
Eval: 2022-04-04 01:09:01.358065: total loss: 1.080373092754379, mse:0.6069826716708062, ic :0.05594643384723817, sharpe5:8.775707557797432, irr5:256.7093505859375, ndcg5:0.8525664046137598, pnl5:2.7573060989379883 
train 30, step: 0, loss: 1.6688917528538323, grad_norm: 0.008106385049568905, ic: 0.08563625635800871
Epoch 30: 2022-04-04 01:09:32.081773: train loss: 1.6268727505972571
Eval step 0: eval loss: 1.1507263605190448
Eval: 2022-04-04 01:09:33.903535: total loss: 1.0786966255458348, mse:0.6055498600899957, ic :0.07268903655264759, sharpe5:9.6031220215559, irr5:285.6180419921875, ndcg5:0.8562331882726312, pnl5:2.8789443969726562 
train 31, step: 0, loss: 1.5204200519225681, grad_norm: 0.019546200823367603, ic: 0.13741416402993772
Epoch 31: 2022-04-04 01:09:59.573929: train loss: 1.6207949301157454
Eval step 0: eval loss: 1.1439375133626075
Eval: 2022-04-04 01:10:01.371128: total loss: 1.074596911035377, mse:0.5952895079668324, ic :0.14247169485335975, sharpe5:9.624358999729155, irr5:304.4888610839844, ndcg5:0.8339733647161912, pnl5:3.2578742504119873 
train 32, step: 0, loss: 1.3535698319984582, grad_norm: 0.00766813550567767, ic: 0.1218902607156297
Epoch 32: 2022-04-04 01:10:27.073883: train loss: 1.6154610205860114
Eval step 0: eval loss: 1.139052837806723
Eval: 2022-04-04 01:10:28.910525: total loss: 1.0728962966651758, mse:0.5937036150131882, ic :0.14796584756562509, sharpe5:11.509864209294319, irr5:363.0805358886719, ndcg5:0.826973090764844, pnl5:4.336245059967041 
train 33, step: 0, loss: 1.3635666148736738, grad_norm: 0.030768817637958374, ic: 0.18251509761849283
Epoch 33: 2022-04-04 01:10:56.382122: train loss: 1.617338474898286
Eval step 0: eval loss: 1.1417893456844943
Eval: 2022-04-04 01:10:58.181980: total loss: 1.0731256574387609, mse:0.5928853069701865, ic :0.1520990284792255, sharpe5:10.90935935139656, irr5:344.7080993652344, ndcg5:0.8417153143554864, pnl5:3.8082947731018066 
train 34, step: 0, loss: 2.1880032867707477, grad_norm: 0.014664395561086611, ic: 0.1500962062894884
Epoch 34: 2022-04-04 01:11:23.954891: train loss: 1.6166210985340126
Eval step 0: eval loss: 1.137893503100125
Eval: 2022-04-04 01:11:25.774948: total loss: 1.0709852450473747, mse:0.5822461611080326, ic :0.1616254983560911, sharpe5:11.30093381345272, irr5:360.978759765625, ndcg5:0.8398984286905273, pnl5:2.440485715866089 
train 35, step: 0, loss: 1.8444357421525666, grad_norm: 0.04910742438688657, ic: 0.13700989527181634
Epoch 35: 2022-04-04 01:11:51.558384: train loss: 1.6163557058712765
Eval step 0: eval loss: 1.1381004950332214
Eval: 2022-04-04 01:11:53.353801: total loss: 1.0714036412029373, mse:0.5834044836838658, ic :0.158677160719022, sharpe5:11.456995475292205, irr5:362.1585998535156, ndcg5:0.8495282052950607, pnl5:3.85776686668396 
train 36, step: 0, loss: 1.6150707866492722, grad_norm: 0.0014760528168662455, ic: 0.03712710226094598
Epoch 36: 2022-04-04 01:12:19.149163: train loss: 1.6170971853567861
Eval step 0: eval loss: 1.1432891699148082
Eval: 2022-04-04 01:12:20.932320: total loss: 1.07206465778209, mse:0.582548588287759, ic :0.16215015524472015, sharpe5:11.614602779746056, irr5:366.4657287597656, ndcg5:0.8404933755354712, pnl5:4.338320255279541 
train 37, step: 0, loss: 1.53501630252635, grad_norm: 0.08933457411345348, ic: 0.1869944553481801
Epoch 37: 2022-04-04 01:12:46.704940: train loss: 1.6117840278586406
Eval step 0: eval loss: 1.1349704326606802
Eval: 2022-04-04 01:12:48.470882: total loss: 1.0756729574244193, mse:0.587463033489661, ic :0.15259845793443533, sharpe5:11.490240980386734, irr5:379.2599182128906, ndcg5:0.8475897520394953, pnl5:3.706625461578369 
train 38, step: 0, loss: 1.8502882625406525, grad_norm: 0.08374042831812273, ic: 0.054864154660640416
Epoch 38: 2022-04-04 01:13:14.265059: train loss: 1.613573781148148
Eval step 0: eval loss: 1.1380600217502137
Eval: 2022-04-04 01:13:16.061508: total loss: 1.0706438486504621, mse:0.582287916490418, ic :0.16156200760703526, sharpe5:11.713635526299477, irr5:391.74859619140625, ndcg5:0.849719112664763, pnl5:3.6726491451263428 
train 39, step: 0, loss: 1.559547561185973, grad_norm: 0.002868841479173865, ic: 0.15697376285997092
Epoch 39: 2022-04-04 01:13:41.831552: train loss: 1.6172150475487284
Eval step 0: eval loss: 1.1409397922011708
Eval: 2022-04-04 01:13:43.729411: total loss: 1.0710538524963669, mse:0.5819811576391141, ic :0.16508879374107382, sharpe5:11.483698958158492, irr5:384.5101623535156, ndcg5:0.8373431367630454, pnl5:3.2717478275299072 
