Namespace(adj_path='./data/graphs/concepts_graph_multihot_1931_1931_824.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='TimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=True, input_dim=9, input_graph=False, label_cnt=3, lr=0.0004, lstm_layers=1, market=None, mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path=None, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
relation encoding shape: torch.Size([1931, 1931, 824]) torch.float32
relation mask shape: torch.Size([1931, 1931]) torch.float32
90420
ReRaLSTM(
  (rnn1): LSTM(9, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=824, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 4.838890857114934, grad_norm: 7.969836008369453e-05, ic: 0.007738539775790629
train 0, step: 500, loss: 0.8796371080503486, grad_norm: 4.063902347495394e-06, ic: 0.04803282932752671
train 0, step: 1000, loss: 1.9048053375891552, grad_norm: 4.583807431122973e-05, ic: 0.01568170816508741
train 0, step: 1500, loss: 0.9318673959362648, grad_norm: 2.010342667361695e-05, ic: 0.09928814030416445
train 0, step: 2000, loss: 0.9845905784568484, grad_norm: 0.005733731708492982, ic: 0.04768306071292125
Epoch 0: 2022-05-13 10:52:47.393087: train loss: 1.6468395149963002
Eval step 0: eval loss: 0.8334041229666095
Eval: 2022-05-13 10:52:50.795397: total loss: 1.0786967051979515, mse:4.8262966124672175, ic :0.015374397205279708, sharpe5:1.2617284508049487, sharpe5_real:465.4300185012817, irr5:12.374537467956543, irr5_real:1197.3116455078125, ndcg5:0.8413617109181064, pnl5:1.022432565689087 
train 1, step: 0, loss: 2.729894231980847, grad_norm: 7.799650080793934e-05, ic: 0.10922237373940533
train 1, step: 500, loss: 1.792260911196114, grad_norm: 7.114946852617912e-05, ic: 0.013378490842586794
train 1, step: 1000, loss: 0.8519697575814622, grad_norm: 0.018840900199793356, ic: 0.035002149599126474
train 1, step: 1500, loss: 1.7075922121946838, grad_norm: 0.12395903043386043, ic: -0.008268121556223387
train 1, step: 2000, loss: 2.1866728515625002, grad_norm: 0.15142791176610115, ic: -0.027118577684000344
Epoch 1: 2022-05-13 10:54:27.630732: train loss: 1.6468805169201988
Eval step 0: eval loss: 0.833440139497168
Eval: 2022-05-13 10:54:31.049760: total loss: 1.0786846592638606, mse:4.825947616189769, ic :0.05796048595790368, sharpe5:1.4127448996156453, sharpe5_real:465.43026065826416, irr5:15.159021377563477, irr5_real:1197.3116455078125, ndcg5:0.8600263519499162, pnl5:0.86257404088974 
train 2, step: 0, loss: 2.1439825994318182, grad_norm: 1.578241661596562e-05, ic: 0.12493325508414309
train 2, step: 500, loss: 3.3074544270833335, grad_norm: 0.008682391474633958, ic: -0.022237422533516897
train 2, step: 1000, loss: 2.0670449443247128, grad_norm: 0.003824573390766932, ic: 0.20931207146688455
train 2, step: 1500, loss: 1.4783047508647424, grad_norm: 0.055569628791508605, ic: -0.07550212863800373
train 2, step: 2000, loss: 3.228837890625, grad_norm: 0.3342654072811989, ic: 0.1440613695363145
Epoch 2: 2022-05-13 10:56:07.841321: train loss: 1.6462562289524687
Eval step 0: eval loss: 0.8358514462180584
Eval: 2022-05-13 10:56:11.229189: total loss: 1.0789867160165338, mse:4.8209486080357316, ic :0.02025340255937895, sharpe5:4.121097052395344, sharpe5_real:465.43026065826416, irr5:40.71305847167969, irr5_real:1197.3116455078125, ndcg5:0.8638045908984396, pnl5:1.3798543214797974 
train 3, step: 0, loss: 1.5107312706427845, grad_norm: 0.09735871362739837, ic: 0.09706222886057195
train 3, step: 500, loss: 1.4815973029439116, grad_norm: 0.21502674221432289, ic: 0.15277057775371305
train 3, step: 1000, loss: 3.7031778479418542, grad_norm: 0.4648711153996976, ic: 0.016383999955201803
train 3, step: 1500, loss: 1.9485878202997138, grad_norm: 0.03132435214663547, ic: -0.024637566948623034
train 3, step: 2000, loss: 0.8953026024070946, grad_norm: 0.00012664654440793202, ic: 0.008131748066985554
Epoch 3: 2022-05-13 10:57:48.272889: train loss: 1.6457753898272836
Eval step 0: eval loss: 0.8356127080726422
Eval: 2022-05-13 10:57:51.619140: total loss: 1.0786508572419684, mse:4.819034450257706, ic :0.024590696711510235, sharpe5:4.51348217278719, sharpe5_real:465.4300185012817, irr5:42.8917350769043, irr5_real:1197.3116455078125, ndcg5:0.838086935374575, pnl5:1.2618502378463745 
train 4, step: 0, loss: 1.4389888592155613, grad_norm: 0.021587194961034756, ic: 0.034577385762276244
train 4, step: 500, loss: 1.6554235743725394, grad_norm: 0.42603244608139323, ic: 0.019036729685293154
train 4, step: 1000, loss: 2.9606844274009148, grad_norm: 0.4379615569103351, ic: 0.047890926258345776
train 4, step: 1500, loss: 2.15175410403481, grad_norm: 0.09213857888251811, ic: 0.030613920424191456
train 4, step: 2000, loss: 1.0868673606386081, grad_norm: 0.4636995812655664, ic: 0.13031519869146255
Epoch 4: 2022-05-13 10:59:28.331740: train loss: 1.6452212720960229
Eval step 0: eval loss: 0.8574501737025816
Eval: 2022-05-13 10:59:31.709457: total loss: 1.0936655213014628, mse:4.857364353450383, ic :0.02468083126640296, sharpe5:3.602753173559904, sharpe5_real:465.43026065826416, irr5:36.73154067993164, irr5_real:1197.3116455078125, ndcg5:0.857368291328463, pnl5:1.2949280738830566 
train 5, step: 0, loss: 1.383089738884228, grad_norm: 0.4046148413140646, ic: 0.07623680332004039
train 5, step: 500, loss: 0.8900499820331087, grad_norm: 0.0070544262991959, ic: 0.09521171443902092
train 5, step: 1000, loss: 0.9906115301724139, grad_norm: 0.13470378787489884, ic: -0.019739914907527377
train 5, step: 1500, loss: 1.5345481416897973, grad_norm: 0.1463824287651459, ic: 0.04250168841883987
train 5, step: 2000, loss: 1.1204835400503914, grad_norm: 0.021333153164611703, ic: 0.08450649640519264
Epoch 5: 2022-05-13 11:01:08.671377: train loss: 1.6454927627954987
Eval step 0: eval loss: 0.839883239553148
Eval: 2022-05-13 11:01:11.993968: total loss: 1.0808365792338896, mse:4.821329995209709, ic :0.026585011403393647, sharpe5:4.74748243778944, sharpe5_real:465.4300185012817, irr5:45.179359436035156, irr5_real:1197.3116455078125, ndcg5:0.8518658234489439, pnl5:1.3323053121566772 
train 6, step: 0, loss: 1.3264877587033992, grad_norm: 0.3038874747784811, ic: 0.08521571516075142
train 6, step: 500, loss: 1.0088047652660797, grad_norm: 0.035348720635121615, ic: 0.01571070425017686
train 6, step: 1000, loss: 1.1222546711620722, grad_norm: 0.06420330991302821, ic: 0.14050455491312813
train 6, step: 1500, loss: 1.581220339940599, grad_norm: 0.37200278299060024, ic: 0.09762763206019819
train 6, step: 2000, loss: 0.8063179058872098, grad_norm: 0.029403910706139097, ic: 0.05132651685424607
Epoch 6: 2022-05-13 11:02:48.904762: train loss: 1.6452446767798237
Eval step 0: eval loss: 0.8352609037473656 
Eval: 2022-05-13 11:02:52.237880: total loss: 1.0783141530366334, mse:4.8170015292479125, ic :0.030323011797881005, sharpe5:3.4533411329984665, sharpe5_real:465.4302909278869, irr5:37.143157958984375, irr5_real:1197.3116455078125, ndcg5:0.8438321734193617, pnl5:1.2728197574615479 
train 7, step: 0, loss: 0.9957713127136231, grad_norm: 0.030220000922740492, ic: 0.04920350324729194
train 7, step: 500, loss: 0.6519166430441442, grad_norm: 0.003072119357655474, ic: 0.058645198534925516
train 7, step: 1000, loss: 1.0418147997191547, grad_norm: 0.06378190470004245, ic: 0.06265674905036632
train 7, step: 1500, loss: 2.276927690413987, grad_norm: 0.23255362886345377, ic: 0.08383317454537247
train 7, step: 2000, loss: 0.904364516546345, grad_norm: 0.02931149155034271, ic: -0.01877382551840464
Epoch 7: 2022-05-13 11:04:29.071990: train loss: 1.6452219231648957
Eval step 0: eval loss: 0.8380332118718716
Eval: 2022-05-13 11:04:32.403791: total loss: 1.0796720407329228, mse:4.817824056279595, ic :0.029578430303367022, sharpe5:4.09110411286354, sharpe5_real:465.43026065826416, irr5:41.81480026245117, irr5_real:1197.3116455078125, ndcg5:0.84810516713953, pnl5:1.5077064037322998 
train 8, step: 0, loss: 3.613980412137681, grad_norm: 0.6445356047208991, ic: -0.03636035684510986
train 8, step: 500, loss: 2.773287231074278, grad_norm: 0.48293651007053784, ic: 0.03658345699352981
train 8, step: 1000, loss: 3.0622134001358696, grad_norm: 0.28294653659332963, ic: -0.03676393934798497
train 8, step: 1500, loss: 0.758452428401472, grad_norm: 0.007714495812035509, ic: 0.043382826127924726
train 8, step: 2000, loss: 1.1161888255079093, grad_norm: 0.26062328863123635, ic: 0.10154638870080467
Epoch 8: 2022-05-13 11:06:09.414352: train loss: 1.6451859583276796
Eval step 0: eval loss: 0.8347971909164251
Eval: 2022-05-13 11:06:12.779943: total loss: 1.0781586121989868, mse:4.816989366984555, ic :0.029436279988619488, sharpe5:3.649952265322208, sharpe5_real:465.4301093101501, irr5:37.97858810424805, irr5_real:1197.3116455078125, ndcg5:0.8409519206153535, pnl5:1.2428232431411743 
train 9, step: 0, loss: 5.354881566487241, grad_norm: 0.49711959339480527, ic: 0.015212716725121844
train 9, step: 500, loss: 1.3222252408364663, grad_norm: 0.11473190244988035, ic: 0.0701910123430444
train 9, step: 1000, loss: 0.9251869339465312, grad_norm: 0.019939234341055257, ic: 0.11035425181450569
train 9, step: 1500, loss: 1.1126840223444403, grad_norm: 0.010828236300015738, ic: 0.13966103174947864
train 9, step: 2000, loss: 1.1174469922667343, grad_norm: 0.12252353184354967, ic: -0.044129065469338265
Epoch 9: 2022-05-13 11:07:49.544279: train loss: 1.6448449261675644
Eval step 0: eval loss: 0.8352295822288264
Eval: 2022-05-13 11:07:52.874758: total loss: 1.078393821084225, mse:4.817751042223552, ic :0.025248545595230553, sharpe5:3.4551665331423282, sharpe5_real:465.4302909278869, irr5:34.47380065917969, irr5_real:1197.3116455078125, ndcg5:0.8470409301042333, pnl5:1.2089262008666992 
train 10, step: 0, loss: 7.202830322977405, grad_norm: 0.14207948900056994, ic: 0.08066269301312248
train 10, step: 500, loss: 1.1288932189462324, grad_norm: 0.02938042632884235, ic: -0.029284137586312632
train 10, step: 1000, loss: 2.4009633444569594, grad_norm: 0.5360314561928354, ic: 0.08475600734346686
train 10, step: 1500, loss: 1.088582521909243, grad_norm: 0.09243293694372832, ic: -0.014692607650567973
train 10, step: 2000, loss: 2.8947182513297873, grad_norm: 0.009867879459427078, ic: 0.24824474007192504
Epoch 10: 2022-05-13 11:09:29.780688: train loss: 1.6451395108650986
Eval step 0: eval loss: 0.8356476955594704
Eval: 2022-05-13 11:09:33.131385: total loss: 1.0785904979046719, mse:4.818106722598331, ic :0.024565341246290298, sharpe5:4.180887597799301, sharpe5_real:465.43026065826416, irr5:43.66976547241211, irr5_real:1197.3116455078125, ndcg5:0.8625698240357758, pnl5:1.3442498445510864 
train 11, step: 0, loss: 1.2697706701952824, grad_norm: 0.0005750131989660346, ic: 0.12315715317896751
train 11, step: 500, loss: 0.7121476988094205, grad_norm: 0.00010897728160629098, ic: 0.07710490260176575
train 11, step: 1000, loss: 0.9298883675546167, grad_norm: 0.02401686553208646, ic: 0.054246466780670986
train 11, step: 1500, loss: 1.0747240300764116, grad_norm: 0.028835392071097348, ic: -0.021070395359711322
train 11, step: 2000, loss: 0.79060930249062, grad_norm: 0.0015256501316033612, ic: 0.11657444894400903
Epoch 11: 2022-05-13 11:11:09.971592: train loss: 1.6448607964548616
Eval step 0: eval loss: 0.8375789533802028
Eval: 2022-05-13 11:11:13.357267: total loss: 1.0795300723381889, mse:4.816806491230802, ic :0.030375239280245842, sharpe5:4.741850396096706, sharpe5_real:465.43026065826416, irr5:51.3127326965332, irr5_real:1197.3116455078125, ndcg5:0.8675822425649563, pnl5:1.295232892036438 
train 12, step: 0, loss: 1.038946787516276, grad_norm: 0.04099307951165324, ic: 0.06239953621895686
train 12, step: 500, loss: 0.940043981303747, grad_norm: 0.03206393169534412, ic: 0.09597421066733952
train 12, step: 1000, loss: 2.9580987820959397, grad_norm: 0.3559863805003476, ic: 0.2613156013416629
train 12, step: 1500, loss: 0.9449522391767422, grad_norm: 3.6865139171281704e-05, ic: 0.026938755827383497
train 12, step: 2000, loss: 0.8771041455225642, grad_norm: 0.0001396741503798052, ic: 0.024764375485033692
Epoch 12: 2022-05-13 11:12:50.135176: train loss: 1.6445323369368268
Eval step 0: eval loss: 0.8356905295047418
Eval: 2022-05-13 11:12:53.483492: total loss: 1.0784356035583476, mse:4.814747071554206, ic :0.033102150857021825, sharpe5:5.314020522236824, sharpe5_real:465.4300185012817, irr5:58.37638473510742, irr5_real:1197.3116455078125, ndcg5:0.8455131324357663, pnl5:1.6150473356246948 
train 13, step: 0, loss: 2.127510626691196, grad_norm: 0.44887693978987747, ic: 0.09346183342962311
train 13, step: 500, loss: 0.8998203251566763, grad_norm: 0.001452062935849125, ic: 0.14077689977984506
train 13, step: 1000, loss: 1.0215487691380034, grad_norm: 0.10231086446238949, ic: 0.10970275026753305
train 13, step: 1500, loss: 2.4081276529566744, grad_norm: 0.40635652503079217, ic: -0.018556677995391242
train 13, step: 2000, loss: 1.5090822567840645, grad_norm: 0.02830243823476222, ic: 0.053158251403437606
Epoch 13: 2022-05-13 11:14:30.569553: train loss: 1.6444502351501635
Eval step 0: eval loss: 0.8334189797854649
Eval: 2022-05-13 11:14:33.995550: total loss: 1.0778462960611035, mse:4.8186321932608, ic :0.034152278371669065, sharpe5:6.574851998984814, sharpe5_real:465.43026065826416, irr5:91.20362854003906, irr5_real:1197.3116455078125, ndcg5:0.8572686171771379, pnl5:1.7730330228805542 
train 14, step: 0, loss: 4.511184763796802, grad_norm: 0.2868527129331186, ic: 0.0680306710769305
train 14, step: 500, loss: 0.8271415313814029, grad_norm: 0.004333318729258818, ic: 0.08003571411148824
train 14, step: 1000, loss: 1.941771997496678, grad_norm: 0.013085564034800172, ic: 0.3173802259748258
train 14, step: 1500, loss: 1.1206556766336342, grad_norm: 0.0361177531175528, ic: -0.009396029232519403
train 14, step: 2000, loss: 1.136635340006888, grad_norm: 0.08814560705548187, ic: -0.05638210400167562
Epoch 14: 2022-05-13 11:16:10.773274: train loss: 1.6443697974671354
Eval step 0: eval loss: 0.8397851588226093
Eval: 2022-05-13 11:16:14.135192: total loss: 1.0811828028258454, mse:4.8185065691780125, ic :0.03600619423124577, sharpe5:10.202535281181335, sharpe5_real:465.4302909278869, irr5:162.00128173828125, irr5_real:1197.3116455078125, ndcg5:0.8459996209482122, pnl5:2.291308879852295 
train 15, step: 0, loss: 3.4072987597276265, grad_norm: 0.6896877651947859, ic: 0.018897340379101256
train 15, step: 500, loss: 1.2580042812889651, grad_norm: 0.00018834888543358308, ic: 0.009485847064499536
train 15, step: 1000, loss: 1.3171057228150407, grad_norm: 0.03743280827057111, ic: -0.028799017465996658
train 15, step: 1500, loss: 0.8614220326341043, grad_norm: 0.11590853114475844, ic: -0.03368230038170632
train 15, step: 2000, loss: 1.471707698803593, grad_norm: 0.3067367505000758, ic: 0.0015445183974743468
Epoch 15: 2022-05-13 11:17:51.153744: train loss: 1.6440046167989617
Eval step 0: eval loss: 0.8472172342185853 
Eval: 2022-05-13 11:17:54.535620: total loss: 1.0855866349264116, mse:4.822431589767939, ic :0.04789922619902402, sharpe5:10.518287175893784, sharpe5_real:465.43026065826416, irr5:178.4615478515625, irr5_real:1197.3116455078125, ndcg5:0.8485649877716668, pnl5:2.4986517429351807 
train 16, step: 0, loss: 0.6965991191607284, grad_norm: 0.2172582713009994, ic: -0.039211943683502226
train 16, step: 500, loss: 1.672310420733523, grad_norm: 0.3808610598515864, ic: 0.049286964859159274
train 16, step: 1000, loss: 0.8786498098662405, grad_norm: 0.006484565715685174, ic: -0.06183569661233943
train 16, step: 1500, loss: 0.8784298968183609, grad_norm: 0.00746741244637243, ic: 0.008485846933698232
train 16, step: 2000, loss: 3.372872287236788, grad_norm: 0.08964244885790443, ic: 0.029221655578833557
Epoch 16: 2022-05-13 11:19:31.559349: train loss: 1.6435177516544757
Eval step 0: eval loss: 0.8352011548957784 
Eval: 2022-05-13 11:19:34.936220: total loss: 1.0782800768837395, mse:4.802970297766627, ic :0.06437961730202368, sharpe5:11.647133165001868, sharpe5_real:465.43026065826416, irr5:216.68331909179688, irr5_real:1197.3116455078125, ndcg5:0.8538802552676074, pnl5:2.305945634841919 
train 17, step: 0, loss: 1.2512431096651193, grad_norm: 0.10503894308496514, ic: -0.05406215737997677
train 17, step: 500, loss: 1.836352208248645, grad_norm: 0.2985492674539267, ic: 0.2005424021915237
train 17, step: 1000, loss: 1.2655567804298118, grad_norm: 0.05053747644529423, ic: 0.10101144922944034
train 17, step: 1500, loss: 4.612507390590558, grad_norm: 0.009319788324646939, ic: 0.1984905385029745
train 17, step: 2000, loss: 1.27935135506787, grad_norm: 0.00724286753834872, ic: -0.022691869447870938
Epoch 17: 2022-05-13 11:21:11.795964: train loss: 1.6407865899572385
Eval step 0: eval loss: 0.839469306712658
Eval: 2022-05-13 11:21:15.167025: total loss: 1.0807500072213896, mse:4.779184083393471, ic :0.09765814790050813, sharpe5:14.471340052485465, sharpe5_real:465.43026065826416, irr5:280.2666931152344, irr5_real:1197.3116455078125, ndcg5:0.8463169468457953, pnl5:2.1461126804351807 
train 18, step: 0, loss: 1.4111858280881195, grad_norm: 0.33101701126003263, ic: -0.04283638325958286
train 18, step: 500, loss: 1.4899225488990617, grad_norm: 0.4739577338425976, ic: -0.06549053482682668
train 18, step: 1000, loss: 0.6813301316352739, grad_norm: 0.0021725291643682892, ic: 0.23657596912970721
train 18, step: 1500, loss: 1.444885303894093, grad_norm: 0.02123373156391518, ic: 0.026233895384287262
train 18, step: 2000, loss: 0.9110781918665406, grad_norm: 0.0008045011034636875, ic: -0.027706522569480602
Epoch 18: 2022-05-13 11:22:52.177874: train loss: 1.6393417234628611
Eval step 0: eval loss: 0.8310204717959694
Eval: 2022-05-13 11:22:55.560193: total loss: 1.0749637346096694, mse:4.754579958680854, ic :0.11870568344756846, sharpe5:14.328097575902937, sharpe5_real:465.43026065826416, irr5:269.8268127441406, irr5_real:1197.3116455078125, ndcg5:0.8463330482038057, pnl5:1.8439103364944458 
train 19, step: 0, loss: 1.476763431609623, grad_norm: 0.00819979311094949, ic: 0.05343837075637595
train 19, step: 500, loss: 0.8749936421712239, grad_norm: 0.002947317937256214, ic: 0.23966434311694745
train 19, step: 1000, loss: 0.9687240473139712, grad_norm: 0.0003167716784560936, ic: 0.07586285449314113
train 19, step: 1500, loss: 3.9728477193868588, grad_norm: 0.11030751562235483, ic: 0.023457904206768188
train 19, step: 2000, loss: 1.020432880108173, grad_norm: 0.06239592069293244, ic: 0.03600690709991638
Epoch 19: 2022-05-13 11:24:32.417190: train loss: 1.6380743751672007
Eval step 0: eval loss: 0.8313399898742097
Eval: 2022-05-13 11:24:35.764977: total loss: 1.0749772317048858, mse:4.722018680614306, ic :0.13260297148185646, sharpe5:15.320072844028472, sharpe5_real:465.43026065826416, irr5:297.35162353515625, irr5_real:1197.3116455078125, ndcg5:0.8584380202496176, pnl5:2.8326995372772217 
train 20, step: 0, loss: 2.2639262444416994, grad_norm: 0.488537044698667, ic: 0.045263965652961216
train 20, step: 500, loss: 3.2415504261363632, grad_norm: 0.3589110036894635, ic: 0.14097336715323228
train 20, step: 1000, loss: 0.9969575881958008, grad_norm: 0.04414138893560984, ic: 0.04243175293276512
train 20, step: 1500, loss: 1.8448562972578484, grad_norm: 0.49872521294640754, ic: 0.21390073126125453
train 20, step: 2000, loss: 1.046230596196982, grad_norm: 0.03031760748757092, ic: -0.0013478162314293734
Epoch 20: 2022-05-13 11:26:12.625507: train loss: 1.6356232044397236
Eval step 0: eval loss: 0.8286267231337262
Eval: 2022-05-13 11:26:15.994433: total loss: 1.0743783729504135, mse:4.718798829579682, ic :0.1426674809177781, sharpe5:17.458918715715406, sharpe5_real:465.43026065826416, irr5:358.9427795410156, irr5_real:1197.3116455078125, ndcg5:0.8415991017701804, pnl5:3.7082102298736572 
train 21, step: 0, loss: 1.0498992896643784, grad_norm: 0.10391867470837696, ic: 0.01256745504441426
train 21, step: 500, loss: 0.7856481771553512, grad_norm: 0.0006558537005710185, ic: 0.13214765573495882
train 21, step: 1000, loss: 0.9397247046755071, grad_norm: 0.15006002942547012, ic: 0.18215943643418525
train 21, step: 1500, loss: 1.0138388538291936, grad_norm: 0.052788225371514355, ic: 0.26204801041895287
train 21, step: 2000, loss: 0.936326881315753, grad_norm: 0.04117946413553738, ic: 0.10344501755964645
Epoch 21: 2022-05-13 11:27:52.876958: train loss: 1.6346735730806417
Eval step 0: eval loss: 0.8279831849109259 
Eval: 2022-05-13 11:27:56.232453: total loss: 1.0724439923600333, mse:4.674104699108066, ic :0.15368042114331742, sharpe5:17.333428426980973, sharpe5_real:465.43026065826416, irr5:347.85845947265625, irr5_real:1197.3116455078125, ndcg5:0.8373696343485671, pnl5:3.4152944087982178 
train 22, step: 0, loss: 1.0593961726474224, grad_norm: 0.014089401155711436, ic: 0.1834461602598598
train 22, step: 500, loss: 3.29573547859502, grad_norm: 1.0571902434871894, ic: 0.01719144940426611
train 22, step: 1000, loss: 1.2321327165372111, grad_norm: 0.0016333923681825604, ic: 0.38420837215794806
train 22, step: 1500, loss: 0.9729671023019547, grad_norm: 0.048912205002998976, ic: 0.022297577649864633
train 22, step: 2000, loss: 1.8059919361624859, grad_norm: 0.3991036675790586, ic: 0.1586281109988995
Epoch 22: 2022-05-13 11:29:33.067446: train loss: 1.632947213026449
Eval step 0: eval loss: 0.8277751251317176 
Eval: 2022-05-13 11:29:36.435422: total loss: 1.0721360368644908, mse:4.656722384634311, ic :0.15490651499526956, sharpe5:16.084991887807846, sharpe5_real:465.4301093101501, irr5:326.1021728515625, irr5_real:1197.3116455078125, ndcg5:0.8335798843735485, pnl5:2.850043296813965 
train 23, step: 0, loss: 1.0004319952269454, grad_norm: 0.011525229222867486, ic: 0.16315931908680686
train 23, step: 500, loss: 1.3855622439781201, grad_norm: 0.8036473510250941, ic: 0.004281394778229676
train 23, step: 1000, loss: 1.6738131713867188, grad_norm: 0.011711761913871438, ic: -0.0005934529752323527
train 23, step: 1500, loss: 1.1345912789895913, grad_norm: 0.18582970622718836, ic: 0.0948322300386153
train 23, step: 2000, loss: 1.8795300396338528, grad_norm: 0.9600165249319638, ic: 0.19393393388863228
Epoch 23: 2022-05-13 11:31:13.545300: train loss: 1.6357951847042271
Eval step 0: eval loss: 0.8313440417338974 
Eval: 2022-05-13 11:31:16.897130: total loss: 1.0766616783518543, mse:4.774569308746716, ic :0.10847411347120729, sharpe5:19.45996402144432, sharpe5_real:465.43026065826416, irr5:388.3186340332031, irr5_real:1197.3116455078125, ndcg5:0.8457442223669422, pnl5:3.199125051498413 
train 24, step: 0, loss: 2.185044318660982, grad_norm: 0.08076793991204288, ic: 0.1467600908703909
train 24, step: 500, loss: 1.229421700206712, grad_norm: 0.08980325223510881, ic: 0.11424884129404872
train 24, step: 1000, loss: 0.9329932893473583, grad_norm: 0.008615507789027197, ic: 0.34667687236700667
train 24, step: 1500, loss: 2.6326261238922095, grad_norm: 0.588275201938389, ic: -0.010066658068020706
train 24, step: 2000, loss: 0.9325696328061328, grad_norm: 0.009864477279543706, ic: 0.10924445955414123
Epoch 24: 2022-05-13 11:32:53.676359: train loss: 1.6313695162922845
Eval step 0: eval loss: 0.8244565877321522  
Eval: 2022-05-13 11:32:57.046978: total loss: 1.069528761013947, mse:4.59586201730164, ic :0.1784409965940219, sharpe5:19.9634159553051, sharpe5_real:465.43026065826416, irr5:408.6717224121094, irr5_real:1197.3116455078125, ndcg5:0.8491523249689465, pnl5:4.200328350067139 
train 25, step: 0, loss: 0.8737623060071791, grad_norm: 0.010454138413446817, ic: 0.5803360390639135
train 25, step: 500, loss: 0.8750203757847904, grad_norm: 0.0070095890554314234, ic: 0.08790700967620084
train 25, step: 1000, loss: 2.1157263750714015, grad_norm: 0.0626602910820927, ic: 0.24004435619939873
train 25, step: 1500, loss: 1.1473001317500424, grad_norm: 0.020869123775199186, ic: 0.5472184788925001
train 25, step: 2000, loss: 1.0238181967275328, grad_norm: 0.041738516395277585, ic: 0.5685667238242889
Epoch 25: 2022-05-13 11:34:34.036100: train loss: 1.6287359979474902
Eval step 0: eval loss: 0.8247894833788856
Eval: 2022-05-13 11:34:37.407894: total loss: 1.0693821795689202, mse:4.592535821370353, ic :0.17747329881604265, sharpe5:19.25021634578705, sharpe5_real:465.43026065826416, irr5:392.7552490234375, irr5_real:1197.3116455078125, ndcg5:0.8461934445754057, pnl5:3.909334897994995 
train 26, step: 0, loss: 6.7764506477136575, grad_norm: 1.6866138563411242, ic: 0.12354441801180267
train 26, step: 500, loss: 3.899545390686083, grad_norm: 1.6270831825205228, ic: 0.3786422009317601
train 26, step: 1000, loss: 1.319223065578395, grad_norm: 0.35277751991384554, ic: 0.010537801089843944
train 26, step: 1500, loss: 0.8470832344766811, grad_norm: 0.009640281316273435, ic: 0.26422944122715414
train 26, step: 2000, loss: 0.9669198096970889, grad_norm: 0.0803682750570245, ic: 0.03160949232281482
Epoch 26: 2022-05-13 11:36:14.397957: train loss: 1.6284771490862013
Eval step 0: eval loss: 0.8239571156315858
Eval: 2022-05-13 11:36:17.729453: total loss: 1.068496001863814, mse:4.587281715275076, ic :0.1789094012712951, sharpe5:20.196753126382827, sharpe5_real:465.43004877090453, irr5:407.77264404296875, irr5_real:1197.3116455078125, ndcg5:0.84904155744812, pnl5:3.974672555923462 
train 27, step: 0, loss: 0.8201139322916666, grad_norm: 0.009533301538424434, ic: 0.1761716132938213
train 27, step: 500, loss: 0.8932691139494591, grad_norm: 0.5384917671675034, ic: 0.30417041030873815
train 27, step: 1000, loss: 0.7692522726036833, grad_norm: 0.14738814305630965, ic: -0.005569150810592184
train 27, step: 1500, loss: 0.6186118971665874, grad_norm: 0.0012640696414681287, ic: 0.5536859893144033
train 27, step: 2000, loss: 1.3857137322335327, grad_norm: 0.041063835487725076, ic: 0.025704533367578636
Epoch 27: 2022-05-13 11:37:54.603128: train loss: 1.6257084932109473
Eval step 0: eval loss: 0.8282805142337328
Eval: 2022-05-13 11:37:57.995021: total loss: 1.0704939925502277, mse:4.593489875594949, ic :0.1741000722717324, sharpe5:19.313207430839537, sharpe5_real:465.4300185012817, irr5:409.3329772949219, irr5_real:1197.3116455078125, ndcg5:0.8356813567394937, pnl5:4.81130313873291 
train 28, step: 0, loss: 1.585986516650579, grad_norm: 0.5043103058905409, ic: 0.14259480923575113
train 28, step: 500, loss: 1.3888543322474147, grad_norm: 0.280319819505931, ic: 0.18163649018976524
train 28, step: 1000, loss: 0.9049371652163787, grad_norm: 0.0032754350412228664, ic: 0.5925250483529431
train 28, step: 1500, loss: 1.038143605526418, grad_norm: 0.0028966365238410337, ic: 0.0022058475343701817
train 28, step: 2000, loss: 1.0505702480948045, grad_norm: 0.11090266189344761, ic: 0.06222165417577411
Epoch 28: 2022-05-13 11:39:34.937135: train loss: 1.624771495604059
Eval step 0: eval loss: 0.823681846433746
Eval: 2022-05-13 11:39:38.288194: total loss: 1.0692241968595426, mse:4.592402070517447, ic :0.1784287657347405, sharpe5:19.42422694802284, sharpe5_real:465.43026065826416, irr5:421.1898498535156, irr5_real:1197.3116455078125, ndcg5:0.8515334588582976, pnl5:4.011409282684326 
train 29, step: 0, loss: 0.9103046963845717, grad_norm: 0.0017205449744362872, ic: 0.11602867418377649
train 29, step: 500, loss: 1.0940583655222402, grad_norm: 0.05469563214941417, ic: 0.6260250145336819
train 29, step: 1000, loss: 1.0591957636823677, grad_norm: 0.1219572867882567, ic: 0.04471157922085177
train 29, step: 1500, loss: 2.3177698926009955, grad_norm: 0.0345713443561385, ic: 0.06153445713434224
train 29, step: 2000, loss: 4.560420660325038, grad_norm: 0.12853531116982286, ic: 0.23943046606613264
Epoch 29: 2022-05-13 11:41:15.127805: train loss: 1.624443099605713
Eval step 0: eval loss: 0.8244036562952779
Eval: 2022-05-13 11:41:18.468353: total loss: 1.0688121251323934, mse:4.587261813648592, ic :0.18048769975503481, sharpe5:20.143136165142057, sharpe5_real:465.43026065826416, irr5:431.591796875, irr5_real:1197.3116455078125, ndcg5:0.8540225805623731, pnl5:4.593281269073486 
train 30, step: 0, loss: 1.008747835991447, grad_norm: 0.027790912064210107, ic: 0.5221735383424814
train 30, step: 500, loss: 1.4263706723620797, grad_norm: 1.126455468813837, ic: -0.010869987181956678
train 30, step: 1000, loss: 0.9733074766216856, grad_norm: 0.06995084893822165, ic: 0.045964517615467104
train 30, step: 1500, loss: 1.5301537863634842, grad_norm: 0.4713027583457657, ic: 0.11772199035393655
train 30, step: 2000, loss: 1.8351664116296862, grad_norm: 0.3112098482990491, ic: 0.11456811782336357
Epoch 30: 2022-05-13 11:43:32.377463: train loss: 1.6237986642783868
Eval step 0: eval loss: 0.8237308546413988
Eval: 2022-05-13 11:43:35.783088: total loss: 1.068945829320199, mse:4.591484485992711, ic :0.17925776064152613, sharpe5:20.344572937488554, sharpe5_real:465.43026065826416, irr5:434.9983215332031, irr5_real:1197.3116455078125, ndcg5:0.8527620766341694, pnl5:2.6692137718200684 
train 31, step: 0, loss: 1.0697611504716178, grad_norm: 0.05119495513363069, ic: 0.30615591475948034
train 31, step: 500, loss: 1.5310744799704217, grad_norm: 0.5186063182071226, ic: 0.0593057757074476
train 31, step: 1000, loss: 4.423401212431694, grad_norm: 1.0888507388332775, ic: 0.43248992377952966
train 31, step: 1500, loss: 0.7755262677107607, grad_norm: 0.017278105130757535, ic: 0.7039779892931377
train 31, step: 2000, loss: 1.225931927063545, grad_norm: 0.8772613168907969, ic: 0.18747641431078596
Epoch 31: 2022-05-13 11:45:12.690793: train loss: 1.622524528218172
Eval step 0: eval loss: 0.8261144414968058 
Eval: 2022-05-13 11:45:16.039975: total loss: 1.0712739527793176, mse:4.596689546543757, ic :0.17737709786054576, sharpe5:18.20990049004555, sharpe5_real:465.43026065826416, irr5:405.1852722167969, irr5_real:1197.3116455078125, ndcg5:0.8386030231464555, pnl5:2.8849384784698486 
train 32, step: 0, loss: 1.1417277240232853, grad_norm: 0.06794655911993017, ic: 0.21366989675132278
train 32, step: 500, loss: 1.5046031080831692, grad_norm: 0.8825001373791673, ic: 0.12530923043018927
train 32, step: 1000, loss: 1.0139580385941362, grad_norm: 0.0018798514388977507, ic: 0.5371520259673371
train 32, step: 1500, loss: 0.9910476184091342, grad_norm: 0.6553552819577357, ic: 0.05258656724684947
train 32, step: 2000, loss: 0.9821400062895204, grad_norm: 0.013953211272395325, ic: 0.5277577126745778
Epoch 32: 2022-05-13 11:46:52.867967: train loss: 1.6216235542319337
Eval step 0: eval loss: 0.823537780311512
Eval: 2022-05-13 11:46:56.287372: total loss: 1.0676830192957159, mse:4.582609211027349, ic :0.1862174733926862, sharpe5:20.294259148836137, sharpe5_real:465.43026065826416, irr5:438.4227600097656, irr5_real:1197.3116455078125, ndcg5:0.8512257647213279, pnl5:2.6674911975860596 
train 33, step: 0, loss: 1.2654427294253958, grad_norm: 0.05796414790433699, ic: 0.22302181484960695
train 33, step: 500, loss: 1.003268761339763, grad_norm: 0.003970435552581061, ic: 0.12176150528421707
train 33, step: 1000, loss: 1.009258699570438, grad_norm: 0.30714233168635857, ic: 0.16652866594375287
train 33, step: 1500, loss: 0.8898772288330369, grad_norm: 0.0037660450121649873, ic: 0.5593826764691315
train 33, step: 2000, loss: 0.8207181758245841, grad_norm: 0.04396342938435467, ic: 0.23824612319731867
Epoch 33: 2022-05-13 11:49:10.250089: train loss: 1.622384178128575
Eval step 0: eval loss: 0.8242759262422615
Eval: 2022-05-13 11:49:13.644399: total loss: 1.0678595938212487, mse:4.5811349506047065, ic :0.18800098668945517, sharpe5:21.252175415754316, sharpe5_real:465.4300185012817, irr5:454.4598388671875, irr5_real:1197.3116455078125, ndcg5:0.8464772721150119, pnl5:3.1481857299804688 
train 34, step: 0, loss: 1.0027885569374566, grad_norm: 0.0119397192382824, ic: 0.6114771681648151
train 34, step: 500, loss: 0.8123390127759461, grad_norm: 0.2044737727319338, ic: 0.19418108330296052
train 34, step: 1000, loss: 3.1436641945084487, grad_norm: 0.26819763313301526, ic: 0.31546857205117523
train 34, step: 1500, loss: 0.8086616961691746, grad_norm: 0.19165687394043962, ic: 0.6838594151224328
train 34, step: 2000, loss: 7.022134912374129, grad_norm: 0.4954314535171394, ic: 0.4567359409538538
Epoch 34: 2022-05-13 11:51:27.602818: train loss: 1.6211095251059102
Eval step 0: eval loss: 0.823566657851192
Eval: 2022-05-13 11:51:30.980063: total loss: 1.0687396980684767, mse:4.59101747499625, ic :0.18822866618996623, sharpe5:19.694610353708267, sharpe5_real:465.43026065826416, irr5:440.2383117675781, irr5_real:1197.3116455078125, ndcg5:0.8397930468290877, pnl5:3.0098376274108887 
train 35, step: 0, loss: 1.2434857536764705, grad_norm: 0.004382407593230191, ic: 0.5681129028405643
train 35, step: 500, loss: 1.192957930358238, grad_norm: 0.09196489705118914, ic: 0.00356013516684435
train 35, step: 1000, loss: 1.7725169187898089, grad_norm: 1.061382137683363, ic: -0.012529919392227345
train 35, step: 1500, loss: 1.633131167763158, grad_norm: 0.022353471988745068, ic: 0.004169441779720156
train 35, step: 2000, loss: 0.7623885047627005, grad_norm: 0.019389321747917677, ic: 0.596205111930011
Epoch 35: 2022-05-13 11:53:44.357830: train loss: 1.622059090638576
Eval step 0: eval loss: 0.8254267187088382
Eval: 2022-05-13 11:53:47.747997: total loss: 1.0700182773005427, mse:4.595870770280179, ic :0.17835336790269338, sharpe5:17.90428324341774, sharpe5_real:465.4300185012817, irr5:384.3039855957031, irr5_real:1197.3116455078125, ndcg5:0.8544610475086676, pnl5:3.5297911167144775 
train 36, step: 0, loss: 1.8026452655882066, grad_norm: 0.9324581824710929, ic: 0.031643581093369746
train 36, step: 500, loss: 0.8449166420409772, grad_norm: 0.4766112067369693, ic: 0.20667347419819848
train 36, step: 1000, loss: 1.795152521306818, grad_norm: 2.1440972952080974, ic: 0.23478271798795078
train 36, step: 1500, loss: 0.7786689941723521, grad_norm: 0.007366159763426723, ic: 0.35682947642430285
train 36, step: 2000, loss: 1.125542965647339, grad_norm: 1.025893244503534, ic: 0.7669201357447425
Epoch 36: 2022-05-13 11:55:24.671873: train loss: 1.6224303566004143
Eval step 0: eval loss: 0.8237352280772523  
Eval: 2022-05-13 11:55:28.042709: total loss: 1.0674558652865787, mse:4.5790006363453, ic :0.1905873246811132, sharpe5:20.43831985116005, sharpe5_real:465.43026065826416, irr5:453.33673095703125, irr5_real:1197.3116455078125, ndcg5:0.8666711192810915, pnl5:3.2547848224639893 
train 37, step: 0, loss: 2.041691030879116, grad_norm: 1.5756309100251684, ic: 0.15293856419825022
train 37, step: 500, loss: 2.3571775352390905, grad_norm: 1.6675969486840923, ic: -0.031684148291154075
train 37, step: 1000, loss: 1.0600608233447488, grad_norm: 0.14087714626400996, ic: 0.15330044106426172
train 37, step: 1500, loss: 2.0486177118082813, grad_norm: 1.1531845109381011, ic: 0.6112447283252447
train 37, step: 2000, loss: 1.3305258513289038, grad_norm: 0.013647920521046027, ic: 0.11706911222608471
Epoch 37: 2022-05-13 11:57:41.583378: train loss: 1.6199260959783903
Eval step 0: eval loss: 0.8231446856065595
Eval: 2022-05-13 11:57:44.936663: total loss: 1.0678356905433395, mse:4.580739911681467, ic :0.1908156371148208, sharpe5:20.56858328104019, sharpe5_real:465.43026065826416, irr5:457.7184143066406, irr5_real:1197.3116455078125, ndcg5:0.8517722439699875, pnl5:2.9741735458374023 
train 38, step: 0, loss: 1.3646288615901296, grad_norm: 0.09287154216311835, ic: -0.08566571398631591
train 38, step: 500, loss: 0.9290171682098766, grad_norm: 0.004356738210454641, ic: 0.25737685334002475
train 38, step: 1000, loss: 0.924395438333745, grad_norm: 0.001265053105590923, ic: -0.06997101310298343
train 38, step: 1500, loss: 0.9602292697359055, grad_norm: 0.005285616487576682, ic: 0.19029742150656231
train 38, step: 2000, loss: 2.3102795004484515, grad_norm: 2.2472528677867234, ic: 0.03680670128928112
Epoch 38: 2022-05-13 11:59:58.898550: train loss: 1.6198967109365867
Eval step 0: eval loss: 0.8231403121707059
Eval: 2022-05-13 12:00:02.321633: total loss: 1.067631889326215, mse:4.5845763616184625, ic :0.18953232139440934, sharpe5:20.39659317612648, sharpe5_real:465.43026065826416, irr5:442.5355529785156, irr5_real:1197.3116455078125, ndcg5:0.8353023814929124, pnl5:2.6969828605651855 
train 39, step: 0, loss: 0.9744729324947439, grad_norm: 0.005902075752106458, ic: 0.13316744515335496
train 39, step: 500, loss: 0.9094075020416987, grad_norm: 0.11539820517722829, ic: 0.15965007464362727
train 39, step: 1000, loss: 0.960058742502856, grad_norm: 0.011638844943628157, ic: 0.13976748644365555
train 39, step: 1500, loss: 2.117897674512183, grad_norm: 0.4133392678769628, ic: 0.2000296956988526
train 39, step: 2000, loss: 0.6308890247796949, grad_norm: 0.0971195191329303, ic: -0.02511181511203516
Epoch 39: 2022-05-13 12:01:39.173323: train loss: 1.6211583312371616
Eval step 0: eval loss: 0.8273457566352739
Eval: 2022-05-13 12:01:42.551554: total loss: 1.0698469162398236, mse:4.590403867918959, ic :0.18489546153108372, sharpe5:19.529975767135618, sharpe5_real:465.43026065826416, irr5:453.7607421875, irr5_real:1197.3116455078125, ndcg5:0.8682368665467695, pnl5:2.8041844367980957 
