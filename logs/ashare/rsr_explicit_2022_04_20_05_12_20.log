Namespace(adj_path='./data/graphs/concepts_graph_multihot_1931_1931_824.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=8, dataset_type='TimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=2, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=9, input_graph=False, label_cnt=3, lr=0.001, lstm_layers=3, mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, relation_num=1, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
relation encoding shape: torch.Size([1931, 1931, 824]) torch.float32
relation mask shape: torch.Size([1931, 1931]) torch.float32
25457
ReRaLSTM(
  (rnn1): LSTM(9, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=824, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 2.985187013507326, grad_norm: 0.0004262831750037736, ic: 0.005068056026334929
Epoch 0: 2022-04-20 17:13:13.134275: train loss: 1.628605642557591
Eval step 0: eval loss: 1.1448811190464443
Eval: 2022-04-20 17:13:14.739792: total loss: 1.0784505346844877, mse:0.6084705626859105, ic :0.004965205400699616, sharpe5:7.222180652618408, irr5:203.43345642089844, ndcg5:0.8547567850241813, pnl5:2.548311233520508 
train 1, step: 0, loss: 1.506100142982842, grad_norm: 2.22842305829372e-06, ic: 0.018368512800427117
Epoch 1: 2022-04-20 17:13:51.709313: train loss: 1.6283679411877765
Eval step 0: eval loss: 1.1448948671140056
Eval: 2022-04-20 17:13:53.363504: total loss: 1.0784506779161604, mse:0.6084681957597449, ic :0.007852878719976225, sharpe5:7.267460224628448, irr5:201.07530212402344, ndcg5:0.8656406496367428, pnl5:2.6367738246917725 
train 2, step: 0, loss: 1.6450718436701397, grad_norm: 7.343022642053382e-06, ic: -0.0016253757808191499
Epoch 2: 2022-04-20 17:14:30.331063: train loss: 1.6297461087038636
Eval step 0: eval loss: 1.144888185810144
Eval: 2022-04-20 17:14:31.996317: total loss: 1.078450379802222, mse:0.6084691527883664, ic :0.008497408936269312, sharpe5:7.3473720288276665, irr5:205.42300415039062, ndcg5:0.8367579184941273, pnl5:2.770235538482666 
train 3, step: 0, loss: 1.3181588582484325, grad_norm: 7.686168147708744e-08, ic: 0.002669907246213084
Epoch 3: 2022-04-20 17:15:08.965002: train loss: 1.6266768824357596
Eval step 0: eval loss: 1.1448786778008024
Eval: 2022-04-20 17:15:10.597188: total loss: 1.0784497168419385, mse:0.6084703413273854, ic :0.008731831252095382, sharpe5:7.700305898487567, irr5:218.1476287841797, ndcg5:0.8595851561795936, pnl5:2.5492568016052246 
train 4, step: 0, loss: 1.680511799467752, grad_norm: 1.2232110342413896e-05, ic: 0.056324336753802676
Epoch 4: 2022-04-20 17:15:47.581914: train loss: 1.6281069909744836
Eval step 0: eval loss: 1.1449038611768962
Eval: 2022-04-20 17:15:49.307962: total loss: 1.0784496285007537, mse:0.6084648692709702, ic :0.02083651454931918, sharpe5:7.8438912731409065, irr5:217.28466796875, ndcg5:0.8664783374407661, pnl5:4.19111967086792 
train 5, step: 0, loss: 2.0264849767784323, grad_norm: 1.536066847604167e-07, ic: 0.03168085978508891
Epoch 5: 2022-04-20 17:16:26.309422: train loss: 1.6379921294587456
Eval step 0: eval loss: 1.1444374547727123
Eval: 2022-04-20 17:16:27.952175: total loss: 1.0784497236426809, mse:0.6085488136235455, ic :0.0008945378937162041, sharpe5:3.885597731620073, irr5:37.27397918701172, ndcg5:0.8321756723836621, pnl5:1.3634014129638672 
train 6, step: 0, loss: 1.4260008268104, grad_norm: 7.042164305532272e-07, ic: 0.034839050336639976
Epoch 6: 2022-04-20 17:17:04.954095: train loss: 1.6282776499286014
Eval step 0: eval loss: 1.144864544273403
Eval: 2022-04-20 17:17:06.574524: total loss: 1.0784503721168235, mse:0.6084733877695966, ic :0.014597951478103246, sharpe5:6.942229681313037, irr5:163.9766845703125, ndcg5:0.8465993532719156, pnl5:3.045654296875 
train 7, step: 0, loss: 1.2734850925492034, grad_norm: 5.297118315598214e-09, ic: 0.012734633004947822
Epoch 7: 2022-04-20 17:17:43.533197: train loss: 1.6291161089849635
Eval step 0: eval loss: 1.1486624800588776
Eval: 2022-04-20 17:17:45.162348: total loss: 1.0788283232325462, mse:0.6080602701612178, ic :0.014323138244513586, sharpe5:7.939752330780029, irr5:224.73089599609375, ndcg5:0.8580513656947558, pnl5:2.8911375999450684 
train 8, step: 0, loss: 1.9710944846027267, grad_norm: 0.0054705298675737455, ic: -0.014052275471973626
Epoch 8: 2022-04-20 17:18:22.118358: train loss: 1.6268591330267355
Eval step 0: eval loss: 1.14935720717387
Eval: 2022-04-20 17:18:23.721214: total loss: 1.078956079048926, mse:0.608025537408974, ic :0.018558379359074707, sharpe5:7.6286614850163454, irr5:217.8518524169922, ndcg5:0.8475694040496702, pnl5:2.503178596496582 
train 9, step: 0, loss: 2.578339286793137, grad_norm: 0.18210557503361557, ic: -0.007127036501378735
Epoch 9: 2022-04-20 17:19:00.755241: train loss: 1.6300067461671657
Eval step 0: eval loss: 1.1488516123528056
Eval: 2022-04-20 17:19:02.385486: total loss: 1.0788565640649557, mse:0.6080403308582446, ic :0.022240554265183066, sharpe5:8.117198535203933, irr5:231.5868682861328, ndcg5:0.8543067888652504, pnl5:2.428882360458374 
train 10, step: 0, loss: 2.0337702280554573, grad_norm: 0.19221571182754388, ic: -0.010395969150657524
Epoch 10: 2022-04-20 17:19:39.362886: train loss: 1.6274918123128297
Eval step 0: eval loss: 1.1490941950776263
Eval: 2022-04-20 17:19:41.042072: total loss: 1.0788727235850069, mse:0.6080087652081736, ic :0.008262698643326976, sharpe5:7.254056930243968, irr5:191.93115234375, ndcg5:0.8650940837942381, pnl5:2.795592784881592 
train 11, step: 0, loss: 1.373740595527086, grad_norm: 0.01776023221022867, ic: 0.07990891271114492
Epoch 11: 2022-04-20 17:20:18.030425: train loss: 1.6294657058182742
Eval step 0: eval loss: 1.1491585668706006
Eval: 2022-04-20 17:20:19.662103: total loss: 1.0788862609890009, mse:0.6080120381230467, ic :0.0055568140573048225, sharpe5:3.1275863103568553, irr5:50.71556854248047, ndcg5:0.866743734008667, pnl5:1.6221309900283813 
train 12, step: 0, loss: 2.011321401488431, grad_norm: 0.0028212278652782583, ic: 0.06354884660708798
Epoch 12: 2022-04-20 17:20:56.756300: train loss: 1.6282482488180607
Eval step 0: eval loss: 1.1448678849253338
Eval: 2022-04-20 17:20:58.378335: total loss: 1.0784503100262202, mse:0.6084718200244541, ic :0.08875078308690776, sharpe5:8.366459419727326, irr5:237.9759979248047, ndcg5:0.8518088540279833, pnl5:2.5354273319244385 
train 13, step: 0, loss: 1.9607099337555158, grad_norm: 3.0091817776056277e-05, ic: 0.00458282814310648
Epoch 13: 2022-04-20 17:22:12.216314: train loss: 1.6264447827203237
Eval step 0: eval loss: 1.144899235658838
Eval: 2022-04-20 17:22:13.893372: total loss: 1.078443409531817, mse:0.6083945338525966, ic :0.05429230783556231, sharpe5:7.107420945167541, irr5:202.56846618652344, ndcg5:0.8507332706312211, pnl5:2.8184163570404053 
train 14, step: 0, loss: 1.6793308962062172, grad_norm: 0.0007106610395240398, ic: 0.016007294738402338
Epoch 14: 2022-04-20 17:22:50.906306: train loss: 1.6268934331231695
Eval step 0: eval loss: 1.1523554422817577
Eval: 2022-04-20 17:22:52.552488: total loss: 1.0795772148202192, mse:0.6079162551733127, ic :0.011767813580542923, sharpe5:5.305623066723347, irr5:99.6773681640625, ndcg5:0.8568538592950707, pnl5:1.9907292127609253 
train 15, step: 0, loss: 1.8142776290018376, grad_norm: 0.0008743604869130362, ic: 0.052499436419562645
Epoch 15: 2022-04-20 17:23:29.571490: train loss: 1.6313458066409876
Eval step 0: eval loss: 1.1511118203572133
Eval: 2022-04-20 17:23:31.211463: total loss: 1.0792898574598626, mse:0.6079361889139938, ic :0.01015716567176817, sharpe5:5.0005099985003465, irr5:102.4746322631836, ndcg5:0.8494461469368891, pnl5:2.0406334400177 
train 16, step: 0, loss: 1.8859009105423918, grad_norm: 0.011123347797245196, ic: 0.019380609674058108
Epoch 16: 2022-04-20 17:24:08.263606: train loss: 1.6286176420117888
Eval step 0: eval loss: 1.1454314272087363
Eval: 2022-04-20 17:24:09.906552: total loss: 1.0783936140979236, mse:0.6082315560323847, ic :0.016363517144653696, sharpe5:6.907889740169048, irr5:186.48663330078125, ndcg5:0.8512925560568234, pnl5:2.9603464603424072 
train 17, step: 0, loss: 1.8025247280659815, grad_norm: 9.001979238302102e-05, ic: 0.056731742698136044
Epoch 17: 2022-04-20 17:24:46.934765: train loss: 1.630115602694677
Eval step 0: eval loss: 1.1518758017564632
Eval: 2022-04-20 17:24:48.577969: total loss: 1.0795073626780352, mse:0.6079572318822671, ic :0.012218135677626595, sharpe5:4.625067353546619, irr5:88.29341125488281, ndcg5:0.8396873181598499, pnl5:1.9088762998580933 
train 18, step: 0, loss: 1.2032408222521964, grad_norm: 0.01581736793991878, ic: 0.026565221681978366
Epoch 18: 2022-04-20 17:25:25.617387: train loss: 1.6269547714630677
Eval step 0: eval loss: 1.1476334307775804
Eval: 2022-04-20 17:25:27.250171: total loss: 1.0784046028976606, mse:0.6079257980887834, ic :0.015041594438269234, sharpe5:7.561015499532222, irr5:199.2325439453125, ndcg5:0.8602654188399469, pnl5:3.1135027408599854 
train 19, step: 0, loss: 1.4597541393038667, grad_norm: 0.02105378625389055, ic: 0.04877899822318292
Epoch 19: 2022-04-20 17:26:04.169729: train loss: 1.6253225570551277
Eval step 0: eval loss: 1.1533760114466152
Eval: 2022-04-20 17:26:05.810777: total loss: 1.0798353349931638, mse:0.6078882627807622, ic :0.018028255072789774, sharpe5:5.042655718624592, irr5:88.86772155761719, ndcg5:0.8420729087487362, pnl5:1.8626946210861206 
train 20, step: 0, loss: 1.5953388210521362, grad_norm: 0.013716941134266853, ic: 0.06552890998989046
Epoch 20: 2022-04-20 17:26:42.844144: train loss: 1.6277465564628801
Eval step 0: eval loss: 1.1511294230231564
Eval: 2022-04-20 17:26:44.447305: total loss: 1.0790341936823287, mse:0.6077537023216533, ic :0.019755372530939074, sharpe5:5.2068651115894315, irr5:90.4269027709961, ndcg5:0.8556753256324614, pnl5:2.0829811096191406 
train 21, step: 0, loss: 1.5784446505437246, grad_norm: 0.006042273929027207, ic: 0.03969619595171829
Epoch 21: 2022-04-20 17:27:21.460271: train loss: 1.625443732348833
Eval step 0: eval loss: 1.1514900849450693
Eval: 2022-04-20 17:27:23.105936: total loss: 1.0791226876648676, mse:0.6077421425512279, ic :0.020991607093818587, sharpe5:5.952626794874668, irr5:102.79216766357422, ndcg5:0.8387144033703079, pnl5:2.1085093021392822 
train 22, step: 0, loss: 1.167007164905514, grad_norm: 0.006962594307453372, ic: 0.08198311971962517
Epoch 22: 2022-04-20 17:28:00.131483: train loss: 1.626732147469638
Eval step 0: eval loss: 1.1517898442125518
Eval: 2022-04-20 17:28:01.772713: total loss: 1.0790908766670682, mse:0.6076616399689507, ic :0.023594945600174843, sharpe5:5.572673503160477, irr5:95.90564727783203, ndcg5:0.8418892418338977, pnl5:1.7727004289627075 
train 23, step: 0, loss: 1.5137383989830924, grad_norm: 0.0017807579487830367, ic: 0.0452909963550909
Epoch 23: 2022-04-20 17:28:38.844825: train loss: 1.6250597883697728
Eval step 0: eval loss: 1.1534898505854878
Eval: 2022-04-20 17:28:40.694485: total loss: 1.0796262261708587, mse:0.6077021330262278, ic :0.025731558260154046, sharpe5:6.5471973878145215, irr5:131.66932678222656, ndcg5:0.8473443333223205, pnl5:1.8744081258773804 
train 24, step: 0, loss: 1.5322770001542394, grad_norm: 0.039976874122136755, ic: 0.07647568236724776
Epoch 24: 2022-04-20 17:29:17.762183: train loss: 1.6279400753733682
Eval step 0: eval loss: 1.1448547792908361
Eval: 2022-04-20 17:29:19.565082: total loss: 1.078425659349565, mse:0.6084045048796232, ic :0.009661809754711584, sharpe5:1.4630875390022993, irr5:16.121868133544922, ndcg5:0.8278588712883148, pnl5:1.1258468627929688 
train 25, step: 0, loss: 1.7556702743366719, grad_norm: 0.032892455919396, ic: 0.012839392974006972
Epoch 25: 2022-04-20 17:29:56.700017: train loss: 1.6260964871584258
Eval step 0: eval loss: 1.1488665167998815
Eval: 2022-04-20 17:29:58.328338: total loss: 1.078085550408628, mse:0.6073156888290717, ic :0.029367952684040508, sharpe5:5.498803326487541, irr5:111.12237548828125, ndcg5:0.8487394788923618, pnl5:1.9914872646331787 
train 26, step: 0, loss: 1.8751536055683242, grad_norm: 0.0016847154956917763, ic: 0.016276222843212538
Epoch 26: 2022-04-20 17:30:35.374620: train loss: 1.6237845936008108
Eval step 0: eval loss: 1.1522521390451286
Eval: 2022-04-20 17:30:37.014920: total loss: 1.079815441914752, mse:0.6079341902999902, ic :0.021039239587566986, sharpe5:3.807836253046989, irr5:58.26395797729492, ndcg5:0.8579969764300308, pnl5:1.5368046760559082 
train 27, step: 0, loss: 1.6310134683586095, grad_norm: 0.014821877864841806, ic: 0.057762772232686485
Epoch 27: 2022-04-20 17:31:14.071831: train loss: 1.6245910266172763
Eval step 0: eval loss: 1.1516567320817708
Eval: 2022-04-20 17:31:15.705339: total loss: 1.0798226847540386, mse:0.60791263226561, ic :0.02115159133691574, sharpe5:2.8263040047883985, irr5:35.33222198486328, ndcg5:0.8456742645966948, pnl5:1.1837247610092163 
train 28, step: 0, loss: 2.1750674821794633, grad_norm: 0.04435069595518353, ic: 0.06614902452178681
Epoch 28: 2022-04-20 17:31:52.719315: train loss: 1.6260256766865373
Eval step 0: eval loss: 1.1464590631372935
Eval: 2022-04-20 17:31:54.322410: total loss: 1.077834235139154, mse:0.6075157422203797, ic :0.030756597865531546, sharpe5:7.348581394851207, irr5:132.2025604248047, ndcg5:0.8616430536521132, pnl5:2.1594369411468506 
train 29, step: 0, loss: 1.4202452227970628, grad_norm: 0.0029344761507134657, ic: 0.08557246485873111
Epoch 29: 2022-04-20 17:32:31.193973: train loss: 1.6221768319766716
Eval step 0: eval loss: 1.1520980835964738
Eval: 2022-04-20 17:32:32.816199: total loss: 1.079839453850517, mse:0.6078503995452491, ic :0.02235600756709185, sharpe5:4.776086758375167, irr5:89.51899719238281, ndcg5:0.851171715236354, pnl5:1.8624811172485352 
train 30, step: 0, loss: 1.6684642814994421, grad_norm: 0.005659556080496419, ic: 0.05680809746901898
Epoch 30: 2022-04-20 17:33:09.618712: train loss: 1.6255507919104135
Eval step 0: eval loss: 1.1503931947322543
Eval: 2022-04-20 17:33:11.224234: total loss: 1.0790071099559766, mse:0.607451408756906, ic :0.026871337080876495, sharpe5:3.9450567300617694, irr5:69.44609832763672, ndcg5:0.8552398968148954, pnl5:1.7469184398651123 
train 31, step: 0, loss: 1.5147568678895846, grad_norm: 0.013044150863395082, ic: 0.06037014637122344
Epoch 31: 2022-04-20 17:33:48.061660: train loss: 1.6215054348400892
Eval step 0: eval loss: 1.1436950591243995
Eval: 2022-04-20 17:33:49.731202: total loss: 1.075098842364801, mse:0.5945711174532571, ic :0.12701956707664014, sharpe5:11.679557606577873, irr5:381.6080322265625, ndcg5:0.8588894581436061, pnl5:3.9107470512390137 
train 32, step: 0, loss: 1.3493908739506597, grad_norm: 0.002927401893886573, ic: 0.15531409781620742
Epoch 32: 2022-04-20 17:35:03.484352: train loss: 1.6133872564833331
Eval step 0: eval loss: 1.1416261676863364
Eval: 2022-04-20 17:35:05.306474: total loss: 1.0735836624996675, mse:0.5921441577437928, ic :0.13586391248225266, sharpe5:12.267755025029182, irr5:407.8017272949219, ndcg5:0.856490085688316, pnl5:4.16585111618042 
train 33, step: 0, loss: 1.367553030452032, grad_norm: 0.005024317377258541, ic: 0.16346613999790977
Epoch 33: 2022-04-20 17:36:19.638861: train loss: 1.6134754591973102
Eval step 0: eval loss: 1.1431428236629169
Eval: 2022-04-20 17:36:21.354545: total loss: 1.0746438314021591, mse:0.5934520704632184, ic :0.1281882677618631, sharpe5:12.002801232933997, irr5:357.7626953125, ndcg5:0.8471815702448035, pnl5:5.191065311431885 
train 34, step: 0, loss: 2.2129886824671323, grad_norm: 0.036371326101415295, ic: 0.1993465811471971
Epoch 34: 2022-04-20 17:36:58.258119: train loss: 1.6142805036532437
Eval step 0: eval loss: 1.141106182364647
Eval: 2022-04-20 17:36:59.966021: total loss: 1.0729213987065676, mse:0.5854888076253472, ic :0.14084797015429135, sharpe5:12.235507471561432, irr5:392.3009338378906, ndcg5:0.8488650755306467, pnl5:5.914140224456787 
train 35, step: 0, loss: 1.9042801069799677, grad_norm: 0.051375243999445395, ic: 0.10516179620868162
Epoch 35: 2022-04-20 17:38:14.898709: train loss: 1.6144388981253073
Eval step 0: eval loss: 1.1387539779455298
Eval: 2022-04-20 17:38:16.631844: total loss: 1.0716466755932557, mse:0.5821389398904206, ic :0.1440015263503014, sharpe5:12.331364745497703, irr5:409.0029296875, ndcg5:0.8508813000507477, pnl5:4.668674945831299 
train 36, step: 0, loss: 1.6069441284971935, grad_norm: 0.0021691956282708824, ic: 0.03776686508614984
Epoch 36: 2022-04-20 17:39:30.937203: train loss: 1.6149165132989434
Eval step 0: eval loss: 1.1401922570883494
Eval: 2022-04-20 17:39:32.578653: total loss: 1.0723042873090842, mse:0.5826014831028441, ic :0.1435528080632767, sharpe5:12.37531150817871, irr5:407.7361145019531, ndcg5:0.8443526685322099, pnl5:4.6661200523376465 
train 37, step: 0, loss: 1.5463737171782543, grad_norm: 0.08507254291439229, ic: 0.16372108201944124
Epoch 37: 2022-04-20 17:40:09.432302: train loss: 1.6101827087018394
Eval step 0: eval loss: 1.1345326787711334
Eval: 2022-04-20 17:40:11.047925: total loss: 1.0704976054988589, mse:0.5812896033792098, ic :0.1544202678778272, sharpe5:14.54699519097805, irr5:476.4234619140625, ndcg5:0.8451639377713431, pnl5:5.543123722076416 
train 38, step: 0, loss: 1.8304961980757861, grad_norm: 0.06459855556983211, ic: 0.057206417715674
Epoch 38: 2022-04-20 17:41:24.633011: train loss: 1.6149752113720732
Eval step 0: eval loss: 1.1397592572034734
Eval: 2022-04-20 17:41:26.386656: total loss: 1.0724455331083145, mse:0.5833815616197477, ic :0.138743523263631, sharpe5:12.253325874209404, irr5:384.1415710449219, ndcg5:0.8461876437461184, pnl5:4.232914924621582 
train 39, step: 0, loss: 1.5434944876816301, grad_norm: 0.007069340191836537, ic: 0.14444392654817076
Epoch 39: 2022-04-20 17:42:03.188167: train loss: 1.6173636649968146
Eval step 0: eval loss: 1.1419570207140977
Eval: 2022-04-20 17:42:04.800567: total loss: 1.072695683337337, mse:0.5826982651710841, ic :0.1424120817652051, sharpe5:12.486803988218307, irr5:396.96917724609375, ndcg5:0.837524457391516, pnl5:4.23090124130249 
