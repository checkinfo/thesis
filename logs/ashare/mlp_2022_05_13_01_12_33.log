Namespace(adj_path='./data/concepts_graph_1931_233_3.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='TimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=2, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=9, input_graph=False, label_cnt=3, lr=0.001, lstm_layers=3, market=None, mask_adj=False, mask_type='soft', model_type='MlpModel', normalize_adj=False, num_days=1, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path=None, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
37839
MlpModel(
  (fc1): Linear(in_features=9, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): ReLU()
)
train 0, step: 0, loss: 2.081331058547431, grad_norm: 0.4922886230290927, ic: -0.12157467715456352
train 0, step: 500, loss: 1.3645183340539708, grad_norm: 0.8675560002415724, ic: -0.018179597293257087
train 0, step: 1000, loss: 1.504275257965937, grad_norm: 0.03245867428536492, ic: 0.2763552039439304
train 0, step: 1500, loss: 1.1928011918416122, grad_norm: 0.11017088958790075, ic: 0.05991928626326147
train 0, step: 2000, loss: 1.5614970137433308, grad_norm: 0.052933023560523984, ic: 0.039613070197962945
Epoch 0: 2022-05-13 01:12:48.270803: train loss: 1.64730396568538
Eval step 0: eval loss: 1.0079495478705898
Eval: 2022-05-13 01:12:50.033952: total loss: 1.0914027005239437, mse:4.88960992577652, ic :0.02561816486976109, sharpe5:6.633432705402374, sharpe5_real:67.35841650009155, irr5:202.51458740234375, irr5_real:1417.9013671875, ndcg5:0.8735738590955816, pnl5:2.726392984390259 
train 1, step: 0, loss: 0.643482774791151, grad_norm: 0.07324611285126174, ic: 0.058341897443220096
train 1, step: 500, loss: 1.2674840032255363, grad_norm: 0.35246380312280184, ic: 0.24243012696785263
train 1, step: 1000, loss: 0.8762885950254219, grad_norm: 0.06557467888733308, ic: 0.09894049578617481
train 1, step: 1500, loss: 1.8631197301352898, grad_norm: 0.571290474888622, ic: 0.0851940729845424
train 1, step: 2000, loss: 1.373362799698507, grad_norm: 0.23026237830554291, ic: 0.09259301219615793
Epoch 1: 2022-05-13 01:12:58.703568: train loss: 1.6457522623149088
Eval step 0: eval loss: 1.0072535092482884
Eval: 2022-05-13 01:13:00.545328: total loss: 1.089391895058659, mse:4.8814528957171515, ic :0.0453118542156607, sharpe5:6.767922531366348, sharpe5_real:67.35841650009155, irr5:206.44102478027344, irr5_real:1417.9013671875, ndcg5:0.8422907273246163, pnl5:2.6881844997406006 
train 2, step: 0, loss: 1.3299927750254066, grad_norm: 0.517046422953387, ic: 0.1162230506740215
train 2, step: 500, loss: 0.9392328797775986, grad_norm: 0.2477533413222902, ic: 0.08344604878613965
train 2, step: 1000, loss: 3.0513035356025573, grad_norm: 1.2472958072758784, ic: 0.14660744834547193
train 2, step: 1500, loss: 2.277062630105075, grad_norm: 0.8966233691419849, ic: 0.06487487903925515
train 2, step: 2000, loss: 1.4562727771425286, grad_norm: 0.3027742286690971, ic: -0.07223848809157607
Epoch 2: 2022-05-13 01:13:09.092946: train loss: 1.6453441423137827
Eval step 0: eval loss: 1.0038410686956951
Eval: 2022-05-13 01:13:10.906892: total loss: 1.090099455989203, mse:4.882700034307667, ic :0.0399876185965886, sharpe5:6.707971651554107, sharpe5_real:67.35840893268585, irr5:204.23074340820312, irr5_real:1417.9013671875, ndcg5:0.8501565999118148, pnl5:2.752556800842285 
train 3, step: 0, loss: 1.8292091562260901, grad_norm: 0.06565425077215829, ic: -0.12428017870646106
train 3, step: 500, loss: 0.7834373168155725, grad_norm: 0.02490996920680501, ic: 0.09045305241812111
train 3, step: 1000, loss: 1.3584387560050417, grad_norm: 0.5252135531304143, ic: 0.23672657546801146
train 3, step: 1500, loss: 2.59935938104215, grad_norm: 0.5643157111906139, ic: -0.049251070426079485
train 3, step: 2000, loss: 1.360354151870265, grad_norm: 0.16338269375569237, ic: 0.07891623622710676
Epoch 3: 2022-05-13 01:13:19.556992: train loss: 1.6451777523284854
Eval step 0: eval loss: 1.004012314252567
Eval: 2022-05-13 01:13:21.338206: total loss: 1.090621187621945, mse:4.878633146432083, ic :0.053054165893656725, sharpe5:6.752039965689182, sharpe5_real:67.35842406749725, irr5:205.45550537109375, irr5_real:1417.9013671875, ndcg5:0.8604626972771843, pnl5:2.5358710289001465 
train 4, step: 0, loss: 1.160535281107306, grad_norm: 0.15026467935142, ic: 0.10290237137460286
train 4, step: 500, loss: 0.9936694803986936, grad_norm: 0.0035176970422833437, ic: 0.139366295823795
train 4, step: 1000, loss: 1.3407364182577708, grad_norm: 0.06919761275892342, ic: 0.05259072184281366
train 4, step: 1500, loss: 1.0664749536758813, grad_norm: 0.08874471358361963, ic: 0.20145204638324
train 4, step: 2000, loss: 4.192387422551141, grad_norm: 0.9015213337657105, ic: -0.0016452054803266017
Epoch 4: 2022-05-13 01:13:30.652325: train loss: 1.645048021072683
Eval step 0: eval loss: 1.0041789315511453
Eval: 2022-05-13 01:13:32.474591: total loss: 1.0910532613680584, mse:4.878778945891748, ic :0.05402295619106609, sharpe5:6.73051022350788, sharpe5_real:67.35842406749725, irr5:206.1005096435547, irr5_real:1417.9013671875, ndcg5:0.8575016089911983, pnl5:2.71531081199646 
train 5, step: 0, loss: 0.9794856795625476, grad_norm: 0.14448484901761935, ic: -0.08647768637122813
train 5, step: 500, loss: 0.7922028696744174, grad_norm: 0.018910332117469154, ic: 0.13056513238781164
train 5, step: 1000, loss: 1.1199693734167195, grad_norm: 0.043034963166744655, ic: -0.08729332891841698
train 5, step: 1500, loss: 1.782986375762195, grad_norm: 0.4130844606937618, ic: -0.014238679313005525
train 5, step: 2000, loss: 2.1688208435674454, grad_norm: 0.8074542663426196, ic: 0.06133133060940238
Epoch 5: 2022-05-13 01:13:41.099496: train loss: 1.6450537047615557
Eval step 0: eval loss: 1.003448759523927
Eval: 2022-05-13 01:13:42.875552: total loss: 1.0910932865211165, mse:4.879726302406655, ic :0.05189287459485913, sharpe5:6.791008321344852, sharpe5_real:67.35841650009155, irr5:206.7886505126953, irr5_real:1417.9013671875, ndcg5:0.8485814547394253, pnl5:2.7539947032928467 
train 6, step: 0, loss: 0.7805276044340349, grad_norm: 0.010159852880408313, ic: -0.07554649064380387
train 6, step: 500, loss: 1.4430547346148574, grad_norm: 0.2653780045663139, ic: 0.10373767348030002
train 6, step: 1000, loss: 1.2325767995033354, grad_norm: 0.1711054775071337, ic: 0.1554159558908761
train 6, step: 1500, loss: 1.0905474277712264, grad_norm: 0.3259769067860428, ic: 0.08452372986876329
train 6, step: 2000, loss: 2.25068047706117, grad_norm: 0.9229515931600122, ic: 0.07700443331324099
Epoch 6: 2022-05-13 01:13:51.573894: train loss: 1.644949805195461
Eval step 0: eval loss: 1.0048060605499605
Eval: 2022-05-13 01:13:53.382695: total loss: 1.09021132119859, mse:4.877396519832968, ic :0.05426335910352699, sharpe5:6.794939115643501, sharpe5_real:67.35841650009155, irr5:208.1543426513672, irr5_real:1417.9013671875, ndcg5:0.8499853159887727, pnl5:2.6495373249053955 
train 7, step: 0, loss: 1.4602134239536142, grad_norm: 0.5043659161036379, ic: 0.17414883436115414
train 7, step: 500, loss: 1.3238315441684583, grad_norm: 0.021974374965531118, ic: 0.12933237064420827
train 7, step: 1000, loss: 0.6558356570269036, grad_norm: 0.0046529858380321585, ic: 0.2666054261780988
train 7, step: 1500, loss: 0.9993215401357444, grad_norm: 0.12208751258187457, ic: 0.06825862736694345
train 7, step: 2000, loss: 1.6008727672675647, grad_norm: 0.5658547207368103, ic: 0.17024930859453558
Epoch 7: 2022-05-13 01:14:01.961477: train loss: 1.6448395870740706
Eval step 0: eval loss: 1.0001619890402842
Eval: 2022-05-13 01:14:03.775027: total loss: 1.0932530315867495, mse:4.908903235160471, ic :0.04466977326860173, sharpe5:6.652493581473827, sharpe5_real:67.35842406749725, irr5:203.35855102539062, irr5_real:1417.9013671875, ndcg5:0.8603799814259554, pnl5:2.7711832523345947 
train 8, step: 0, loss: 1.2051905531077212, grad_norm: 0.0914171421625845, ic: 0.04745532827873451
train 8, step: 500, loss: 5.579602854378918, grad_norm: 1.2644432162977268, ic: 0.1464574019975573
train 8, step: 1000, loss: 1.9093680190740379, grad_norm: 0.5909448085341581, ic: -0.032119081442400284
train 8, step: 1500, loss: 1.1183006722045596, grad_norm: 0.3188672389764504, ic: 0.5720051299321578
train 8, step: 2000, loss: 1.1087361849271333, grad_norm: 0.4657793647521413, ic: 0.0492256599218411
Epoch 8: 2022-05-13 01:14:12.172055: train loss: 1.6444518082291908
Eval step 0: eval loss: 1.0018413397059307
Eval: 2022-05-13 01:14:13.968280: total loss: 1.0916898372504127, mse:4.836900533324258, ic :0.10702064752771122, sharpe5:6.676683739721775, sharpe5_real:67.35842406749725, irr5:204.06480407714844, irr5_real:1417.9013671875, ndcg5:0.8453573514576633, pnl5:2.653993844985962 
train 9, step: 0, loss: 1.1494379023186923, grad_norm: 0.016766295040912774, ic: 0.3480056526151347
train 9, step: 500, loss: 3.3459190240915144, grad_norm: 2.114695313573766, ic: 0.1594957124780706
train 9, step: 1000, loss: 0.8934596695746868, grad_norm: 0.16330364537083125, ic: 0.13946993504147764
train 9, step: 1500, loss: 2.139697107349068, grad_norm: 0.9424500880655429, ic: -0.04516829996176063
train 9, step: 2000, loss: 0.6052097707728904, grad_norm: 0.005108125893786863, ic: 0.09215682703159067
Epoch 9: 2022-05-13 01:14:22.422335: train loss: 1.639891960850982
Eval step 0: eval loss: 1.0034783289519154
Eval: 2022-05-13 01:14:24.254204: total loss: 1.0871415997424574, mse:4.7164428578192865, ic :0.12260124057551872, sharpe5:6.801304722726345, sharpe5_real:67.35842406749725, irr5:202.10240173339844, irr5_real:1417.9013671875, ndcg5:0.8422423962746184, pnl5:2.764892339706421 
train 10, step: 0, loss: 1.318471864780766, grad_norm: 0.02796898418266284, ic: 0.3803358307072007
train 10, step: 500, loss: 0.9000443118010804, grad_norm: 0.004048603384826063, ic: 0.10643055184149508
train 10, step: 1000, loss: 1.5536902028257702, grad_norm: 0.49583832629370994, ic: 0.03193822326025895
train 10, step: 1500, loss: 3.136323630200138, grad_norm: 0.7794832691384217, ic: 0.02013263864229029
train 10, step: 2000, loss: 1.381201097668123, grad_norm: 0.12519141275800616, ic: 0.02915839585837499
Epoch 10: 2022-05-13 01:14:32.837252: train loss: 1.6386807200223246
Eval step 0: eval loss: 1.0058476115101698
Eval: 2022-05-13 01:14:34.667744: total loss: 1.08758323910056, mse:4.71829141059418, ic :0.12150976071918076, sharpe5:6.738854707181454, sharpe5_real:67.35842406749725, irr5:204.6476593017578, irr5_real:1417.9013671875, ndcg5:0.8479647546039544, pnl5:2.6156601905822754 
train 11, step: 0, loss: 4.732071030223808, grad_norm: 1.5711042254615315, ic: 0.10874808390164886
train 11, step: 500, loss: 0.9988289875552036, grad_norm: 0.06361517702784797, ic: 0.0208966040377408
train 11, step: 1000, loss: 1.0263225866764398, grad_norm: 0.2703318075201675, ic: 0.04388017573645045
train 11, step: 1500, loss: 0.6953601523498678, grad_norm: 0.00177274021925883, ic: 0.0898407831019491
train 11, step: 2000, loss: 1.1330909512083671, grad_norm: 0.03981048784679727, ic: -0.1869296324776002
Epoch 11: 2022-05-13 01:14:43.185831: train loss: 1.6380653373668872
Eval step 0: eval loss: 1.0014111688100644
Eval: 2022-05-13 01:14:45.024934: total loss: 1.0862676339572466, mse:4.719637890080498, ic :0.11754574870092227, sharpe5:6.747203447520732, sharpe5_real:67.35842406749725, irr5:204.13998413085938, irr5_real:1417.9012451171875, ndcg5:0.8570905588815866, pnl5:2.5403072834014893 
train 12, step: 0, loss: 1.4120980498455322, grad_norm: 0.24107084563072767, ic: 0.05693527386356679
train 12, step: 500, loss: 0.7937320989233919, grad_norm: 0.29596539820090595, ic: 0.0629150812435354
train 12, step: 1000, loss: 1.2149314377112879, grad_norm: 0.21423414464423138, ic: 0.5787980403124099
train 12, step: 1500, loss: 1.0899256901638952, grad_norm: 0.17434245928027003, ic: -0.0884397818105099
train 12, step: 2000, loss: 1.1143945200444634, grad_norm: 0.05515876526483802, ic: 0.11011734126312081
Epoch 12: 2022-05-13 01:14:53.739818: train loss: 1.6385273978685353
Eval step 0: eval loss: 1.0045917464784095
Eval: 2022-05-13 01:14:55.508487: total loss: 1.0877968159711804, mse:4.721591730943799, ic :0.11814509687677158, sharpe5:6.685312947034835, sharpe5_real:67.35842406749725, irr5:203.64146423339844, irr5_real:1417.9013671875, ndcg5:0.8476159810337273, pnl5:2.6044113636016846 
train 13, step: 0, loss: 1.077134968740092, grad_norm: 0.028318458721296274, ic: 0.43022845609342775
train 13, step: 500, loss: 1.143319212935353, grad_norm: 0.006063678221434211, ic: -0.1838271890955005
train 13, step: 1000, loss: 1.4049456436553402, grad_norm: 0.3895270324982148, ic: 0.03207970133939405
train 13, step: 1500, loss: 0.7739761329314117, grad_norm: 0.0002848529983929722, ic: -0.044933904842930514
train 13, step: 2000, loss: 1.0395948465701805, grad_norm: 0.021151187425658184, ic: 0.03183230954030901
Epoch 13: 2022-05-13 01:15:04.155101: train loss: 1.6385315967561858
Eval step 0: eval loss: 0.9912920605828724
Eval: 2022-05-13 01:15:05.978333: total loss: 1.0852519484172722, mse:4.741838574243946, ic :0.11777714657710592, sharpe5:6.580921058356761, sharpe5_real:67.35842406749725, irr5:197.53994750976562, irr5_real:1417.9013671875, ndcg5:0.8531505345722187, pnl5:2.489365339279175 
train 14, step: 0, loss: 1.7452250335176112, grad_norm: 0.6741545094752496, ic: 0.169299522194565
train 14, step: 500, loss: 1.2782514293258633, grad_norm: 0.14184044663066483, ic: 0.15542832652898572
train 14, step: 1000, loss: 1.0710333201510847, grad_norm: 0.11853357812919772, ic: 0.12829801583742798
train 14, step: 1500, loss: 0.9921222830663009, grad_norm: 0.06409689967006486, ic: 0.14928233399186705
train 14, step: 2000, loss: 2.303822453609299, grad_norm: 0.43134493871010415, ic: -0.0903115399993127
Epoch 14: 2022-05-13 01:15:14.709739: train loss: 1.6385431159582762
Eval step 0: eval loss: 1.0012988692650737
Eval: 2022-05-13 01:15:16.524284: total loss: 1.0881948769170873, mse:4.723732182098818, ic :0.11558242480918735, sharpe5:6.7093394601345056, sharpe5_real:67.35842406749725, irr5:203.0811767578125, irr5_real:1417.9013671875, ndcg5:0.8438767504417286, pnl5:2.602999448776245 
train 15, step: 0, loss: 0.9790896379938149, grad_norm: 0.14079398841349888, ic: 0.12085757971921178
train 15, step: 500, loss: 1.2278557552282277, grad_norm: 0.00408988704109741, ic: 0.061490683803152174
train 15, step: 1000, loss: 1.760119921875, grad_norm: 0.037891361233621454, ic: -0.1099759617104033
train 15, step: 1500, loss: 5.414039275485789, grad_norm: 0.8451811289692475, ic: -0.0024328388013823716
train 15, step: 2000, loss: 0.9344126890400055, grad_norm: 0.0184209864263938, ic: -0.10654389713066797
Epoch 15: 2022-05-13 01:15:25.239819: train loss: 1.638808136563959
Eval step 0: eval loss: 1.0012991906718995
Eval: 2022-05-13 01:15:27.076443: total loss: 1.0870527063371995, mse:4.719583388309077, ic :0.11605779126210805, sharpe5:6.662333100736141, sharpe5_real:67.35842406749725, irr5:200.9187469482422, irr5_real:1417.9013671875, ndcg5:0.8659014355113968, pnl5:2.764080762863159 
train 16, step: 0, loss: 6.290809926963108, grad_norm: 1.1253765686940398, ic: -0.02031287865337112
train 16, step: 500, loss: 1.3530763656374007, grad_norm: 0.685077969031418, ic: 0.017688178095465627
train 16, step: 1000, loss: 0.8153467170660001, grad_norm: 0.06410862008994381, ic: -0.003098835735307814
train 16, step: 1500, loss: 1.2210525244177983, grad_norm: 0.2560819256198295, ic: 0.0882473916053737
train 16, step: 2000, loss: 0.9652463665693473, grad_norm: 0.20236288262629704, ic: 0.5103001595963983
Epoch 16: 2022-05-13 01:15:35.469402: train loss: 1.637828833124261
Eval step 0: eval loss: 1.0012547722485519
Eval: 2022-05-13 01:15:37.311074: total loss: 1.085195489666398, mse:4.727535836635704, ic :0.11469492651485264, sharpe5:7.687787044644355, sharpe5_real:67.35841650009155, irr5:215.78048706054688, irr5_real:1417.9013671875, ndcg5:0.8402254359160218, pnl5:3.6558837890625 
train 17, step: 0, loss: 1.1931982683989169, grad_norm: 0.00240550082611666, ic: 0.12187032913171639
train 17, step: 500, loss: 1.0502655875624491, grad_norm: 0.00608901692067876, ic: -0.03513503329105096
train 17, step: 1000, loss: 3.373084342125619, grad_norm: 0.7581296562252581, ic: -0.02116827481536573
train 17, step: 1500, loss: 0.8887536502578884, grad_norm: 0.004705812263178271, ic: 0.025002109151669297
train 17, step: 2000, loss: 1.0364746913013843, grad_norm: 0.5879488348023953, ic: 0.5114035788645659
Epoch 17: 2022-05-13 01:15:45.919646: train loss: 1.638155843678382
Eval step 0: eval loss: 0.9993972979199578
Eval: 2022-05-13 01:15:47.716955: total loss: 1.0874609906726325, mse:4.738960129391319, ic :0.11222141131815724, sharpe5:6.568758818507194, sharpe5_real:67.35842406749725, irr5:200.39132690429688, irr5_real:1417.9013671875, ndcg5:0.8709069829775734, pnl5:2.4449703693389893 
train 18, step: 0, loss: 0.8539672949453688, grad_norm: 0.005748526603429387, ic: 0.018617677900050304
train 18, step: 500, loss: 2.4897119902937552, grad_norm: 0.9631506758677665, ic: 0.04088560259755143
train 18, step: 1000, loss: 1.365279339028777, grad_norm: 0.2996651592593589, ic: 0.5034349295269321
train 18, step: 1500, loss: 1.7727331685362542, grad_norm: 0.5445899730602104, ic: 0.3553796058952946
train 18, step: 2000, loss: 1.2784746105033218, grad_norm: 0.29149131571703923, ic: 0.08454055740597685
Epoch 18: 2022-05-13 01:15:56.416946: train loss: 1.6382608711729474
Eval step 0: eval loss: 0.9932109878965902
Eval: 2022-05-13 01:15:58.273708: total loss: 1.0866556424529539, mse:4.72930995409019, ic :0.11825493601902544, sharpe5:6.592558309435844, sharpe5_real:67.35840893268585, irr5:201.20846557617188, irr5_real:1417.9013671875, ndcg5:0.8530652165584057, pnl5:2.5442090034484863 
train 19, step: 0, loss: 2.396156737160482, grad_norm: 2.3405481400489245, ic: 0.07898625842495435
train 19, step: 500, loss: 1.0241906454396803, grad_norm: 0.04018296721825227, ic: -0.0860733187769484
train 19, step: 1000, loss: 1.0421090273772247, grad_norm: 0.020797700070960913, ic: 0.4508802690892029
train 19, step: 1500, loss: 1.5827425733024691, grad_norm: 0.004360247028943297, ic: 0.12298941245014791
train 19, step: 2000, loss: 1.9425353767884765, grad_norm: 0.5791853101646516, ic: 0.6089472673681066
Epoch 19: 2022-05-13 01:16:06.879488: train loss: 1.638203333662502
Eval step 0: eval loss: 1.0004030441597551
Eval: 2022-05-13 01:16:08.641537: total loss: 1.0864612078741918, mse:4.719596474972944, ic :0.1187415012095592, sharpe5:6.7187887850403785, sharpe5_real:67.35842406749725, irr5:203.52684020996094, irr5_real:1417.9013671875, ndcg5:0.8503280065579663, pnl5:2.6207540035247803 
train 20, step: 0, loss: 1.2279048168153834, grad_norm: 0.25658182491832304, ic: 0.44689615630359225
train 20, step: 500, loss: 1.2521613049009106, grad_norm: 0.4839649226472321, ic: 0.010945739094373162
train 20, step: 1000, loss: 1.5567232114792882, grad_norm: 0.21490525505447663, ic: 0.11677371734051298
train 20, step: 1500, loss: 0.8374480255769826, grad_norm: 0.2096878720279304, ic: 0.5524851459432045
train 20, step: 2000, loss: 1.365769431777991, grad_norm: 0.06441177502803427, ic: -0.06383811160648528
Epoch 20: 2022-05-13 01:16:17.225632: train loss: 1.6379442796289068
Eval step 0: eval loss: 1.0024064371873354
Eval: 2022-05-13 01:16:18.991209: total loss: 1.0868606755465648, mse:4.718811723491739, ic :0.11803730515553885, sharpe5:6.704661384522915, sharpe5_real:67.35841650009155, irr5:203.268798828125, irr5_real:1417.9013671875, ndcg5:0.8400000238114324, pnl5:2.5596654415130615 
train 21, step: 0, loss: 1.424699201667274, grad_norm: 0.21667943426766834, ic: 0.3097319621806902
train 21, step: 500, loss: 1.1112282832524387, grad_norm: 0.06905838979853851, ic: -0.06494101154755502
train 21, step: 1000, loss: 0.9300060664030402, grad_norm: 0.145394579613841, ic: 0.08327194955000938
train 21, step: 1500, loss: 0.7866532392070392, grad_norm: 0.09176812694890278, ic: 0.5442626407990593
train 21, step: 2000, loss: 1.1789645784576908, grad_norm: 0.011244478767930945, ic: 0.014801006408997173
Epoch 21: 2022-05-13 01:16:27.607371: train loss: 1.63794048505301
Eval step 0: eval loss: 1.00133782377238
Eval: 2022-05-13 01:16:29.379022: total loss: 1.0860596572309649, mse:4.717706825084642, ic :0.11987153128787317, sharpe5:6.599142898321151, sharpe5_real:67.35842406749725, irr5:199.99761962890625, irr5_real:1417.9013671875, ndcg5:0.8441901534472799, pnl5:2.6077070236206055 
train 22, step: 0, loss: 1.0610614543559083, grad_norm: 0.17744873071158782, ic: 0.08193195618605985
train 22, step: 500, loss: 1.0301965428149606, grad_norm: 0.004558735910097335, ic: 0.013148574893150522
train 22, step: 1000, loss: 0.9214721773084832, grad_norm: 0.008966971675644496, ic: 0.10286832928490763
train 22, step: 1500, loss: 1.0269402714904594, grad_norm: 0.003941073505696077, ic: 0.12469832288227839
train 22, step: 2000, loss: 1.0665577733239462, grad_norm: 0.10468116210675689, ic: 0.02423175815366315
Epoch 22: 2022-05-13 01:16:38.133613: train loss: 1.638220705547497
Eval step 0: eval loss: 0.9989434072003356
Eval: 2022-05-13 01:16:39.889695: total loss: 1.0864200024681634, mse:4.718690413648906, ic :0.12026327251362795, sharpe5:6.461915563344955, sharpe5_real:67.35842406749725, irr5:196.6134490966797, irr5_real:1417.9013671875, ndcg5:0.8496038761250777, pnl5:2.61826491355896 
train 23, step: 0, loss: 1.263835721337814, grad_norm: 0.7220169019639918, ic: -0.032622495873493966
train 23, step: 500, loss: 0.9332158853719523, grad_norm: 0.13406047106018165, ic: 0.5196074920589033
train 23, step: 1000, loss: 2.342595845508122, grad_norm: 0.7741253191960182, ic: 0.019214732809670468
train 23, step: 1500, loss: 0.8090533463201697, grad_norm: 0.2604734150592522, ic: 0.6652897700716548
train 23, step: 2000, loss: 1.4679840849100056, grad_norm: 0.3174634798083716, ic: 0.40559662132618773
Epoch 23: 2022-05-13 01:16:48.457593: train loss: 1.637757127758429
Eval step 0: eval loss: 1.005338695941943
Eval: 2022-05-13 01:16:50.286832: total loss: 1.0914037725148542, mse:4.729181716295038, ic :0.11452141836267536, sharpe5:6.776421673893928, sharpe5_real:67.35842406749725, irr5:204.89947509765625, irr5_real:1417.9013671875, ndcg5:0.8300864286628011, pnl5:2.5850067138671875 
train 24, step: 0, loss: 1.204650545380806, grad_norm: 0.10938818547543666, ic: 0.0433843986423461
train 24, step: 500, loss: 1.235041870768974, grad_norm: 0.16408993416966133, ic: 0.03208322710798803
train 24, step: 1000, loss: 1.0948666828434641, grad_norm: 0.28456954035398474, ic: 0.058868047900917736
train 24, step: 1500, loss: 1.2127717265932578, grad_norm: 0.07131398218301141, ic: 0.03242877773585279
train 24, step: 2000, loss: 1.3733543970510793, grad_norm: 0.36830034893385577, ic: 0.44778642589179274
Epoch 24: 2022-05-13 01:16:58.960775: train loss: 1.6383100451789228
Eval step 0: eval loss: 1.0061571262835702
Eval: 2022-05-13 01:17:00.772608: total loss: 1.0885281923550725, mse:4.722148892095951, ic :0.12005216512972236, sharpe5:6.434403313994407, sharpe5_real:67.35841650009155, irr5:195.33255004882812, irr5_real:1417.9013671875, ndcg5:0.8600766127902566, pnl5:2.5073482990264893 
train 25, step: 0, loss: 1.3686402341522947, grad_norm: 0.3280167597104524, ic: 0.13182029573632922
train 25, step: 500, loss: 1.5185783683479608, grad_norm: 0.25357326719298956, ic: 0.0841662488300231
train 25, step: 1000, loss: 1.3892448122574037, grad_norm: 0.1536331373294456, ic: 0.2555465225903229
train 25, step: 1500, loss: 2.884003416904956, grad_norm: 1.1157860535800648, ic: 0.08336915081758582
train 25, step: 2000, loss: 1.211253878436511, grad_norm: 0.12132184986299498, ic: 0.1336483195332197
Epoch 25: 2022-05-13 01:17:09.435990: train loss: 1.6383336659716765
Eval step 0: eval loss: 1.002492317091232
Eval: 2022-05-13 01:17:11.249280: total loss: 1.0863611197580711, mse:4.717836388337223, ic :0.1202373771200096, sharpe5:6.6188190990686415, sharpe5_real:67.35842406749725, irr5:195.6863250732422, irr5_real:1417.9013671875, ndcg5:0.8360067933404172, pnl5:2.463148355484009 
train 26, step: 0, loss: 1.6301004971590909, grad_norm: 0.16298025458244136, ic: 7.641695146491309e-05
train 26, step: 500, loss: 1.0174814316711174, grad_norm: 0.14022775969438822, ic: -0.03580730511634742
train 26, step: 1000, loss: 1.8790707044259993, grad_norm: 0.36285513089113475, ic: 0.09464774527263213
train 26, step: 1500, loss: 0.9273066127527088, grad_norm: 0.0028426606401631073, ic: -0.11842539545469329
train 26, step: 2000, loss: 0.9892490657295767, grad_norm: 0.07319364404183672, ic: 0.15184384422098823
Epoch 26: 2022-05-13 01:17:20.013614: train loss: 1.6382009813580358
Eval step 0: eval loss: 0.9996743506039362
Eval: 2022-05-13 01:17:21.885946: total loss: 1.086775015232221, mse:4.721283353935885, ic :0.11904549839700153, sharpe5:6.570857354700565, sharpe5_real:67.35842406749725, irr5:194.61843872070312, irr5_real:1417.9012451171875, ndcg5:0.8716889190141209, pnl5:2.613538980484009 
train 27, step: 0, loss: 1.6240811635212726, grad_norm: 0.2528613750818253, ic: 0.6493501681986305
train 27, step: 500, loss: 1.5402768433186722, grad_norm: 0.3956648580613347, ic: -0.17921953166466265
train 27, step: 1000, loss: 2.7266516578040014, grad_norm: 0.6139878260974301, ic: 0.3154317668559348
train 27, step: 1500, loss: 0.8417510456876734, grad_norm: 0.2667385720801559, ic: 0.5346353774628178
train 27, step: 2000, loss: 1.3580946680587558, grad_norm: 0.44513051681552107, ic: 0.007690401053492337
Epoch 27: 2022-05-13 01:17:30.468614: train loss: 1.6379501691262353
Eval step 0: eval loss: 1.0027304152679042
Eval: 2022-05-13 01:17:32.292364: total loss: 1.0858826607223964, mse:4.717479855571415, ic :0.12023800468352779, sharpe5:6.453507229685783, sharpe5_real:67.35842406749725, irr5:195.26414489746094, irr5_real:1417.9013671875, ndcg5:0.8429389511228288, pnl5:2.6355042457580566 
train 28, step: 0, loss: 1.1878139152262557, grad_norm: 0.1006451108857931, ic: 0.046688721247226506
train 28, step: 500, loss: 2.9661030651513594, grad_norm: 0.3353099552660393, ic: 0.06787136975392036
train 28, step: 1000, loss: 2.6888973483165484, grad_norm: 0.9243316152131987, ic: -0.021855289357122845
train 28, step: 1500, loss: 1.0408374609593105, grad_norm: 0.00170490501785208, ic: 0.09173085975063625
train 28, step: 2000, loss: 1.7705237810001817, grad_norm: 0.32826952854300295, ic: 0.13764680960373898
Epoch 28: 2022-05-13 01:17:40.799153: train loss: 1.6377345902704894
Eval step 0: eval loss: 1.00166553017213
Eval: 2022-05-13 01:17:42.641460: total loss: 1.0858842853568014, mse:4.718718981494329, ic :0.11779199560923241, sharpe5:6.519370145201683, sharpe5_real:67.35841650009155, irr5:191.8971405029297, irr5_real:1417.9013671875, ndcg5:0.8449126557694515, pnl5:2.8990700244903564 
train 29, step: 0, loss: 1.5218108830079606, grad_norm: 0.08383292812734335, ic: 0.06279639524176914
train 29, step: 500, loss: 2.5501686862901565, grad_norm: 0.8655697781392139, ic: -0.010700612997341444
train 29, step: 1000, loss: 1.6884907547577854, grad_norm: 0.7167363329800017, ic: 0.4697548284383619
train 29, step: 1500, loss: 3.995587908447397, grad_norm: 0.959270393165337, ic: 0.05224630860669767
train 29, step: 2000, loss: 0.9478283060568726, grad_norm: 0.14213286302748263, ic: 0.4626640238055523
Epoch 29: 2022-05-13 01:17:51.245927: train loss: 1.6380378306582732
Eval step 0: eval loss: 1.0022692607540151
Eval: 2022-05-13 01:17:53.060147: total loss: 1.08700661079839, mse:4.724646730021138, ic :0.11322170845369045, sharpe5:6.6385284072160715, sharpe5_real:67.35842406749725, irr5:195.71035766601562, irr5_real:1417.9013671875, ndcg5:0.853544226330856, pnl5:2.6554903984069824 
train 30, step: 0, loss: 1.2548449254234482, grad_norm: 0.023303938936669502, ic: 0.9940680830853129
train 30, step: 500, loss: 1.9560759339151503, grad_norm: 0.19586570791085933, ic: 0.16370169695778958
train 30, step: 1000, loss: 3.452604123636814, grad_norm: 0.4957562390230386, ic: 0.3425124628636215
train 30, step: 1500, loss: 1.1069895338586644, grad_norm: 0.20355962939057082, ic: 0.05413853220014854
train 30, step: 2000, loss: 1.1056383949733808, grad_norm: 0.06297028048887127, ic: 0.43689216666931946
Epoch 30: 2022-05-13 01:18:01.512806: train loss: 1.6382480266659556
Eval step 0: eval loss: 1.0045482922755398
Eval: 2022-05-13 01:18:03.384259: total loss: 1.0872260498356627, mse:4.715906889360711, ic :0.12308426788040376, sharpe5:6.611938908398151, sharpe5_real:67.35841650009155, irr5:200.0083465576172, irr5_real:1417.9013671875, ndcg5:0.8417455271918024, pnl5:2.617654323577881 
train 31, step: 0, loss: 1.1909195413144122, grad_norm: 0.21972148545180314, ic: 0.1442329047073902
train 31, step: 500, loss: 0.8386811664912882, grad_norm: 0.07826267609691234, ic: 0.2617227304967307
train 31, step: 1000, loss: 5.017077304231518, grad_norm: 0.33074568989391423, ic: -0.2255916029281008
train 31, step: 1500, loss: 1.6763038694213679, grad_norm: 0.21450130194401232, ic: 0.1927994714775379
train 31, step: 2000, loss: 1.0407080639367816, grad_norm: 0.19609819453002814, ic: 0.10863919788636084
Epoch 31: 2022-05-13 01:18:12.023118: train loss: 1.6381798563312524
Eval step 0: eval loss: 1.004061489496939
Eval: 2022-05-13 01:18:13.861350: total loss: 1.0874536540268385, mse:4.717717004171092, ic :0.12143921717778094, sharpe5:6.462360621392727, sharpe5_real:67.35842406749725, irr5:196.2516326904297, irr5_real:1417.9013671875, ndcg5:0.8567659810448449, pnl5:2.694397211074829 
train 32, step: 0, loss: 0.8641436087353108, grad_norm: 0.31257211214974434, ic: 0.1062937856770508
train 32, step: 500, loss: 1.1467825726764957, grad_norm: 0.3608675868233592, ic: 0.029862567609413575
train 32, step: 1000, loss: 1.3869387763614522, grad_norm: 0.04372736191453165, ic: -0.01821073970228483
train 32, step: 1500, loss: 2.1897849446110684, grad_norm: 0.4023266831324601, ic: 0.40959342347619154
train 32, step: 2000, loss: 1.0673872462196103, grad_norm: 0.29399916555597394, ic: 0.46803775450506324
Epoch 32: 2022-05-13 01:18:22.445770: train loss: 1.6375439038398043
Eval step 0: eval loss: 1.0016607733511058
Eval: 2022-05-13 01:18:24.242583: total loss: 1.087289312440055, mse:4.720378932555473, ic :0.11688520922121338, sharpe5:6.712512094974517, sharpe5_real:67.35841650009155, irr5:198.2063751220703, irr5_real:1417.9013671875, ndcg5:0.8499479602660776, pnl5:2.462379217147827 
train 33, step: 0, loss: 1.1709498208019002, grad_norm: 0.011078362148292418, ic: -0.01044930126267462
train 33, step: 500, loss: 3.4345935818601077, grad_norm: 0.5123797946834927, ic: 0.4674860663416265
train 33, step: 1000, loss: 5.331176668904771, grad_norm: 1.3848866931855082, ic: -0.010429017594623901
train 33, step: 1500, loss: 1.3386778296493902, grad_norm: 1.1024079286674975, ic: 0.0477060530904739
train 33, step: 2000, loss: 1.9067806746608527, grad_norm: 0.3247713561322353, ic: -0.05625969415873407
Epoch 33: 2022-05-13 01:18:32.981471: train loss: 1.6377492974516257
Eval step 0: eval loss: 1.006940973250724
Eval: 2022-05-13 01:18:34.790759: total loss: 1.0933628452347834, mse:4.735304709100889, ic :0.11395598258288703, sharpe5:6.7560450151562685, sharpe5_real:67.35842406749725, irr5:199.92677307128906, irr5_real:1417.9013671875, ndcg5:0.851521802933898, pnl5:2.4565658569335938 
train 34, step: 0, loss: 0.7094166992961322, grad_norm: 0.22213222974833916, ic: -0.012765155434141359
train 34, step: 500, loss: 1.7658543497569184, grad_norm: 0.12947464549888454, ic: 0.8951883573128373
train 34, step: 1000, loss: 0.7669038759428879, grad_norm: 0.007751441244609223, ic: 0.121895252180925
train 34, step: 1500, loss: 1.6648763020833333, grad_norm: 0.5217039787620182, ic: 0.6208802891206376
train 34, step: 2000, loss: 3.000147409454798, grad_norm: 0.3806697059840094, ic: 0.06529552063557992
Epoch 34: 2022-05-13 01:18:43.319488: train loss: 1.638174010145646
Eval step 0: eval loss: 1.0016915641250328
Eval: 2022-05-13 01:18:45.065894: total loss: 1.086292595954223, mse:4.7209422409458766, ic :0.11647522620771922, sharpe5:6.889065345525741, sharpe5_real:67.35842406749725, irr5:204.23077392578125, irr5_real:1417.9013671875, ndcg5:0.843331278088715, pnl5:2.4408676624298096 
train 35, step: 0, loss: 1.0503324677672567, grad_norm: 0.35005280679648987, ic: -0.030079884987043073
train 35, step: 500, loss: 3.35467529296875, grad_norm: 0.9211025611604501, ic: -0.08188982378409403
train 35, step: 1000, loss: 1.3792547626555152, grad_norm: 0.014351164146074298, ic: 0.43456681259355256
train 35, step: 1500, loss: 1.6523972369919637, grad_norm: 0.3302360530060784, ic: 0.09129416978701141
train 35, step: 2000, loss: 1.2752008944681004, grad_norm: 0.0356058350298964, ic: -0.08189960181340572
Epoch 35: 2022-05-13 01:18:53.618462: train loss: 1.637983445574362
Eval step 0: eval loss: 1.0000436470469654
Eval: 2022-05-13 01:18:55.438887: total loss: 1.0885908837108647, mse:4.72513152515278, ic :0.11636868141403038, sharpe5:6.5509196054935455, sharpe5_real:67.35842406749725, irr5:198.5496063232422, irr5_real:1417.9013671875, ndcg5:0.8415807629974703, pnl5:2.882481336593628 
train 36, step: 0, loss: 8.990401631560774, grad_norm: 1.1717382888860028, ic: -0.1836485406182582
train 36, step: 500, loss: 0.8647377770746594, grad_norm: 0.004240557629740713, ic: 0.07297634172028478
train 36, step: 1000, loss: 1.9365386499097643, grad_norm: 0.9640695475492923, ic: -0.052796135327469046
train 36, step: 1500, loss: 1.0636095243699304, grad_norm: 0.06732752490279706, ic: 0.034604157576990036
train 36, step: 2000, loss: 2.1447528302494114, grad_norm: 0.858099642341946, ic: 0.40542688025694423
Epoch 36: 2022-05-13 01:19:03.994629: train loss: 1.637885872241673
Eval step 0: eval loss: 1.0034592373864533
Eval: 2022-05-13 01:19:05.838243: total loss: 1.0899790593377816, mse:4.722487254450974, ic :0.12245453136194605, sharpe5:6.7232351088523865, sharpe5_real:67.35841650009155, irr5:203.59146118164062, irr5_real:1417.9013671875, ndcg5:0.850988981701518, pnl5:2.6310391426086426 
train 37, step: 0, loss: 1.195976825377649, grad_norm: 0.12114621234532477, ic: 0.1538755305722027
train 37, step: 500, loss: 2.3504572824818464, grad_norm: 0.020848573743536845, ic: 0.21628418350385076
train 37, step: 1000, loss: 0.758117433962089, grad_norm: 0.2210469515968405, ic: 0.03627388353818287
train 37, step: 1500, loss: 3.2187438035374365, grad_norm: 0.6585343450102167, ic: -0.035302571992544274
train 37, step: 2000, loss: 3.1311991296340302, grad_norm: 1.188196706293558, ic: 0.018013370941236173
Epoch 37: 2022-05-13 01:19:14.579671: train loss: 1.6380240036326996
Eval step 0: eval loss: 0.999453222707675
Eval: 2022-05-13 01:19:16.313806: total loss: 1.085402483808665, mse:4.716012515529728, ic :0.1227755529501555, sharpe5:6.638051187694073, sharpe5_real:67.35842406749725, irr5:197.66455078125, irr5_real:1417.9013671875, ndcg5:0.8420020327164212, pnl5:2.579052686691284 
train 38, step: 0, loss: 1.3246911251183713, grad_norm: 0.25397977406645866, ic: -0.23019968305607363
train 38, step: 500, loss: 1.7731982800387596, grad_norm: 0.6369340372866499, ic: 0.043693297234316086
train 38, step: 1000, loss: 1.8352768052214259, grad_norm: 0.47604417474231175, ic: 0.006085656615695951
train 38, step: 1500, loss: 1.0811328487136898, grad_norm: 0.102250221617108, ic: 0.4644123444853031
train 38, step: 2000, loss: 0.7798224136499057, grad_norm: 0.0008708478909256612, ic: 0.513947313570686
Epoch 38: 2022-05-13 01:19:25.314526: train loss: 1.6376038418023582
Eval step 0: eval loss: 0.9983320271359926
Eval: 2022-05-13 01:19:27.096177: total loss: 1.084996665409675, mse:4.716019752427239, ic :0.1240933941487956, sharpe5:6.859480572938919, sharpe5_real:67.35841650009155, irr5:202.752197265625, irr5_real:1417.9013671875, ndcg5:0.8631201267855395, pnl5:2.557600259780884 
train 39, step: 0, loss: 0.8679910813462678, grad_norm: 0.007270543578291193, ic: 0.5393451703393585
train 39, step: 500, loss: 1.2758680403280374, grad_norm: 0.30969025276206386, ic: 0.060352701801700014
train 39, step: 1000, loss: 1.3751455595999054, grad_norm: 0.17745136791880686, ic: 0.0802732217541388
train 39, step: 1500, loss: 2.438921449984427, grad_norm: 0.300151053505395, ic: -0.03936668548460856
train 39, step: 2000, loss: 2.8160084680363777, grad_norm: 0.7262877524767035, ic: 0.27148716905744624
Epoch 39: 2022-05-13 01:19:35.577418: train loss: 1.6375668803730672
Eval step 0: eval loss: 0.9992956048002237
Eval: 2022-05-13 01:19:37.406322: total loss: 1.0855508652560966, mse:4.717966514503771, ic :0.12124448713855379, sharpe5:6.59903080612421, sharpe5_real:67.35842406749725, irr5:199.61097717285156, irr5_real:1417.9013671875, ndcg5:0.8561219117459744, pnl5:2.7516658306121826 
