Namespace(adj_path='./data/graphs/concepts_graph_multihot_1931_1931_824.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='TimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=9, input_graph=False, label_cnt=3, lr=0.0004, lstm_layers=1, market=None, mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path=None, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
relation encoding shape: torch.Size([1931, 1931, 824]) torch.float32
relation mask shape: torch.Size([1931, 1931]) torch.float32
88514
ReRaLSTM(
  (rnn1): LSTM(9, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=824, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 4.838890857114934, grad_norm: 7.969782703130618e-05, ic: 0.007738848460723634
train 0, step: 500, loss: 0.8795984723824887, grad_norm: 4.170989211468536e-06, ic: 0.04932157552518546
train 0, step: 1000, loss: 1.905137168811723, grad_norm: 0.002435865627141435, ic: 0.1504948583077917
train 0, step: 1500, loss: 0.9318042860671937, grad_norm: 0.00020270781258086118, ic: 0.07589046117013552
train 0, step: 2000, loss: 0.9837287040474262, grad_norm: 0.002798472900737358, ic: 0.05367216133101055
Epoch 0: 2022-05-13 10:52:21.614846: train loss: 1.6472568436730752
Eval step 0: eval loss: 0.8334657369599577
Eval: 2022-05-13 10:52:25.271830: total loss: 1.0786759572878184, mse:4.825811274294889, ic :0.029712641823292023, sharpe5:1.8585674918442963, sharpe5_real:465.43026065826416, irr5:19.305587768554688, irr5_real:1197.3116455078125, ndcg5:0.8569846694054376, pnl5:1.1714680194854736 
train 1, step: 0, loss: 2.7303017893145163, grad_norm: 0.0001880939987351398, ic: 0.04414350766241033
train 1, step: 500, loss: 1.763166231956026, grad_norm: 0.35555574204827833, ic: 0.04599244258459827
train 1, step: 1000, loss: 0.8752016901055928, grad_norm: 0.13477370411244635, ic: 0.05967746162303166
train 1, step: 1500, loss: 1.720709018049569, grad_norm: 0.21213281626531488, ic: 0.020654699842319456
train 1, step: 2000, loss: 2.1722625, grad_norm: 0.31189611736501793, ic: -0.0305999323221116
Epoch 1: 2022-05-13 10:54:02.415362: train loss: 1.6466620441396624
Eval step 0: eval loss: 0.8354673556457455
Eval: 2022-05-13 10:54:06.099294: total loss: 1.0788576590634549, mse:4.820775734140907, ic :0.019820975079538564, sharpe5:3.3370634512603283, sharpe5_real:465.4300185012817, irr5:34.21570587158203, irr5_real:1197.3116455078125, ndcg5:0.836700191461063, pnl5:1.2785907983779907 
train 2, step: 0, loss: 2.1386265980113635, grad_norm: 0.011104166721841868, ic: 0.14686209561329067
train 2, step: 500, loss: 3.297121050958529, grad_norm: 0.06086201165244024, ic: -0.06527239456055947
train 2, step: 1000, loss: 2.0650815298730842, grad_norm: 0.00441230621931234, ic: 0.21292332161042646
train 2, step: 1500, loss: 1.4885352680701336, grad_norm: 0.07249770802199222, ic: -0.09756450089198272
train 2, step: 2000, loss: 3.200009765625, grad_norm: 0.7791354514161294, ic: 0.16953603195775846
Epoch 2: 2022-05-13 10:55:43.191143: train loss: 1.645773678913685
Eval step 0: eval loss: 0.836318889332521
Eval: 2022-05-13 10:55:46.861242: total loss: 1.0788623138503246, mse:4.81930554532624, ic :0.025203377063758713, sharpe5:6.320342645645141, sharpe5_real:465.43026065826416, irr5:58.80058670043945, irr5_real:1197.3116455078125, ndcg5:0.8448271456089862, pnl5:1.3445028066635132 
train 3, step: 0, loss: 1.524130124968242, grad_norm: 0.373794138864591, ic: 0.10789513584503749
train 3, step: 500, loss: 1.4933770403044244, grad_norm: 0.28405828288840446, ic: 0.13800052193803033
train 3, step: 1000, loss: 3.705872811870323, grad_norm: 0.5326432186986867, ic: 0.02661186949111918
train 3, step: 1500, loss: 1.950011507774141, grad_norm: 0.00012906709083671474, ic: -0.05081321156407659
train 3, step: 2000, loss: 0.9065399994721284, grad_norm: 0.01799124566560869, ic: 0.0020665773095416918
Epoch 3: 2022-05-13 10:57:24.192712: train loss: 1.646180048109257
Eval step 0: eval loss: 0.8341296631116636
Eval: 2022-05-13 10:57:27.859355: total loss: 1.0781352102012558, mse:4.819717374311858, ic :0.02848386789123256, sharpe5:3.770642217546701, sharpe5_real:465.43026065826416, irr5:38.103878021240234, irr5_real:1197.3116455078125, ndcg5:0.8541875796178002, pnl5:1.3744468688964844 
train 4, step: 0, loss: 1.4433442283163267, grad_norm: 0.025577412668334028, ic: 0.036315633889564894
train 4, step: 500, loss: 1.6481547197957678, grad_norm: 0.3982248340147919, ic: 0.021291716788861513
train 4, step: 1000, loss: 2.9533300632383765, grad_norm: 0.33500498202430845, ic: 0.04088904275416947
train 4, step: 1500, loss: 2.149600309862869, grad_norm: 0.10353650869538064, ic: 0.02883893165415545
train 4, step: 2000, loss: 1.0826130298952663, grad_norm: 0.4536322972348551, ic: 0.1510031092374979
Epoch 4: 2022-05-13 10:59:04.957509: train loss: 1.6450527915067614
Eval step 0: eval loss: 0.88374687170706
Eval: 2022-05-13 10:59:08.651573: total loss: 1.1122517258528826, mse:4.9144252200210685, ic :0.025586136220453047, sharpe5:2.3756198273599147, sharpe5_real:465.43026065826416, irr5:22.76927947998047, irr5_real:1197.3116455078125, ndcg5:0.8525147679721288, pnl5:1.0052605867385864 
train 5, step: 0, loss: 1.4458325686870805, grad_norm: 1.210469653571642, ic: 0.06575658434842041
train 5, step: 500, loss: 0.8890930708205294, grad_norm: 0.009962620805731102, ic: 0.11614347005181415
train 5, step: 1000, loss: 0.9922209874880269, grad_norm: 0.09886698706806958, ic: -0.03748751611895744
train 5, step: 1500, loss: 1.5361193529862176, grad_norm: 0.12328810769395084, ic: 0.037918744037419044
train 5, step: 2000, loss: 1.12281661243837, grad_norm: 0.02978027139338616, ic: 0.08727284081530878
Epoch 5: 2022-05-13 11:00:45.904329: train loss: 1.6452967580531865
Eval step 0: eval loss: 0.8405165516538791 
Eval: 2022-05-13 11:00:49.573278: total loss: 1.0810377933604578, mse:4.822102827963507, ic :0.026757589783995204, sharpe5:4.739742873609066, sharpe5_real:465.4302909278869, irr5:45.93080520629883, irr5_real:1197.3116455078125, ndcg5:0.8458468183578891, pnl5:1.3374781608581543 
train 6, step: 0, loss: 1.327925443269039, grad_norm: 0.2878666604759219, ic: 0.08509253024102931
train 6, step: 500, loss: 1.0108683704417114, grad_norm: 0.03644778954124918, ic: 0.01471524787393008
train 6, step: 1000, loss: 1.1203470324382128, grad_norm: 0.058627273603936006, ic: 0.1471980176500187
train 6, step: 1500, loss: 1.5775979790805785, grad_norm: 0.39471331084513717, ic: 0.10336719137552937
train 6, step: 2000, loss: 0.8117660143739991, grad_norm: 0.0446187892017529, ic: 0.06193984275921369
Epoch 6: 2022-05-13 11:02:26.889148: train loss: 1.6448269280507313
Eval step 0: eval loss: 0.8341797646782797
Eval: 2022-05-13 11:02:30.554202: total loss: 1.0778598425253654, mse:4.817606879003583, ic :0.03218237852335359, sharpe5:3.727813775539398, sharpe5_real:465.4302909278869, irr5:37.905094146728516, irr5_real:1197.3116455078125, ndcg5:0.849274339176138, pnl5:1.6057955026626587 
train 7, step: 0, loss: 0.991097354888916, grad_norm: 0.01201897549450104, ic: 0.034647145286257466
train 7, step: 500, loss: 0.650848388671875, grad_norm: 0.00471065169896134, ic: 0.07088835075353384
train 7, step: 1000, loss: 1.0426535798862338, grad_norm: 0.05684882406174964, ic: 0.07659955692440654
train 7, step: 1500, loss: 2.280719851118703, grad_norm: 0.22163446717408813, ic: 0.08790128722296991
train 7, step: 2000, loss: 0.9066341566538773, grad_norm: 0.05276661971831138, ic: -0.012008253049081426
Epoch 7: 2022-05-13 11:04:07.708427: train loss: 1.6442460554420795
Eval step 0: eval loss: 0.8371991076132771
Eval: 2022-05-13 11:04:11.359822: total loss: 1.079177588347379, mse:4.818301139141569, ic :0.027703212536336078, sharpe5:4.404388087391853, sharpe5_real:465.43026065826416, irr5:42.83514404296875, irr5_real:1197.3116455078125, ndcg5:0.8506707541803432, pnl5:1.3865004777908325 
train 8, step: 0, loss: 3.624894913383152, grad_norm: 0.529664039596439, ic: -0.017586069225549915
train 8, step: 500, loss: 2.7700250967657674, grad_norm: 0.48278467717649887, ic: 0.039628638280733486
train 8, step: 1000, loss: 3.0557928555253624, grad_norm: 0.4616845707832277, ic: 0.007977868117228462
train 8, step: 1500, loss: 0.759280730410951, grad_norm: 0.0119095947627995, ic: 0.07092743875789054
train 8, step: 2000, loss: 1.1158148905183778, grad_norm: 0.27266087718203813, ic: 0.15714701331685949
Epoch 8: 2022-05-13 11:05:48.607014: train loss: 1.6435736113800294
Eval step 0: eval loss: 0.8353489513015344
Eval: 2022-05-13 11:05:52.328451: total loss: 1.07813057602681, mse:4.817325200258132, ic :0.03093468719116926, sharpe5:4.073668337166309, sharpe5_real:465.43026065826416, irr5:40.35255432128906, irr5_real:1197.3116455078125, ndcg5:0.857924012526351, pnl5:1.4573312997817993 
train 9, step: 0, loss: 5.312346584679027, grad_norm: 0.9790287514913354, ic: -0.04081134232212222
train 9, step: 500, loss: 1.3018924820040159, grad_norm: 0.41036342672106735, ic: 0.16280191613277534
train 9, step: 1000, loss: 0.9275656012674466, grad_norm: 0.027592431889097217, ic: 0.10088119788476069
train 9, step: 1500, loss: 1.1134380177650958, grad_norm: 0.019971838290528784, ic: 0.12406499505822732
train 9, step: 2000, loss: 1.1074315316778651, grad_norm: 0.14100313829208805, ic: 0.049976429635927376
Epoch 9: 2022-05-13 11:07:29.393643: train loss: 1.6423141623274915
Eval step 0: eval loss: 0.8363563207982085  
Eval: 2022-05-13 11:07:33.122634: total loss: 1.078654903948752, mse:4.813369158000139, ic :0.04395050715407781, sharpe5:10.579991801977156, sharpe5_real:465.4300185012817, irr5:146.08819580078125, irr5_real:1197.3116455078125, ndcg5:0.8543574674062417, pnl5:1.679665446281433 
train 10, step: 0, loss: 7.220069640579446, grad_norm: 0.3711337226657833, ic: 0.048876637230034575
train 10, step: 500, loss: 1.1367561184630102, grad_norm: 0.07438616132988177, ic: -0.026611788158127724
train 10, step: 1000, loss: 2.370406261982362, grad_norm: 0.04513386493449661, ic: 0.013437745287326698
train 10, step: 1500, loss: 1.1110262189592635, grad_norm: 0.0007916728863497963, ic: 0.012915259367485714
train 10, step: 2000, loss: 2.8953293449610564, grad_norm: 0.4429976250667659, ic: 0.43260371998884306
Epoch 10: 2022-05-13 11:09:10.344282: train loss: 1.6410536197796146
Eval step 0: eval loss: 0.8346725479945996  
Eval: 2022-05-13 11:09:14.040958: total loss: 1.07715842337462, mse:4.729608341098006, ic :0.1180223545852385, sharpe5:10.625829470157623, sharpe5_real:465.4302909278869, irr5:188.0212860107422, irr5_real:1197.3116455078125, ndcg5:0.8412580864442158, pnl5:1.3656660318374634 
train 11, step: 0, loss: 1.2872281410116977, grad_norm: 0.07012404485775883, ic: 0.13560462482138863
train 11, step: 500, loss: 0.7000596035196912, grad_norm: 0.004867091285752386, ic: 0.4680117304793229
train 11, step: 1000, loss: 0.9386330499987119, grad_norm: 0.0013292441970148689, ic: 0.04706181872851842
train 11, step: 1500, loss: 1.05364541840135, grad_norm: 0.007155700270628614, ic: 0.16821759936969216
train 11, step: 2000, loss: 0.8011904651708136, grad_norm: 0.0023934643963115882, ic: -0.0218563619044821
Epoch 11: 2022-05-13 11:10:51.214638: train loss: 1.6371907769467937
Eval step 0: eval loss: 0.8332731771519362
Eval: 2022-05-13 11:10:54.914204: total loss: 1.0758891175292273, mse:4.721901327976984, ic :0.12395753339074855, sharpe5:10.908851389288902, sharpe5_real:465.4300185012817, irr5:198.74530029296875, irr5_real:1197.3116455078125, ndcg5:0.852199704512415, pnl5:1.6575570106506348 
train 12, step: 0, loss: 0.9992685317993164, grad_norm: 0.030619454163437063, ic: 0.2785239275395049
train 12, step: 500, loss: 0.9254016423205877, grad_norm: 0.0004434105169125582, ic: 0.03454715943557672
train 12, step: 1000, loss: 2.869424224659136, grad_norm: 0.9316433102806204, ic: 0.30615761090468374
train 12, step: 1500, loss: 0.9488003825923458, grad_norm: 0.007211586977254152, ic: -0.0203481149232696
train 12, step: 2000, loss: 0.8768191611298621, grad_norm: 0.002300255417613595, ic: 0.037711814000679106
Epoch 12: 2022-05-13 11:12:31.944426: train loss: 1.6350102764126067
Eval step 0: eval loss: 0.8327987879922945
Eval: 2022-05-13 11:12:35.605176: total loss: 1.0761031165484118, mse:4.728470392958152, ic :0.1240082235814547, sharpe5:11.118613253831862, sharpe5_real:465.4300185012817, irr5:201.7809295654297, irr5_real:1197.3116455078125, ndcg5:0.8522427696043913, pnl5:2.0098342895507812 
train 13, step: 0, loss: 2.09838892967925, grad_norm: 0.6101277360973284, ic: 0.3824277669331791
train 13, step: 500, loss: 0.8664022864618861, grad_norm: 0.007467306174152583, ic: 0.45852146082320355
train 13, step: 1000, loss: 0.996664285339765, grad_norm: 0.13317672056310165, ic: 0.43283619671199614
train 13, step: 1500, loss: 2.4269085660006833, grad_norm: 0.5344282817258592, ic: 0.008052381144642951
train 13, step: 2000, loss: 1.5344446900259814, grad_norm: 0.21978242946213017, ic: 0.07105109890541934
Epoch 13: 2022-05-13 11:14:12.903354: train loss: 1.6349392986159046
Eval step 0: eval loss: 0.8346290708969968
Eval: 2022-05-13 11:14:16.569322: total loss: 1.075217673403598, mse:4.723901203433845, ic :0.1258315565519904, sharpe5:11.55520242869854, sharpe5_real:465.43026065826416, irr5:208.24114990234375, irr5_real:1197.3116455078125, ndcg5:0.849799934653123, pnl5:2.138265609741211 
train 14, step: 0, loss: 4.373065918730499, grad_norm: 2.105874177232641, ic: 0.09587701510104402
train 14, step: 500, loss: 0.8298828871607415, grad_norm: 0.0006018050069900625, ic: 0.012553886558922738
train 14, step: 1000, loss: 1.8521931502705011, grad_norm: 0.10503467219074661, ic: 0.337424867931637
train 14, step: 1500, loss: 1.1190934832466641, grad_norm: 0.018087411420367773, ic: -0.04523781199811906
train 14, step: 2000, loss: 1.1440945158425173, grad_norm: 0.11769857981348171, ic: 0.12377648237236917
Epoch 14: 2022-05-13 11:15:53.652899: train loss: 1.6335360837799875
Eval step 0: eval loss: 0.8376255176089963
Eval: 2022-05-13 11:15:57.367451: total loss: 1.0781349704597651, mse:4.717160596822994, ic :0.12680027688017323, sharpe5:11.99231280863285, sharpe5_real:465.43026065826416, irr5:218.1792755126953, irr5_real:1197.3116455078125, ndcg5:0.8304451373591383, pnl5:2.2327873706817627 
train 15, step: 0, loss: 3.595882098127432, grad_norm: 2.95149659952877, ic: 0.05669595858958153
train 15, step: 500, loss: 1.2562103652002805, grad_norm: 0.0001402020516530152, ic: 0.03218683802587014
train 15, step: 1000, loss: 1.3076615496379573, grad_norm: 0.033103334937114925, ic: 0.011685814498173838
train 15, step: 1500, loss: 0.8836418091781496, grad_norm: 0.1581334353418322, ic: 0.014800292949924104
train 15, step: 2000, loss: 1.5069002160703502, grad_norm: 0.1908603189735486, ic: 0.023013604115638842
Epoch 15: 2022-05-13 11:17:34.664674: train loss: 1.6337139602946271
Eval step 0: eval loss: 0.8470506577647523
Eval: 2022-05-13 11:17:38.318910: total loss: 1.083105443340653, mse:4.716517550415068, ic :0.12687904683844872, sharpe5:11.90090138554573, sharpe5_real:465.43026065826416, irr5:216.0171661376953, irr5_real:1197.3116455078125, ndcg5:0.8539430904115708, pnl5:2.489121198654175 
train 16, step: 0, loss: 0.7060018193599069, grad_norm: 0.3332991185352825, ic: 0.01927691529127521
train 16, step: 500, loss: 1.6316935113651403, grad_norm: 0.48283148815163646, ic: 0.12895106022844768
train 16, step: 1000, loss: 0.8828809333570076, grad_norm: 0.00372488447007892, ic: -0.12343438265068568
train 16, step: 1500, loss: 0.8747032412024724, grad_norm: 0.0025682951764099586, ic: 0.07780357759740278
train 16, step: 2000, loss: 3.350635531714492, grad_norm: 0.02583497044804098, ic: 0.04402648464396284
Epoch 16: 2022-05-13 11:19:15.532447: train loss: 1.6333882028552147
Eval step 0: eval loss: 0.8348837592202317
Eval: 2022-05-13 11:19:19.233915: total loss: 1.0753554007960375, mse:4.697018673717449, ic :0.13227608002690355, sharpe5:12.230111911296843, sharpe5_real:465.4300185012817, irr5:218.44590759277344, irr5_real:1197.3116455078125, ndcg5:0.8463032043898281, pnl5:2.60081148147583 
train 17, step: 0, loss: 1.2731178506299734, grad_norm: 0.09012478394532815, ic: -0.055912924667286666
train 17, step: 500, loss: 1.8047684832317072, grad_norm: 0.3650323839651253, ic: 0.1346007226699139
train 17, step: 1000, loss: 1.2774088627965934, grad_norm: 0.0351991293768073, ic: 0.09344751324398085
train 17, step: 1500, loss: 4.624367135837619, grad_norm: 0.08049073606599359, ic: 0.1620555521348015
train 17, step: 2000, loss: 1.2752239800865155, grad_norm: 0.027625208669946298, ic: -0.03216980268926645
Epoch 17: 2022-05-13 11:20:56.472152: train loss: 1.632310688726823
Eval step 0: eval loss: 0.8425218363079556
Eval: 2022-05-13 11:21:00.141526: total loss: 1.0804582185407252, mse:4.7023498283020775, ic :0.12865628623120298, sharpe5:12.192452716827392, sharpe5_real:465.43026065826416, irr5:219.7763671875, irr5_real:1197.3116455078125, ndcg5:0.8426507305945025, pnl5:2.3513312339782715 
train 18, step: 0, loss: 1.3894945770431746, grad_norm: 0.23037270392356513, ic: 0.021491858138910695
train 18, step: 500, loss: 1.468177481367282, grad_norm: 0.7880559094603025, ic: -0.08033811220931342
train 18, step: 1000, loss: 0.6969757330907533, grad_norm: 0.18504952457701063, ic: 0.5229256259429521
train 18, step: 1500, loss: 1.4380548650568183, grad_norm: 0.015009874547603367, ic: 0.03618198541581594
train 18, step: 2000, loss: 0.9088166838238954, grad_norm: 0.00016943565370420167, ic: -0.027747973097990722
Epoch 18: 2022-05-13 11:22:37.408250: train loss: 1.6343167173073812
Eval step 0: eval loss: 0.831210716255598
Eval: 2022-05-13 11:22:41.089863: total loss: 1.0742357427164206, mse:4.671240322017682, ic :0.13669869001654686, sharpe5:12.77810370326042, sharpe5_real:465.4301093101501, irr5:221.66958618164062, irr5_real:1197.3116455078125, ndcg5:0.8268711188971917, pnl5:1.8147186040878296 
train 19, step: 0, loss: 1.473752945188492, grad_norm: 0.033806977548112696, ic: 0.05133212732957838
train 19, step: 500, loss: 0.8684147022388599, grad_norm: 0.002371873732343971, ic: 0.2495180773956368
train 19, step: 1000, loss: 0.9693380137148824, grad_norm: 0.0008047333809912207, ic: 0.06543631941475177
train 19, step: 1500, loss: 3.9755234869114546, grad_norm: 0.15069550456347658, ic: 0.03762097986364582
train 19, step: 2000, loss: 1.010207237830529, grad_norm: 0.021255669126556347, ic: 0.05663378429794427
Epoch 19: 2022-05-13 11:24:18.179783: train loss: 1.6318475350915023
Eval step 0: eval loss: 0.8414598631783455
Eval: 2022-05-13 11:24:21.829592: total loss: 1.0766238185704948, mse:4.637542762174439, ic :0.13778727461655052, sharpe5:12.289510370492934, sharpe5_real:465.43026065826416, irr5:222.18585205078125, irr5_real:1197.3116455078125, ndcg5:0.8535748292693638, pnl5:2.538205862045288 
train 20, step: 0, loss: 2.2664083729619566, grad_norm: 0.30148747930911657, ic: 0.038516397728161345
train 20, step: 500, loss: 3.2319850852272727, grad_norm: 0.3649282134797641, ic: 0.06416377758738323
train 20, step: 1000, loss: 0.9925420761108399, grad_norm: 0.006598153900416546, ic: -0.044792511585380605
train 20, step: 1500, loss: 1.648864465687213, grad_norm: 0.5037193326733838, ic: 0.18697665567762484
train 20, step: 2000, loss: 1.0704655359464212, grad_norm: 0.07481139980923793, ic: -0.03228604234759462
Epoch 20: 2022-05-13 11:25:58.975199: train loss: 1.6299345313842237
Eval step 0: eval loss: 0.8368969546479846 
Eval: 2022-05-13 11:26:02.653585: total loss: 1.0735021697781555, mse:4.6276423454428475, ic :0.1377002702241598, sharpe5:11.223785058259963, sharpe5_real:465.43026065826416, irr5:204.26852416992188, irr5_real:1197.3116455078125, ndcg5:0.8600780008292612, pnl5:2.4741814136505127 
train 21, step: 0, loss: 1.0513697201563692, grad_norm: 0.045427241323920106, ic: 0.0025043901588886874
train 21, step: 500, loss: 0.7845583890391662, grad_norm: 0.0007636721405250038, ic: 0.13144864147795043
train 21, step: 1000, loss: 0.9397247716000205, grad_norm: 0.19096276621627672, ic: 0.18597182649210503
train 21, step: 1500, loss: 1.0193902847147227, grad_norm: 0.03257781569853119, ic: 0.1491837182729266
train 21, step: 2000, loss: 0.9305759907296858, grad_norm: 0.027842381233991645, ic: 0.11307861178205375
Epoch 21: 2022-05-13 11:27:39.807682: train loss: 1.6286901711132098
Eval step 0: eval loss: 0.8372172445090226  
Eval: 2022-05-13 11:27:43.458883: total loss: 1.0739441298255235, mse:4.624710413980729, ic :0.1409448594979699, sharpe5:13.064393795728682, sharpe5_real:465.4300185012817, irr5:230.27113342285156, irr5_real:1197.3116455078125, ndcg5:0.8511882816430373, pnl5:2.9504525661468506 
train 22, step: 0, loss: 1.0648977850790078, grad_norm: 0.0023649481353896157, ic: 0.10408217691654698
train 22, step: 500, loss: 3.250220719004065, grad_norm: 0.646055587421005, ic: -0.021892263469704756
train 22, step: 1000, loss: 1.2241050058706648, grad_norm: 0.0192580639689434, ic: 0.42069388993443624
train 22, step: 1500, loss: 0.9830176585005144, grad_norm: 0.0032953990408716547, ic: -0.024159409837951798
train 22, step: 2000, loss: 1.7958093067956349, grad_norm: 0.42246341893794975, ic: 0.11761467270222574
Epoch 22: 2022-05-13 11:29:20.540481: train loss: 1.6277355770797628
Eval step 0: eval loss: 0.8403684336719572
Eval: 2022-05-13 11:29:24.189942: total loss: 1.0754058183705304, mse:4.628754806845287, ic :0.14117815181064688, sharpe5:12.742155688405036, sharpe5_real:465.4300185012817, irr5:235.3022003173828, irr5_real:1197.3116455078125, ndcg5:0.8392572552087724, pnl5:2.708157539367676 
train 23, step: 0, loss: 1.0275837395307998, grad_norm: 0.12397176894257966, ic: 0.13621215317226804
train 23, step: 500, loss: 1.4499382366378042, grad_norm: 0.04939724743518555, ic: -0.01414038175236293
train 23, step: 1000, loss: 1.6706556193033855, grad_norm: 0.008739512624264863, ic: 0.2537761865525648
train 23, step: 1500, loss: 1.1297849126714792, grad_norm: 0.14137656973897095, ic: 0.0046298101391142234
train 23, step: 2000, loss: 1.5999544421189376, grad_norm: 0.9897569595619716, ic: 0.40180449784099853
Epoch 23: 2022-05-13 11:31:01.561795: train loss: 1.6267037866529366
Eval step 0: eval loss: 0.8408204411304662
Eval: 2022-05-13 11:31:05.269072: total loss: 1.0790513178825833, mse:4.639835744790694, ic :0.14037066785855243, sharpe5:13.808162886500359, sharpe5_real:465.43026065826416, irr5:255.09683227539062, irr5_real:1197.3116455078125, ndcg5:0.8431331334341158, pnl5:2.5948965549468994 
train 24, step: 0, loss: 2.209885535747751, grad_norm: 0.16863640382962425, ic: 0.13569805600588322
train 24, step: 500, loss: 1.218567607003891, grad_norm: 0.07049755135190114, ic: 0.1031503622710313
train 24, step: 1000, loss: 0.9271316888926402, grad_norm: 0.00914666889897326, ic: 0.5083337018499134
train 24, step: 1500, loss: 2.6105109684150865, grad_norm: 0.2528450820310879, ic: -0.042959043298521446
train 24, step: 2000, loss: 0.9306148165304094, grad_norm: 0.0009972510261438017, ic: 0.11426386223503149
Epoch 24: 2022-05-13 11:32:42.309498: train loss: 1.6267238126402124
Eval step 0: eval loss: 0.8469008675867689
Eval: 2022-05-13 11:32:46.020357: total loss: 1.0764517738639154, mse:4.640973204867434, ic :0.13722962528543348, sharpe5:12.178525852560997, sharpe5_real:465.43026065826416, irr5:224.24600219726562, irr5_real:1197.3116455078125, ndcg5:0.8462626699250515, pnl5:2.610128402709961 
train 25, step: 0, loss: 0.8824268237964528, grad_norm: 0.010373774740578798, ic: 0.5577535436752802
train 25, step: 500, loss: 0.8773918036607817, grad_norm: 5.9531714742732484e-05, ic: 0.03789747662051611
train 25, step: 1000, loss: 2.1814844345011424, grad_norm: 0.46593400624423487, ic: 0.22175559754453122
train 25, step: 1500, loss: 1.1804397438472598, grad_norm: 0.06140788394115662, ic: 0.5068464452445439
train 25, step: 2000, loss: 1.0404173872853053, grad_norm: 0.04117274498109398, ic: 0.5549002909134834
Epoch 25: 2022-05-13 11:34:23.284882: train loss: 1.6262537372347388
Eval step 0: eval loss: 0.8385085657600104
Eval: 2022-05-13 11:34:26.944730: total loss: 1.0786197557372597, mse:4.640272803451421, ic :0.13757468219437158, sharpe5:12.023197283148765, sharpe5_real:465.4300185012817, irr5:225.04212951660156, irr5_real:1197.3116455078125, ndcg5:0.8633410836628113, pnl5:2.160886764526367 
train 26, step: 0, loss: 6.784728808905751, grad_norm: 0.720489515296408, ic: 0.13336779806972865
train 26, step: 500, loss: 4.070070459098905, grad_norm: 1.5175456843696533, ic: 0.3285792802843608
train 26, step: 1000, loss: 1.321863578664639, grad_norm: 0.07770853053511001, ic: 0.004138850782391883
train 26, step: 1500, loss: 0.8578846477031363, grad_norm: 0.016708181103922366, ic: 0.19288130533052575
train 26, step: 2000, loss: 0.9691785426706334, grad_norm: 0.016877139015030452, ic: 0.0412082198565427
Epoch 26: 2022-05-13 11:36:04.170518: train loss: 1.625238566777712
Eval step 0: eval loss: 0.8354205341560195
Eval: 2022-05-13 11:36:07.946866: total loss: 1.0727426263678792, mse:4.6165191947896735, ic :0.15209789391509065, sharpe5:16.83741336107254, sharpe5_real:465.43026065826416, irr5:321.8876647949219, irr5_real:1197.3116455078125, ndcg5:0.8448893300229431, pnl5:5.341933727264404 
train 27, step: 0, loss: 0.8311624923406863, grad_norm: 0.0007022245679722863, ic: 0.03765910077200488
train 27, step: 500, loss: 0.9157751984818712, grad_norm: 0.17211878137073044, ic: 0.2825443985835332
train 27, step: 1000, loss: 0.768076791195379, grad_norm: 0.016717395631406232, ic: 0.03717672740923363
train 27, step: 1500, loss: 0.6232651802868268, grad_norm: 0.003127270658210909, ic: 0.5494188669197904
train 27, step: 2000, loss: 1.3807811461892558, grad_norm: 0.003914926526336401, ic: 0.057789860245187646
Epoch 27: 2022-05-13 11:37:45.103934: train loss: 1.624630251892737
Eval step 0: eval loss: 0.8432693079475104
Eval: 2022-05-13 11:37:48.752828: total loss: 1.0791526689394615, mse:4.638378522479048, ic :0.14373408973474572, sharpe5:14.941364863514899, sharpe5_real:465.43026065826416, irr5:293.3314208984375, irr5_real:1197.3116455078125, ndcg5:0.8393789153509664, pnl5:3.056063175201416 
train 28, step: 0, loss: 1.5565117677666507, grad_norm: 0.1353291825612767, ic: 0.11997373841176298
train 28, step: 500, loss: 1.3725442646468, grad_norm: 0.2383294909775768, ic: 0.143296400577207
train 28, step: 1000, loss: 0.9164212027862466, grad_norm: 0.024584830133242017, ic: 0.5715695071732864
train 28, step: 1500, loss: 1.0422725603389666, grad_norm: 0.1066791570423962, ic: 0.0029509828024914843
train 28, step: 2000, loss: 1.0539142632045628, grad_norm: 0.0453545188881548, ic: -0.03220327069888923
Epoch 28: 2022-05-13 11:39:26.048835: train loss: 1.623118244170938
Eval step 0: eval loss: 0.8325087262908324
Eval: 2022-05-13 11:39:29.753724: total loss: 1.0709199236012101, mse:4.608581723276783, ic :0.15893686314231573, sharpe5:16.259889768362044, sharpe5_real:465.4302909278869, irr5:309.52667236328125, irr5_real:1197.3116455078125, ndcg5:0.8367528627536832, pnl5:3.5218029022216797 
train 29, step: 0, loss: 0.9126713241565579, grad_norm: 0.0007897775085092669, ic: 0.008719066406546723
train 29, step: 500, loss: 1.129383420916214, grad_norm: 0.09739375277773346, ic: 0.6084914841319667
train 29, step: 1000, loss: 1.0567339343102455, grad_norm: 0.03932672025996693, ic: 0.05680695141904594
train 29, step: 1500, loss: 2.3322538544106166, grad_norm: 0.1311024317573803, ic: 0.013893203925821981
train 29, step: 2000, loss: 4.622053735050154, grad_norm: 0.830394647233649, ic: 0.2253090126091192
Epoch 29: 2022-05-13 11:41:06.949622: train loss: 1.6222908302425814
Eval step 0: eval loss: 0.8339479725780427
Eval: 2022-05-13 11:41:10.630593: total loss: 1.0723047218207518, mse:4.610347285023026, ic :0.1601801608774951, sharpe5:16.897158029079435, sharpe5_real:465.4302909278869, irr5:328.6904296875, irr5_real:1197.3116455078125, ndcg5:0.8465192368777661, pnl5:3.5558831691741943 
train 30, step: 0, loss: 0.9981127761103264, grad_norm: 0.011504522235586564, ic: 0.5347020134380924
train 30, step: 500, loss: 1.4421582992591264, grad_norm: 0.11560272753545006, ic: 0.004806583617487379
train 30, step: 1000, loss: 0.9702631170099432, grad_norm: 0.013259081529277605, ic: 0.010943949973033575
train 30, step: 1500, loss: 1.5460541801268746, grad_norm: 0.45657640387970966, ic: 0.10319728719923014
train 30, step: 2000, loss: 1.8328792977716144, grad_norm: 0.11445790379086418, ic: 0.1160849732659618
Epoch 30: 2022-05-13 11:42:47.913006: train loss: 1.6210925772944005
Eval step 0: eval loss: 0.838904426019988
Eval: 2022-05-13 11:42:51.560713: total loss: 1.0737773409865023, mse:4.614154173163508, ic :0.15998408437130748, sharpe5:17.317232286930082, sharpe5_real:465.43026065826416, irr5:336.9555969238281, irr5_real:1197.3116455078125, ndcg5:0.8491926451818276, pnl5:3.23107647895813 
train 31, step: 0, loss: 1.0498918213056594, grad_norm: 0.014140354287994327, ic: 0.3300009404527708
train 31, step: 500, loss: 1.5174573607896091, grad_norm: 0.052581421899341174, ic: 0.033615747107833306
train 31, step: 1000, loss: 4.753850980069282, grad_norm: 4.8180550972720955, ic: 0.40867491733317407
train 31, step: 1500, loss: 0.7768731047405543, grad_norm: 0.007282136270223454, ic: 0.6968924604422256
train 31, step: 2000, loss: 1.2483887831853153, grad_norm: 0.5879402136530845, ic: 0.1506905791431174
Epoch 31: 2022-05-13 11:44:28.734154: train loss: 1.6189676755875233
Eval step 0: eval loss: 0.8382239065381322
Eval: 2022-05-13 11:44:32.426424: total loss: 1.075883212954272, mse:4.625216979335213, ic :0.14650392850887156, sharpe5:16.294739563465118, sharpe5_real:465.43026065826416, irr5:318.8656005859375, irr5_real:1197.3116455078125, ndcg5:0.8337452092545365, pnl5:3.811318874359131 
train 32, step: 0, loss: 1.1753359740354639, grad_norm: 0.07720450441737264, ic: 0.049568753491401885
train 32, step: 500, loss: 1.4596464382381888, grad_norm: 0.10424662564498108, ic: 0.059794795344871574
train 32, step: 1000, loss: 1.0219951389157138, grad_norm: 0.02223303903694031, ic: 0.5297119184399249
train 32, step: 1500, loss: 1.007312114142353, grad_norm: 0.2715417951631275, ic: 0.01580811567182594
train 32, step: 2000, loss: 0.978665407758521, grad_norm: 0.0021872846508580804, ic: 0.519566723776404
Epoch 32: 2022-05-13 11:46:09.511252: train loss: 1.620540224472089
Eval step 0: eval loss: 0.8287743265937829
Eval: 2022-05-13 11:46:13.193808: total loss: 1.0715153694524904, mse:4.605960912494809, ic :0.16466840475465494, sharpe5:18.163586075305936, sharpe5_real:465.43026065826416, irr5:348.363525390625, irr5_real:1197.3116455078125, ndcg5:0.8575260507680779, pnl5:3.453386068344116 
train 33, step: 0, loss: 1.2873392784827213, grad_norm: 0.15227218586904903, ic: 0.22580923218613874
train 33, step: 500, loss: 1.011700938365403, grad_norm: 0.02256082302846678, ic: 0.047133235339754276
train 33, step: 1000, loss: 1.012212264703912, grad_norm: 0.20921718817527152, ic: 0.16824774156479555
train 33, step: 1500, loss: 0.8953601117660143, grad_norm: 0.007616245429475833, ic: 0.556855262212415
train 33, step: 2000, loss: 0.8236996126250495, grad_norm: 0.007336327874277786, ic: 0.21404809025235771
Epoch 33: 2022-05-13 11:47:50.604837: train loss: 1.6192905983739538
Eval step 0: eval loss: 0.8287299490829162
Eval: 2022-05-13 11:47:54.371179: total loss: 1.071682210653755, mse:4.6037536191507815, ic :0.16617669879412927, sharpe5:18.8481354868412, sharpe5_real:465.43026065826416, irr5:359.85333251953125, irr5_real:1197.3116455078125, ndcg5:0.8473320402117624, pnl5:4.032690048217773 
train 34, step: 0, loss: 1.0194025721341515, grad_norm: 0.05845547439034003, ic: 0.6004796685233726
train 34, step: 500, loss: 0.8057844529458142, grad_norm: 0.09718808927726488, ic: 0.10995481339374727
train 34, step: 1000, loss: 3.2474108342933947, grad_norm: 1.3890938456121715, ic: 0.3130376424381731
train 34, step: 1500, loss: 0.8086846116330825, grad_norm: 0.06719938002769768, ic: 0.6868605664652117
train 34, step: 2000, loss: 7.1649013906371035, grad_norm: 6.479176044134408, ic: 0.4373113950154819
Epoch 34: 2022-05-13 11:49:31.586024: train loss: 1.6183091664426044
Eval step 0: eval loss: 0.8266081895416227
Eval: 2022-05-13 11:49:35.256694: total loss: 1.0695375407255647, mse:4.596448783660584, ic :0.17068598872467783, sharpe5:18.345975687503813, sharpe5_real:465.43026065826416, irr5:359.5063781738281, irr5_real:1197.3116455078125, ndcg5:0.8357068456573381, pnl5:4.257429599761963 
train 35, step: 0, loss: 1.249414924172794, grad_norm: 0.012340467603764393, ic: 0.5474130414004504
train 35, step: 500, loss: 1.1977650852156583, grad_norm: 0.00494039880369931, ic: -0.04218063468032336
train 35, step: 1000, loss: 1.7925771401439756, grad_norm: 0.6415153613446393, ic: 0.025936305265209618
train 35, step: 1500, loss: 1.64735116600094, grad_norm: 0.41552795167336126, ic: 0.0028395566776715647
train 35, step: 2000, loss: 0.7668092289072944, grad_norm: 0.010238840315036368, ic: 0.5928578850754515
Epoch 35: 2022-05-13 11:51:12.561042: train loss: 1.618780321708899
Eval step 0: eval loss: 0.8349012529636459 
Eval: 2022-05-13 11:51:16.434706: total loss: 1.0731211193172583, mse:4.605463410236757, ic :0.16674568851110524, sharpe5:18.749089497327805, sharpe5_real:465.43026065826416, irr5:365.09954833984375, irr5_real:1197.3116455078125, ndcg5:0.8449549319578484, pnl5:3.8294668197631836 
train 36, step: 0, loss: 1.8243498270702512, grad_norm: 0.6358147613619767, ic: 0.06682159861622701
train 36, step: 500, loss: 0.8507462930641746, grad_norm: 0.16711740557238602, ic: 0.1527952727167852
train 36, step: 1000, loss: 1.766504971590909, grad_norm: 1.30052860714919, ic: 0.1927100411034301
train 36, step: 1500, loss: 0.7891418972597871, grad_norm: 0.015072556202297796, ic: 0.30836744007475125
train 36, step: 2000, loss: 1.080275725712371, grad_norm: 0.269811842178973, ic: 0.7755143515609629
Epoch 36: 2022-05-13 11:52:53.706252: train loss: 1.617517301117233
Eval step 0: eval loss: 0.8288737579442176
Eval: 2022-05-13 11:52:57.390515: total loss: 1.070375051199435, mse:4.596372931110523, ic :0.17263703798147656, sharpe5:20.156233452558517, sharpe5_real:465.43026065826416, irr5:393.1330261230469, irr5_real:1197.3116455078125, ndcg5:0.8428114482487439, pnl5:4.203339576721191 
train 37, step: 0, loss: 2.042522342792879, grad_norm: 0.6036734024097207, ic: 0.13336236265734686
train 37, step: 500, loss: 2.2978384195299757, grad_norm: 0.3415508605775677, ic: -2.6019581786725088e-05
train 37, step: 1000, loss: 1.0724778081002664, grad_norm: 0.05218292416352613, ic: 0.07540198019094907
train 37, step: 1500, loss: 2.055438701923077, grad_norm: 0.5848176457007241, ic: 0.6116100703801567
train 37, step: 2000, loss: 1.3283377105611505, grad_norm: 0.019127787581111586, ic: 0.06904779030629622
Epoch 37: 2022-05-13 11:54:34.602741: train loss: 1.6158554858041867
Eval step 0: eval loss: 0.8276862414795179
Eval: 2022-05-13 11:54:38.292050: total loss: 1.069811881266527, mse:4.594726829804424, ic :0.17294437496955323, sharpe5:19.34922449827194, sharpe5_real:465.43026065826416, irr5:387.8564147949219, irr5_real:1197.3116455078125, ndcg5:0.8587774321733476, pnl5:3.640516996383667 
train 38, step: 0, loss: 1.3542546528141675, grad_norm: 0.0775814241307613, ic: -0.08531298863528258
train 38, step: 500, loss: 0.9310444396219135, grad_norm: 0.00813193646703474, ic: 0.24279615776127839
train 38, step: 1000, loss: 0.922758924160079, grad_norm: 0.0012063329814106926, ic: -0.002473947120923502
train 38, step: 1500, loss: 0.9644483422907176, grad_norm: 0.0025142467165546645, ic: 0.17988870862792977
train 38, step: 2000, loss: 2.304546990063255, grad_norm: 1.284561584442521, ic: -0.03203693902459378
Epoch 38: 2022-05-13 11:56:15.541622: train loss: 1.616357784613501
Eval step 0: eval loss: 0.8277627766069546
Eval: 2022-05-13 11:56:19.239390: total loss: 1.0692023466438545, mse:4.594615168711114, ic :0.17496483684244685, sharpe5:19.741885828971864, sharpe5_real:465.43026065826416, irr5:395.9415283203125, irr5_real:1197.3116455078125, ndcg5:0.84323181131182, pnl5:3.0351004600524902 
train 39, step: 0, loss: 0.9724925563240635, grad_norm: 0.0037270918042704095, ic: 0.11716784712378517
train 39, step: 500, loss: 0.9043066331187548, grad_norm: 0.07812536683832103, ic: 0.2101127227165842
train 39, step: 1000, loss: 0.9573771003903275, grad_norm: 0.012919366975085417, ic: 0.10469130190662747
train 39, step: 1500, loss: 2.149845854793978, grad_norm: 0.41230289032393186, ic: 0.17530066742517644
train 39, step: 2000, loss: 0.6280214330784706, grad_norm: 0.03660039494003724, ic: 0.025123218113588353
Epoch 39: 2022-05-13 11:57:56.382096: train loss: 1.6159327047075183
Eval step 0: eval loss: 0.8338970349133956
Eval: 2022-05-13 11:58:00.016689: total loss: 1.0719347954155243, mse:4.6019448353297605, ic :0.16994336005687735, sharpe5:18.87280901312828, sharpe5_real:465.43026065826416, irr5:374.11309814453125, irr5_real:1197.3116455078125, ndcg5:0.8405984710064097, pnl5:4.828890323638916 
