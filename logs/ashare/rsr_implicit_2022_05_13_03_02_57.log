Namespace(adj_path='./data/graphs/concepts_graph_multihot_1931_1931_824.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='TimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=9, input_graph=False, label_cnt=3, lr=0.001, lstm_layers=1, market=None, mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path=None, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
relation encoding shape: torch.Size([1931, 1931, 824]) torch.float32
relation mask shape: torch.Size([1931, 1931]) torch.float32
10481
ReRaLSTM(
  (rnn1): LSTM(9, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=824, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 4.838890857114934, grad_norm: 7.969782670579446e-05, ic: 0.007738848460723634
train 0, step: 500, loss: 0.8794439297110493, grad_norm: 4.8287911527186985e-06, ic: 0.03162095677307899
train 0, step: 1000, loss: 1.9048312339978055, grad_norm: 4.332143649978197e-05, ic: 0.01828804971192898
train 0, step: 1500, loss: 0.9318893975419961, grad_norm: 3.4996120005729395e-07, ic: 0.00827688558852761
train 0, step: 2000, loss: 0.9832015782487401, grad_norm: 1.1406394421918822e-05, ic: 0.12934617717225372
Epoch 0: 2022-05-13 15:04:50.679903: train loss: 1.646850301048791
Eval step 0: eval loss: 0.8334212308186248
Eval: 2022-05-13 15:04:54.152472: total loss: 1.078701802557209, mse:4.826308360895146, ic :0.020393790742892964, sharpe5:1.6525190951675175, sharpe5_real:465.43026065826416, irr5:15.841721534729004, irr5_real:1197.3116455078125, ndcg5:0.8393254564666185, pnl5:0.9788850545883179 
train 1, step: 0, loss: 2.730032447076613, grad_norm: 7.39353584024462e-05, ic: 0.13818803716916211
train 1, step: 500, loss: 1.7923292828626496, grad_norm: 6.752550763022719e-05, ic: 0.05145732850564509
train 1, step: 1000, loss: 0.8479500610752669, grad_norm: 0.00035390027121700516, ic: -0.00025618916138382165
train 1, step: 1500, loss: 1.683587716639727, grad_norm: 0.05248188402147685, ic: 0.002793845322377239
train 1, step: 2000, loss: 2.1972365234375, grad_norm: 0.0001003997836738006, ic: 0.02512571339339268
Epoch 1: 2022-05-13 15:06:31.325433: train loss: 1.6470439745608647
Eval step 0: eval loss: 0.8335391849562038
Eval: 2022-05-13 15:06:34.791007: total loss: 1.0786594264581149, mse:4.8248328346612634, ic :0.03630309997497577, sharpe5:1.043806085139513, sharpe5_real:465.43026065826416, irr5:12.619242668151855, irr5_real:1197.3116455078125, ndcg5:0.8444863518061603, pnl5:1.025966763496399 
train 2, step: 0, loss: 2.1442428977272727, grad_norm: 3.3599896591510182e-06, ic: 0.15857016366729373
train 2, step: 500, loss: 3.309613486037754, grad_norm: 3.647405013219061e-05, ic: -0.08920181864052991
train 2, step: 1000, loss: 2.073528421336207, grad_norm: 0.00016089584969878733, ic: 0.35817667479750404
train 2, step: 1500, loss: 1.4738211362416507, grad_norm: 0.036416412620918485, ic: -0.04033541260379109
train 2, step: 2000, loss: 3.257248347355769, grad_norm: 0.012210537164125847, ic: 0.10669446519025261
Epoch 2: 2022-05-13 15:08:11.883461: train loss: 1.6468932418085152
Eval step 0: eval loss: 0.8357671932626448
Eval: 2022-05-13 15:08:15.387047: total loss: 1.0790993897052548, mse:4.822771321562214, ic :0.016276326475902925, sharpe5:0.36212956823408604, sharpe5_real:465.43026065826416, irr5:3.839939594268799, irr5_real:1197.3116455078125, ndcg5:0.863141199371656, pnl5:0.9131858348846436 
train 3, step: 0, loss: 1.508128890370935, grad_norm: 0.05426597167713077, ic: 0.07013382740360409
train 3, step: 500, loss: 1.4713809641432556, grad_norm: 0.07421226443838022, ic: 0.14957213859020185
train 3, step: 1000, loss: 3.681613638816926, grad_norm: 0.33854523406817605, ic: -0.009144594475170313
train 3, step: 1500, loss: 1.9492924716780893, grad_norm: 0.006414235618919891, ic: -0.007469523233071697
train 3, step: 2000, loss: 0.896689453125, grad_norm: 0.0011407413293022318, ic: 0.00961998865622273
Epoch 3: 2022-05-13 15:09:52.607131: train loss: 1.6464427783747007
Eval step 0: eval loss: 0.8348846596334957
Eval: 2022-05-13 15:09:56.124081: total loss: 1.0784848979776906, mse:4.820190285359138, ic :0.02223987691695362, sharpe5:1.3734103524684906, sharpe5_real:465.43026065826416, irr5:13.795944213867188, irr5_real:1197.3116455078125, ndcg5:0.8469768033965864, pnl5:1.0002771615982056 
train 4, step: 0, loss: 1.4395454001913266, grad_norm: 0.017739797730852488, ic: 0.06304615030900348
train 4, step: 500, loss: 1.6472398652805118, grad_norm: 0.40043468909014057, ic: -0.003594717121534434
train 4, step: 1000, loss: 2.944739364996189, grad_norm: 0.03131223521332451, ic: 0.06571604505463385
train 4, step: 1500, loss: 2.1507557027953585, grad_norm: 0.022274447931315083, ic: 0.027489085567860394
train 4, step: 2000, loss: 1.104272536875486, grad_norm: 0.10593371691871191, ic: 0.10887113980604012
Epoch 4: 2022-05-13 15:11:33.193676: train loss: 1.6456323451372208
Eval step 0: eval loss: 0.857268161592795
Eval: 2022-05-13 15:11:36.679726: total loss: 1.0937326551216306, mse:4.859888081912384, ic :0.022808162339097965, sharpe5:4.034904774427414, sharpe5_real:465.4302909278869, irr5:42.08110809326172, irr5_real:1197.3116455078125, ndcg5:0.8315231810139966, pnl5:1.2079505920410156 
train 5, step: 0, loss: 1.3714337444945468, grad_norm: 0.1754263536902595, ic: 0.07276126722659561
train 5, step: 500, loss: 0.8922540239641158, grad_norm: 1.841866918766632e-05, ic: 0.009201091379781359
train 5, step: 1000, loss: 0.9973485018558429, grad_norm: 0.06358622335428421, ic: -0.030787812616246045
train 5, step: 1500, loss: 1.505590558599732, grad_norm: 0.004206710653355289, ic: 0.0502944237122536
train 5, step: 2000, loss: 1.1238633441261239, grad_norm: 0.022388608875139698, ic: 0.07662880007944689
Epoch 5: 2022-05-13 15:13:13.943136: train loss: 1.6457001963977789
Eval step 0: eval loss: 0.8413359277240845
Eval: 2022-05-13 15:13:17.436455: total loss: 1.0819779550782962, mse:4.825138560277996, ic :0.024544503081430934, sharpe5:3.181535055041313, sharpe5_real:465.4302909278869, irr5:32.64674377441406, irr5_real:1197.3116455078125, ndcg5:0.8484829858331078, pnl5:1.0961434841156006 
train 6, step: 0, loss: 1.3221934925426135, grad_norm: 0.2306624057941748, ic: 0.1026172263231776
train 6, step: 500, loss: 1.0068734185071306, grad_norm: 0.035742622643932784, ic: 0.011332622875197967
train 6, step: 1000, loss: 1.1150837133139258, grad_norm: 0.043207380019335995, ic: 0.1626160667353989
train 6, step: 1500, loss: 1.6131402133910124, grad_norm: 0.1885835909308622, ic: 0.052525704098766016
train 6, step: 2000, loss: 0.7969970703125, grad_norm: 0.0023963180013582878, ic: 0.029503747564253217
Epoch 6: 2022-05-13 15:14:54.671722: train loss: 1.6445262438613242
Eval step 0: eval loss: 0.8334265689829754
Eval: 2022-05-13 15:14:58.149732: total loss: 1.0787300558864383, mse:4.826227805408373, ic :0.021530535805123666, sharpe5:1.2092795895785093, sharpe5_real:465.43026065826416, irr5:12.226459503173828, irr5_real:1197.3116455078125, ndcg5:0.8454317746541207, pnl5:0.9860541820526123 
train 7, step: 0, loss: 0.9883068084716797, grad_norm: 9.413876516790678e-05, ic: 0.0074526998012417085
train 7, step: 500, loss: 0.6529025741623528, grad_norm: 0.002982437225416067, ic: 0.05619444671569566
train 7, step: 1000, loss: 1.035921025621192, grad_norm: 0.00983572185870441, ic: 0.010979418432932016
train 7, step: 1500, loss: 2.275854309016613, grad_norm: 0.27672235109067944, ic: 0.08850634963381478
train 7, step: 2000, loss: 0.9071997425282715, grad_norm: 0.03684744262506975, ic: 0.0097405156095402
Epoch 7: 2022-05-13 15:16:35.329792: train loss: 1.6439866356593185
Eval step 0: eval loss: 0.8363007524367755
Eval: 2022-05-13 15:16:38.804957: total loss: 1.0785431461734059, mse:4.817937452736729, ic :0.02602610714350783, sharpe5:0.5272870743647218, sharpe5_real:465.43026065826416, irr5:4.8533406257629395, irr5_real:1197.3116455078125, ndcg5:0.8447433664228488, pnl5:1.111868143081665 
train 8, step: 0, loss: 3.6297356204710147, grad_norm: 0.5357373393502007, ic: 0.002099777431167956
train 8, step: 500, loss: 2.7623361512158056, grad_norm: 0.2888800085228602, ic: 0.0535424161889889
train 8, step: 1000, loss: 3.037121051290761, grad_norm: 0.405002685713725, ic: 0.002456826431606357
train 8, step: 1500, loss: 0.7564286350762947, grad_norm: 0.0030827002009406086, ic: 0.10286629099240614
train 8, step: 2000, loss: 1.1221523994843363, grad_norm: 0.19241165140523886, ic: 0.21469064949844244
Epoch 8: 2022-05-13 15:18:16.349585: train loss: 1.643684474495845
Eval step 0: eval loss: 0.8351950449486301
Eval: 2022-05-13 15:18:19.845475: total loss: 1.0783298240496488, mse:4.819285134074744, ic :0.024353050205496305, sharpe5:0.8165042748302221, sharpe5_real:465.43026065826416, irr5:7.605458736419678, irr5_real:1197.3116455078125, ndcg5:0.8469704325518279, pnl5:1.048439383506775 
train 9, step: 0, loss: 5.315609580592105, grad_norm: 0.462520045715215, ic: -0.006560630775517358
train 9, step: 500, loss: 1.3087457746817328, grad_norm: 0.17095590418274192, ic: 0.11116570027557934
train 9, step: 1000, loss: 0.9283085464452483, grad_norm: 0.014293092160564385, ic: 0.09194286658650021
train 9, step: 1500, loss: 1.1107005146009756, grad_norm: 0.012557442342663525, ic: 0.1431386602132359
train 9, step: 2000, loss: 1.1156558023263183, grad_norm: 0.08862196141827361, ic: 0.001202295306292813
Epoch 9: 2022-05-13 15:19:56.975614: train loss: 1.6426556674394457
Eval step 0: eval loss: 0.8363552917544783
Eval: 2022-05-13 15:20:00.435253: total loss: 1.078825032207799, mse:4.819718633556503, ic :0.023821351639346736, sharpe5:1.7071850880235433, sharpe5_real:465.4300185012817, irr5:15.76717758178711, irr5_real:1197.3116455078125, ndcg5:0.8588363469772964, pnl5:0.861825168132782 
train 10, step: 0, loss: 7.239106203307216, grad_norm: 0.32085712384015563, ic: -0.013806847034935317
train 10, step: 500, loss: 1.1331357851133241, grad_norm: 0.041434543349771966, ic: -0.05148324341668478
train 10, step: 1000, loss: 2.3683570908622507, grad_norm: 0.013684968913071362, ic: 0.018143435060382858
train 10, step: 1500, loss: 1.0949633709796065, grad_norm: 0.038683698706784495, ic: 0.00471865726634337
train 10, step: 2000, loss: 2.932073993161094, grad_norm: 0.13635543259720187, ic: 0.2069634271268433
Epoch 10: 2022-05-13 15:21:37.399851: train loss: 1.6428550891505367
Eval step 0: eval loss: 0.8374223457875065
Eval: 2022-05-13 15:21:40.889480: total loss: 1.0793758955192707, mse:4.8209091699266455, ic :0.021704242418282095, sharpe5:2.217773676663637, sharpe5_real:465.43026065826416, irr5:20.0858154296875, irr5_real:1197.3116455078125, ndcg5:0.8521372884783435, pnl5:0.9276268482208252 
train 11, step: 0, loss: 1.2886089611127225, grad_norm: 0.02664525030744305, ic: 0.13483199524587264
train 11, step: 500, loss: 0.712166166073907, grad_norm: 0.00013013743167424963, ic: 0.09997169188253378
train 11, step: 1000, loss: 0.9307727483511954, grad_norm: 0.01682875206289561, ic: 0.01409977191722826
train 11, step: 1500, loss: 1.0656470583196271, grad_norm: 0.012919239441470609, ic: -0.03111727723930714
train 11, step: 2000, loss: 0.7945105385441351, grad_norm: 0.004042921703785936, ic: 0.08239500600295221
Epoch 11: 2022-05-13 15:23:17.868596: train loss: 1.6425659455343509
Eval step 0: eval loss: 0.8368286518703898
Eval: 2022-05-13 15:23:21.319443: total loss: 1.0790443025372196, mse:4.820639216794357, ic :0.020774688656300045, sharpe5:1.0907923436164855, sharpe5_real:465.43026065826416, irr5:10.321157455444336, irr5_real:1197.3116455078125, ndcg5:0.8464830177251832, pnl5:0.8978134393692017 
train 12, step: 0, loss: 1.032599687576294, grad_norm: 0.018973558804843412, ic: 0.0951328460466643
train 12, step: 500, loss: 0.9342886809927826, grad_norm: 0.015330903131625722, ic: 0.0940354378573366
train 12, step: 1000, loss: 2.888230244824841, grad_norm: 0.35504249482963823, ic: 0.2808972551521596
train 12, step: 1500, loss: 0.9449178400787795, grad_norm: 0.00010289631910298835, ic: -0.08375742233445305
train 12, step: 2000, loss: 0.8777810641285876, grad_norm: 9.03638626306955e-05, ic: 0.005381769969902545
Epoch 12: 2022-05-13 15:24:58.376491: train loss: 1.6417171354445663
Eval step 0: eval loss: 0.835719085468256
Eval: 2022-05-13 15:25:01.857812: total loss: 1.078803461727202, mse:4.819413423503036, ic :0.02414777750542685, sharpe5:1.9080457916110753, sharpe5_real:465.4300185012817, irr5:16.55217742919922, irr5_real:1197.3116455078125, ndcg5:0.8400320770764905, pnl5:1.048663854598999 
train 13, step: 0, loss: 2.091198640237262, grad_norm: 0.22142255529973856, ic: 0.08466378491979312
train 13, step: 500, loss: 0.8974051482030184, grad_norm: 6.682133926519743e-05, ic: 0.1747191601096918
train 13, step: 1000, loss: 1.0235645678219378, grad_norm: 0.04403961814806358, ic: 0.10994210331275488
train 13, step: 1500, loss: 2.4047188323331383, grad_norm: 0.17516525584098858, ic: 0.012851752361990916
train 13, step: 2000, loss: 1.5322611443899152, grad_norm: 0.055126036650268356, ic: 0.025072288971148448
Epoch 13: 2022-05-13 15:26:39.458978: train loss: 1.642216045413422
Eval step 0: eval loss: 0.8360913420376712
Eval: 2022-05-13 15:26:42.986210: total loss: 1.079155700959195, mse:4.82242385896874, ic :0.01775896524224226, sharpe5:1.8072846022993325, sharpe5_real:465.4302909278869, irr5:16.46645736694336, irr5_real:1197.3116455078125, ndcg5:0.8462778646358424, pnl5:0.8457234501838684 
train 14, step: 0, loss: 4.407813490273986, grad_norm: 0.6388941498479873, ic: 0.04751335975613251
train 14, step: 500, loss: 0.8283861259437117, grad_norm: 0.0027616588974069614, ic: 0.05726965435925771
train 14, step: 1000, loss: 1.9177728072204823, grad_norm: 0.0413125927918506, ic: 0.33529892476969086
train 14, step: 1500, loss: 1.1143867816056712, grad_norm: 0.005658343347356504, ic: -0.01190749104058256
train 14, step: 2000, loss: 1.1489920560832365, grad_norm: 0.05411407556432021, ic: 0.02942533455245669
Epoch 14: 2022-05-13 15:28:19.968457: train loss: 1.6411155011005543
Eval step 0: eval loss: 0.8415435372966609
Eval: 2022-05-13 15:28:23.487579: total loss: 1.079190384395489, mse:4.707308413695068, ic :0.10290516658301495, sharpe5:6.796926978528499, sharpe5_real:465.43026065826416, irr5:77.99700164794922, irr5_real:1197.3116455078125, ndcg5:0.8565201876718638, pnl5:1.2226933240890503 
train 15, step: 0, loss: 3.4995744163424125, grad_norm: 0.9747583447562567, ic: 0.02439744635564867
train 15, step: 500, loss: 1.256454607296862, grad_norm: 0.00017505617982728822, ic: 0.032923599340334446
train 15, step: 1000, loss: 1.3092494561420223, grad_norm: 0.006731348572588642, ic: -0.03563601208967713
train 15, step: 1500, loss: 0.885709122785433, grad_norm: 0.0706704983858444, ic: 0.0271137239811848
train 15, step: 2000, loss: 1.5074635872710347, grad_norm: 0.061590903943133955, ic: 0.012126455375861354
Epoch 15: 2022-05-13 15:30:00.528036: train loss: 1.6351199277263
Eval step 0: eval loss: 0.8479121603126646
Eval: 2022-05-13 15:30:04.037204: total loss: 1.0804195011159317, mse:4.658372706652136, ic :0.1292859936909615, sharpe5:11.488938440680503, sharpe5_real:465.43026065826416, irr5:184.3199920654297, irr5_real:1197.3116455078125, ndcg5:0.8436099590462177, pnl5:2.0945167541503906 
train 16, step: 0, loss: 0.7158882582083828, grad_norm: 0.0920760669245543, ic: 0.035988361227092217
train 16, step: 500, loss: 1.643383827835495, grad_norm: 0.22916532865479242, ic: 0.124717186783328
train 16, step: 1000, loss: 0.8928144975142045, grad_norm: 0.0014823470082496746, ic: -0.16159669812206373
train 16, step: 1500, loss: 0.8744180256969071, grad_norm: 0.001135907591432339, ic: 0.028650828049504758
train 16, step: 2000, loss: 3.34975291597853, grad_norm: 0.009579170305362397, ic: 0.04121523248453074
Epoch 16: 2022-05-13 15:31:41.225753: train loss: 1.631626053935355
Eval step 0: eval loss: 0.8331934905780756
Eval: 2022-05-13 15:31:44.743832: total loss: 1.072996085672042, mse:4.625343862771996, ic :0.13810788445579017, sharpe5:12.602123683691024, sharpe5_real:465.4300185012817, irr5:216.10589599609375, irr5_real:1197.3116455078125, ndcg5:0.8464747687607959, pnl5:2.2948226928710938 
train 17, step: 0, loss: 1.276022411720822, grad_norm: 0.034450970917589877, ic: -0.056859862188324506
train 17, step: 500, loss: 1.7990414337737128, grad_norm: 0.11886395033702965, ic: 0.13233102680627448
train 17, step: 1000, loss: 1.282852318481575, grad_norm: 0.02495407428079553, ic: 0.08118837768009687
train 17, step: 1500, loss: 4.620884947878398, grad_norm: 0.03733492018488248, ic: 0.16663443637021222
train 17, step: 2000, loss: 1.2773555977152944, grad_norm: 0.008661142363927753, ic: -0.010189683771723032
Epoch 17: 2022-05-13 15:33:21.982418: train loss: 1.6304801323744165
Eval step 0: eval loss: 0.8429552566640871
Eval: 2022-05-13 15:33:25.441863: total loss: 1.0782446691267442, mse:4.639858719225158, ic :0.13566105438612425, sharpe5:12.757664140462875, sharpe5_real:465.4300185012817, irr5:213.205322265625, irr5_real:1197.3116455078125, ndcg5:0.8537434341822959, pnl5:2.486368417739868 
train 18, step: 0, loss: 1.391525304570712, grad_norm: 0.11696299762780968, ic: 0.021756436736165397
train 18, step: 500, loss: 1.534670136261602, grad_norm: 0.1756342966148129, ic: -0.07212294588368733
train 18, step: 1000, loss: 0.6640794226241438, grad_norm: 0.002407761296562554, ic: 0.5605976306142751
train 18, step: 1500, loss: 1.4403970954263925, grad_norm: 0.010967031213204399, ic: 0.04566629711436414
train 18, step: 2000, loss: 0.9087772247897592, grad_norm: 3.248922354530669e-05, ic: 0.007009952660772686
Epoch 18: 2022-05-13 15:35:02.414062: train loss: 1.6299456662767122
Eval step 0: eval loss: 0.8305161117376844
Eval: 2022-05-13 15:35:05.912005: total loss: 1.0718842058543714, mse:4.621176424011305, ic :0.14098295680412043, sharpe5:13.117763870358466, sharpe5_real:465.4300185012817, irr5:217.62149047851562, irr5_real:1197.3116455078125, ndcg5:0.8373303179336588, pnl5:2.1319057941436768 
train 19, step: 0, loss: 1.4699766128782241, grad_norm: 0.020251777313848404, ic: 0.04184807590618208
train 19, step: 500, loss: 0.8691616764775029, grad_norm: 0.000926573454943557, ic: 0.24976548458014763
train 19, step: 1000, loss: 0.9690803406178816, grad_norm: 0.00017299775227390285, ic: 0.08094757818892995
train 19, step: 1500, loss: 3.975558486691848, grad_norm: 0.05027724011697559, ic: -0.047922507430252545
train 19, step: 2000, loss: 1.0085489595853365, grad_norm: 0.0043361002583136585, ic: 0.08744559736366928
Epoch 19: 2022-05-13 15:36:43.045401: train loss: 1.6301480378238875
Eval step 0: eval loss: 0.839221950326001
Eval: 2022-05-13 15:36:46.515903: total loss: 1.0744364451347654, mse:4.630081024031991, ic :0.13880174191128494, sharpe5:11.990556224584578, sharpe5_real:465.43026065826416, irr5:204.60873413085938, irr5_real:1197.3116455078125, ndcg5:0.8321530249788245, pnl5:2.0924272537231445 
train 20, step: 0, loss: 2.2719066514328063, grad_norm: 0.13974434784838635, ic: 0.03781297028163149
train 20, step: 500, loss: 3.2455269886363634, grad_norm: 0.20261976155819184, ic: 0.06519310497335157
train 20, step: 1000, loss: 0.9911563873291016, grad_norm: 0.002164044430634403, ic: 0.012188618065805408
train 20, step: 1500, loss: 1.6642471944391273, grad_norm: 0.22208091611789393, ic: 0.20249946416463596
train 20, step: 2000, loss: 1.0637268763381933, grad_norm: 0.033102095145754296, ic: -0.03385369021559636
Epoch 20: 2022-05-13 15:38:23.714639: train loss: 1.6282737351697623
Eval step 0: eval loss: 0.8309386628194151
Eval: 2022-05-13 15:38:27.161407: total loss: 1.0710818662916934, mse:4.621233472928327, ic :0.14354288437014276, sharpe5:11.171134833097458, sharpe5_real:465.43026065826416, irr5:210.7950439453125, irr5_real:1197.3116455078125, ndcg5:0.8402058927836316, pnl5:2.3083531856536865 
train 21, step: 0, loss: 1.0540746344036043, grad_norm: 0.011099412154578644, ic: -0.00040838176819255664
train 21, step: 500, loss: 0.7850998059838219, grad_norm: 0.0004363782643340828, ic: 0.1277455626675386
train 21, step: 1000, loss: 0.9411414966248629, grad_norm: 0.07081639522550762, ic: 0.18174387573301257
train 21, step: 1500, loss: 1.0212406737929716, grad_norm: 0.020292613102127717, ic: 0.14811152088933735
train 21, step: 2000, loss: 0.9317286967703142, grad_norm: 0.019548052410141636, ic: 0.11252072156434749
Epoch 21: 2022-05-13 15:40:04.289694: train loss: 1.6282204789272479
Eval step 0: eval loss: 0.8371193567241833
Eval: 2022-05-13 15:40:07.808646: total loss: 1.0731379490154969, mse:4.623980455289993, ic :0.14079445993634948, sharpe5:12.74482792854309, sharpe5_real:465.43026065826416, irr5:225.81503295898438, irr5_real:1197.3116455078125, ndcg5:0.8603337071939812, pnl5:2.4409124851226807 
train 22, step: 0, loss: 1.0621300821250441, grad_norm: 0.0037624060202944244, ic: 0.08390788947275084
train 22, step: 500, loss: 3.271753723640752, grad_norm: 0.4399949826756179, ic: 0.012237243015113884
train 22, step: 1000, loss: 1.2271625496748555, grad_norm: 0.01045407474381308, ic: 0.41592305451164174
train 22, step: 1500, loss: 0.9802674093364198, grad_norm: 0.004669124155268384, ic: 0.019258402857121985
train 22, step: 2000, loss: 1.774291161777211, grad_norm: 0.0907075108504867, ic: 0.1603873056463784
Epoch 22: 2022-05-13 15:41:44.873730: train loss: 1.6279359878543862
Eval step 0: eval loss: 0.8404349999382573
Eval: 2022-05-13 15:41:48.413823: total loss: 1.073808891542804, mse:4.623087440824567, ic :0.14187758508997833, sharpe5:11.668355008363724, sharpe5_real:465.43026065826416, irr5:213.38079833984375, irr5_real:1197.3116455078125, ndcg5:0.8387155581063134, pnl5:2.3244128227233887 
train 23, step: 0, loss: 1.0128924542957494, grad_norm: 0.016455409047743605, ic: 0.15439609834670937
train 23, step: 500, loss: 1.4373869364452512, grad_norm: 0.05394968281048219, ic: 0.005646506984766635
train 23, step: 1000, loss: 1.6711409505208334, grad_norm: 0.006659653042371522, ic: 0.2538866287791686
train 23, step: 1500, loss: 1.1250389725633154, grad_norm: 0.07394813864333014, ic: -0.03138831904451323
train 23, step: 2000, loss: 1.6462494436826405, grad_norm: 0.32095836784381937, ic: 0.4199530291821433
Epoch 23: 2022-05-13 15:43:25.640671: train loss: 1.6268965262680568
Eval step 0: eval loss: 0.8540936903154636
Eval: 2022-05-13 15:43:29.159549: total loss: 1.0762928686679225, mse:4.635535447451845, ic :0.13890720859152697, sharpe5:11.589548045396803, sharpe5_real:465.4299882316589, irr5:211.2967529296875, irr5_real:1197.3116455078125, ndcg5:0.8393637676923952, pnl5:2.4325127601623535 
train 24, step: 0, loss: 2.2345781454975637, grad_norm: 0.1816929886308974, ic: 0.10197169077637547
train 24, step: 500, loss: 1.2196351760092414, grad_norm: 0.04666399905114834, ic: 0.1432837099226796
train 24, step: 1000, loss: 0.9297390975797604, grad_norm: 0.0068617882228603315, ic: 0.5061235891812614
train 24, step: 1500, loss: 2.624299781340169, grad_norm: 0.1565069029037154, ic: -0.04549761149520007
train 24, step: 2000, loss: 0.9327254291462918, grad_norm: 0.0025340545547043554, ic: 0.09352591697163357
Epoch 24: 2022-05-13 15:45:06.226637: train loss: 1.6258458665106568
Eval step 0: eval loss: 0.8367202163873155
Eval: 2022-05-13 15:45:09.716407: total loss: 1.0716212425936025, mse:4.622684356765407, ic :0.1417547625251361, sharpe5:11.935719019174575, sharpe5_real:465.43026065826416, irr5:215.55580139160156, irr5_real:1197.3116455078125, ndcg5:0.8537751271533192, pnl5:2.4676260948181152 
train 25, step: 0, loss: 0.8833429284997889, grad_norm: 0.0009535067113861866, ic: 0.5504837135720408
train 25, step: 500, loss: 0.8773390663354419, grad_norm: 4.2208393655604126e-05, ic: 0.010730172803730498
train 25, step: 1000, loss: 2.1914763497834158, grad_norm: 0.13876854172869788, ic: 0.19012465737225984
train 25, step: 1500, loss: 1.1797802503118657, grad_norm: 0.04550899446352229, ic: 0.5061293951555973
train 25, step: 2000, loss: 1.0596199538623352, grad_norm: 0.0925325447536673, ic: 0.5521333687005247
Epoch 25: 2022-05-13 15:46:47.013152: train loss: 1.625971723815468
Eval step 0: eval loss: 0.8599306192990976
Eval: 2022-05-13 15:46:50.501743: total loss: 1.075975872623147, mse:4.635234928773168, ic :0.13538764031459447, sharpe5:12.60885772883892, sharpe5_real:465.43026065826416, irr5:215.52847290039062, irr5_real:1197.3116455078125, ndcg5:0.857529398065673, pnl5:2.9773950576782227 
train 26, step: 0, loss: 6.78549321086262, grad_norm: 1.2475039195136242, ic: 0.04750270195462432
train 26, step: 500, loss: 4.090968056709343, grad_norm: 0.7716783225839962, ic: 0.32547034687330123
train 26, step: 1000, loss: 1.2956221025068682, grad_norm: 0.22203635981318776, ic: 0.029488373903683827
train 26, step: 1500, loss: 0.8698876988430947, grad_norm: 0.0498466704296688, ic: 0.16110317608660257
train 26, step: 2000, loss: 0.961419058258753, grad_norm: 0.032135124141853474, ic: 0.06683551164344498
Epoch 26: 2022-05-13 15:48:27.743701: train loss: 1.6254177164002412
Eval step 0: eval loss: 0.8411254239660167
Eval: 2022-05-13 15:48:31.227714: total loss: 1.0739677425262575, mse:4.624383187165812, ic :0.14465812415376342, sharpe5:12.615811228752136, sharpe5_real:465.43026065826416, irr5:218.43690490722656, irr5_real:1197.3116455078125, ndcg5:0.8570071749506073, pnl5:2.490354537963867 
train 27, step: 0, loss: 0.8288715916053921, grad_norm: 0.00016501442949027722, ic: 0.012211254078654633
train 27, step: 500, loss: 0.8998410197187711, grad_norm: 0.11011916413354174, ic: 0.27654082641114064
train 27, step: 1000, loss: 0.763656675216309, grad_norm: 0.03607521913447223, ic: 0.01222330838098784
train 27, step: 1500, loss: 0.6218959737783937, grad_norm: 0.0029086385396442666, ic: 0.5464653407184724
train 27, step: 2000, loss: 1.3831851991090074, grad_norm: 0.0018931997664660952, ic: 0.005697331083553652
Epoch 27: 2022-05-13 15:50:08.205041: train loss: 1.6254452704310278
Eval step 0: eval loss: 0.8490427577960352
Eval: 2022-05-13 15:50:11.718251: total loss: 1.0779217373449679, mse:4.635524753835663, ic :0.1418323634433647, sharpe5:12.742681623101234, sharpe5_real:465.43026065826416, irr5:215.2390594482422, irr5_real:1197.3116455078125, ndcg5:0.8460464846369278, pnl5:2.598798990249634 
train 28, step: 0, loss: 1.5524184061293436, grad_norm: 0.05813071415495808, ic: 0.12845539787431776
train 28, step: 500, loss: 1.3691051434111237, grad_norm: 0.1409762035404498, ic: 0.1429727707943183
train 28, step: 1000, loss: 0.9166026541857215, grad_norm: 0.05022129379543869, ic: 0.5518632934268216
train 28, step: 1500, loss: 1.0383696300444347, grad_norm: 0.003051395176620516, ic: 0.051570664920023164
train 28, step: 2000, loss: 1.0540662894219708, grad_norm: 0.0292050349115942, ic: -0.01697359402065289
Epoch 28: 2022-05-13 15:51:48.941431: train loss: 1.624298743242119
Eval step 0: eval loss: 0.8365610361852936
Eval: 2022-05-13 15:51:52.423278: total loss: 1.0714879208356654, mse:4.62078128032113, ic :0.14208698141465587, sharpe5:12.238698078989982, sharpe5_real:465.43026065826416, irr5:212.35011291503906, irr5_real:1197.3116455078125, ndcg5:0.8460441932603476, pnl5:2.775326728820801 
train 29, step: 0, loss: 0.9105880772010045, grad_norm: 0.004303064996364906, ic: 0.08178567246745293
train 29, step: 500, loss: 1.1448862072445685, grad_norm: 0.0972818246820954, ic: 0.5834411727652841
train 29, step: 1000, loss: 1.0533955969997122, grad_norm: 0.04766191674540915, ic: 0.031177678552613934
train 29, step: 1500, loss: 2.3128779319745316, grad_norm: 0.011333920140474534, ic: 0.019509240442275276
train 29, step: 2000, loss: 4.61968994140625, grad_norm: 0.17344873417868484, ic: 0.11803783146011829
Epoch 29: 2022-05-13 15:53:29.396535: train loss: 1.623755947005318
Eval step 0: eval loss: 0.8493599605258825
Eval: 2022-05-13 15:53:32.902962: total loss: 1.0755455430031917, mse:4.629532771505097, ic :0.14198448250596254, sharpe5:12.523802926540375, sharpe5_real:465.43026065826416, irr5:216.13223266601562, irr5_real:1197.3116455078125, ndcg5:0.8671195832086628, pnl5:2.482465982437134 
train 30, step: 0, loss: 1.0112180548199152, grad_norm: 0.022495176660275593, ic: 0.5117268843217639
train 30, step: 500, loss: 1.4218419538940732, grad_norm: 0.15651848805222457, ic: 0.0175810780965504
train 30, step: 1000, loss: 0.9709136962890625, grad_norm: 0.01322368475654289, ic: 0.023646039378439624
train 30, step: 1500, loss: 1.5474539022747054, grad_norm: 0.2392797077034057, ic: 0.12313225579592901
train 30, step: 2000, loss: 1.820087038841335, grad_norm: 0.06507965814386951, ic: 0.19805137110105286
Epoch 30: 2022-05-13 15:55:10.118612: train loss: 1.623791952747033
Eval step 0: eval loss: 0.8541354309017716
Eval: 2022-05-13 15:55:13.634568: total loss: 1.076032503190532, mse:4.6319882949423326, ic :0.1403254776625892, sharpe5:11.908892565965651, sharpe5_real:465.43026065826416, irr5:208.0084991455078, irr5_real:1197.3116455078125, ndcg5:0.8419209034283583, pnl5:2.8868067264556885 
train 31, step: 0, loss: 1.0807074800305914, grad_norm: 0.005149558282113458, ic: 0.24831651118412565
train 31, step: 500, loss: 1.5278881936406892, grad_norm: 0.08741012839018947, ic: 0.05232482908510277
train 31, step: 1000, loss: 4.66703297289715, grad_norm: 1.376144486648749, ic: 0.39500906526413815
train 31, step: 1500, loss: 0.7768450659537284, grad_norm: 0.0012824375547765372, ic: 0.6956830649721158
train 31, step: 2000, loss: 1.2357663789418694, grad_norm: 0.18227801131415033, ic: 0.0914471271532976
Epoch 31: 2022-05-13 15:56:50.844142: train loss: 1.622352793714342
Eval step 0: eval loss: 0.8436243280344441
Eval: 2022-05-13 15:56:54.368761: total loss: 1.0754030624740334, mse:4.627603273635906, ic :0.14125013278800627, sharpe5:11.984006634950637, sharpe5_real:465.4301093101501, irr5:213.099365234375, irr5_real:1197.3116455078125, ndcg5:0.8580504103195759, pnl5:2.0193049907684326 
train 32, step: 0, loss: 1.172174800120567, grad_norm: 0.030950015545821892, ic: 0.0351109604620164
train 32, step: 500, loss: 1.4693840927965058, grad_norm: 0.10318104802859951, ic: 0.04878819946779326
train 32, step: 1000, loss: 1.0272963704225895, grad_norm: 0.04100769196050931, ic: 0.5320861195795897
train 32, step: 1500, loss: 1.0020959593702328, grad_norm: 0.16272543326753175, ic: 0.016146847911716247
train 32, step: 2000, loss: 0.9877742176655999, grad_norm: 0.0026384591995022486, ic: 0.5025685497528998
Epoch 32: 2022-05-13 15:58:31.440767: train loss: 1.6240099039895082
Eval step 0: eval loss: 0.8372298502947181
Eval: 2022-05-13 15:58:34.898237: total loss: 1.0730972163142887, mse:4.621489387119628, ic :0.14337459660316854, sharpe5:12.266106276512145, sharpe5_real:465.43026065826416, irr5:215.61724853515625, irr5_real:1197.3116455078125, ndcg5:0.8524157279919148, pnl5:2.152470111846924 
train 33, step: 0, loss: 1.292576964936555, grad_norm: 0.09933959458207027, ic: 0.22566817614528592
train 33, step: 500, loss: 1.0098682050945378, grad_norm: 0.00620939793333526, ic: 0.03491607640772404
train 33, step: 1000, loss: 1.029110367786207, grad_norm: 0.10707970268167219, ic: 0.14704737312493255
train 33, step: 1500, loss: 0.9102391506570656, grad_norm: 0.003933364456826523, ic: 0.5222371310596725
train 33, step: 2000, loss: 0.8225369460987025, grad_norm: 0.0056716524714055675, ic: 0.20761528974656485
Epoch 33: 2022-05-13 16:00:12.231223: train loss: 1.6230892437986841
Eval step 0: eval loss: 0.8372867692760471
Eval: 2022-05-13 16:00:15.709756: total loss: 1.0729061933545099, mse:4.620995228748671, ic :0.14288858017417977, sharpe5:12.70378515779972, sharpe5_real:465.43004877090453, irr5:219.62570190429688, irr5_real:1197.3116455078125, ndcg5:0.8458626736430029, pnl5:2.1626546382904053 
train 34, step: 0, loss: 1.0419677903799445, grad_norm: 0.0749650283935181, ic: 0.5506859351800926
train 34, step: 500, loss: 0.8152027188455657, grad_norm: 0.04831587673283386, ic: 0.08046952031934743
train 34, step: 1000, loss: 3.3694361439132106, grad_norm: 0.495976507679488, ic: 0.23168650755839154
train 34, step: 1500, loss: 0.7987677445712902, grad_norm: 0.06201295238073722, ic: 0.6794587640448909
train 34, step: 2000, loss: 7.076002432707204, grad_norm: 1.6054975818284016, ic: 0.4227894488940542
Epoch 34: 2022-05-13 16:01:52.749689: train loss: 1.6222165104368076
Eval step 0: eval loss: 0.8352726091197971
Eval: 2022-05-13 16:01:56.187039: total loss: 1.0713179041215286, mse:4.615654781146382, ic :0.14474745535783795, sharpe5:12.322736011147498, sharpe5_real:465.43026065826416, irr5:215.70518493652344, irr5_real:1197.3116455078125, ndcg5:0.8488278123169781, pnl5:2.484584093093872 
train 35, step: 0, loss: 1.246171156939338, grad_norm: 0.01966332573767352, ic: 0.5441600682597327
train 35, step: 500, loss: 1.1914539602284342, grad_norm: 0.027738823478413485, ic: -0.024406514658273946
train 35, step: 1000, loss: 1.8384343691945328, grad_norm: 0.27816324328481123, ic: -0.007075858941748042
train 35, step: 1500, loss: 1.6386256167763158, grad_norm: 0.04113664417912939, ic: 0.033601527951942184
train 35, step: 2000, loss: 0.7852244657628676, grad_norm: 0.003375174932823039, ic: 0.5602882871044522
Epoch 35: 2022-05-13 16:03:33.454114: train loss: 1.621259406114909
Eval step 0: eval loss: 0.8410768016497628
Eval: 2022-05-13 16:03:36.976905: total loss: 1.0730941369007443, mse:4.622165092209785, ic :0.14288102406532735, sharpe5:12.443490049839019, sharpe5_real:465.4300185012817, irr5:213.289306640625, irr5_real:1197.3116455078125, ndcg5:0.8479374973454525, pnl5:2.2682995796203613 
train 36, step: 0, loss: 1.820240254304847, grad_norm: 0.27216589789671813, ic: 0.03745490179335202
train 36, step: 500, loss: 0.850513022372439, grad_norm: 0.00033998315358319523, ic: 0.04116002065762232
train 36, step: 1000, loss: 1.7355653409090908, grad_norm: 0.4455625669826389, ic: 0.18484537051438593
train 36, step: 1500, loss: 0.8080632716049382, grad_norm: 0.006884606789361185, ic: 0.20317857653763516
train 36, step: 2000, loss: 1.0773103576126886, grad_norm: 0.10158275427954339, ic: 0.7799194605262755
Epoch 36: 2022-05-13 16:05:14.151029: train loss: 1.6215855979758445
Eval step 0: eval loss: 0.8360397612206928
Eval: 2022-05-13 16:05:17.680541: total loss: 1.0726707028106317, mse:4.621170106854176, ic :0.14398487066208568, sharpe5:12.275452968478202, sharpe5_real:465.43026065826416, irr5:217.46395874023438, irr5_real:1197.3116455078125, ndcg5:0.8438614842581568, pnl5:2.10141921043396 
train 37, step: 0, loss: 2.0388000394812407, grad_norm: 0.3930133390885458, ic: 0.06521392024570366
train 37, step: 500, loss: 2.3098833541496737, grad_norm: 0.2143513156270322, ic: 0.002264126705246743
train 37, step: 1000, loss: 1.0708423074521973, grad_norm: 0.02853963483312713, ic: 0.008790432583988228
train 37, step: 1500, loss: 2.044393925689266, grad_norm: 0.21393182541298678, ic: 0.6091317099097278
train 37, step: 2000, loss: 1.3223015161051703, grad_norm: 0.015670512873066155, ic: 0.07386709270646194
Epoch 37: 2022-05-13 16:06:54.942622: train loss: 1.6205287101534191
Eval step 0: eval loss: 0.8342010530204491
Eval: 2022-05-13 16:06:58.450034: total loss: 1.0717092409793874, mse:4.617642161988505, ic :0.1435028361897574, sharpe5:12.791389229893683, sharpe5_real:465.43026065826416, irr5:218.55198669433594, irr5_real:1197.3116455078125, ndcg5:0.8570197557613827, pnl5:2.410581350326538 
train 38, step: 0, loss: 1.3537482284918065, grad_norm: 0.05788275717701243, ic: -0.08751392075072886
train 38, step: 500, loss: 0.9309140805844908, grad_norm: 0.005754083259571245, ic: 0.2464489986542041
train 38, step: 1000, loss: 0.9159638054286067, grad_norm: 0.018132341986437508, ic: 0.016066543131688735
train 38, step: 1500, loss: 0.9688753143982537, grad_norm: 0.0003118203748247101, ic: 0.06887824838922518
train 38, step: 2000, loss: 2.2870474178625377, grad_norm: 0.40293372798523786, ic: -0.03722153844081223
Epoch 38: 2022-05-13 16:08:35.812191: train loss: 1.619890322031741
Eval step 0: eval loss: 0.8335564214386854
Eval: 2022-05-13 16:08:39.316895: total loss: 1.0721348515972162, mse:4.622985193577273, ic :0.14268751670512866, sharpe5:12.015028268694877, sharpe5_real:465.43026065826416, irr5:213.37545776367188, irr5_real:1197.3116455078125, ndcg5:0.8336396869806884, pnl5:2.3876726627349854 
train 39, step: 0, loss: 0.9697926372563074, grad_norm: 0.0012904044138201294, ic: 0.16309888549981583
train 39, step: 500, loss: 0.9019337213561683, grad_norm: 0.014099695553797854, ic: 0.1673258528158396
train 39, step: 1000, loss: 0.9576707943105008, grad_norm: 0.0074232485239378075, ic: 0.10038294031735231
train 39, step: 1500, loss: 2.1909299629803884, grad_norm: 0.1818804613275579, ic: 0.0586731309868284
train 39, step: 2000, loss: 0.6265275180810624, grad_norm: 0.01870711526721413, ic: 0.045736108035216175
Epoch 39: 2022-05-13 16:10:16.288990: train loss: 1.618502971782961
Eval step 0: eval loss: 0.8364011485157072
Eval: 2022-05-13 16:10:19.798035: total loss: 1.0726867995560971, mse:4.6192396985246384, ic :0.14599786569991005, sharpe5:12.83629043161869, sharpe5_real:465.43026065826416, irr5:223.8673858642578, irr5_real:1197.3116455078125, ndcg5:0.852170892978779, pnl5:2.043285369873047 
