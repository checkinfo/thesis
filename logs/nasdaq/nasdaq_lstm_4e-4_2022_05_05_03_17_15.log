Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=64, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.0004, lstm_layers=1, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='BaseLSTM', normalize_adj=True, num_days=16, num_heads=1, print_inteval=600, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
42987
BaseLSTM(
  (rnn1): LSTM(5, 64, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=128, out_features=64, bias=True)
  (predict): Linear(in_features=64, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.004462052136659622, grad_norm: 0.011314060449992724, ic: 0.013065140099290263
train 0, step: 600, loss: 0.0001514029281679541, grad_norm: 9.698086603666896e-06, ic: -0.007988073956887946
Epoch 0: 2022-05-05 15:18:38.349896: train loss: 0.00028508444084837794
Eval step 0: eval loss: 0.00030769300065003335
Eval: 2022-05-05 15:18:40.769642: total loss: 0.00023956322346917224, mse:0.00047912644007670866, ic :0.03683491113918598, sharpe5:1.5530158688127993, irr5:0.2687315046787262, ndcg5:0.8669720145798032, pnl5:1.2406508922576904 
train 1, step: 0, loss: 0.00038438092451542616, grad_norm: 0.0004506118356679364, ic: 0.025924880966654906
train 1, step: 600, loss: 0.00011978356633335352, grad_norm: 7.479996861155581e-06, ic: 0.052868726597777214
Epoch 1: 2022-05-05 15:18:46.247355: train loss: 0.00022448206081871586
Eval step 0: eval loss: 0.00019275893282610923
Eval: 2022-05-05 15:18:48.564121: total loss: 0.00019000132905442596, mse:0.0003800026522787995, ic :0.028965921828228377, sharpe5:-0.9514388632401823, irr5:-0.19977986812591553, ndcg5:0.8554433100967349, pnl5:0.9851316809654236 
train 2, step: 0, loss: 0.000277381157502532, grad_norm: 0.0001412983072283623, ic: 0.02766172286048043
train 2, step: 600, loss: 0.00026809805422089994, grad_norm: 0.00010642309213956247, ic: 0.032239850173537504
Epoch 2: 2022-05-05 15:18:53.955335: train loss: 0.00021999640747388775
Eval step 0: eval loss: 0.00018877495313063264
Eval: 2022-05-05 15:18:56.241515: total loss: 0.00019230874934432843, mse:0.0003846174928469445, ic :0.025930952496680953, sharpe5:-0.8961931952834129, irr5:-0.18819957971572876, ndcg5:0.8617592680495126, pnl5:0.9951777458190918 
train 3, step: 0, loss: 0.00017879765073303133, grad_norm: 9.501128641379431e-05, ic: 0.06224202984080299
train 3, step: 600, loss: 0.0001745122135616839, grad_norm: 0.0001356733324469075, ic: -0.010780966107834172
Epoch 3: 2022-05-05 15:19:01.783071: train loss: 0.00021477854772112206
Eval step 0: eval loss: 0.00018225700478069484
Eval: 2022-05-05 15:19:04.117258: total loss: 0.00020011127525408504, mse:0.00040022255041306847, ic :0.02450380392066083, sharpe5:-0.9499406351521611, irr5:-0.1987377405166626, ndcg5:0.8547098643382381, pnl5:1.0037182569503784 
train 4, step: 0, loss: 0.00021549586381297559, grad_norm: 2.186922300746239e-06, ic: 0.025687540341286536
train 4, step: 600, loss: 0.000381812802515924, grad_norm: 0.0004119503710307833, ic: -0.015321774083955181
Epoch 4: 2022-05-05 15:19:09.605998: train loss: 0.00021293234148706195
Eval step 0: eval loss: 0.00018980955064762384
Eval: 2022-05-05 15:19:12.010550: total loss: 0.0001898333007889606, mse:0.0003796665974520587, ic :0.02496133924754718, sharpe5:-0.8121826949715614, irr5:-0.17031359672546387, ndcg5:0.853182190958673, pnl5:1.0280141830444336 
train 5, step: 0, loss: 0.000598368642386049, grad_norm: 6.112096756648109e-05, ic: 0.04336232876845668
train 5, step: 600, loss: 0.00015990453539416194, grad_norm: 1.0807546069199882e-05, ic: 0.016333275546113805
Epoch 5: 2022-05-05 15:19:17.435355: train loss: 0.00020971094882288771
Eval step 0: eval loss: 0.0001941261871252209
Eval: 2022-05-05 15:19:19.739171: total loss: 0.00018922006573087675, mse:0.00037844012795621546, ic :0.024168746553785272, sharpe5:-0.7262549214810132, irr5:-0.1495206654071808, ndcg5:0.862280014417188, pnl5:1.0442932844161987 
train 6, step: 0, loss: 0.0001668599434196949, grad_norm: 1.1867777656217396e-05, ic: -0.03645116654850543
train 6, step: 600, loss: 0.00017560660489834845, grad_norm: 1.0726874803720284e-07, ic: -0.0011921751322304629
Epoch 6: 2022-05-05 15:19:25.159943: train loss: 0.00020981794400663726
Eval step 0: eval loss: 0.00018687118426896632
Eval: 2022-05-05 15:19:27.535035: total loss: 0.0001912213258399961, mse:0.00038244264744904477, ic :0.023459963852168864, sharpe5:-0.7633034617826342, irr5:-0.1590324342250824, ndcg5:0.8578516985975618, pnl5:1.0186831951141357 
train 7, step: 0, loss: 0.000201011702301912, grad_norm: 3.1629235057394924e-07, ic: 0.07452844767530822
train 7, step: 600, loss: 0.0002252536069136113, grad_norm: 0.00011750582963611589, ic: -0.05225377348214402
Epoch 7: 2022-05-05 15:19:33.146505: train loss: 0.00020866126481426339
Eval step 0: eval loss: 0.0001881940697785467
Eval: 2022-05-05 15:19:35.531519: total loss: 0.00019039159403756741, mse:0.0003807831823181648, ic :0.02311113096347392, sharpe5:-0.8903081775829196, irr5:-0.18307119607925415, ndcg5:0.8520884690377645, pnl5:1.0513663291931152 
train 8, step: 0, loss: 8.668961527291685e-05, grad_norm: 2.140920316871328e-07, ic: 0.06671685045186365
train 8, step: 600, loss: 0.00025666895089671016, grad_norm: 0.00013554511557590512, ic: 0.049174136461672485
Epoch 8: 2022-05-05 15:19:41.022416: train loss: 0.00020820461373856428
Eval step 0: eval loss: 0.00019444330246187747
Eval: 2022-05-05 15:19:43.510920: total loss: 0.00018932217579573072, mse:0.0003786443500227863, ic :0.023156126408472828, sharpe5:-0.9792486062273382, irr5:-0.20335593819618225, ndcg5:0.8427094962359662, pnl5:1.0366287231445312 
train 9, step: 0, loss: 8.741314377402887e-05, grad_norm: 5.44432682196972e-07, ic: 0.02271855802178432
train 9, step: 600, loss: 0.0002542746369726956, grad_norm: 0.0002049370213847534, ic: 0.04368436515335421
Epoch 9: 2022-05-05 15:19:49.103769: train loss: 0.00020895350006302013
Eval step 0: eval loss: 0.00018608442042022943
Eval: 2022-05-05 15:19:51.471021: total loss: 0.00019152293298330277, mse:0.0003830458639335799, ic :0.023185458804841155, sharpe5:-0.7496528669446706, irr5:-0.15593451261520386, ndcg5:0.8435832156660126, pnl5:1.041085958480835 
train 10, step: 0, loss: 0.00011976731184404343, grad_norm: 7.859517936034258e-07, ic: 0.03555393332135129
train 10, step: 600, loss: 0.0001068421479430981, grad_norm: 7.1361071410039e-06, ic: 0.02745259745830859
Epoch 10: 2022-05-05 15:19:57.195194: train loss: 0.00020830419844305897
Eval step 0: eval loss: 0.0001893667213153094
Eval: 2022-05-05 15:19:59.578026: total loss: 0.00019007969210561726, mse:0.0003801593776250795, ic :0.022911061457576706, sharpe5:-1.0607530537247658, irr5:-0.22656923532485962, ndcg5:0.8647984823188919, pnl5:1.0028505325317383 
train 11, step: 0, loss: 0.0001774136326275766, grad_norm: 4.382112503897269e-05, ic: 0.0022391345998312674
train 11, step: 600, loss: 0.0002133952802978456, grad_norm: 2.457190992628879e-06, ic: 0.07386070155075233
Epoch 11: 2022-05-05 15:20:05.152818: train loss: 0.00020780454993852087
Eval step 0: eval loss: 0.0001988535514101386
Eval: 2022-05-05 15:20:07.527398: total loss: 0.00018931433886507678, mse:0.0003786286727438353, ic :0.02295973893710671, sharpe5:-0.9980663202702998, irr5:-0.21183499693870544, ndcg5:0.8526729111471442, pnl5:0.9971991777420044 
train 12, step: 0, loss: 0.0001478683261666447, grad_norm: 1.3676638161169827e-06, ic: 0.0843536797829087
train 12, step: 600, loss: 0.00017216608102899045, grad_norm: 7.505758186833755e-05, ic: -0.002908642140246248
Epoch 12: 2022-05-05 15:20:13.028327: train loss: 0.00020786208132375503
Eval step 0: eval loss: 0.00021316815400496125
Eval: 2022-05-05 15:20:15.405012: total loss: 0.0001922232776167023, mse:0.0003844465503085021, ic :0.01938027539110956, sharpe5:-0.9199876609817147, irr5:-0.19170546531677246, ndcg5:0.8543841506395781, pnl5:1.0302077531814575 
train 13, step: 0, loss: 0.00014679359446745366, grad_norm: 1.4900286849588014e-05, ic: 0.10558724923735262
train 13, step: 600, loss: 0.00016765997861512005, grad_norm: 1.760592559957517e-05, ic: 0.06252303874047421
Epoch 13: 2022-05-05 15:20:20.922130: train loss: 0.00020759487937096777
Eval step 0: eval loss: 0.00019738040282391012
Eval: 2022-05-05 15:20:23.274663: total loss: 0.00018925781955555864, mse:0.0003785156310580986, ic :0.02112353298862758, sharpe5:-1.0574050679057836, irr5:-0.2243114709854126, ndcg5:0.8478721124582635, pnl5:1.0202120542526245 
train 14, step: 0, loss: 0.00024410284822806716, grad_norm: 0.00015622584785944556, ic: -0.06059793889535814
train 14, step: 600, loss: 0.00016758717538323253, grad_norm: 9.949542645698695e-05, ic: 0.12325453403492406
Epoch 14: 2022-05-05 15:20:28.821693: train loss: 0.0002077675665114421
Eval step 0: eval loss: 0.0002019414387177676
Eval: 2022-05-05 15:20:31.336057: total loss: 0.00018977983086290918, mse:0.0003795596576741263, ic :0.018599113694557832, sharpe5:-0.9548286471515893, irr5:-0.19903269410133362, ndcg5:0.8516264182612027, pnl5:1.0231680870056152 
train 15, step: 0, loss: 0.0006171523127704859, grad_norm: 9.682569562416856e-05, ic: 0.07286036532635765
train 15, step: 600, loss: 0.00010842258780030534, grad_norm: 3.8142611763491667e-07, ic: 0.11119950671136777
Epoch 15: 2022-05-05 15:20:37.071288: train loss: 0.00020760009127214387
Eval step 0: eval loss: 0.000184952950803563
Eval: 2022-05-05 15:20:39.424000: total loss: 0.00019153694285615032, mse:0.00038307388282648303, ic :0.022273752205021126, sharpe5:-0.8641940064355731, irr5:-0.17954343557357788, ndcg5:0.8568518088746226, pnl5:1.0009897947311401 
train 16, step: 0, loss: 0.0002685111830942333, grad_norm: 0.00019204169122804756, ic: 0.053078513665096375
train 16, step: 600, loss: 0.00014157983241602778, grad_norm: 1.413581312254151e-05, ic: 0.04765547774434423
Epoch 16: 2022-05-05 15:20:45.041633: train loss: 0.00020778661877360522
Eval step 0: eval loss: 0.0001816715521272272
Eval: 2022-05-05 15:20:47.397324: total loss: 0.00019528655598953585, mse:0.0003905731070675655, ic :0.021477871642740662, sharpe5:-0.9139699772000313, irr5:-0.19056347012519836, ndcg5:0.8456647812014726, pnl5:1.031292200088501 
train 17, step: 0, loss: 0.00024856632808223367, grad_norm: 2.712513233722036e-06, ic: -0.001151375008878748
train 17, step: 600, loss: 0.0001755128032527864, grad_norm: 8.936034984615405e-06, ic: 0.03077327968489751
Epoch 17: 2022-05-05 15:20:53.045721: train loss: 0.00020821812886424597
Eval step 0: eval loss: 0.000203230170882307
Eval: 2022-05-05 15:20:55.515610: total loss: 0.00019008990896579163, mse:0.00038017981611663214, ic :0.02021129654526439, sharpe5:-1.1967561243474483, irr5:-0.2555161416530609, ndcg5:0.8468110973324103, pnl5:1.015703558921814 
train 18, step: 0, loss: 0.00019605086708907038, grad_norm: 0.00020460951609167064, ic: -0.04702650449442809
train 18, step: 600, loss: 0.00011910391185665503, grad_norm: 8.795900794670656e-06, ic: -0.02537833339279639
Epoch 18: 2022-05-05 15:21:00.969711: train loss: 0.0002078880410457763
Eval step 0: eval loss: 0.0002042861597146839
Eval: 2022-05-05 15:21:03.330177: total loss: 0.00019023646696679277, mse:0.00038047292980602506, ic :0.019058338999546082, sharpe5:-0.7982344291359186, irr5:-0.16626900434494019, ndcg5:0.8546951738433878, pnl5:1.0516154766082764 
train 19, step: 0, loss: 0.00017669389490038157, grad_norm: 8.870110535253287e-05, ic: -0.021539553789920073
train 19, step: 600, loss: 0.0002903719141613692, grad_norm: 0.00012037703642430779, ic: 0.057143108006872195
Epoch 19: 2022-05-05 15:21:08.796502: train loss: 0.00020801718577343777
Eval step 0: eval loss: 0.00018974363047163934
Eval: 2022-05-05 15:21:11.059445: total loss: 0.00018988338429997022, mse:0.0003797667638094256, ic :0.025042342449200224, sharpe5:-1.0102188643813133, irr5:-0.20937597751617432, ndcg5:0.8431447360899426, pnl5:1.0307029485702515 
train 20, step: 0, loss: 0.000478055706480518, grad_norm: 0.0005974118197128066, ic: -0.09142060516186512
train 20, step: 600, loss: 0.00013147661229595542, grad_norm: 2.2309413899155475e-05, ic: -0.07874361178902464
Epoch 20: 2022-05-05 15:21:16.690986: train loss: 0.00020775903295371619
Eval step 0: eval loss: 0.000196019173017703
Eval: 2022-05-05 15:21:19.126319: total loss: 0.0001892515479764012, mse:0.00037850309148573314, ic :0.02046256970705712, sharpe5:-0.7213240472227335, irr5:-0.14970365166664124, ndcg5:0.8403446825949029, pnl5:1.0655109882354736 
train 21, step: 0, loss: 0.00022945989621803164, grad_norm: 0.00016518728082496698, ic: 0.031282949156834244
train 21, step: 600, loss: 0.00010249177285004407, grad_norm: 2.0419624113927536e-07, ic: -0.0009239664347210144
Epoch 21: 2022-05-05 15:21:24.635993: train loss: 0.0002081441983456308
Eval step 0: eval loss: 0.00020653061801567674
Eval: 2022-05-05 15:21:26.961178: total loss: 0.00019070350666945522, mse:0.0003814070117955096, ic :0.029674569711052822, sharpe5:-1.018145367130637, irr5:-0.21712952852249146, ndcg5:0.8551642756402017, pnl5:1.0098662376403809 
train 22, step: 0, loss: 0.0001280386932194233, grad_norm: 1.3322821343375962e-05, ic: -0.04728080853658438
train 22, step: 600, loss: 0.00017199937428813428, grad_norm: 3.331586472868391e-05, ic: -0.0033078295347432956
Epoch 22: 2022-05-05 15:21:32.539779: train loss: 0.00020719489598500454
Eval step 0: eval loss: 0.00018329755403101444
Eval: 2022-05-05 15:21:34.912455: total loss: 0.00019315911388594648, mse:0.0003863182265114472, ic :0.027587204797730018, sharpe5:-0.8172316917032003, irr5:-0.1703895628452301, ndcg5:0.8457431574291735, pnl5:1.02927827835083 
train 23, step: 0, loss: 0.00018948943761643022, grad_norm: 5.468192757890728e-06, ic: 0.007787417404378981
train 23, step: 600, loss: 0.00011840719525935128, grad_norm: 6.203978212135503e-05, ic: -0.0764294772335424
Epoch 23: 2022-05-05 15:21:40.572182: train loss: 0.00020788928187677222
Eval step 0: eval loss: 0.00020547608437482268
Eval: 2022-05-05 15:21:42.879108: total loss: 0.00019042043695415947, mse:0.00038084087153430606, ic :0.01671791210981742, sharpe5:-0.7976949558779597, irr5:-0.16548201441764832, ndcg5:0.8488209782046434, pnl5:1.032735824584961 
train 24, step: 0, loss: 0.0004118108481634408, grad_norm: 0.000140252494671301, ic: 0.0058667753671284295
train 24, step: 600, loss: 0.00016671486082486808, grad_norm: 7.211359790033783e-05, ic: -0.00201857444466067
Epoch 24: 2022-05-05 15:21:48.406308: train loss: 0.00020778979974853134
Eval step 0: eval loss: 0.0001895552413770929
Eval: 2022-05-05 15:21:50.814018: total loss: 0.00018981025858842284, mse:0.0003796205168548002, ic :0.028352836227766104, sharpe5:-0.8013960675895214, irr5:-0.16720902919769287, ndcg5:0.8590722898363392, pnl5:1.031853199005127 
train 25, step: 0, loss: 0.00010611343896016479, grad_norm: 3.235606294109427e-05, ic: 0.02104243070647277
train 25, step: 600, loss: 0.00012471538502722979, grad_norm: 2.584741110998257e-05, ic: 0.04880847950645899
Epoch 25: 2022-05-05 15:21:56.436194: train loss: 0.00020813672699905757
Eval step 0: eval loss: 0.00018192711286246777
Eval: 2022-05-05 15:21:58.810537: total loss: 0.00019592316099547894, mse:0.0003918463145605096, ic :0.02882962813878344, sharpe5:-0.774658531397581, irr5:-0.16122537851333618, ndcg5:0.8561137985616273, pnl5:1.0367329120635986 
train 26, step: 0, loss: 0.00023709688684903085, grad_norm: 0.00023768861970008563, ic: 0.1869284696574725
train 26, step: 600, loss: 0.00017739893519319594, grad_norm: 2.970553011455823e-05, ic: -0.02901676232624218
Epoch 26: 2022-05-05 15:22:04.225316: train loss: 0.0002084257485802408
Eval step 0: eval loss: 0.0001888619881356135
Eval: 2022-05-05 15:22:06.690762: total loss: 0.00019014727080486317, mse:0.00038029453832702834, ic :0.02629127763227141, sharpe5:-0.8263026463240385, irr5:-0.17249992489814758, ndcg5:0.8636835761920298, pnl5:1.0275768041610718 
train 27, step: 0, loss: 0.0002543944283388555, grad_norm: 0.0001749420362029524, ic: 0.043180816530444754
train 27, step: 600, loss: 9.746352588990703e-05, grad_norm: 3.0103792193211217e-06, ic: 0.007760646660903703
Epoch 27: 2022-05-05 15:22:12.164716: train loss: 0.00020768428732136838
Eval step 0: eval loss: 0.0001988757139770314
Eval: 2022-05-05 15:22:14.475484: total loss: 0.00018943148421895863, mse:0.00037886296326058354, ic :0.02083981555307578, sharpe5:-0.774658531397581, irr5:-0.16122540831565857, ndcg5:0.8447155992633698, pnl5:1.036732792854309 
train 28, step: 0, loss: 0.000117546456749551, grad_norm: 1.2057320147347461e-05, ic: 0.035961191234673104
train 28, step: 600, loss: 0.0001398346939822659, grad_norm: 3.905807445054984e-06, ic: 0.028012944640928943
Epoch 28: 2022-05-05 15:22:19.868437: train loss: 0.00020772603542403934
Eval step 0: eval loss: 0.0001912917650770396
Eval: 2022-05-05 15:22:22.178735: total loss: 0.00019018353371669187, mse:0.0003803670619015408, ic :0.027106650597505652, sharpe5:-0.7746587087586522, irr5:-0.16122542321681976, ndcg5:0.8616828848353212, pnl5:1.036732792854309 
train 29, step: 0, loss: 0.0001222754508489743, grad_norm: 1.2917145534300953e-05, ic: 0.04346651681627643
train 29, step: 600, loss: 0.00032201994326896966, grad_norm: 0.00012939710629499652, ic: 0.13889185988277553
Epoch 29: 2022-05-05 15:22:27.638087: train loss: 0.0002077734753510339
Eval step 0: eval loss: 0.00019621376122813672
Eval: 2022-05-05 15:22:29.982280: total loss: 0.0001891343223236025, mse:0.00037826864221523137, ic :0.030362878596435036, sharpe5:-0.8107220083102583, irr5:-0.1685076653957367, ndcg5:0.8507937533540634, pnl5:1.0487663745880127 
train 30, step: 0, loss: 0.0001734281686367467, grad_norm: 5.688951468991348e-05, ic: -0.00037893276841777235
train 30, step: 600, loss: 0.0002282433706568554, grad_norm: 4.886680441877977e-06, ic: 0.08558793035887888
Epoch 30: 2022-05-05 15:22:35.447113: train loss: 0.00020783057085232892
Eval step 0: eval loss: 0.00019512676226440817
Eval: 2022-05-05 15:22:37.749546: total loss: 0.0001891774916336598, mse:0.0003783549775544454, ic :0.029150934981193168, sharpe5:-0.6613207276538015, irr5:-0.13803896307945251, ndcg5:0.8541862087880802, pnl5:1.0386461019515991 
train 31, step: 0, loss: 0.00015470270591322333, grad_norm: 4.418854856084415e-05, ic: 0.04724505737547147
train 31, step: 600, loss: 0.00018142795306630433, grad_norm: 7.643603879990089e-06, ic: 0.0801816792399545
Epoch 31: 2022-05-05 15:22:43.177219: train loss: 0.0002077180092512847
Eval step 0: eval loss: 0.00019771924417000264
Eval: 2022-05-05 15:22:45.468348: total loss: 0.0001891766937475386, mse:0.0003783533872637469, ic :0.0299782850903533, sharpe5:-0.6613206685334444, irr5:-0.1380389928817749, ndcg5:0.8454616924800494, pnl5:1.0386461019515991 
train 32, step: 0, loss: 0.0001553575275465846, grad_norm: 1.045448243997449e-05, ic: 0.027325279214786433
train 32, step: 600, loss: 0.00016885074728634208, grad_norm: 2.7250938115631775e-05, ic: 0.019711973916169023
Epoch 32: 2022-05-05 15:22:50.990343: train loss: 0.0002078517390121281
Eval step 0: eval loss: 0.00018167115922551602
Eval: 2022-05-05 15:22:53.405146: total loss: 0.00019536526920853342, mse:0.0003907305342109526, ic :0.029329288844106984, sharpe5:-0.6667596822604537, irr5:-0.13787341117858887, ndcg5:0.8572593126808612, pnl5:1.0748029947280884 
train 33, step: 0, loss: 0.00017252434918191284, grad_norm: 1.0663976816359039e-05, ic: 0.08734916968291431
train 33, step: 600, loss: 9.626811515772715e-05, grad_norm: 1.938669309995182e-05, ic: 0.03989584161962009
Epoch 33: 2022-05-05 15:22:58.854343: train loss: 0.00020835333611643906
Eval step 0: eval loss: 0.00019955576863139868
Eval: 2022-05-05 15:23:01.241119: total loss: 0.00018936867476177584, mse:0.0003787373428540031, ic :0.02849412371582548, sharpe5:-0.8107218900695443, irr5:-0.1685076355934143, ndcg5:0.862672477688213, pnl5:1.0487662553787231 
train 34, step: 0, loss: 0.00013546743139158934, grad_norm: 3.295870822830312e-05, ic: -0.03249872972192258
train 34, step: 600, loss: 0.00014803526573814452, grad_norm: 0.0001354116686128406, ic: 0.14108861520311222
Epoch 34: 2022-05-05 15:23:06.899313: train loss: 0.00020750657485395268
Eval step 0: eval loss: 0.00019997631898149848
Eval: 2022-05-05 15:23:09.210172: total loss: 0.00018937038810164098, mse:0.00037874077417939363, ic :0.028470004249372946, sharpe5:-0.8081100709363818, irr5:-0.1679478883743286, ndcg5:0.8523334765579021, pnl5:1.049230694770813 
train 35, step: 0, loss: 8.867329597705975e-05, grad_norm: 1.2716411262472077e-05, ic: 0.128178024979243
train 35, step: 600, loss: 0.00023840327048674226, grad_norm: 1.990346050748305e-05, ic: 0.03601377959158224
Epoch 35: 2022-05-05 15:23:14.658615: train loss: 0.00020789584364998468
Eval step 0: eval loss: 0.0001882407523225993
Eval: 2022-05-05 15:23:16.962903: total loss: 0.00019061398272728126, mse:0.0003812279576299101, ic :0.029635205495508653, sharpe5:-0.6918715268746018, irr5:-0.14318197965621948, ndcg5:0.8509304388570731, pnl5:1.0701990127563477 
train 36, step: 0, loss: 8.527107274858281e-05, grad_norm: 1.2661191590164333e-05, ic: 0.07929548515549269
train 36, step: 600, loss: 0.0001080683505279012, grad_norm: 1.145909674822068e-05, ic: 0.029110935529354676
Epoch 36: 2022-05-05 15:23:22.370738: train loss: 0.0002075676224243629
Eval step 0: eval loss: 0.00018826626182999462
Eval: 2022-05-05 15:23:24.700247: total loss: 0.0001901157545170755, mse:0.0003802315053272099, ic :0.03120856512326, sharpe5:-0.8107218900695443, irr5:-0.1685076355934143, ndcg5:0.8597053566656916, pnl5:1.0487663745880127 
train 37, step: 0, loss: 0.00021469219063874334, grad_norm: 0.00010722880116115143, ic: 0.12001751681139701
train 37, step: 600, loss: 0.00011668637307593599, grad_norm: 3.272474367028663e-06, ic: 0.040830169146691006
Epoch 37: 2022-05-05 15:23:30.153078: train loss: 0.00020795324036609257
Eval step 0: eval loss: 0.0001906713005155325
Eval: 2022-05-05 15:23:32.525797: total loss: 0.00018975264709511334, mse:0.00037950529201945374, ic :0.029605479117281328, sharpe5:-0.6953799653425813, irr5:-0.1446416676044464, ndcg5:0.8514800839929001, pnl5:1.0694522857666016 
train 38, step: 0, loss: 0.0003228159330319613, grad_norm: 2.822111814713946e-06, ic: 0.09375712313320045
train 38, step: 600, loss: 0.00039870437467470765, grad_norm: 0.00041687507949845413, ic: -0.0021284794358431124
Epoch 38: 2022-05-05 15:23:37.969284: train loss: 0.00020764710730086458
Eval step 0: eval loss: 0.00019054320000577718
Eval: 2022-05-05 15:23:40.307899: total loss: 0.0001899485414551689, mse:0.0003798970806682032, ic :0.03218231508131348, sharpe5:-0.6918716451153158, irr5:-0.14318197965621948, ndcg5:0.85061839903801, pnl5:1.0701990127563477 
train 39, step: 0, loss: 0.00013960643263999373, grad_norm: 9.145950597608108e-08, ic: 0.08282917262301917
train 39, step: 600, loss: 0.0002471136685926467, grad_norm: 2.9471541774190683e-06, ic: 0.004205763584740473
Epoch 39: 2022-05-05 15:23:45.620293: train loss: 0.00020723342770636647
Eval step 0: eval loss: 0.00018975765851791948
Eval: 2022-05-05 15:23:47.954992: total loss: 0.00019003521608624912, mse:0.0003800704290334953, ic :0.027056618450285296, sharpe5:-0.6918718815967441, irr5:-0.14318202435970306, ndcg5:0.8522194624883476, pnl5:1.070198893547058 
