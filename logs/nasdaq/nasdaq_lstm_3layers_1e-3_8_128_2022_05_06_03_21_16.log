Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=60, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=3, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='BaseLSTM', normalize_adj=True, num_days=8, num_heads=1, print_inteval=600, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
78622
BaseLSTM(
  (rnn1): LSTM(5, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (predict): Linear(in_features=128, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.006502751260995865, grad_norm: 0.016871674931255926, ic: 0.002295163329792748
train 0, step: 600, loss: 0.0002063739375444129, grad_norm: 0.00010087553467602463, ic: 0.04585673264940551
Epoch 0: 2022-05-06 15:22:45.552044: train loss: 0.00025556491918856886
Eval step 0: eval loss: 0.00016080900968518108
Eval: 2022-05-06 15:22:48.139523: total loss: 0.0001916731012564185, mse:0.0003833461977643924, ic :0.022609878689650358, sharpe5:-0.8839458812400698, irr5:-0.19286313652992249, ndcg5:0.8559834728697512, pnl5:0.9895498156547546 
train 1, step: 0, loss: 0.00011884080595336854, grad_norm: 4.3679762182367336e-05, ic: 0.00031441068506277495
train 1, step: 600, loss: 0.00027665868401527405, grad_norm: 2.5199738915057912e-05, ic: 0.00047543164414737445
Epoch 1: 2022-05-06 15:22:58.675303: train loss: 0.00021867743554348587
Eval step 0: eval loss: 0.00015988633094821125
Eval: 2022-05-06 15:23:01.315534: total loss: 0.00019139796701960436, mse:0.00038279593111047806, ic :0.02322732526946794, sharpe5:-0.9175818762928247, irr5:-0.20091095566749573, ndcg5:0.8611570542878652, pnl5:0.9501063227653503 
train 2, step: 0, loss: 0.00015068153152242303, grad_norm: 3.105747323801598e-05, ic: 0.012329380455917624
train 2, step: 600, loss: 0.0001704971946310252, grad_norm: 5.234681891634927e-05, ic: 0.029568180387405066
Epoch 2: 2022-05-06 15:23:11.840556: train loss: 0.00021272595549233565
Eval step 0: eval loss: 0.00013170794409234077
Eval: 2022-05-06 15:23:14.438307: total loss: 0.0001895615511256632, mse:0.0003791230967636599, ic :0.02285447388860757, sharpe5:-0.9208098477870226, irr5:-0.20013928413391113, ndcg5:0.8448615728751452, pnl5:0.9657604694366455 
train 3, step: 0, loss: 0.0001350484526483342, grad_norm: 1.9527642762816933e-06, ic: 0.007144458868193519
train 3, step: 600, loss: 0.0001479664642829448, grad_norm: 5.555157588504016e-05, ic: -0.037345409971591664
Epoch 3: 2022-05-06 15:23:24.965049: train loss: 0.00021164870191510844
Eval step 0: eval loss: 0.00015096220886334777
Eval: 2022-05-06 15:23:27.617567: total loss: 0.0001895539560426417, mse:0.00037910790402268776, ic :0.016052208669589056, sharpe5:0.5102118737250566, irr5:0.08885778486728668, ndcg5:0.8641252833777656, pnl5:1.0271713733673096 
train 4, step: 0, loss: 0.00014373508747667074, grad_norm: 1.0998105025248627e-05, ic: 0.03237849525652601
train 4, step: 600, loss: 0.0002623894833959639, grad_norm: 0.00021741346974172698, ic: 0.07005275201487436
Epoch 4: 2022-05-06 15:23:38.193880: train loss: 0.00020901276052014012
Eval step 0: eval loss: 0.00013161329843569547
Eval: 2022-05-06 15:23:40.754270: total loss: 0.00018961339756616647, mse:0.00037922679098147116, ic :0.021808342288460257, sharpe5:-0.8730156505107879, irr5:-0.19048035144805908, ndcg5:0.842297468255596, pnl5:0.9741785526275635 
train 5, step: 0, loss: 0.00021143759659025818, grad_norm: 4.6627867815408e-05, ic: 0.021673233825167722
train 5, step: 600, loss: 0.00017265384667553008, grad_norm: 2.2852439426872674e-06, ic: -0.005301717988334648
Epoch 5: 2022-05-06 15:23:51.332532: train loss: 0.0002090060106930519
Eval step 0: eval loss: 0.00017983470752369612
Eval: 2022-05-06 15:23:53.883095: total loss: 0.0001978807174638788, mse:0.00039576143430141136, ic :0.022271143830918955, sharpe5:-0.8522041615471243, irr5:-0.1856144666671753, ndcg5:0.8609740275986535, pnl5:0.9950554966926575 
train 6, step: 0, loss: 0.0001965047267731279, grad_norm: 0.0001845277628654161, ic: 0.06916433764418348
train 6, step: 600, loss: 0.0001291776861762628, grad_norm: 7.269011691478318e-08, ic: -0.020720014213456775
Epoch 6: 2022-05-06 15:24:04.427244: train loss: 0.00020911996042824202
Eval step 0: eval loss: 0.000145195605000481
Eval: 2022-05-06 15:24:06.947226: total loss: 0.00018884961532203147, mse:0.00037769922570807235, ic :0.021506252229078152, sharpe5:-0.8236778207123279, irr5:-0.1794511079788208, ndcg5:0.8544205991748892, pnl5:0.9830154180526733 
train 7, step: 0, loss: 0.00020796022727154195, grad_norm: 8.991415214874135e-06, ic: 0.00691055930562191
train 7, step: 600, loss: 0.00011822179658338428, grad_norm: 6.206291559862666e-06, ic: 0.07246136013141756
Epoch 7: 2022-05-06 15:24:17.511838: train loss: 0.00020882744789599002
Eval step 0: eval loss: 0.00013971271982882172
Eval: 2022-05-06 15:24:20.183727: total loss: 0.00018866568413363795, mse:0.00037733136502933766, ic :0.021603188280565795, sharpe5:-0.8522040433064103, irr5:-0.18561449646949768, ndcg5:0.8557318931849872, pnl5:0.9950554966926575 
train 8, step: 0, loss: 0.00015274899487849325, grad_norm: 8.242730217867174e-06, ic: 0.10684541584554631
train 8, step: 600, loss: 0.00011851685849251226, grad_norm: 1.0445550871780904e-05, ic: 0.05321220729578531
Epoch 8: 2022-05-06 15:24:30.804929: train loss: 0.00020869996217060785
Eval step 0: eval loss: 0.0001365816278848797
Eval: 2022-05-06 15:24:33.306971: total loss: 0.00018886372902762047, mse:0.0003777274522091185, ic :0.014410004040602218, sharpe5:-0.8522038068249821, irr5:-0.18561449646949768, ndcg5:0.852855779654382, pnl5:0.9950554966926575 
train 9, step: 0, loss: 0.00013451588165480644, grad_norm: 6.126659420385587e-06, ic: 0.04730096772280266
train 9, step: 600, loss: 0.0001720003638183698, grad_norm: 9.53255247720445e-05, ic: -0.030757616400263355
Epoch 9: 2022-05-06 15:24:43.895271: train loss: 0.00020831615108757575
Eval step 0: eval loss: 0.00011681747128022835
Eval: 2022-05-06 15:24:46.512157: total loss: 0.0002064089527568174, mse:0.0004128178994487565, ic :0.022347353289905007, sharpe5:-0.865024292729795, irr5:-0.18856915831565857, ndcg5:0.8732824878390563, pnl5:0.9934116005897522 
train 10, step: 0, loss: 0.00010538855713093653, grad_norm: 2.5890176905370918e-05, ic: 0.05460807064969482
train 10, step: 600, loss: 0.00022904864454176277, grad_norm: 0.00013571443622651254, ic: 0.0799793098059902
Epoch 10: 2022-05-06 15:24:56.729996: train loss: 0.00020914977218602928
Eval step 0: eval loss: 0.00017167816986329854
Eval: 2022-05-06 15:24:59.390824: total loss: 0.00019488872193978432, mse:0.0003897774424297282, ic :0.02721421330221765, sharpe5:-0.9204623974487185, irr5:-0.19964295625686646, ndcg5:0.8627331064014047, pnl5:0.9836066365242004 
train 11, step: 0, loss: 0.00023521373805124313, grad_norm: 4.936874052829819e-06, ic: -0.03314413846018988
train 11, step: 600, loss: 0.0003841672732960433, grad_norm: 0.0001047365052869616, ic: -0.035488836463537024
Epoch 11: 2022-05-06 15:25:10.221016: train loss: 0.00020903359406722964
Eval step 0: eval loss: 0.0001327614882029593
Eval: 2022-05-06 15:25:12.806823: total loss: 0.00018947539886273647, mse:0.0003789507965870338, ic :0.022163090060142346, sharpe5:-0.9204623974487185, irr5:-0.19964298605918884, ndcg5:0.8570764498352144, pnl5:0.9836065769195557 
train 12, step: 0, loss: 0.00016672244237270206, grad_norm: 7.178326809004162e-05, ic: 0.02535162932045086
train 12, step: 600, loss: 0.00024239752383437008, grad_norm: 1.0973511565806627e-05, ic: -0.04648008674540197
Epoch 12: 2022-05-06 15:25:22.963869: train loss: 0.0002083674292645839
Eval step 0: eval loss: 0.00014700916653964669
Eval: 2022-05-06 15:25:25.567073: total loss: 0.00018902853286726498, mse:0.00037805706016441116, ic :0.022130597353963166, sharpe5:-0.9378480390831828, irr5:-0.20340991020202637, ndcg5:0.8564970617122312, pnl5:0.9980016946792603 
train 13, step: 0, loss: 0.0001700636639725417, grad_norm: 1.5605122896581072e-05, ic: 0.061551055418345185
train 13, step: 600, loss: 0.00015370178152807057, grad_norm: 2.2847636353033845e-05, ic: 0.020714854091283187
Epoch 13: 2022-05-06 15:25:36.172701: train loss: 0.00020833883696896546
Eval step 0: eval loss: 0.0001629041216801852
Eval: 2022-05-06 15:25:38.759438: total loss: 0.00019218715195118056, mse:0.0003843742989801111, ic :0.021851408094910683, sharpe5:-0.9697845603525638, irr5:-0.21048209071159363, ndcg5:0.8489958025906031, pnl5:0.9751587510108948 
train 14, step: 0, loss: 0.00020384855451993644, grad_norm: 8.320902811001886e-07, ic: 0.0762866195245097
train 14, step: 600, loss: 0.00010572628525551409, grad_norm: 7.4903183994606475e-06, ic: 0.03782615849951768
Epoch 14: 2022-05-06 15:25:49.305572: train loss: 0.00020813425412670962
Eval step 0: eval loss: 0.0001360459573334083
Eval: 2022-05-06 15:25:51.902362: total loss: 0.0001889550418508601, mse:0.00037791008257239664, ic :0.022117219105355437, sharpe5:-1.066688028126955, irr5:-0.2318229079246521, ndcg5:0.8472177405346514, pnl5:0.9758704304695129 
train 15, step: 0, loss: 0.00013917495380155742, grad_norm: 4.632090422316334e-06, ic: 0.07430197439844241
train 15, step: 600, loss: 0.00022404089395422488, grad_norm: 7.178462607071903e-05, ic: 0.05072454089135729
Epoch 15: 2022-05-06 15:26:02.504110: train loss: 0.00020784166835824787
Eval step 0: eval loss: 0.00011831706797238439
Eval: 2022-05-06 15:26:05.147129: total loss: 0.00020104113046850555, mse:0.0004020822574411342, ic :0.021897842101671876, sharpe5:-0.8951747288927435, irr5:-0.195207417011261, ndcg5:0.8495484961741532, pnl5:0.9708943367004395 
train 16, step: 0, loss: 0.00020551722263917327, grad_norm: 5.872162853786904e-06, ic: -0.017580337425355325
train 16, step: 600, loss: 8.670136594446376e-05, grad_norm: 7.732825307168386e-07, ic: -0.033341340297584704
Epoch 16: 2022-05-06 15:26:15.700710: train loss: 0.00020899457386040402
Eval step 0: eval loss: 0.00017889852460939437
Eval: 2022-05-06 15:26:18.221174: total loss: 0.00019741204764752945, mse:0.00039482408984372615, ic :0.02192339420771454, sharpe5:-0.8951747880131006, irr5:-0.1952073872089386, ndcg5:0.8636494106126261, pnl5:0.9708943367004395 
train 17, step: 0, loss: 0.00014411522715818137, grad_norm: 3.5866856698685157e-06, ic: 0.014566562100859264
train 17, step: 600, loss: 0.0004929727874696255, grad_norm: 0.0005140619690071189, ic: 0.008479316525896528
Epoch 17: 2022-05-06 15:26:28.858741: train loss: 0.00020912822883425655
Eval step 0: eval loss: 0.00015778694069013
Eval: 2022-05-06 15:26:31.409821: total loss: 0.00019089295477992712, mse:0.00038178590579488896, ic :0.018934878061176462, sharpe5:-0.9268397103622555, irr5:-0.20099031925201416, ndcg5:0.8626294584766082, pnl5:0.9651746153831482 
train 18, step: 0, loss: 0.00038404608494602144, grad_norm: 0.00029751212432628553, ic: 0.006147570862370848
train 18, step: 600, loss: 0.0001315645786235109, grad_norm: 8.538064751414305e-06, ic: 0.07803513416527377
Epoch 18: 2022-05-06 15:26:41.980606: train loss: 0.0002089703921715008
Eval step 0: eval loss: 0.0001399489992763847
Eval: 2022-05-06 15:26:44.521363: total loss: 0.00018870226968197747, mse:0.0003774045362579788, ic :-0.020778850716116883, sharpe5:-3.0500974948704243, irr5:-0.15997134149074554, ndcg5:0.8675610064984454, pnl5:0.2746233642101288 
train 19, step: 0, loss: 0.00023062909895088524, grad_norm: 0.00019222210458528575, ic: 0.0009313221987377772
train 19, step: 600, loss: 0.00025326249306090176, grad_norm: 6.061985867907735e-06, ic: -0.011834293654738103
Epoch 19: 2022-05-06 15:26:55.253695: train loss: 0.0002078600061059675
Eval step 0: eval loss: 0.00013480348570737988
Eval: 2022-05-06 15:26:57.821606: total loss: 0.00018912017050323252, mse:0.00037824033891822135, ic :-0.019949633060713373, sharpe5:-3.1411303111910818, irr5:-0.17275677621364594, ndcg5:0.8567638757474666, pnl5:0.31253376603126526 
train 20, step: 0, loss: 0.0002265931834699586, grad_norm: 1.1094203266461321e-06, ic: -0.032699229345640346
train 20, step: 600, loss: 0.00013408872473519295, grad_norm: 9.435758681304599e-06, ic: -0.00374165783816925
Epoch 20: 2022-05-06 15:27:08.373809: train loss: 0.00020845114183678314
Eval step 0: eval loss: 0.00014170340728014708
Eval: 2022-05-06 15:27:10.959205: total loss: 0.00018869095598093304, mse:0.00037738190689662516, ic :0.02983915094814846, sharpe5:-0.19092208382673562, irr5:-0.04205320402979851, ndcg5:0.8459335656784941, pnl5:0.9582186341285706 
train 21, step: 0, loss: 0.0003858134150505066, grad_norm: 0.0003904876375169297, ic: -0.022327924342516906
train 21, step: 600, loss: 0.00032889432623051107, grad_norm: 7.868064793358197e-06, ic: 0.03130193188501766
Epoch 21: 2022-05-06 15:27:21.723122: train loss: 0.00020802627666386463
Eval step 0: eval loss: 0.00016088932170532644
Eval: 2022-05-06 15:27:24.276825: total loss: 0.0001916504666419175, mse:0.0003833009279059589, ic :0.03768132424501497, sharpe5:-0.9583016725257039, irr5:-0.20805078744888306, ndcg5:0.8572369032232484, pnl5:0.9944865107536316 
train 22, step: 0, loss: 0.00013039408077020198, grad_norm: 1.4163733097252062e-05, ic: 0.01414315468555009
train 22, step: 600, loss: 0.00017541028501000255, grad_norm: 0.00012661376978961029, ic: -0.03359089033873477
Epoch 22: 2022-05-06 15:27:35.008329: train loss: 0.00020827488377711325
Eval step 0: eval loss: 0.00012552508269436657
Eval: 2022-05-06 15:27:37.609723: total loss: 0.0001923552344834806, mse:0.0003847104687224443, ic :-0.00044106164746223684, sharpe5:-1.0071787773817777, irr5:-0.2186986804008484, ndcg5:0.8522058833254711, pnl5:0.9519976377487183 
train 23, step: 0, loss: 0.00020847439009230584, grad_norm: 8.102901233686666e-05, ic: 0.09573699144046571
train 23, step: 600, loss: 0.00019804731709882617, grad_norm: 0.00012245568566486486, ic: -0.05952573092294035
Epoch 23: 2022-05-06 15:27:48.438945: train loss: 0.00020902794909138695
Eval step 0: eval loss: 0.00013775280967820436
Eval: 2022-05-06 15:27:51.049179: total loss: 0.00018878749764410528, mse:0.00037757499234305385, ic :0.03020809433856378, sharpe5:-0.865119653865695, irr5:-0.1887831687927246, ndcg5:0.8393697645049321, pnl5:0.9757574200630188 
train 24, step: 0, loss: 0.00016249252075795084, grad_norm: 1.7019265171399503e-06, ic: -0.01570111697174951
train 24, step: 600, loss: 0.00011445987911429256, grad_norm: 2.088348642808088e-06, ic: -0.02454473313794148
Epoch 24: 2022-05-06 15:28:01.791679: train loss: 0.00020858002975008782
Eval step 0: eval loss: 0.00015849604096729308
Eval: 2022-05-06 15:28:04.470135: total loss: 0.00019106219434835155, mse:0.0003821243800660592, ic :0.031652706772206204, sharpe5:0.6965724820643663, irr5:0.19867338240146637, ndcg5:0.8548284684233877, pnl5:1.217796802520752 
train 25, step: 0, loss: 0.0001525085826870054, grad_norm: 0.00011059351659111712, ic: 0.0842230754089629
train 25, step: 600, loss: 0.00013907843094784766, grad_norm: 7.056535821068189e-05, ic: 0.009685233281709792
Epoch 25: 2022-05-06 15:28:15.048345: train loss: 0.00020898214813465325
Eval step 0: eval loss: 0.00013454165309667587
Eval: 2022-05-06 15:28:17.581673: total loss: 0.00018917181903133412, mse:0.0003783436316196822, ic :-0.045564188641613226, sharpe5:-3.057647637426853, irr5:-0.16009071469306946, ndcg5:0.8507222820466179, pnl5:0.27309587597846985 
train 26, step: 0, loss: 0.0001433335419278592, grad_norm: 2.140302006947106e-05, ic: -0.021236273325171418
train 26, step: 600, loss: 0.00017866436974145472, grad_norm: 8.089878702218348e-05, ic: -0.021381924547893
Epoch 26: 2022-05-06 15:28:28.043540: train loss: 0.0002089014144980549
Eval step 0: eval loss: 0.0001490492868470028
Eval: 2022-05-06 15:28:30.589465: total loss: 0.00018927961784007239, mse:0.0003785592328133207, ic :0.03265033396504796, sharpe5:-0.9195800261199474, irr5:-0.20055276155471802, ndcg5:0.8511854694919591, pnl5:0.983996570110321 
train 27, step: 0, loss: 0.00020140694687142968, grad_norm: 7.483293994781011e-05, ic: -0.021118880425059532
train 27, step: 600, loss: 0.0006278347573243082, grad_norm: 0.0006439778879293388, ic: 0.024052150389259473
Epoch 27: 2022-05-06 15:28:41.213533: train loss: 0.0002095126010560652
Eval step 0: eval loss: 0.00013985356781631708
Eval: 2022-05-06 15:28:43.732371: total loss: 0.00018870391786112714, mse:0.00037740783297698867, ic :0.042022153443340225, sharpe5:1.0508170500397682, irr5:0.14310844242572784, ndcg5:0.8555036468972671, pnl5:1.0240426063537598 
train 28, step: 0, loss: 0.0003122846828773618, grad_norm: 3.210020353061381e-06, ic: -0.0240906479884689
train 28, step: 600, loss: 0.0003222913364879787, grad_norm: 0.00014402940558208818, ic: -0.09970438639127714
Epoch 28: 2022-05-06 15:28:54.476383: train loss: 0.00020816623326873451
Eval step 0: eval loss: 0.00015188691031653434
Eval: 2022-05-06 15:28:57.051864: total loss: 0.00018970946950114058, mse:0.00037941893349583333, ic :0.035122055511835816, sharpe5:-0.8951747880131006, irr5:-0.1952073872089386, ndcg5:0.8586708336737614, pnl5:0.9708943367004395 
train 29, step: 0, loss: 0.00018028085469268262, grad_norm: 4.936231534993552e-07, ic: 0.024854973382800072
train 29, step: 600, loss: 0.00015755370259284973, grad_norm: 3.444319007000158e-06, ic: 0.005238134340270789
Epoch 29: 2022-05-06 15:29:07.647209: train loss: 0.00020853600906843773
Eval step 0: eval loss: 0.00017000648949760944
Eval: 2022-05-06 15:29:10.193730: total loss: 0.00019430902806379097, mse:0.000388618053355898, ic :0.028572234760827802, sharpe5:0.7887276983633636, irr5:0.1549571007490158, ndcg5:0.8610594693964781, pnl5:1.2152644395828247 
train 30, step: 0, loss: 0.0001669739867793396, grad_norm: 6.587655199449456e-05, ic: -0.006817948769152829
train 30, step: 600, loss: 0.00016835973656270653, grad_norm: 7.691234549204732e-05, ic: -0.005867660697799107
Epoch 30: 2022-05-06 15:29:20.805264: train loss: 0.0002090863636210044
Eval step 0: eval loss: 0.00016765447799116373
Eval: 2022-05-06 15:29:23.344877: total loss: 0.00019356661594262362, mse:0.00038713322848929515, ic :0.04470650567490282, sharpe5:-0.8475248444080352, irr5:-0.1847420036792755, ndcg5:0.8519296692014544, pnl5:0.979036271572113 
train 31, step: 0, loss: 0.0001367639924865216, grad_norm: 6.42341346354984e-05, ic: 0.002192988758672019
train 31, step: 600, loss: 0.0002153045206796378, grad_norm: 0.0001569869221967387, ic: -0.0405813452332631
Epoch 31: 2022-05-06 15:29:34.120096: train loss: 0.00020858187099536172
Eval step 0: eval loss: 0.00012146608787588775
Eval: 2022-05-06 15:29:36.700185: total loss: 0.00019583711171864356, mse:0.0003916742214069799, ic :-0.015350771850814616, sharpe5:-1.917295407950878, irr5:-0.2237910032272339, ndcg5:0.8607230580997808, pnl5:0.7656033039093018 
train 32, step: 0, loss: 0.00017481116810813546, grad_norm: 2.2189431612692456e-05, ic: -0.023319413641308663
train 32, step: 600, loss: 0.000216994623770006, grad_norm: 6.568469672319581e-05, ic: 0.05454369403508249
Epoch 32: 2022-05-06 15:29:47.353516: train loss: 0.00020865599350524566
Eval step 0: eval loss: 0.00012856096145696938
Eval: 2022-05-06 15:29:49.877077: total loss: 0.0001907984122893708, mse:0.00038159682224697954, ic :-0.016919919407009078, sharpe5:-1.4289785219728945, irr5:-0.09082233160734177, ndcg5:0.8541956131051802, pnl5:0.6128770709037781 
train 33, step: 0, loss: 0.00017905911954585463, grad_norm: 8.807815463806641e-06, ic: 0.02975440402974427
train 33, step: 600, loss: 0.00017824626411311328, grad_norm: 2.7774522800953233e-05, ic: -0.023253344161243993
Epoch 33: 2022-05-06 15:30:00.593413: train loss: 0.00020873360077082925
Eval step 0: eval loss: 0.00016116655024234205
Eval: 2022-05-06 15:30:03.202162: total loss: 0.00019172111771544278, mse:0.00038344223433722617, ic :0.015324868489753726, sharpe5:-1.0895773020386694, irr5:-0.23483699560165405, ndcg5:0.8538582980959536, pnl5:0.9704924821853638 
train 34, step: 0, loss: 0.0001726086193230003, grad_norm: 7.626582688890507e-08, ic: -0.013146905320040918
train 34, step: 600, loss: 0.00010681575804483145, grad_norm: 7.99022496278548e-06, ic: -0.008125680765791538
Epoch 34: 2022-05-06 15:30:13.752270: train loss: 0.00020826070785283094
Eval step 0: eval loss: 0.00012447503104340285
Eval: 2022-05-06 15:30:16.328417: total loss: 0.00019306310671244394, mse:0.00038612620906501707, ic :0.01694810597058635, sharpe5:0.27546787463128564, irr5:0.07316332310438156, ndcg5:0.8473264364176387, pnl5:1.0654884576797485 
train 35, step: 0, loss: 0.00033384215203113854, grad_norm: 0.0003447025753443025, ic: -0.07567496628502265
train 35, step: 600, loss: 0.00023093873460311443, grad_norm: 8.42403369782456e-07, ic: 0.04683390305774594
Epoch 35: 2022-05-06 15:30:26.997290: train loss: 0.00020872406952898953
Eval step 0: eval loss: 0.00014164535969030112
Eval: 2022-05-06 15:30:29.493889: total loss: 0.00018869979429952434, mse:0.00037739958213173745, ic :-0.01870486869006198, sharpe5:-2.9732897458970546, irr5:-0.1607663631439209, ndcg5:0.8504319425710504, pnl5:0.31189703941345215 
train 36, step: 0, loss: 0.00024304848921019584, grad_norm: 0.000150590355573132, ic: -0.04723054479981856
train 36, step: 600, loss: 5.9489200793905184e-05, grad_norm: 1.3248717308967959e-06, ic: 0.09212168125892126
Epoch 36: 2022-05-06 15:30:40.144950: train loss: 0.00020824298397512618
Eval step 0: eval loss: 0.0001816644216887653
Eval: 2022-05-06 15:30:42.739474: total loss: 0.00019845951039203764, mse:0.0003969190201096914, ic :-0.004354534747819265, sharpe5:-0.9133090116083622, irr5:-0.19806453585624695, ndcg5:0.8592252567160318, pnl5:0.9847120642662048 
train 37, step: 0, loss: 0.0003418956184759736, grad_norm: 0.0003845915508258689, ic: -0.01595700595488099
train 37, step: 600, loss: 0.0003303163102827966, grad_norm: 0.0002562485113102758, ic: 0.05416618268884152
Epoch 37: 2022-05-06 15:30:53.411754: train loss: 0.00020892718110063435
Eval step 0: eval loss: 0.00014820498472545296
Eval: 2022-05-06 15:30:55.910360: total loss: 0.00018916613409370917, mse:0.000378332262937071, ic :-0.001451531418742068, sharpe5:-0.9204624565690755, irr5:-0.19964301586151123, ndcg5:0.8457303797063208, pnl5:0.9836065769195557 
train 38, step: 0, loss: 0.00015801520203240216, grad_norm: 2.186736452629865e-08, ic: -0.006877314931213088
train 38, step: 600, loss: 0.00015308489673770964, grad_norm: 2.603125815877288e-05, ic: -0.007283340476344882
Epoch 38: 2022-05-06 15:31:06.592065: train loss: 0.00020800980937224874
Eval step 0: eval loss: 0.0001274310634471476
Eval: 2022-05-06 15:31:09.142922: total loss: 0.00019129616585580476, mse:0.00038259232884390476, ic :0.016458067655523857, sharpe5:0.858479078002274, irr5:0.2527849078178406, ndcg5:0.8554829369181786, pnl5:1.0967689752578735 
train 39, step: 0, loss: 0.0003180484054610133, grad_norm: 0.00016554471054189973, ic: 0.06811479970299829
train 39, step: 600, loss: 0.00015860571875236928, grad_norm: 2.54134542160422e-06, ic: -0.03137055128987048
Epoch 39: 2022-05-06 15:31:19.743730: train loss: 0.00020833566398999496
Eval step 0: eval loss: 0.0001710130018182099
Eval: 2022-05-06 15:31:22.269084: total loss: 0.00019463735590531293, mse:0.0003892747106377469, ic :-0.010514183536915927, sharpe5:-3.918640808612108, irr5:-0.15831077098846436, ndcg5:0.8541390636234426, pnl5:0.2941471338272095 
train 40, step: 0, loss: 0.00019753100059460849, grad_norm: 4.980292811890763e-05, ic: 0.04167686828614994
train 40, step: 600, loss: 8.328432886628434e-05, grad_norm: 3.4119676918288005e-06, ic: 0.014364840426470864
Epoch 40: 2022-05-06 15:31:32.565193: train loss: 0.00020828474999995614
Eval step 0: eval loss: 0.00011975016968790442
Eval: 2022-05-06 15:31:35.028116: total loss: 0.0001982210138744032, mse:0.00039644202465740155, ic :-0.0007351181828799892, sharpe5:-1.0006899634748696, irr5:-0.21717476844787598, ndcg5:0.8602001490444565, pnl5:0.9697887301445007 
train 41, step: 0, loss: 0.00017573850345797837, grad_norm: 2.4703054630101418e-05, ic: 0.0062845981370966385
train 41, step: 600, loss: 0.0001950767618836835, grad_norm: 8.313876075710694e-05, ic: 0.0030933427028263837
Epoch 41: 2022-05-06 15:31:46.220834: train loss: 0.00020825750972414334
Eval step 0: eval loss: 0.00016761412553023547
Eval: 2022-05-06 15:31:48.767037: total loss: 0.00019355516396661179, mse:0.00038711033142075924, ic :0.03602901799479453, sharpe5:2.873162563294172, irr5:0.42834481596946716, ndcg5:0.8532145765879685, pnl5:1.1698771715164185 
train 42, step: 0, loss: 0.00011736390297301114, grad_norm: 3.5868091830829544e-05, ic: 0.0490318374638301
train 42, step: 600, loss: 0.00013064182712696493, grad_norm: 2.0192963408279367e-05, ic: 0.12181003151108681
Epoch 42: 2022-05-06 15:31:58.907432: train loss: 0.00020814838645360955
Eval step 0: eval loss: 0.000142796037835069
Eval: 2022-05-06 15:32:01.503479: total loss: 0.00018869897751767987, mse:0.0003773979481717618, ic :0.01905053525914171, sharpe5:-1.0006898452341555, irr5:-0.21717482805252075, ndcg5:0.8637303291577372, pnl5:0.9697887301445007 
train 43, step: 0, loss: 0.00016115422477014363, grad_norm: 5.81396923228748e-05, ic: 0.02267112023617991
train 43, step: 600, loss: 0.0003013807290699333, grad_norm: 0.00022618073338348576, ic: -0.029688859661863222
Epoch 43: 2022-05-06 15:32:12.171383: train loss: 0.00020884312626174718
Eval step 0: eval loss: 0.00015119873569346964
Eval: 2022-05-06 15:32:14.662522: total loss: 0.0001895963354455612, mse:0.0003791926635854275, ic :-0.016432673382192613, sharpe5:-3.0992972195148467, irr5:-0.1631634384393692, ndcg5:0.8515433683407451, pnl5:0.27229440212249756 
train 44, step: 0, loss: 0.00018034259846899658, grad_norm: 6.150401182344156e-07, ic: -0.007141719871473041
train 44, step: 600, loss: 0.00010827384539879858, grad_norm: 1.3613087814859549e-05, ic: 0.016727979380007797
Epoch 44: 2022-05-06 15:32:25.356219: train loss: 0.00020795880529846198
Eval step 0: eval loss: 0.000127165942103602
Eval: 2022-05-06 15:32:27.910785: total loss: 0.0001914332417835274, mse:0.0003828664817563699, ic :0.019623648054904554, sharpe5:-0.5668862442299724, irr5:-0.12292882800102234, ndcg5:0.8539316972275681, pnl5:0.9960774183273315 
train 45, step: 0, loss: 0.00036262234789319336, grad_norm: 8.165155549782248e-06, ic: -0.024414105843677064
train 45, step: 600, loss: 0.00017077664961107075, grad_norm: 3.4401695008511195e-06, ic: -0.0155612888857618
Epoch 45: 2022-05-06 15:32:38.685056: train loss: 0.00020830308114775964
Eval step 0: eval loss: 0.00014793421723879874
Eval: 2022-05-06 15:32:41.212467: total loss: 0.00018913904506805674, mse:0.0003782780881666829, ic :-0.019349421781399125, sharpe5:-3.0767543908953665, irr5:-0.16190025210380554, ndcg5:0.8597867972772709, pnl5:0.2787732481956482 
train 46, step: 0, loss: 0.0002458500675857067, grad_norm: 8.87383831531118e-05, ic: 0.011073159207725988
train 46, step: 600, loss: 0.00036300442297942936, grad_norm: 0.0003342570351935737, ic: 0.011745133366166848
Epoch 46: 2022-05-06 15:32:51.875520: train loss: 0.00020855081938716077
Eval step 0: eval loss: 0.0001374094426864758
Eval: 2022-05-06 15:32:54.494027: total loss: 0.00018882376238308222, mse:0.00037764752074108556, ic :0.019361822057512624, sharpe5:-1.0006898452341555, irr5:-0.21717482805252075, ndcg5:0.8478393334796296, pnl5:0.9697887301445007 
train 47, step: 0, loss: 0.00019581150263547897, grad_norm: 0.00011487414794980442, ic: 0.0429789467622525
train 47, step: 600, loss: 0.0001900923380162567, grad_norm: 5.275210626918909e-05, ic: 0.011891658437589126
Epoch 47: 2022-05-06 15:33:05.135013: train loss: 0.0002086009922168354
Eval step 0: eval loss: 0.00016373886319343
Eval: 2022-05-06 15:33:07.640090: total loss: 0.00019241524264206256, mse:0.0003848304845267729, ic :0.024878756113114256, sharpe5:0.17540355174802244, irr5:0.05100012943148613, ndcg5:0.8557042660906774, pnl5:1.0768390893936157 
train 48, step: 0, loss: 0.00019997567869722843, grad_norm: 3.915228006177427e-05, ic: -0.025030931891271924
train 48, step: 600, loss: 0.00016663379210513085, grad_norm: 2.896644945947165e-05, ic: -0.028795946944528916
Epoch 48: 2022-05-06 15:33:18.249641: train loss: 0.00020813734786291445
Eval step 0: eval loss: 0.00012503845209721476
Eval: 2022-05-06 15:33:20.830014: total loss: 0.0001926656468521283, mse:0.00038533128552687795, ic :0.019683799451082718, sharpe5:-1.0272604255378246, irr5:-0.22305768728256226, ndcg5:0.8450101318567396, pnl5:0.9654930233955383 
train 49, step: 0, loss: 0.0001831355330068618, grad_norm: 1.1146035586169351e-05, ic: -0.0564744198879959
train 49, step: 600, loss: 0.0003758039965759963, grad_norm: 6.810221777801454e-05, ic: -0.02683148679831402
Epoch 49: 2022-05-06 15:33:31.442330: train loss: 0.00020789748087215966
Eval step 0: eval loss: 0.00014892593026161194
Eval: 2022-05-06 15:33:33.923945: total loss: 0.00018926327667472575, mse:0.0003785265494592157, ic :0.019103219113127082, sharpe5:-0.8957931278273463, irr5:-0.19503474235534668, ndcg5:0.8448694627389454, pnl5:0.9720548391342163 
train 50, step: 0, loss: 0.0003918196598533541, grad_norm: 0.00016324080106375481, ic: -0.019176048493688026
train 50, step: 600, loss: 0.00014380741049535573, grad_norm: 1.2077684619798786e-06, ic: -0.05092047621349345
Epoch 50: 2022-05-06 15:33:44.645136: train loss: 0.00020780618476777437
Eval step 0: eval loss: 0.00013498406042344868
Eval: 2022-05-06 15:33:47.183376: total loss: 0.00018909342274858767, mse:0.0003781868429109879, ic :-0.019271148376094987, sharpe5:-3.127303242087364, irr5:-0.1643754243850708, ndcg5:0.8619899072264358, pnl5:0.2734171152114868 
train 51, step: 0, loss: 0.0001292215019930154, grad_norm: 2.669830430485928e-05, ic: -0.018971372895603526
train 51, step: 600, loss: 0.0002273003337904811, grad_norm: 8.716562311734309e-07, ic: 0.012788365688393265
Epoch 51: 2022-05-06 15:33:57.911945: train loss: 0.00020868956481258634
Eval step 0: eval loss: 0.00015914830146357417
Eval: 2022-05-06 15:34:00.521577: total loss: 0.00019121452169996121, mse:0.0003824290378404033, ic :0.01930109700413572, sharpe5:-1.0245528314262629, irr5:-0.2224656492471695, ndcg5:0.850063166120372, pnl5:0.965923547744751 
train 52, step: 0, loss: 0.0002212340768892318, grad_norm: 6.534735954194793e-07, ic: -0.057669487746040825
train 52, step: 600, loss: 0.0002891800832003355, grad_norm: 0.00018963227394995649, ic: 0.014240877628848049
Epoch 52: 2022-05-06 15:34:11.127037: train loss: 0.000208385366260729
Eval step 0: eval loss: 0.00013515057798940688
Eval: 2022-05-06 15:34:13.722829: total loss: 0.0001890680063353225, mse:0.00037813600498667476, ic :0.019259517122447136, sharpe5:-1.024552949666977, irr5:-0.22246569395065308, ndcg5:0.8476046313664313, pnl5:0.965923547744751 
train 53, step: 0, loss: 0.00024680892238393426, grad_norm: 0.00016292950854900656, ic: 0.027808816973084106
train 53, step: 600, loss: 0.00020130519988015294, grad_norm: 9.204867591024722e-05, ic: 0.012942254537396596
Epoch 53: 2022-05-06 15:34:24.283987: train loss: 0.00020786621187040695
Eval step 0: eval loss: 0.00016597106878180057
Eval: 2022-05-06 15:34:26.895529: total loss: 0.00019305826362535586, mse:0.0003861165223352067, ic :0.02078690001578344, sharpe5:1.4013071206212042, irr5:0.3830878436565399, ndcg5:0.8531427202819504, pnl5:1.0446033477783203 
train 54, step: 0, loss: 0.00021418227697722614, grad_norm: 0.0001098486853688506, ic: 0.037661589648431804
train 54, step: 600, loss: 0.00017647503409534693, grad_norm: 7.536254847696924e-06, ic: -0.044784781007222454
Epoch 54: 2022-05-06 15:34:37.449758: train loss: 0.0002088297211852925
Eval step 0: eval loss: 0.00013154001499060541
Eval: 2022-05-06 15:34:40.080358: total loss: 0.0001897956922042334, mse:0.0003795913807535918, ic :-0.01576991882636954, sharpe5:-3.2500458531081673, irr5:-0.17229905724525452, ndcg5:0.8466672368484986, pnl5:0.2935149371623993 
train 55, step: 0, loss: 8.762923971517012e-05, grad_norm: 9.167865703310306e-06, ic: -0.03977060224641357
train 55, step: 600, loss: 0.00013487711839843541, grad_norm: 9.947332914325264e-06, ic: 0.014718547695960578
Epoch 55: 2022-05-06 15:34:50.669858: train loss: 0.00020832284102419467
Eval step 0: eval loss: 0.0001436288730474189
Eval: 2022-05-06 15:34:53.227297: total loss: 0.00018876708940908875, mse:0.0003775341740428547, ic :0.019797911578356416, sharpe5:1.0105567963421345, irr5:0.28922703862190247, ndcg5:0.8522123879537443, pnl5:1.3122098445892334 
train 56, step: 0, loss: 0.00022505772358272225, grad_norm: 0.00011080324708806102, ic: 0.001603457366659948
train 56, step: 600, loss: 0.0001454733865102753, grad_norm: 3.6788372248387347e-06, ic: -0.030393458998963493
Epoch 56: 2022-05-06 15:35:03.956628: train loss: 0.0002091224176348822
Eval step 0: eval loss: 0.0001460887142457068
Eval: 2022-05-06 15:35:06.489808: total loss: 0.00018894267501055333, mse:0.00037788534718427987, ic :0.019865479665129873, sharpe5:-1.0247071355581283, irr5:-0.22260457277297974, ndcg5:0.8615311447438063, pnl5:0.9658226370811462 
train 57, step: 0, loss: 0.00012875450192950666, grad_norm: 3.511433298916572e-05, ic: 0.0015324079217553417
train 57, step: 600, loss: 0.00011583726882236078, grad_norm: 4.2821873787790013e-07, ic: -0.01909312399059858
Epoch 57: 2022-05-06 15:35:17.068485: train loss: 0.00020820477876309828
Eval step 0: eval loss: 0.00013274485536385328
Eval: 2022-05-06 15:35:19.540824: total loss: 0.00018950044668043708, mse:0.0003790008881935178, ic :0.03133583592921337, sharpe5:-0.938405780531466, irr5:-0.2041955292224884, ndcg5:0.8506284249500532, pnl5:0.9814128875732422 
train 58, step: 0, loss: 0.00017442462558392435, grad_norm: 0.00013476535711473507, ic: 0.06960613095271508
train 58, step: 600, loss: 0.00024145498173311353, grad_norm: 9.157406410292585e-06, ic: -0.0100318847976444
Epoch 58: 2022-05-06 15:35:30.463699: train loss: 0.00020866385237114593
Eval step 0: eval loss: 0.00016093313752207905
Eval: 2022-05-06 15:35:33.108023: total loss: 0.000191660759866077, mse:0.0003833215121208779, ic :-0.0168376105004268, sharpe5:-6.976418274343013, irr5:-0.7875154614448547, ndcg5:0.8534544165966506, pnl5:0.46472054719924927 
train 59, step: 0, loss: 0.00015348827582783997, grad_norm: 2.0569676621420682e-05, ic: -0.03133952109947951
train 59, step: 600, loss: 0.00010118944192072377, grad_norm: 2.852114400482386e-07, ic: 0.00017912575534037925
Epoch 59: 2022-05-06 15:35:43.648831: train loss: 0.00020744227104564912
Eval step 0: eval loss: 0.00018754655320663005
Eval: 2022-05-06 15:35:46.294371: total loss: 0.00020082012249342894, mse:0.00040164024269250133, ic :0.020287430277855796, sharpe5:-1.0245528314262629, irr5:-0.2224656343460083, ndcg5:0.8460549285174527, pnl5:0.965923547744751 
