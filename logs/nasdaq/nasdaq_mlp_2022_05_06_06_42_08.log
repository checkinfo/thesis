Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=1, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='MlpModel', normalize_adj=True, num_days=1, num_heads=1, print_inteval=600, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
54424
MlpModel(
  (fc1): Linear(in_features=5, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): ReLU()
)
train 0, step: 0, loss: 0.0002562964509706944, grad_norm: 0.00025287971845347197, ic: 0.07660444199436953
train 0, step: 600, loss: 0.00017165654571726918, grad_norm: 1.8462042870196557e-07, ic: 0.039194708089153485
Epoch 0: 2022-05-06 18:43:32.079471: train loss: 0.00022325333543599812
Eval step 0: eval loss: 0.00021105591440573335
Eval: 2022-05-06 18:43:34.434291: total loss: 0.00018901266732921043, mse:0.0003780253339251637, ic :0.03165393644579081, sharpe5:-1.3780381757766007, irr5:-0.3928026854991913, ndcg5:0.8560834773995013, pnl5:0.8697090148925781 
train 1, step: 0, loss: 0.00020669015066232532, grad_norm: 8.807189057868179e-06, ic: 0.06060607879022465
train 1, step: 600, loss: 0.00023269630037248135, grad_norm: 0.0002317470843713049, ic: 0.13545234540248124
Epoch 1: 2022-05-06 18:43:38.568998: train loss: 0.00021209053592856616
Eval step 0: eval loss: 0.0001312278473051265
Eval: 2022-05-06 18:43:40.999080: total loss: 0.00021936944087151382, mse:0.0004387388763394528, ic :0.015060793505340977, sharpe5:-0.9328942852467298, irr5:-0.20512104034423828, ndcg5:0.8411239552085845, pnl5:0.9697316288948059 
train 2, step: 0, loss: 0.00026707485085353255, grad_norm: 0.0001920870587872508, ic: 0.18698594444939387
train 2, step: 600, loss: 0.0003160988271702081, grad_norm: 0.00024885557852129725, ic: 0.03209130360074214
Epoch 2: 2022-05-06 18:43:45.292405: train loss: 0.00021244967385235285
Eval step 0: eval loss: 0.00020235335978213698
Eval: 2022-05-06 18:43:47.606359: total loss: 0.0001885645659181676, mse:0.00037712912763688096, ic :0.0406955084984634, sharpe5:1.4485289146006106, irr5:0.43981897830963135, ndcg5:0.8538970505021658, pnl5:1.1589716672897339 
train 3, step: 0, loss: 0.00012453871022444218, grad_norm: 6.884167449276656e-07, ic: 0.05067562602319778
train 3, step: 600, loss: 0.00017603572632651776, grad_norm: 8.872058372321931e-05, ic: 0.004253522756933792
Epoch 3: 2022-05-06 18:43:51.880335: train loss: 0.00021206911178945644
Eval step 0: eval loss: 0.00027739774668589234
Eval: 2022-05-06 18:43:54.193000: total loss: 0.00020220841419729167, mse:0.0004044168281895835, ic :0.03245015223243491, sharpe5:0.7474226105958223, irr5:0.22172027826309204, ndcg5:0.8531056256930091, pnl5:1.0785691738128662 
train 4, step: 0, loss: 0.0003824464220087975, grad_norm: 0.00035486449365992434, ic: 0.1210313248523107
train 4, step: 600, loss: 0.0001424051879439503, grad_norm: 8.549551906952005e-05, ic: -0.0859545612840887
Epoch 4: 2022-05-06 18:43:58.350131: train loss: 0.00021036049001368337
Eval step 0: eval loss: 0.00023221354058478028
Eval: 2022-05-06 18:44:00.699353: total loss: 0.0001917652285956754, mse:0.0003835304522497045, ic :0.026414639340190015, sharpe5:-0.5141741200536489, irr5:-0.1226048395037651, ndcg5:0.848891205497637, pnl5:1.048475742340088 
train 5, step: 0, loss: 0.00012543972115963697, grad_norm: 5.944971356103972e-05, ic: 0.06832962883528174
train 5, step: 600, loss: 0.00032588245812803507, grad_norm: 0.0003254840710221613, ic: 0.05545514676194105
Epoch 5: 2022-05-06 18:44:04.970281: train loss: 0.00020928643118156066
Eval step 0: eval loss: 0.00021580491738859564
Eval: 2022-05-06 18:44:07.338699: total loss: 0.00018950081123305501, mse:0.00037900162031048403, ic :0.026753274447601758, sharpe5:0.6846509803086519, irr5:0.198247492313385, ndcg5:0.8468247751804051, pnl5:1.1042906045913696 
train 6, step: 0, loss: 0.00019409801461733878, grad_norm: 1.668033799578643e-05, ic: 0.08536842722626087
train 6, step: 600, loss: 0.00027843989664688706, grad_norm: 0.00020773313293481454, ic: 0.008477631546040108
Epoch 6: 2022-05-06 18:44:11.498522: train loss: 0.00020918072370345093
Eval step 0: eval loss: 0.0001935297332238406
Eval: 2022-05-06 18:44:13.817738: total loss: 0.00018852404570941995, mse:0.0003770480890833043, ic :0.03353745060962529, sharpe5:1.0702675292640924, irr5:0.3252628445625305, ndcg5:0.8428531430397884, pnl5:1.1564949750900269 
train 7, step: 0, loss: 0.00043074876884929836, grad_norm: 0.00045138481514112706, ic: -0.06651237060808513
train 7, step: 600, loss: 0.00023016674094833434, grad_norm: 8.482556788974345e-05, ic: 0.07050826571698464
Epoch 7: 2022-05-06 18:44:18.172556: train loss: 0.00020850034366440436
Eval step 0: eval loss: 0.0001888914848677814
Eval: 2022-05-06 18:44:20.426993: total loss: 0.0001889582862670561, mse:0.00037791656696217134, ic :0.01092927983021195, sharpe5:-0.39358227806165813, irr5:-0.09956149011850357, ndcg5:0.8554201505399585, pnl5:1.1863867044448853 
train 8, step: 0, loss: 0.00035920870141126215, grad_norm: 0.00031924311696838754, ic: -0.0018076087475581287
train 8, step: 600, loss: 0.0006082269246689975, grad_norm: 8.751084974662629e-05, ic: 0.09549925915826611
Epoch 8: 2022-05-06 18:44:24.693706: train loss: 0.00020849350655304164
Eval step 0: eval loss: 0.00018290891603101045
Eval: 2022-05-06 18:44:27.014360: total loss: 0.00018960832590059678, mse:0.00037921664841870543, ic :0.004121993771920965, sharpe5:-0.8998305161297321, irr5:-0.19536012411117554, ndcg5:0.8552056643214998, pnl5:0.974664032459259 
train 9, step: 0, loss: 0.0002434655325487256, grad_norm: 2.6515495296976067e-05, ic: 0.05784631185380494
train 9, step: 600, loss: 0.00019884042558260262, grad_norm: 1.3391794802544613e-06, ic: 0.04516539452610333
Epoch 9: 2022-05-06 18:44:31.322010: train loss: 0.0002080141275318182
Eval step 0: eval loss: 0.0001944576360983774
Eval: 2022-05-06 18:44:33.708386: total loss: 0.00018874704933989698, mse:0.000377494098795987, ic :0.006836104514034359, sharpe5:-1.027685973867774, irr5:-0.22782206535339355, ndcg5:0.8475964991531667, pnl5:0.9544248580932617 
train 10, step: 0, loss: 0.00020645059703383595, grad_norm: 1.4659057037736572e-05, ic: 0.07330276677210774
train 10, step: 600, loss: 0.0002050416951533407, grad_norm: 2.9387995229314e-06, ic: 0.01701170789527872
Epoch 10: 2022-05-06 18:44:37.931090: train loss: 0.00020838951933778213
Eval step 0: eval loss: 0.0001819717581383884
Eval: 2022-05-06 18:44:40.215987: total loss: 0.00018974879005049765, mse:0.0003794975742683999, ic :0.003170545106309987, sharpe5:-0.6451028313115239, irr5:-0.14490899443626404, ndcg5:0.8581007537425865, pnl5:0.9239506125450134 
train 11, step: 0, loss: 0.0003916225687135011, grad_norm: 9.76588590713828e-06, ic: 0.029341120870993668
train 11, step: 600, loss: 0.00027561309980228543, grad_norm: 6.943032764807254e-05, ic: 0.00988214563183916
Epoch 11: 2022-05-06 18:44:44.629550: train loss: 0.0002077795710454738
Eval step 0: eval loss: 0.00018793076742440462
Eval: 2022-05-06 18:44:46.858431: total loss: 0.0001891190300831745, mse:0.00037823805538416593, ic :0.002861944717854277, sharpe5:-0.899830338768661, irr5:-0.19536012411117554, ndcg5:0.8485204025161494, pnl5:0.974664032459259 
train 12, step: 0, loss: 0.0004460745258256793, grad_norm: 0.0005084285683051298, ic: 0.012882910760938029
train 12, step: 600, loss: 0.00024108772049658, grad_norm: 1.3683620040046525e-05, ic: 0.03639496710985662
Epoch 12: 2022-05-06 18:44:51.186387: train loss: 0.00020811101288722815
Eval step 0: eval loss: 0.00023125149891711771
Eval: 2022-05-06 18:44:53.539379: total loss: 0.00019131038055293482, mse:0.00038262075879284054, ic :-0.0002746271834051747, sharpe5:-0.8022314382344484, irr5:-0.17416414618492126, ndcg5:0.8543065335271967, pnl5:1.0278791189193726 
train 13, step: 0, loss: 0.0002465313591528684, grad_norm: 1.3249050173463822e-06, ic: 0.04517146547139325
train 13, step: 600, loss: 0.00040930838440544903, grad_norm: 0.00039373558538969406, ic: 0.10448476372408921
Epoch 13: 2022-05-06 18:44:57.776116: train loss: 0.00020721983842513932
Eval step 0: eval loss: 0.00022685556905344129
Eval: 2022-05-06 18:45:00.163727: total loss: 0.00019073637113097456, mse:0.0003814727399110049, ic :0.0025335830230963498, sharpe5:-0.7179402935877442, irr5:-0.15535619854927063, ndcg5:0.8472383118274167, pnl5:1.0428261756896973 
train 14, step: 0, loss: 8.126014290610328e-05, grad_norm: 1.4520183223582314e-05, ic: 0.09040184074861023
train 14, step: 600, loss: 0.00015314437041524798, grad_norm: 1.0725121187616838e-05, ic: 0.13887678956675992
Epoch 14: 2022-05-06 18:45:04.428500: train loss: 0.000207216881663887
Eval step 0: eval loss: 0.00017667838255874813
Eval: 2022-05-06 18:45:06.755444: total loss: 0.00019056661739788548, mse:0.00038113323306562764, ic :0.0016946423574554972, sharpe5:-0.7875588889047503, irr5:-0.17097380757331848, ndcg5:0.8584638031982871, pnl5:1.013002872467041 
train 15, step: 0, loss: 0.0002704785147216171, grad_norm: 9.888280337713373e-05, ic: -0.032577857745988884
train 15, step: 600, loss: 8.857469219947234e-05, grad_norm: 1.9974583178301165e-07, ic: 0.07101235251352325
Epoch 15: 2022-05-06 18:45:10.983846: train loss: 0.00020826635737221114
Eval step 0: eval loss: 0.0002261459594592452
Eval: 2022-05-06 18:45:13.266917: total loss: 0.00019066061876231796, mse:0.00038132123017965697, ic :0.0008596395155615928, sharpe5:-0.8022313791140914, irr5:-0.1741640865802765, ndcg5:0.8526137485054934, pnl5:1.0278791189193726 
train 16, step: 0, loss: 0.0001515942276455462, grad_norm: 9.153906405048912e-07, ic: 0.0673737006979105
train 16, step: 600, loss: 0.00024107092758640647, grad_norm: 0.00011720975252112015, ic: 0.040901143954838945
Epoch 16: 2022-05-06 18:45:17.693692: train loss: 0.0002074725843959454
Eval step 0: eval loss: 0.0001558717922307551
Eval: 2022-05-06 18:45:20.028791: total loss: 0.00019733051583713503, mse:0.0003946610287567854, ic :-0.00010357619367791692, sharpe5:-0.8090178048983215, irr5:-0.1756380796432495, ndcg5:0.8450837149051392, pnl5:1.0267258882522583 
train 17, step: 0, loss: 0.00022376750712282956, grad_norm: 0.00011341241666801196, ic: 0.06691933444490178
train 17, step: 600, loss: 0.00013480197230819613, grad_norm: 6.53795130022131e-06, ic: 0.05783120968709175
Epoch 17: 2022-05-06 18:45:24.324312: train loss: 0.00020796238841405693
Eval step 0: eval loss: 0.0001783054176485166
Eval: 2022-05-06 18:45:26.540043: total loss: 0.00019034755320517126, mse:0.0003806951042053983, ic :-8.59661529232251e-05, sharpe5:-0.7272609134763479, irr5:-0.15738984942436218, ndcg5:0.8605849929597893, pnl5:1.0411890745162964 
train 18, step: 0, loss: 0.0001551091409055516, grad_norm: 8.00337228768278e-06, ic: 0.07086723428324823
train 18, step: 600, loss: 0.00015270005678758025, grad_norm: 2.2816445120299214e-05, ic: 0.009335982450679143
Epoch 18: 2022-05-06 18:45:30.724763: train loss: 0.00020751462163136106
Eval step 0: eval loss: 0.00016567684360779822
Eval: 2022-05-06 18:45:33.007580: total loss: 0.00019309917211180388, mse:0.00038619834028195716, ic :0.00439742003810036, sharpe5:-0.8090178048983215, irr5:-0.1756380796432495, ndcg5:0.84970341702038, pnl5:1.0267258882522583 
train 19, step: 0, loss: 0.00018603737407829612, grad_norm: 0.0001833670497301271, ic: 0.02262479030495169
train 19, step: 600, loss: 0.00010363720502937213, grad_norm: 1.3272037705826508e-06, ic: 0.07061045374342398
Epoch 19: 2022-05-06 18:45:37.348533: train loss: 0.0002087068680013894
Eval step 0: eval loss: 0.00019668125605676323
Eval: 2022-05-06 18:45:39.600952: total loss: 0.00018873135550011747, mse:0.00037746270848547175, ic :-0.0005121395233661033, sharpe5:-0.710027802363038, irr5:-0.1536397635936737, ndcg5:0.8506857198503003, pnl5:1.0265928506851196 
train 20, step: 0, loss: 0.00016480109479743987, grad_norm: 8.839754513657823e-07, ic: -0.06803950033379165
train 20, step: 600, loss: 0.00043892516987398267, grad_norm: 0.00042216496827731005, ic: -0.0011149449475444488
Epoch 20: 2022-05-06 18:45:43.929483: train loss: 0.00020810817974015904
Eval step 0: eval loss: 0.00019421856268309057
Eval: 2022-05-06 18:45:46.232735: total loss: 0.0001887902196928843, mse:0.0003775804337379818, ic :0.0018288934454458664, sharpe5:-0.46830724641680715, irr5:-0.10200433433055878, ndcg5:0.8627633882460831, pnl5:1.003146767616272 
train 21, step: 0, loss: 0.00016553886234760284, grad_norm: 9.474243893710251e-05, ic: 0.011237191055191224
train 21, step: 600, loss: 0.0004552392347250134, grad_norm: 0.0003707292122767356, ic: 0.00847069625084327
Epoch 21: 2022-05-06 18:45:50.609749: train loss: 0.00020844381968417538
Eval step 0: eval loss: 0.0002003632253035903
Eval: 2022-05-06 18:45:52.890968: total loss: 0.00018870259851086057, mse:0.00037740519300204857, ic :0.0011213402673596175, sharpe5:-0.8115161720663309, irr5:-0.1761978268623352, ndcg5:0.8491117203121261, pnl5:1.0262885093688965 
train 22, step: 0, loss: 0.0002675324212759733, grad_norm: 0.00018420244342069267, ic: -0.11567870736268553
train 22, step: 600, loss: 0.00012369088653940707, grad_norm: 2.4247897335884668e-05, ic: 0.04623718242707469
Epoch 22: 2022-05-06 18:45:57.160168: train loss: 0.0002079087068517199
Eval step 0: eval loss: 0.00019921294006053358
Eval: 2022-05-06 18:45:59.495800: total loss: 0.00018870657497584836, mse:0.0003774131469757638, ic :0.002218155517420748, sharpe5:-0.8047306330874562, irr5:-0.17472389340400696, ndcg5:0.8463887173020479, pnl5:1.0274407863616943 
train 23, step: 0, loss: 0.00013310233771335334, grad_norm: 2.879072455109401e-05, ic: 0.038078809398492466
train 23, step: 600, loss: 0.0002248148957733065, grad_norm: 9.395321679894233e-06, ic: 0.041590058539271293
Epoch 23: 2022-05-06 18:46:04.046077: train loss: 0.00020804214056131017
Eval step 0: eval loss: 0.00024840261903591454
Eval: 2022-05-06 18:46:06.399873: total loss: 0.00019459479736431572, mse:0.00038918959032854816, ic :-0.0009062699182971855, sharpe5:-0.8047303966060281, irr5:-0.17472386360168457, ndcg5:0.8537904888438331, pnl5:1.0274409055709839 
train 24, step: 0, loss: 0.00014357762120198458, grad_norm: 4.987775837001158e-06, ic: 0.04340724956613516
train 24, step: 600, loss: 0.0002364828687859699, grad_norm: 6.88160753035073e-06, ic: -0.08062499454833302
Epoch 24: 2022-05-06 18:46:10.777311: train loss: 0.0002088540877762562
Eval step 0: eval loss: 0.00021815250511281192
Eval: 2022-05-06 18:46:13.088664: total loss: 0.00018972359991447914, mse:0.00037944719803566896, ic :-0.00021481949962613852, sharpe5:-0.8115160538256168, irr5:-0.17619779706001282, ndcg5:0.852662841382651, pnl5:1.0262885093688965 
train 25, step: 0, loss: 0.0001082759554265067, grad_norm: 1.0037876820561376e-05, ic: 0.05011362572068904
train 25, step: 600, loss: 0.0001362827606499195, grad_norm: 2.8510673401367893e-08, ic: 0.023884328575641923
Epoch 25: 2022-05-06 18:46:17.379553: train loss: 0.0002076397125303918
Eval step 0: eval loss: 0.00018284621182829142
Eval: 2022-05-06 18:46:19.693988: total loss: 0.00018968633088723252, mse:0.0003793726600871332, ic :0.003148422271213528, sharpe5:-0.7932797884941101, irr5:-0.1719742715358734, ndcg5:0.8537041352312773, pnl5:1.0288543701171875 
train 26, step: 0, loss: 0.0002366106928093359, grad_norm: 0.00022487598500893903, ic: -0.02493522522804347
train 26, step: 600, loss: 0.0002179826988140121, grad_norm: 0.0001539210699890254, ic: -0.05141052215140522
Epoch 26: 2022-05-06 18:46:23.901975: train loss: 0.00020801012691639253
Eval step 0: eval loss: 0.0001908022240968421
Eval: 2022-05-06 18:46:26.180789: total loss: 0.00018892520711233374, mse:0.000377850410665728, ic :0.004103156207186147, sharpe5:1.2124343700706959, irr5:0.35270145535469055, ndcg5:0.8496009091400742, pnl5:1.0376096963882446 
train 27, step: 0, loss: 0.0003804592997767031, grad_norm: 9.528573642859281e-05, ic: -0.09176552961038699
train 27, step: 600, loss: 0.00045980908907949924, grad_norm: 0.0006017436689267986, ic: -0.025665642163205295
Epoch 27: 2022-05-06 18:46:30.432860: train loss: 0.00020854812765352132
Eval step 0: eval loss: 0.00023781975323799998
Eval: 2022-05-06 18:46:32.690977: total loss: 0.00019258659702214666, mse:0.0003851731870960703, ic :0.0006991323770371157, sharpe5:-0.8115160538256168, irr5:-0.17619779706001282, ndcg5:0.8475873820543008, pnl5:1.0262885093688965 
train 28, step: 0, loss: 9.45069405133836e-05, grad_norm: 3.3193482978978614e-05, ic: 0.04171551656779756
train 28, step: 600, loss: 0.00011537862883415073, grad_norm: 3.1133328228819085e-05, ic: -0.0072838331402897485
Epoch 28: 2022-05-06 18:46:36.795846: train loss: 0.00020833662175265023
Eval step 0: eval loss: 0.00024727851268835366
Eval: 2022-05-06 18:46:38.926101: total loss: 0.00019440579819922154, mse:0.0003888115933170883, ic :0.0007515921650726783, sharpe5:-0.8115160538256168, irr5:-0.1761978268623352, ndcg5:0.8461233176534455, pnl5:1.0262885093688965 
train 29, step: 0, loss: 0.0002236825239378959, grad_norm: 4.450953877685209e-05, ic: 0.059398811139631504
train 29, step: 600, loss: 8.844071271596476e-05, grad_norm: 1.4555914802065832e-06, ic: 0.028411083546646503
Epoch 29: 2022-05-06 18:46:43.054498: train loss: 0.00020839601480197748
Eval step 0: eval loss: 0.0002525316085666418
Eval: 2022-05-06 18:46:45.290549: total loss: 0.00019552637684806172, mse:0.0003910527500409366, ic :-0.0006923599405340955, sharpe5:-0.7272609134763479, irr5:-0.15738987922668457, ndcg5:0.8509649608508791, pnl5:1.0411890745162964 
train 30, step: 0, loss: 0.0002766545512713492, grad_norm: 3.2849789474573257e-06, ic: 0.14687053133994746
train 30, step: 600, loss: 0.0005224054912105203, grad_norm: 0.0005608652823468965, ic: -0.05840095815165542
Epoch 30: 2022-05-06 18:46:49.544166: train loss: 0.00020851509381333884
Eval step 0: eval loss: 0.00021233022562228143
Eval: 2022-05-06 18:46:51.868130: total loss: 0.00018922896474655087, mse:0.00037845792483623555, ic :0.0010789209376586683, sharpe5:-0.8115161720663309, irr5:-0.17619779706001282, ndcg5:0.8574243409276842, pnl5:1.0262885093688965 
train 31, step: 0, loss: 0.0003088937664870173, grad_norm: 7.536117036247229e-07, ic: 0.07499499063549678
train 31, step: 600, loss: 0.0002837916254065931, grad_norm: 0.00017191465699794702, ic: 0.24462945273952325
Epoch 31: 2022-05-06 18:46:56.212248: train loss: 0.00020856012666651158
Eval step 0: eval loss: 0.0002483890566509217
Eval: 2022-05-06 18:46:58.462654: total loss: 0.0001947131040651584, mse:0.0003894262050370331, ic :0.0007972443832966065, sharpe5:-0.8115160538256168, irr5:-0.17619779706001282, ndcg5:0.845180765430261, pnl5:1.0262885093688965 
train 32, step: 0, loss: 0.00016504162340424955, grad_norm: 0.000126855932850626, ic: 0.05186740366763362
train 32, step: 600, loss: 0.0002146502520190552, grad_norm: 8.70907600083632e-05, ic: -0.022385850711321636
Epoch 32: 2022-05-06 18:47:02.442381: train loss: 0.00020841564742203752
Eval step 0: eval loss: 0.00020326086087152362
Eval: 2022-05-06 18:47:04.515901: total loss: 0.00018883118900703266, mse:0.0003776623741834232, ic :0.003286425787677999, sharpe5:-0.832835800498724, irr5:-0.18065506219863892, ndcg5:0.8362054601518563, pnl5:1.0220859050750732 
train 33, step: 0, loss: 0.0001862222416093573, grad_norm: 9.793068783590715e-05, ic: 0.026923434322418248
train 33, step: 600, loss: 0.00018612654821481556, grad_norm: 9.618922606937947e-05, ic: 0.07051868124301103
Epoch 33: 2022-05-06 18:47:08.486519: train loss: 0.00020805450639820855
Eval step 0: eval loss: 0.0002144653699360788
Eval: 2022-05-06 18:47:10.623489: total loss: 0.0001894191304079683, mse:0.0003788382579827371, ic :0.0014421320259135392, sharpe5:-0.8396279609575867, irr5:-0.18212896585464478, ndcg5:0.8378345565099093, pnl5:1.0209397077560425 
train 34, step: 0, loss: 0.00011029551387764513, grad_norm: 2.477251813706099e-07, ic: 0.008013669553425286
train 34, step: 600, loss: 8.93108663149178e-05, grad_norm: 3.3493684559477597e-06, ic: 0.02237568397364587
Epoch 34: 2022-05-06 18:47:14.447778: train loss: 0.00020851605519380987
Eval step 0: eval loss: 0.00020763723296113312
Eval: 2022-05-06 18:47:16.474079: total loss: 0.00018891078246470295, mse:0.0003778215638885076, ic :0.0003746136955956017, sharpe5:-0.8139627498015761, irr5:-0.17658579349517822, ndcg5:0.8661981885953648, pnl5:1.0077846050262451 
train 35, step: 0, loss: 0.00020933779887855053, grad_norm: 9.045900729930687e-05, ic: -0.019379395134984788
train 35, step: 600, loss: 8.5075618699193e-05, grad_norm: 4.3213836832622506e-05, ic: 0.020067057630340016
Epoch 35: 2022-05-06 18:47:20.248147: train loss: 0.00020792205151211354
Eval step 0: eval loss: 0.00022242743580136448
Eval: 2022-05-06 18:47:22.289039: total loss: 0.00019023972912444892, mse:0.00038047945009908986, ic :0.0020618833828761826, sharpe5:-0.8977646143734455, irr5:-0.19539374113082886, ndcg5:0.8738583708398042, pnl5:0.9934940338134766 
train 36, step: 0, loss: 0.0001669861376285553, grad_norm: 0.00010164182050381429, ic: -0.134280863761553
train 36, step: 600, loss: 0.0008922858396545053, grad_norm: 0.0009699429796218547, ic: -0.04372270935965317
Epoch 36: 2022-05-06 18:47:26.013604: train loss: 0.00020860585248477862
Eval step 0: eval loss: 0.00024106806085910648
Eval: 2022-05-06 18:47:28.075152: total loss: 0.0001931797708848381, mse:0.0003863595415929293, ic :0.0008711988829949992, sharpe5:-0.8740398515760898, irr5:-0.19008517265319824, ndcg5:0.8487394513364814, pnl5:0.997486412525177 
train 37, step: 0, loss: 0.0002942834107670933, grad_norm: 4.760928160387223e-05, ic: 0.10658743298750156
train 37, step: 600, loss: 0.0002383140381425619, grad_norm: 2.22531129476769e-05, ic: 0.03435971020671097
Epoch 37: 2022-05-06 18:47:31.957585: train loss: 0.00020765667660385432
Eval step 0: eval loss: 0.0002056012162938714
Eval: 2022-05-06 18:47:34.022115: total loss: 0.00018883827745458663, mse:0.00037767655251345027, ic :0.0009580209094726211, sharpe5:-0.8229533007368445, irr5:-0.17845448851585388, ndcg5:0.8492388502117447, pnl5:1.0063464641571045 
train 38, step: 0, loss: 0.00020979245891794562, grad_norm: 0.00010737323285773771, ic: 0.06560821077352506
train 38, step: 600, loss: 0.0003325620200484991, grad_norm: 7.663664223457557e-05, ic: 0.20054325658619468
Epoch 38: 2022-05-06 18:47:37.823443: train loss: 0.00020788770714186484
Eval step 0: eval loss: 0.00027281552320346236
Eval: 2022-05-06 18:47:39.959456: total loss: 0.00020074518505356598, mse:0.0004014903629620578, ic :0.0015506710366327153, sharpe5:-0.7313194077461957, irr5:-0.15809708833694458, ndcg5:0.8459967645726975, pnl5:1.0224106311798096 
train 39, step: 0, loss: 0.00019169870938640088, grad_norm: 0.00016493065297077886, ic: -0.04788815056914043
train 39, step: 600, loss: 0.00017275880964007229, grad_norm: 8.479775806277326e-05, ic: 0.024320075960274988
Epoch 39: 2022-05-06 18:47:43.808243: train loss: 0.00020821966099420205
Eval step 0: eval loss: 0.00017368976841680706
Eval: 2022-05-06 18:47:45.858049: total loss: 0.00019107169818953943, mse:0.0003821433897323359, ic :0.004552795396345091, sharpe5:-0.9061444520205258, irr5:-0.19815275073051453, ndcg5:0.8591422593357856, pnl5:0.9742124676704407 
