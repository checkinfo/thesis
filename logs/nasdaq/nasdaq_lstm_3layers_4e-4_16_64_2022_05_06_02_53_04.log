Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=60, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=64, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.0004, lstm_layers=3, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='BaseLSTM', normalize_adj=True, num_days=16, num_heads=1, print_inteval=600, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
59784
BaseLSTM(
  (rnn1): LSTM(5, 64, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=128, out_features=64, bias=True)
  (predict): Linear(in_features=64, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.0004546617856249213, grad_norm: 0.00045413900630869846, ic: -0.0036837599786770894
train 0, step: 600, loss: 0.00013626391591969877, grad_norm: 5.270637434170616e-07, ic: 0.058516977693107014
Epoch 0: 2022-05-06 14:54:34.584784: train loss: 0.00024243278776584949
Eval step 0: eval loss: 0.00028935514274053276
Eval: 2022-05-06 14:54:37.263702: total loss: 0.00023031812916458183, mse:0.00046063625473532544, ic :0.02280707363978825, sharpe5:-1.0313558109104632, irr5:-0.2200428992509842, ndcg5:0.8446286814001255, pnl5:1.043683409690857 
train 1, step: 0, loss: 0.00036412273766472936, grad_norm: 0.00039728160672879116, ic: -0.025882417720388268
train 1, step: 600, loss: 0.00011962056305492297, grad_norm: 1.0307862676680531e-05, ic: -0.005704745939059182
Epoch 1: 2022-05-06 14:54:48.988149: train loss: 0.0002216412193307848
Eval step 0: eval loss: 0.00018793344497680664
Eval: 2022-05-06 14:54:51.555652: total loss: 0.0001903874742323364, mse:0.00038077494362778893, ic :0.022726195554297644, sharpe5:-1.0376781418919563, irr5:-0.2209189534187317, ndcg5:0.8542298343577874, pnl5:1.0232715606689453 
train 2, step: 0, loss: 0.0002831966558005661, grad_norm: 0.0001573474077642634, ic: 0.010348604440708467
train 2, step: 600, loss: 0.00028689720784313977, grad_norm: 0.00013883284444587653, ic: -0.03653046218758723
Epoch 2: 2022-05-06 14:55:03.333354: train loss: 0.00021800085526813966
Eval step 0: eval loss: 0.00018549792002886534
Eval: 2022-05-06 14:55:05.921894: total loss: 0.0001912632008197473, mse:0.00038252639645153393, ic :0.023036703054684846, sharpe5:-1.04163956053555, irr5:-0.22153031826019287, ndcg5:0.8534576686718781, pnl5:1.041863203048706 
train 3, step: 0, loss: 0.00018399441614747047, grad_norm: 0.00010918865000374244, ic: 0.05138482320709627
train 3, step: 600, loss: 0.00017944007413461804, grad_norm: 0.00014812990064253268, ic: 0.024342704672560618
Epoch 3: 2022-05-06 14:55:17.588040: train loss: 0.00021384825527461911
Eval step 0: eval loss: 0.0001801259641069919
Eval: 2022-05-06 14:55:20.230138: total loss: 0.0001973346887065237, mse:0.00039466937391608955, ic :0.020338913350714964, sharpe5:-0.9383352499455213, irr5:-0.2004438042640686, ndcg5:0.8531321125571524, pnl5:1.022493839263916 
train 4, step: 0, loss: 0.00021407779422588646, grad_norm: 2.936791547667624e-06, ic: 0.018579355279805882
train 4, step: 600, loss: 0.00037589468411169946, grad_norm: 0.00040322137843981973, ic: -0.02461218023111042
Epoch 4: 2022-05-06 14:55:32.139546: train loss: 0.00021241296132290232
Eval step 0: eval loss: 0.00018712766177486628
Eval: 2022-05-06 14:55:34.748710: total loss: 0.0001904113527729252, mse:0.0003808226991766729, ic :0.02295678590782522, sharpe5:-1.0082644636183977, irr5:-0.21447229385375977, ndcg5:0.8486140729123903, pnl5:1.0105594396591187 
train 5, step: 0, loss: 0.0006001055589877069, grad_norm: 5.479969120502268e-05, ic: -0.05246609665629067
train 5, step: 600, loss: 0.00016197231889236718, grad_norm: 1.2305056809827113e-05, ic: -0.029559017666642026
Epoch 5: 2022-05-06 14:55:46.293112: train loss: 0.0002094757549678655
Eval step 0: eval loss: 0.0001931812148541212
Eval: 2022-05-06 14:55:48.945750: total loss: 0.0001893249976491383, mse:0.0003786499920138437, ic :-0.002378991407731862, sharpe5:-1.0531332673877478, irr5:-0.22398430109024048, ndcg5:0.8454816666516171, pnl5:1.0399057865142822 
train 6, step: 0, loss: 0.0001634415239095688, grad_norm: 8.578760438128692e-06, ic: 0.017237155697650414
train 6, step: 600, loss: 0.00017494986241217703, grad_norm: 6.479216122701853e-07, ic: 0.026591243801535304
Epoch 6: 2022-05-06 14:56:00.468402: train loss: 0.00020973953728940073
Eval step 0: eval loss: 0.00018630737031344324
Eval: 2022-05-06 14:56:03.189129: total loss: 0.00019088986504752381, mse:0.00038177972848251927, ic :0.019989621365172933, sharpe5:-1.0556216432154177, irr5:-0.2247077226638794, ndcg5:0.8461017961136887, pnl5:1.0209662914276123 
train 7, step: 0, loss: 0.0002022005064645782, grad_norm: 2.7178276499101297e-07, ic: 0.017955226732618505
train 7, step: 600, loss: 0.000223603579797782, grad_norm: 0.00011678497146635774, ic: 0.0016988228032214035
Epoch 7: 2022-05-06 14:56:14.910533: train loss: 0.00020858537825276741
Eval step 0: eval loss: 0.00018801695841830224
Eval: 2022-05-06 14:56:17.573368: total loss: 0.00019013413022787466, mse:0.0003802682591070825, ic :0.018094550228012055, sharpe5:-1.0082642271369695, irr5:-0.21447229385375977, ndcg5:0.8592825460839939, pnl5:1.0105594396591187 
train 8, step: 0, loss: 8.684799104230478e-05, grad_norm: 1.6401207495091453e-07, ic: 0.04638958188229889
train 8, step: 600, loss: 0.0002576763217803091, grad_norm: 0.00013714204241185277, ic: 0.03587273349419685
Epoch 8: 2022-05-06 14:56:29.244190: train loss: 0.00020822295136403645
Eval step 0: eval loss: 0.00019459176110103726
Eval: 2022-05-06 14:56:31.862329: total loss: 0.00018923435557993947, mse:0.0003784687118243172, ic :0.020648896655870146, sharpe5:-1.0276092356443405, irr5:-0.21855223178863525, ndcg5:0.846716725999077, pnl5:1.0254976749420166 
train 9, step: 0, loss: 8.701525803189725e-05, grad_norm: 7.702725126215558e-07, ic: 0.06103501734529593
train 9, step: 600, loss: 0.0002488539321348071, grad_norm: 0.00019290269722839078, ic: 0.012792259758475644
Epoch 9: 2022-05-06 14:56:43.513141: train loss: 0.0002087527817599727
Eval step 0: eval loss: 0.00018688729323912412
Eval: 2022-05-06 14:56:46.149016: total loss: 0.00019056516651688903, mse:0.00038113032875487015, ic :0.020909481615141366, sharpe5:-1.022291123047471, irr5:-0.21745038032531738, ndcg5:0.8478149767498391, pnl5:1.0266531705856323 
train 10, step: 0, loss: 0.00011936879309359938, grad_norm: 2.9094029697789107e-07, ic: 0.04874845774230171
train 10, step: 600, loss: 0.00010598522203508765, grad_norm: 6.2642213615353206e-06, ic: 0.06178306415255401
Epoch 10: 2022-05-06 14:56:57.733394: train loss: 0.0002081335806685053
Eval step 0: eval loss: 0.00018949453078676015
Eval: 2022-05-06 14:57:00.455992: total loss: 0.0001898185372783495, mse:0.00037963706949839564, ic :0.020739791783487102, sharpe5:-1.026000688970089, irr5:-0.21823924779891968, ndcg5:0.8514918922153714, pnl5:1.0260318517684937 
train 11, step: 0, loss: 0.00017695309361442924, grad_norm: 4.3619651275056905e-05, ic: 0.026367183653882853
train 11, step: 600, loss: 0.00021373316121753305, grad_norm: 2.5801527497136997e-06, ic: 0.07340888605630955
Epoch 11: 2022-05-06 14:57:11.970450: train loss: 0.00020790822470459987
Eval step 0: eval loss: 0.00019907570094801486
Eval: 2022-05-06 14:57:14.579809: total loss: 0.0001894146053800549, mse:0.0003788292077542232, ic :0.020527193139250683, sharpe5:-1.0082645818591118, irr5:-0.21447232365608215, ndcg5:0.8570453509918793, pnl5:1.0105594396591187 
train 12, step: 0, loss: 0.00014796423783991486, grad_norm: 1.383732615060419e-06, ic: 0.0936548061340696
train 12, step: 600, loss: 0.00017314714204985648, grad_norm: 7.73171400749392e-05, ic: -0.0011748269900026158
Epoch 12: 2022-05-06 14:57:26.172934: train loss: 0.00020783767931051615
Eval step 0: eval loss: 0.00021246072719804943
Eval: 2022-05-06 14:57:28.790780: total loss: 0.00019206777120844517, mse:0.00038413554027838775, ic :0.01901099311495663, sharpe5:-1.0276094721257687, irr5:-0.21855223178863525, ndcg5:0.8543474726129654, pnl5:1.025497555732727 
train 13, step: 0, loss: 0.00014680714230053127, grad_norm: 1.4228972508581333e-05, ic: 0.08028015408355188
train 13, step: 600, loss: 0.000168005601153709, grad_norm: 1.793733598962136e-05, ic: 0.060514848134960934
Epoch 13: 2022-05-06 14:57:40.429521: train loss: 0.0002075528075520934
Eval step 0: eval loss: 0.00019801905727945268
Eval: 2022-05-06 14:57:42.964669: total loss: 0.0001893302902992292, mse:0.00037866057809839707, ic :0.025141265977588773, sharpe5:-1.0276092356443405, irr5:-0.21855223178863525, ndcg5:0.8484964492727426, pnl5:1.025497555732727 
train 14, step: 0, loss: 0.0002444818092044443, grad_norm: 0.00015771875830188499, ic: -0.04550601164359255
train 14, step: 600, loss: 0.00016839102318044752, grad_norm: 0.00010042214274596577, ic: 0.12237485299759285
Epoch 14: 2022-05-06 14:57:54.503362: train loss: 0.00020778282115635512
Eval step 0: eval loss: 0.0002015444333665073
Eval: 2022-05-06 14:57:57.078805: total loss: 0.0001897859913602522, mse:0.0003795719789991993, ic :0.014951181424173463, sharpe5:-1.0531332673877478, irr5:-0.22398436069488525, ndcg5:0.8480296993498423, pnl5:1.0399057865142822 
train 15, step: 0, loss: 0.0006164554506540298, grad_norm: 9.59306351696324e-05, ic: 0.09521481800604578
train 15, step: 600, loss: 0.00010864618525374681, grad_norm: 2.700483699639975e-07, ic: 0.15455679458155908
Epoch 15: 2022-05-06 14:58:08.530074: train loss: 0.00020759391349251067
Eval step 0: eval loss: 0.00018502530292607844
Eval: 2022-05-06 14:58:10.830674: total loss: 0.00019122815348668345, mse:0.0003824563063610281, ic :0.022178775445562095, sharpe5:-1.0556216432154177, irr5:-0.22470766305923462, ndcg5:0.8586419244402628, pnl5:1.0209662914276123 
train 16, step: 0, loss: 0.00026811918360181153, grad_norm: 0.0001910494204548811, ic: 0.07302171050056036
train 16, step: 600, loss: 0.00014281539188232273, grad_norm: 1.635587436383305e-05, ic: 0.05401984801072881
Epoch 16: 2022-05-06 14:58:21.693349: train loss: 0.00020784632736625075
Eval step 0: eval loss: 0.00018170633120462298
Eval: 2022-05-06 14:58:24.290303: total loss: 0.0001956227526402657, mse:0.0003912455007020926, ic :0.022722234817289647, sharpe5:-1.0531331491470337, irr5:-0.22398436069488525, ndcg5:0.8563732567366525, pnl5:1.0399057865142822 
train 17, step: 0, loss: 0.0002486133307684213, grad_norm: 2.6196698664658193e-06, ic: -0.0067040664460531925
train 17, step: 600, loss: 0.00017524855502415448, grad_norm: 8.52084214804304e-06, ic: 0.04464895621797059
Epoch 17: 2022-05-06 14:58:35.819381: train loss: 0.00020823578688577982
Eval step 0: eval loss: 0.00020290527027100325
Eval: 2022-05-06 14:58:38.159569: total loss: 0.00019005559887489456, mse:0.0003801111947859775, ic :0.02267245653965, sharpe5:-1.022291123047471, irr5:-0.21745038032531738, ndcg5:0.8478906370153733, pnl5:1.0266531705856323 
train 18, step: 0, loss: 0.00019514358427841216, grad_norm: 0.0002028797853914, ic: -0.04757591138353555
train 18, step: 600, loss: 0.00011894973431481048, grad_norm: 8.518612111809141e-06, ic: -0.04369291785322828
Epoch 18: 2022-05-06 14:58:49.343657: train loss: 0.00020787989450016882
Eval step 0: eval loss: 0.0002046813751803711
Eval: 2022-05-06 14:58:51.967899: total loss: 0.00019040529331591663, mse:0.00038081058204215637, ic :0.01973280315771903, sharpe5:-1.0556217614561318, irr5:-0.22470766305923462, ndcg5:0.869333033033616, pnl5:1.0209662914276123 
train 19, step: 0, loss: 0.00017687139916233718, grad_norm: 8.917839376406636e-05, ic: -0.03431895390189632
train 19, step: 600, loss: 0.00029013631865382195, grad_norm: 0.00011996344389701072, ic: 0.06219920715559266
Epoch 19: 2022-05-06 14:59:03.636933: train loss: 0.00020806964744347293
Eval step 0: eval loss: 0.0001899941562442109
Eval: 2022-05-06 14:59:06.332203: total loss: 0.00018977841346685847, mse:0.00037955682616365455, ic :0.02626437268510696, sharpe5:-1.0798248079419135, irr5:-0.22986793518066406, ndcg5:0.840937208509688, pnl5:1.016615629196167 
train 20, step: 0, loss: 0.00047890402493067086, grad_norm: 0.000599331782373655, ic: -0.0931484772607276
train 20, step: 600, loss: 0.00013163922994863242, grad_norm: 2.2646115500835678e-05, ic: -0.0992446478679101
Epoch 20: 2022-05-06 14:59:17.764726: train loss: 0.00020779649402774756
Eval step 0: eval loss: 0.0001959449000423774
Eval: 2022-05-06 14:59:20.335355: total loss: 0.00018922407211676847, mse:0.00037844813897598234, ic :0.02151420703016987, sharpe5:-1.0556216432154177, irr5:-0.22470766305923462, ndcg5:0.8607964259835055, pnl5:1.0209662914276123 
train 21, step: 0, loss: 0.00023038595099933445, grad_norm: 0.0001670543895673365, ic: 0.03011321583360903
train 21, step: 600, loss: 0.00010258414113195613, grad_norm: 3.1914373256389135e-07, ic: -0.007422687914292039
Epoch 21: 2022-05-06 14:59:31.894960: train loss: 0.000208070281857815
Eval step 0: eval loss: 0.00020715995924547315
Eval: 2022-05-06 14:59:34.402056: total loss: 0.000191017319281044, mse:0.00038203463506871366, ic :0.025804143965480406, sharpe5:-1.0548212718218564, irr5:-0.22452253103256226, ndcg5:0.8562554780301735, pnl5:1.0023852586746216 
train 22, step: 0, loss: 0.00012811139458790421, grad_norm: 1.3847359834261385e-05, ic: 0.00010395686881740918
train 22, step: 600, loss: 0.00017178802227135748, grad_norm: 3.29979869807728e-05, ic: 0.0021466359191765487
Epoch 22: 2022-05-06 14:59:46.148355: train loss: 0.00020728543059777695
Eval step 0: eval loss: 0.0001835807488532737
Eval: 2022-05-06 14:59:48.749303: total loss: 0.00019234336472913934, mse:0.0003846867235075424, ic :0.026279789738467858, sharpe5:-1.0228250981122256, irr5:-0.21795427799224854, ndcg5:0.8509996165102095, pnl5:1.0086116790771484 
train 23, step: 0, loss: 0.0001897651527542621, grad_norm: 6.1259244413173215e-06, ic: 0.007141476843265885
train 23, step: 600, loss: 0.00011829374125227332, grad_norm: 6.210018820893286e-05, ic: -0.08472694646178165
Epoch 23: 2022-05-06 15:00:00.491143: train loss: 0.00020796055787532415
Eval step 0: eval loss: 0.0002058103127637878
Eval: 2022-05-06 15:00:03.233752: total loss: 0.00019070816743061182, mse:0.00038141632946930767, ic :0.008262812599009765, sharpe5:-1.0228249798715114, irr5:-0.2179543375968933, ndcg5:0.8509124396803716, pnl5:1.0086116790771484 
train 24, step: 0, loss: 0.0004121259262319654, grad_norm: 0.00014135715688272537, ic: 0.0184769176795351
train 24, step: 600, loss: 0.00016686134040355682, grad_norm: 7.249071029909215e-05, ic: -0.01770390884765108
Epoch 24: 2022-05-06 15:00:14.659969: train loss: 0.0002078565246257632
Eval step 0: eval loss: 0.00018953178368974477
Eval: 2022-05-06 15:00:17.282646: total loss: 0.00018973399404192983, mse:0.00037946798545733095, ic :0.026723345210170505, sharpe5:-1.0255848363786935, irr5:-0.21854639053344727, ndcg5:0.8547019197445043, pnl5:1.0081558227539062 
train 25, step: 0, loss: 0.00010602879774523899, grad_norm: 3.2337538659218106e-05, ic: 0.03812083417296386
train 25, step: 600, loss: 0.0001244661252712831, grad_norm: 2.5626750127044036e-05, ic: 0.0624130714808386
Epoch 25: 2022-05-06 15:00:28.716390: train loss: 0.00020818124235980528
Eval step 0: eval loss: 0.00018144134082831442
Eval: 2022-05-06 15:00:31.267671: total loss: 0.00019550445406356346, mse:0.0003910089059774195, ic :0.02829635130899035, sharpe5:-1.0255848363786935, irr5:-0.21854639053344727, ndcg5:0.8506926958837814, pnl5:1.0081560611724854 
train 26, step: 0, loss: 0.0002384846011409536, grad_norm: 0.00023937205487312998, ic: 0.18478602657768795
train 26, step: 600, loss: 0.00017677107825875282, grad_norm: 2.898455244975432e-05, ic: -0.045603675777400876
Epoch 26: 2022-05-06 15:00:43.040201: train loss: 0.00020832705368603285
Eval step 0: eval loss: 0.00018884966266341507
Eval: 2022-05-06 15:00:45.742995: total loss: 0.0001899097506254511, mse:0.00037981949710246335, ic :0.024104306311711485, sharpe5:-1.0255849546194076, irr5:-0.21854639053344727, ndcg5:0.8490757103281921, pnl5:1.0081560611724854 
train 27, step: 0, loss: 0.0002544952731113881, grad_norm: 0.00017490385861860733, ic: 0.037628131977612264
train 27, step: 600, loss: 9.73945134319365e-05, grad_norm: 2.987355041345258e-06, ic: 0.0009546305955290824
Epoch 27: 2022-05-06 15:00:57.247348: train loss: 0.00020777210159615827
Eval step 0: eval loss: 0.00019913529104087502
Eval: 2022-05-06 15:00:59.847701: total loss: 0.00018951760432988455, mse:0.00037903520344647506, ic :0.016520983599515957, sharpe5:-1.0255849546194076, irr5:-0.2185463309288025, ndcg5:0.8620166251458724, pnl5:1.0081560611724854 
train 28, step: 0, loss: 0.00011767000978579745, grad_norm: 1.2585003723019222e-05, ic: 0.044975904574317147
train 28, step: 600, loss: 0.00014008028665557504, grad_norm: 3.8763509217267975e-06, ic: -0.008570720295160882
Epoch 28: 2022-05-06 15:01:11.284224: train loss: 0.00020778507533651536
Eval step 0: eval loss: 0.00019143758981954306
Eval: 2022-05-06 15:01:14.034269: total loss: 0.00018966687073203108, mse:0.0003793337355357887, ic :0.026598580607173784, sharpe5:-1.0255849546194076, irr5:-0.2185463309288025, ndcg5:0.8506505095216732, pnl5:1.0081558227539062 
train 29, step: 0, loss: 0.00012190098641440272, grad_norm: 1.2286508736007587e-05, ic: 0.04219430438411879
train 29, step: 600, loss: 0.0003230264992453158, grad_norm: 0.00012948346398779229, ic: 0.1037975636217372
Epoch 29: 2022-05-06 15:01:25.494195: train loss: 0.00020776874316652538
Eval step 0: eval loss: 0.00019641290418803692
Eval: 2022-05-06 15:01:28.054787: total loss: 0.0001892059327264388, mse:0.00037841186089241307, ic :0.0262734769765683, sharpe5:-0.9661647391319275, irr5:-0.2062327265739441, ndcg5:0.8422856822849112, pnl5:1.0008094310760498 
train 30, step: 0, loss: 0.00017359464254695922, grad_norm: 5.746124019381589e-05, ic: 0.017161717767949957
train 30, step: 600, loss: 0.00022818634170107543, grad_norm: 5.085726020254342e-06, ic: 0.09542521391408212
Epoch 30: 2022-05-06 15:01:39.634035: train loss: 0.0002079051422451566
Eval step 0: eval loss: 0.00019504142983350903
Eval: 2022-05-06 15:01:42.206739: total loss: 0.00018917302027786134, mse:0.0003783460386762606, ic :0.02680722598874697, sharpe5:-0.9846341160312294, irr5:-0.2101602852344513, ndcg5:0.8588890964856778, pnl5:1.0159010887145996 
train 31, step: 0, loss: 0.00015429520863108337, grad_norm: 4.4081637916068595e-05, ic: 0.08549215352723022
train 31, step: 600, loss: 0.0001814224960980937, grad_norm: 7.720708490293738e-06, ic: 0.09051945303506354
Epoch 31: 2022-05-06 15:01:53.629815: train loss: 0.00020778612633876037
Eval step 0: eval loss: 0.0001974362094188109
Eval: 2022-05-06 15:01:56.204704: total loss: 0.00018923694522823817, mse:0.0003784738867336588, ic :0.025997688777947028, sharpe5:-1.0307209765166043, irr5:-0.2200087308883667, ndcg5:0.8524078501651451, pnl5:1.0078465938568115 
train 32, step: 0, loss: 0.00015534991689492017, grad_norm: 1.0274085488502479e-05, ic: 0.01520235475943512
train 32, step: 600, loss: 0.0001692908990662545, grad_norm: 2.7907849441179863e-05, ic: -0.011997742466736318
Epoch 32: 2022-05-06 15:02:07.724923: train loss: 0.000207888355308151
Eval step 0: eval loss: 0.0001814915449358523
Eval: 2022-05-06 15:02:10.284192: total loss: 0.00019474095125378182, mse:0.00038948190023250736, ic :0.028382434852746427, sharpe5:-1.0307212129980325, irr5:-0.2200087308883667, ndcg5:0.849263471391353, pnl5:1.0078465938568115 
train 33, step: 0, loss: 0.00017279158055316657, grad_norm: 1.0653462028686407e-05, ic: 0.08508738968740512
train 33, step: 600, loss: 9.644984675105661e-05, grad_norm: 1.9356661707461932e-05, ic: 0.00099666163073708
Epoch 33: 2022-05-06 15:02:21.671887: train loss: 0.0002083851666955869
Eval step 0: eval loss: 0.0001993292389670387
Eval: 2022-05-06 15:02:24.221645: total loss: 0.00018955549287501242, mse:0.00037911097955162644, ic :0.01676726882683519, sharpe5:-1.037765167057514, irr5:-0.22156310081481934, ndcg5:0.8491029637093098, pnl5:1.0066583156585693 
train 34, step: 0, loss: 0.00013488771219272166, grad_norm: 3.239261160466219e-05, ic: -0.0017373548421188868
train 34, step: 600, loss: 0.00014842330710962415, grad_norm: 0.00013463877077367155, ic: 0.05580737698048155
Epoch 34: 2022-05-06 15:02:35.663197: train loss: 0.00020758287951753732
Eval step 0: eval loss: 0.00019973464077338576
Eval: 2022-05-06 15:02:38.261454: total loss: 0.00018949826572346395, mse:0.00037899653185949393, ic :0.021183873618430767, sharpe5:-1.0669528873264789, irr5:-0.2286320924758911, ndcg5:0.8553489225699618, pnl5:1.0201313495635986 
train 35, step: 0, loss: 8.891178003977984e-05, grad_norm: 1.2942743324803113e-05, ic: 0.11791361451430152
train 35, step: 600, loss: 0.00023812937433831394, grad_norm: 2.0248203206703648e-05, ic: 0.07870658011745976
Epoch 35: 2022-05-06 15:02:49.959301: train loss: 0.00020794743007148075
Eval step 0: eval loss: 0.0001881348725873977
Eval: 2022-05-06 15:02:52.521063: total loss: 0.00019025328684080923, mse:0.000380506570540057, ic :0.0274553239068565, sharpe5:-1.066953123807907, irr5:-0.2286321520805359, ndcg5:0.8525783789230271, pnl5:1.0201313495635986 
train 36, step: 0, loss: 8.518188406014815e-05, grad_norm: 1.2390190648032414e-05, ic: 0.0860792877831482
train 36, step: 600, loss: 0.00010809017840074375, grad_norm: 1.113291274728205e-05, ic: 0.006946597623487934
Epoch 36: 2022-05-06 15:03:04.212025: train loss: 0.00020767028778405998
Eval step 0: eval loss: 0.000188069578143768
Eval: 2022-05-06 15:03:06.834617: total loss: 0.00019009028046762747, mse:0.00038018055932345076, ic :0.027513520720136495, sharpe5:-1.066953005567193, irr5:-0.22863204777240753, ndcg5:0.8637360772160443, pnl5:1.0201313495635986 
train 37, step: 0, loss: 0.00021571807155851275, grad_norm: 0.00010849075909556877, ic: 0.08135794386738746
train 37, step: 600, loss: 0.0001167872833320871, grad_norm: 3.4826398196541682e-06, ic: 0.04118989586021572
Epoch 37: 2022-05-06 15:03:18.471823: train loss: 0.00020798714589595013
Eval step 0: eval loss: 0.0001907466066768393
Eval: 2022-05-06 15:03:21.112879: total loss: 0.0001896313435479164, mse:0.00037926268512818357, ic :0.026236387202705505, sharpe5:-1.0669528873264789, irr5:-0.22863203287124634, ndcg5:0.8535086983480705, pnl5:1.0201313495635986 
train 38, step: 0, loss: 0.00032325953361578286, grad_norm: 2.865303486125545e-06, ic: 0.07872679511367225
train 38, step: 600, loss: 0.0003988250100519508, grad_norm: 0.00041744705693669515, ic: 0.0063173115839498355
Epoch 38: 2022-05-06 15:03:32.908725: train loss: 0.0002077097304159857
Eval step 0: eval loss: 0.00019054640142712742
Eval: 2022-05-06 15:03:35.484110: total loss: 0.00018972810509254337, mse:0.00037945620728827896, ic :0.0294460859440346, sharpe5:-1.066953005567193, irr5:-0.22863203287124634, ndcg5:0.8490689879312443, pnl5:1.0201313495635986 
train 39, step: 0, loss: 0.00013975219917483628, grad_norm: 1.312850472862992e-07, ic: 0.08259229809536217
train 39, step: 600, loss: 0.00024667748948559165, grad_norm: 2.8455410529894712e-06, ic: 0.022128446377078625
Epoch 39: 2022-05-06 15:03:47.118987: train loss: 0.00020728530726537922
Eval step 0: eval loss: 0.0001896703033708036
Eval: 2022-05-06 15:03:49.678654: total loss: 0.00018990878081602376, mse:0.0003798175565023817, ic :0.02386512126692298, sharpe5:-1.0669527690857648, irr5:-0.22863203287124634, ndcg5:0.8440397918673967, pnl5:1.0201313495635986 
train 40, step: 0, loss: 0.00017473888874519616, grad_norm: 3.23130598649144e-05, ic: 0.08164869434092673
train 40, step: 600, loss: 0.0002625551132950932, grad_norm: 0.00016346553511607594, ic: 0.027643236070393422
Epoch 40: 2022-05-06 15:04:01.499710: train loss: 0.00020775996026468175
Eval step 0: eval loss: 0.0001953754690475762
Eval: 2022-05-06 15:04:04.090042: total loss: 0.0001892344392040677, mse:0.0003784688728900533, ic :0.01965956719852221, sharpe5:-1.066953005567193, irr5:-0.22863203287124634, ndcg5:0.8612458920942526, pnl5:1.0201313495635986 
train 41, step: 0, loss: 0.0004096170305274427, grad_norm: 0.00021816434924343104, ic: 0.127189783589924
train 41, step: 600, loss: 0.0001315255940426141, grad_norm: 1.7335609129101052e-07, ic: 0.13712898153590522
Epoch 41: 2022-05-06 15:04:15.763378: train loss: 0.00020802468678428684
Eval step 0: eval loss: 0.00020653422689065337
Eval: 2022-05-06 15:04:18.364838: total loss: 0.00019069932197321763, mse:0.0003813986380629485, ic :0.017383422341186637, sharpe5:-1.0669528873264789, irr5:-0.2286320924758911, ndcg5:0.8551648615594982, pnl5:1.020131230354309 
train 42, step: 0, loss: 0.00038416250026784837, grad_norm: 0.00013337630943563493, ic: 0.0700229279737044
train 42, step: 600, loss: 0.00020468016737140715, grad_norm: 3.5932291791054746e-05, ic: 0.012700674889012852
Epoch 42: 2022-05-06 15:04:29.890587: train loss: 0.00020805295708497225
Eval step 0: eval loss: 0.00020348047837615013
Eval: 2022-05-06 15:04:32.554512: total loss: 0.00019014906737378195, mse:0.00038029812998754015, ic :0.01630754949297165, sharpe5:-1.066953005567193, irr5:-0.2286320924758911, ndcg5:0.852745138554214, pnl5:1.020131230354309 
train 43, step: 0, loss: 0.00011551475472515449, grad_norm: 9.980218175988439e-07, ic: 0.08829342177246752
train 43, step: 600, loss: 0.00025349081261083484, grad_norm: 5.3443835849473656e-05, ic: -0.00946416082231923
Epoch 43: 2022-05-06 15:04:44.283831: train loss: 0.00020725730728126773
Eval step 0: eval loss: 0.00020095656509511173
Eval: 2022-05-06 15:04:46.853482: total loss: 0.00018956191356191664, mse:0.00037912382465221477, ic :0.02324115580377624, sharpe5:-0.7997019737586378, irr5:-0.1664958894252777, ndcg5:0.8563784794294206, pnl5:1.0508482456207275 
train 44, step: 0, loss: 0.0001762862375471741, grad_norm: 4.203913652477931e-06, ic: 0.057644665031617776
train 44, step: 600, loss: 0.00021840310364495963, grad_norm: 2.9770468381466998e-05, ic: 0.0984800909968134
Epoch 44: 2022-05-06 15:04:57.937419: train loss: 0.0002079600653175746
Eval step 0: eval loss: 0.00021261480287648737
Eval: 2022-05-06 15:05:00.435459: total loss: 0.00019240281552527252, mse:0.00038480562911280027, ic :0.015722181975405574, sharpe5:-0.7997018555179238, irr5:-0.1664958894252777, ndcg5:0.8510626607221177, pnl5:1.050848126411438 
train 45, step: 0, loss: 8.850092126522213e-05, grad_norm: 7.79278058459544e-06, ic: 0.10656114101077716
train 45, step: 600, loss: 0.00016616312495898455, grad_norm: 1.2974036995078404e-07, ic: 0.049907773659638645
Epoch 45: 2022-05-06 15:05:12.082577: train loss: 0.00020781859621402454
Eval step 0: eval loss: 0.00018704638932831585
Eval: 2022-05-06 15:05:14.734474: total loss: 0.00019080191814447057, mse:0.00038160383713835495, ic :0.027751033699257577, sharpe5:-1.066953005567193, irr5:-0.2286320924758911, ndcg5:0.845373151271894, pnl5:1.020131230354309 
train 46, step: 0, loss: 0.00014972999633755535, grad_norm: 7.281914849513215e-05, ic: 0.026425109247755044
train 46, step: 600, loss: 0.0005717742023989558, grad_norm: 0.00047451908946934644, ic: 0.03154340424381066
Epoch 46: 2022-05-06 15:05:25.852411: train loss: 0.0002081833198915135
Eval step 0: eval loss: 0.00019789069483522326
Eval: 2022-05-06 15:05:28.481014: total loss: 0.00018926517103827134, mse:0.00037853033819399887, ic :0.022435920404617584, sharpe5:-0.839285890571773, irr5:-0.17504799365997314, ndcg5:0.8435443946121997, pnl5:1.0437960624694824 
train 47, step: 0, loss: 0.00013940385542809963, grad_norm: 1.6360528865309339e-06, ic: 0.03243272889324632
train 47, step: 600, loss: 0.00018719826766755432, grad_norm: 4.4261589494253875e-05, ic: -0.017483140195079575
Epoch 47: 2022-05-06 15:05:40.173116: train loss: 0.00020811856162696572
Eval step 0: eval loss: 0.0001916721521411091
Eval: 2022-05-06 15:05:42.795340: total loss: 0.00018942754058408597, mse:0.00037885507832815537, ic :0.025501993043546535, sharpe5:-0.818940683864057, irr5:-0.17032593488693237, ndcg5:0.8508936746183144, pnl5:1.0471872091293335 
train 48, step: 0, loss: 0.00022582038945984095, grad_norm: 0.00011394819553003573, ic: 0.05425007324498137
train 48, step: 600, loss: 0.00019555720791686326, grad_norm: 3.1910139565738757e-06, ic: 0.06459208379352478
Epoch 48: 2022-05-06 15:05:54.489766: train loss: 0.00020791997989903934
Eval step 0: eval loss: 0.00019127030100207776
Eval: 2022-05-06 15:05:57.130213: total loss: 0.00018953617981675068, mse:0.00037907235720040895, ic :0.027316963230533113, sharpe5:-0.8189408612251281, irr5:-0.17032596468925476, ndcg5:0.8506604242892456, pnl5:1.0471872091293335 
train 49, step: 0, loss: 8.093585347523913e-05, grad_norm: 6.684192525701387e-07, ic: 0.0019465170627687434
