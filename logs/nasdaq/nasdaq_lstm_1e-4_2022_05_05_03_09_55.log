Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=64, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.0001, lstm_layers=1, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='BaseLSTM', normalize_adj=True, num_days=16, num_heads=1, print_inteval=600, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
34849
BaseLSTM(
  (rnn1): LSTM(5, 64, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=128, out_features=64, bias=True)
  (predict): Linear(in_features=64, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.004462052136659622, grad_norm: 0.011314060449992724, ic: 0.013065140099290263
train 0, step: 600, loss: 0.00017333164578303695, grad_norm: 2.4584856616069464e-05, ic: -0.001136767600693176
Epoch 0: 2022-05-05 15:11:19.520070: train loss: 0.00038942024696774066
Eval step 0: eval loss: 0.00021393982751760632
Eval: 2022-05-05 15:11:22.004277: total loss: 0.00019178754879594717, mse:0.0003835750923559502, ic :0.036759121633433825, sharpe5:-0.9524800318479537, irr5:-0.19749858975410461, ndcg5:0.854466137136197, pnl5:1.0217417478561401 
train 1, step: 0, loss: 0.0002742612559814006, grad_norm: 0.00018267124751948513, ic: 0.03199953280892065
train 1, step: 600, loss: 0.000128835832583718, grad_norm: 1.7227704836678827e-06, ic: 0.05756358877470176
Epoch 1: 2022-05-05 15:11:27.666503: train loss: 0.00023439490747428814
Eval step 0: eval loss: 0.00019388085638638586
Eval: 2022-05-05 15:11:30.150044: total loss: 0.0001903857419618123, mse:0.0003807714826313056, ic :0.03533031310630334, sharpe5:-0.7307799936085939, irr5:-0.15189847350120544, ndcg5:0.8544748673020701, pnl5:1.0437743663787842 
train 2, step: 0, loss: 0.0002914432843681425, grad_norm: 0.00016521651386080074, ic: 0.002470075845773797
train 2, step: 600, loss: 0.0002968433254864067, grad_norm: 0.0001758017368968242, ic: 0.04348628403852645
Epoch 2: 2022-05-05 15:11:35.657949: train loss: 0.00022912057363616957
Eval step 0: eval loss: 0.00019430046086199582
Eval: 2022-05-05 15:11:38.148548: total loss: 0.00019065061157697821, mse:0.00038130121814908594, ic :0.033578098802248976, sharpe5:-0.756140675805509, irr5:-0.15731629729270935, ndcg5:0.8581307273591824, pnl5:1.039451003074646 
train 3, step: 0, loss: 0.00018123963673133403, grad_norm: 8.556139993566949e-05, ic: 0.00929595448132588
train 3, step: 600, loss: 0.00018197338795289397, grad_norm: 0.0001464550585384802, ic: -0.008938189519940487
Epoch 3: 2022-05-05 15:11:43.706661: train loss: 0.0002254592942532523
Eval step 0: eval loss: 0.00018460296269040555
Eval: 2022-05-05 15:11:46.422903: total loss: 0.00020149074940877963, mse:0.0004029814915194753, ic :0.03065193611944754, sharpe5:-0.9788078048452734, irr5:-0.2028937041759491, ndcg5:0.8584535338616188, pnl5:1.0162904262542725 
train 4, step: 0, loss: 0.0002263927599415183, grad_norm: 1.304865948726751e-06, ic: 0.011760963087575523
train 4, step: 600, loss: 0.0003868117928504944, grad_norm: 0.0004648696897771135, ic: 0.005059272975086664
Epoch 4: 2022-05-05 15:11:52.691709: train loss: 0.000223612939068541
Eval step 0: eval loss: 0.0001919643982546404
Eval: 2022-05-05 15:11:55.125073: total loss: 0.00018967176712227657, mse:0.00037934352894034403, ic :0.03562662395598371, sharpe5:-1.0245538955926894, irr5:-0.21614384651184082, ndcg5:0.8556732397394422, pnl5:0.990692138671875 
train 5, step: 0, loss: 0.0006078809965401888, grad_norm: 7.649982234812258e-05, ic: 0.03544925049140619
train 5, step: 600, loss: 0.00016297248657792807, grad_norm: 5.2434420261192735e-06, ic: 0.03287965881657978
Epoch 5: 2022-05-05 15:12:01.333408: train loss: 0.0002200344767294843
Eval step 0: eval loss: 0.00019817431166302413
Eval: 2022-05-05 15:12:03.778781: total loss: 0.0001891093185117228, mse:0.00037821863375417787, ic :0.03282580300715685, sharpe5:-1.127726840749383, irr5:-0.24575820565223694, ndcg5:0.845586594027745, pnl5:0.9225107431411743 
train 6, step: 0, loss: 0.00018137224833481014, grad_norm: 2.040618340336008e-05, ic: -0.03138581670691222
train 6, step: 600, loss: 0.00018634962907526642, grad_norm: 1.245641767375173e-06, ic: -0.00818577065083708
Epoch 6: 2022-05-05 15:12:09.444542: train loss: 0.00021954784804964565
Eval step 0: eval loss: 0.00018909928621724248
Eval: 2022-05-05 15:12:11.924143: total loss: 0.00019071561801120874, mse:0.00038143123402447547, ic :0.030510026053202025, sharpe5:-0.8691930464655161, irr5:-0.18455925583839417, ndcg5:0.8524004850336442, pnl5:0.9814620614051819 
train 7, step: 0, loss: 0.00020706295617856085, grad_norm: 9.934181967935346e-07, ic: 0.0572966127237053
train 7, step: 600, loss: 0.0002325710083823651, grad_norm: 0.00012778883729950264, ic: -0.04499473053141942
Epoch 7: 2022-05-05 15:12:17.506220: train loss: 0.00021726164091346987
Eval step 0: eval loss: 0.0001847994135459885
Eval: 2022-05-05 15:12:19.969963: total loss: 0.00019395558168923028, mse:0.0003879111621567482, ic :0.028338309629520827, sharpe5:-0.7916021301224827, irr5:-0.16537624597549438, ndcg5:0.8510669381563168, pnl5:1.014161467552185 
train 8, step: 0, loss: 9.718737419461831e-05, grad_norm: 3.919709437814789e-06, ic: 0.020711280318535166
train 8, step: 600, loss: 0.0002519522386137396, grad_norm: 0.0001243558034851264, ic: -0.015124791502330311
Epoch 8: 2022-05-05 15:12:25.464841: train loss: 0.00021600783952021015
Eval step 0: eval loss: 0.00019295142556075007
Eval: 2022-05-05 15:12:27.917135: total loss: 0.00018991715224971783, mse:0.00037983430013005753, ic :0.02860866157939553, sharpe5:-0.6316052990779281, irr5:-0.13393369317054749, ndcg5:0.8511321557426139, pnl5:1.024058222770691 
train 9, step: 0, loss: 9.530717943562195e-05, grad_norm: 8.103843831477799e-08, ic: -0.015587497397939102
train 9, step: 600, loss: 0.00023062432592269033, grad_norm: 0.000169660851794391, ic: 0.048451912846800047
Epoch 9: 2022-05-05 15:12:33.463140: train loss: 0.00021622891877455373
Eval step 0: eval loss: 0.0001840719924075529
Eval: 2022-05-05 15:12:36.245107: total loss: 0.00019643144688370946, mse:0.0003928628915140373, ic :0.027467768531180325, sharpe5:-0.8799792008846998, irr5:-0.18657851219177246, ndcg5:0.853824593369303, pnl5:0.9976979494094849 
train 10, step: 0, loss: 0.00012991296534892172, grad_norm: 5.3027437344469925e-06, ic: 0.008502099592040471
train 10, step: 600, loss: 0.00011823161912616342, grad_norm: 1.825599025497894e-05, ic: -0.021491630921044575
Epoch 10: 2022-05-05 15:12:41.797533: train loss: 0.00021494412007135955
Eval step 0: eval loss: 0.00018561295291874558
Eval: 2022-05-05 15:12:44.211404: total loss: 0.00019286769914111056, mse:0.0003857353945098588, ic :0.02835993990105997, sharpe5:-0.8079685959219932, irr5:-0.17168128490447998, ndcg5:0.8565821865052753, pnl5:0.9927793741226196 
train 11, step: 0, loss: 0.00018963920592796057, grad_norm: 6.468126216489835e-05, ic: 0.012878593235523015
train 11, step: 600, loss: 0.0002188922226196155, grad_norm: 4.9019063065211695e-06, ic: 0.02732514267313872
Epoch 11: 2022-05-05 15:12:49.920172: train loss: 0.00021373505430371577
Eval step 0: eval loss: 0.00019301814609207213
Eval: 2022-05-05 15:12:52.375253: total loss: 0.0001897057651042226, mse:0.00037941152611117553, ic :0.02718393975211897, sharpe5:-0.9816955386847257, irr5:-0.21301299333572388, ndcg5:0.8504422447146162, pnl5:0.9459304213523865 
train 12, step: 0, loss: 0.00015265481488313526, grad_norm: 5.763267119363335e-08, ic: 0.017218572370627894
train 12, step: 600, loss: 0.00017004547407850623, grad_norm: 6.830601172940059e-05, ic: 0.0005017490717284202
Epoch 12: 2022-05-05 15:12:57.943877: train loss: 0.00021341255501406645
Eval step 0: eval loss: 0.0002172060776501894
Eval: 2022-05-05 15:13:00.366304: total loss: 0.00019297277282531546, mse:0.0003859455410747823, ic :0.026849457921609338, sharpe5:-1.1446845692396164, irr5:-0.25142255425453186, ndcg5:0.8484172169328256, pnl5:0.9215461015701294 
train 13, step: 0, loss: 0.00015124905621632934, grad_norm: 2.0912584022890916e-05, ic: 0.057663114673914204
train 13, step: 600, loss: 0.00017238419968634844, grad_norm: 2.2872404098625287e-05, ic: 0.03226106612763499
Epoch 13: 2022-05-05 15:13:05.948199: train loss: 0.00021215382624398664
Eval step 0: eval loss: 0.00019792868988588452
Eval: 2022-05-05 15:13:08.398868: total loss: 0.00018923754564289434, mse:0.00037847508665205486, ic :0.025709308865316846, sharpe5:-1.4321148569136857, irr5:-0.3110125958919525, ndcg5:0.8488939091736223, pnl5:0.9410521388053894 
train 14, step: 0, loss: 0.0002505241718608886, grad_norm: 0.00017371453054374278, ic: -0.011913886692514083
train 14, step: 600, loss: 0.00017492428014520556, grad_norm: 0.00011534180893805416, ic: 0.03577134140977907
Epoch 14: 2022-05-05 15:13:14.203802: train loss: 0.00021224964684979814
Eval step 0: eval loss: 0.0002066439192276448
Eval: 2022-05-05 15:13:16.680481: total loss: 0.00019025582575494195, mse:0.0003805116472489783, ic :0.025494560474672752, sharpe5:-1.4605226614326239, irr5:-0.31591859459877014, ndcg5:0.8524899760868212, pnl5:0.918194055557251 
train 15, step: 0, loss: 0.0006240878137759864, grad_norm: 0.00011514922964726963, ic: 0.03184530146028921
train 15, step: 600, loss: 0.00011378750787116587, grad_norm: 1.7906770785836956e-06, ic: -0.018683752690365773
Epoch 15: 2022-05-05 15:13:22.355764: train loss: 0.00021115019902739535
Eval step 0: eval loss: 0.00018596080190036446
Eval: 2022-05-05 15:13:24.781579: total loss: 0.00019143678788390703, mse:0.0003828735716809112, ic :0.026593581445921298, sharpe5:-1.1394805589318275, irr5:-0.24731311202049255, ndcg5:0.8503810897161536, pnl5:0.9063755869865417 
train 16, step: 0, loss: 0.0002684593200683594, grad_norm: 0.00019518511319430276, ic: -0.022280926553799898
train 16, step: 600, loss: 0.00014105712762102485, grad_norm: 1.0066632944611428e-05, ic: 0.04032296626031767
Epoch 16: 2022-05-05 15:13:30.379260: train loss: 0.0002110265237157315
Eval step 0: eval loss: 0.00018103716138284653
Eval: 2022-05-05 15:13:32.826029: total loss: 0.00020257366445322196, mse:0.0004051473251950179, ic :0.024861243276091377, sharpe5:-0.7773642927780747, irr5:-0.1653968095779419, ndcg5:0.859392221087305, pnl5:0.9629054665565491 
train 17, step: 0, loss: 0.0002494112413842231, grad_norm: 3.6303200151602713e-07, ic: 0.031291411837251655
train 17, step: 600, loss: 0.00018352169718127698, grad_norm: 1.6732453512661962e-05, ic: -0.020931336535014965
Epoch 17: 2022-05-05 15:13:38.423107: train loss: 0.00021119775608255894
Eval step 0: eval loss: 0.00021170114632695913
Eval: 2022-05-05 15:13:40.841439: total loss: 0.00019174263384867443, mse:0.00038348526558043436, ic :0.0260838774405353, sharpe5:-1.4155286407470702, irr5:-0.3042599856853485, ndcg5:0.8475673718865299, pnl5:0.9096314907073975 
train 18, step: 0, loss: 0.0002151524822693318, grad_norm: 0.00025159493602877, ic: 0.0031258102843645073
train 18, step: 600, loss: 0.0001235711097251624, grad_norm: 1.071579808446217e-05, ic: -0.046669750700891466
Epoch 18: 2022-05-05 15:13:46.370943: train loss: 0.0002104135682276211
Eval step 0: eval loss: 0.00020906935969833285
Eval: 2022-05-05 15:13:48.975675: total loss: 0.00019084313157176791, mse:0.00038168625552223055, ic :0.02518264036581633, sharpe5:-1.1837141735851764, irr5:-0.25792601704597473, ndcg5:0.8510629793224392, pnl5:0.914088785648346 
train 19, step: 0, loss: 0.00018687978445086628, grad_norm: 0.00010739906807887617, ic: -0.0446190907987652
train 19, step: 600, loss: 0.0002946630702354014, grad_norm: 0.0001324785089720655, ic: 0.0310263519240752
Epoch 19: 2022-05-05 15:13:54.508571: train loss: 0.00021031512517003794
Eval step 0: eval loss: 0.0001902280782815069
Eval: 2022-05-05 15:13:56.968649: total loss: 0.00019002645955356766, mse:0.0003800529158329382, ic :0.02522473899589256, sharpe5:-1.2089355091005562, irr5:-0.2616017162799835, ndcg5:0.8438807754581424, pnl5:0.9267009496688843 
train 20, step: 0, loss: 0.00048617672291584313, grad_norm: 0.00063654867538228, ic: -0.04749952204135463
train 20, step: 600, loss: 0.00013296720862854272, grad_norm: 2.007874008007568e-05, ic: -0.05476290868017408
Epoch 20: 2022-05-05 15:14:02.504437: train loss: 0.0002096087918756451
Eval step 0: eval loss: 0.00019754220556933433
Eval: 2022-05-05 15:14:04.986026: total loss: 0.00018929412869111807, mse:0.000378588251437863, ic :0.024726545674737317, sharpe5:-0.9553699531406163, irr5:-0.20652881264686584, ndcg5:0.8442784353454533, pnl5:0.9331089854240417 
train 21, step: 0, loss: 0.0002269432006869465, grad_norm: 0.00016246483088274381, ic: -0.0053277496591236165
train 21, step: 600, loss: 0.00010271857172483578, grad_norm: 9.771875417587178e-09, ic: 0.04606754386911979
Epoch 21: 2022-05-05 15:14:10.478135: train loss: 0.0002097700641791783
Eval step 0: eval loss: 0.00020832284644711763
Eval: 2022-05-05 15:14:12.978521: total loss: 0.00019062203526990995, mse:0.0003812440692211754, ic :0.024735924386933613, sharpe5:-0.9522910240665078, irr5:-0.20435607433319092, ndcg5:0.8519590592391462, pnl5:0.9336822032928467 
train 22, step: 0, loss: 0.0001301759184570983, grad_norm: 1.5155614028573292e-05, ic: -0.005785586008197806
train 22, step: 600, loss: 0.00017287513765040785, grad_norm: 3.355656619489761e-05, ic: 0.001757455193082253
Epoch 22: 2022-05-05 15:14:18.596912: train loss: 0.00020844447968261807
Eval step 0: eval loss: 0.0001836524752434343
Eval: 2022-05-05 15:14:21.165486: total loss: 0.00019352611499876457, mse:0.0003870522281017737, ic :0.025283997806805483, sharpe5:-1.317700885310769, irr5:-0.2890336215496063, ndcg5:0.8513001986840131, pnl5:0.9103186726570129 
train 23, step: 0, loss: 0.0001900360657600686, grad_norm: 5.880017975320996e-06, ic: 0.03674748991341732
train 23, step: 600, loss: 0.00012172483548056334, grad_norm: 6.778972083668561e-05, ic: -0.016970978290295754
Epoch 23: 2022-05-05 15:14:26.783384: train loss: 0.00020906788950260553
Eval step 0: eval loss: 0.00020788179244846106
Eval: 2022-05-05 15:14:29.377275: total loss: 0.00019058053962764125, mse:0.0003811610787697197, ic :0.024889645373353274, sharpe5:-0.9418612471595406, irr5:-0.2024002969264984, ndcg5:0.8584667215109548, pnl5:0.9341768622398376 
train 24, step: 0, loss: 0.0004182899137958884, grad_norm: 0.00015426706363889836, ic: -0.018967138110510907
train 24, step: 600, loss: 0.00016653566854074597, grad_norm: 7.604766035642873e-05, ic: 0.0783911817002688
Epoch 24: 2022-05-05 15:14:35.324615: train loss: 0.00020885905508023555
Eval step 0: eval loss: 0.0001894708111649379
Eval: 2022-05-05 15:14:38.037703: total loss: 0.0001902841824334435, mse:0.0003805683621061666, ic :0.02493522088342957, sharpe5:-0.9817151075229048, irr5:-0.21208983659744263, ndcg5:0.8544718983322023, pnl5:0.9286179542541504 
train 25, step: 0, loss: 0.00010747561464086175, grad_norm: 3.343464670708339e-05, ic: 0.004478595934228683
train 25, step: 600, loss: 0.00012516503920778632, grad_norm: 2.587049380271336e-05, ic: 0.03233365712973828
Epoch 25: 2022-05-05 15:14:43.618384: train loss: 0.0002090372279682826
Eval step 0: eval loss: 0.00018210842972621322
Eval: 2022-05-05 15:14:46.105881: total loss: 0.0001972879755441879, mse:0.00039457594382753065, ic :0.02445586631739971, sharpe5:-0.8995862308144569, irr5:-0.1913348138332367, ndcg5:0.8565573233743131, pnl5:0.9595537781715393 
train 26, step: 0, loss: 0.00023989574401639402, grad_norm: 0.00024989649241202727, ic: 0.10035101688398249
train 26, step: 600, loss: 0.00017790340643841773, grad_norm: 3.0378890286843937e-05, ic: 0.0037943717134919664
Epoch 26: 2022-05-05 15:14:51.715854: train loss: 0.00020920389423908264
Eval step 0: eval loss: 0.00018920750881079584
Eval: 2022-05-05 15:14:54.257350: total loss: 0.00019046650196365565, mse:0.00038093299935791224, ic :0.024287281242686462, sharpe5:-0.8266715573519468, irr5:-0.17721763253211975, ndcg5:0.8519029862593416, pnl5:1.007217288017273 
train 27, step: 0, loss: 0.0002552795922383666, grad_norm: 0.00017699470560214792, ic: -0.02660461590763656
train 27, step: 600, loss: 9.844746818998829e-05, grad_norm: 2.5081599285388585e-06, ic: -0.01520720542809106
Epoch 27: 2022-05-05 15:14:59.881484: train loss: 0.00020827085447947596
Eval step 0: eval loss: 0.00019846147915814072
Eval: 2022-05-05 15:15:02.395323: total loss: 0.00018934092027576624, mse:0.0003786818366598982, ic :0.024168433514699543, sharpe5:-0.7662820044904947, irr5:-0.16403043270111084, ndcg5:0.8483045389168229, pnl5:1.0175659656524658 
train 28, step: 0, loss: 0.00011688427912304178, grad_norm: 1.1706415936928084e-05, ic: 0.06546586094900628
train 28, step: 600, loss: 0.00013973239401821047, grad_norm: 3.037639175924867e-06, ic: 0.02528260522133299
Epoch 28: 2022-05-05 15:15:08.208483: train loss: 0.00020825024874628414
Eval step 0: eval loss: 0.0001920864451676607
Eval: 2022-05-05 15:15:10.797762: total loss: 0.00018963035095585258, mse:0.00037926069484051463, ic :0.024616219608151427, sharpe5:-0.9250020131841301, irr5:-0.1991027593612671, ndcg5:0.850245852499577, pnl5:0.9555217027664185 
train 29, step: 0, loss: 0.00012173606955911964, grad_norm: 1.1741025494304469e-05, ic: 0.04502635729288618
train 29, step: 600, loss: 0.0003222244558855891, grad_norm: 0.0001316650791324825, ic: 0.07647566327597499
Epoch 29: 2022-05-05 15:15:16.431945: train loss: 0.00020810616573038027
Eval step 0: eval loss: 0.00019602941756602377
Eval: 2022-05-05 15:15:18.863682: total loss: 0.00018920929553577196, mse:0.00037841858764496236, ic :0.024662050473458933, sharpe5:-0.814318122267723, irr5:-0.17264416813850403, ndcg5:0.8518724562163162, pnl5:0.9558088183403015 
train 30, step: 0, loss: 0.00017270988610107452, grad_norm: 5.7636478304543076e-05, ic: 0.05755303575724878
train 30, step: 600, loss: 0.000226973817916587, grad_norm: 3.261993369308529e-06, ic: 0.08826563141723794
Epoch 30: 2022-05-05 15:15:24.443287: train loss: 0.00020809661714707003
Eval step 0: eval loss: 0.0001965598203241825
Eval: 2022-05-05 15:15:26.913024: total loss: 0.00018920644625760108, mse:0.0003784128877148068, ic :0.024817604008860843, sharpe5:-0.7774303893372416, irr5:-0.16494378447532654, ndcg5:0.8418963932116307, pnl5:0.962161660194397 
train 31, step: 0, loss: 0.00015689106658101082, grad_norm: 4.8976911188822216e-05, ic: 0.0416907162469213
train 31, step: 600, loss: 0.00018052801897283643, grad_norm: 6.340299241527636e-06, ic: 0.07743209403574225
Epoch 31: 2022-05-05 15:15:32.595494: train loss: 0.00020799811855131583
Eval step 0: eval loss: 0.00019866142247337848
Eval: 2022-05-05 15:15:35.034083: total loss: 0.00018925894252224762, mse:0.0003785178785358735, ic :0.024885328208841147, sharpe5:-0.8245001257583499, irr5:-0.17542943358421326, ndcg5:0.8491382002949691, pnl5:0.971472442150116 
train 32, step: 0, loss: 0.00015542547043878585, grad_norm: 1.1269138004863115e-05, ic: 0.05051124500213859
train 32, step: 600, loss: 0.00017015391495078802, grad_norm: 2.8925907777272123e-05, ic: -0.0031061663282389382
Epoch 32: 2022-05-05 15:15:40.576903: train loss: 0.00020792383960773853
Eval step 0: eval loss: 0.00018338386144023389
Eval: 2022-05-05 15:15:43.004087: total loss: 0.00019465135158897205, mse:0.00038930269786770824, ic :0.024449272382674334, sharpe5:-0.8597839234024286, irr5:-0.18463516235351562, ndcg5:0.8578591117972002, pnl5:0.9836174249649048 
train 33, step: 0, loss: 0.00017591859796084464, grad_norm: 1.59034132844049e-05, ic: 0.03541270543544804
train 33, step: 600, loss: 9.458319254918024e-05, grad_norm: 1.497954102996448e-05, ic: -0.001844948947332798
Epoch 33: 2022-05-05 15:15:48.531833: train loss: 0.00020820347683577376
Eval step 0: eval loss: 0.00019808480283245444
Eval: 2022-05-05 15:15:51.137408: total loss: 0.0001892225374823238, mse:0.0003784450705029609, ic :0.02525370354391752, sharpe5:-1.1035696716606616, irr5:-0.23717956244945526, ndcg5:0.8520963715899671, pnl5:0.9087324142456055 
train 34, step: 0, loss: 0.0001355453860014677, grad_norm: 3.145227608993507e-05, ic: -0.043048185844849096
train 34, step: 600, loss: 0.00014592244406230748, grad_norm: 0.00013308673807677226, ic: 0.11935066207015983
Epoch 34: 2022-05-05 15:15:56.852742: train loss: 0.00020754392267868704
Eval step 0: eval loss: 0.00020057270012330264
Eval: 2022-05-05 15:15:59.310461: total loss: 0.00018939395772679858, mse:0.0003787879084081025, ic :0.02517432351194258, sharpe5:-0.8305391519889235, irr5:-0.17730998992919922, ndcg5:0.8499715037616524, pnl5:0.9714144468307495 
train 35, step: 0, loss: 8.785906538832933e-05, grad_norm: 1.1898331479650852e-05, ic: 0.118287918395283
train 35, step: 600, loss: 0.000238263193750754, grad_norm: 1.982776767026183e-05, ic: 0.0385577282303958
Epoch 35: 2022-05-05 15:16:04.915267: train loss: 0.00020785637791689352
Eval step 0: eval loss: 0.00019014894496649504
Eval: 2022-05-05 15:16:07.355473: total loss: 0.0001901021320478173, mse:0.00038020426033155496, ic :0.02522778741423782, sharpe5:-0.9226782875508069, irr5:-0.19664683938026428, ndcg5:0.8488526009550177, pnl5:0.9555304646492004 
train 36, step: 0, loss: 8.365132816834375e-05, grad_norm: 1.0222619329798754e-05, ic: 0.10029015489546275
train 36, step: 600, loss: 0.00010643135465215892, grad_norm: 8.174059823426474e-06, ic: 0.03999924186643259
Epoch 36: 2022-05-05 15:16:13.114051: train loss: 0.00020740395870037705
Eval step 0: eval loss: 0.00018773159536067396
Eval: 2022-05-05 15:16:15.650536: total loss: 0.0001908747313190694, mse:0.0003817494539066435, ic :0.025408559950858774, sharpe5:-0.8644457409158348, irr5:-0.1842544674873352, ndcg5:0.8441183158977545, pnl5:0.9480116367340088 
train 37, step: 0, loss: 0.00021317873324733227, grad_norm: 0.00010504217801847803, ic: 0.06708810101150364
train 37, step: 600, loss: 0.00011904894199687988, grad_norm: 7.815361500030921e-06, ic: 0.034021019297374416
Epoch 37: 2022-05-05 15:16:21.276540: train loss: 0.00020772955343803718
Eval step 0: eval loss: 0.00018962266040034592
Eval: 2022-05-05 15:16:23.791821: total loss: 0.00019027391562925238, mse:0.00038054782512782426, ic :0.025090753584845183, sharpe5:-0.9021253319084643, irr5:-0.19186678528785706, ndcg5:0.8543914613088772, pnl5:0.9413716197013855 
train 38, step: 0, loss: 0.0003222959639970213, grad_norm: 2.4646455858423384e-06, ic: 0.08376010013873994
train 38, step: 600, loss: 0.00040000613080337644, grad_norm: 0.000422320862683732, ic: -0.014249626087864696
Epoch 38: 2022-05-05 15:16:29.327952: train loss: 0.00020743882630356255
Eval step 0: eval loss: 0.00019222959235776216
Eval: 2022-05-05 15:16:31.776660: total loss: 0.00018956644516659486, mse:0.0003791328871949012, ic :0.025357120139538846, sharpe5:-1.1149421817809342, irr5:-0.24153581261634827, ndcg5:0.8512481729949245, pnl5:0.9236460328102112 
train 39, step: 0, loss: 0.00013992561434861273, grad_norm: 4.872092262806498e-07, ic: 0.06994431307432272
train 39, step: 600, loss: 0.0002480852126609534, grad_norm: 5.776195893800433e-06, ic: 0.028608675569441553
Epoch 39: 2022-05-05 15:16:37.536997: train loss: 0.00020706178094917198
Eval step 0: eval loss: 0.00018900549912359565
Eval: 2022-05-05 15:16:39.992985: total loss: 0.00019058060619771497, mse:0.0003811612077381031, ic :0.024893560039033754, sharpe5:-0.9381419854983687, irr5:-0.19992119073867798, ndcg5:0.8489681669160268, pnl5:0.9530642032623291 
