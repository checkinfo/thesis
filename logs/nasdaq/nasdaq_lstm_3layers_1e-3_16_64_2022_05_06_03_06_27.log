Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=60, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=64, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=3, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='BaseLSTM', normalize_adj=True, num_days=16, num_heads=1, print_inteval=600, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
68987
BaseLSTM(
  (rnn1): LSTM(5, 64, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=128, out_features=64, bias=True)
  (predict): Linear(in_features=64, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.0004546617856249213, grad_norm: 0.00045413900630869846, ic: -0.0036837599786770894
train 0, step: 600, loss: 0.00013031112030148506, grad_norm: 1.4521740354059252e-07, ic: 0.08052346594715068
Epoch 0: 2022-05-06 15:07:56.188198: train loss: 0.0002405658364492607
Eval step 0: eval loss: 0.0002651010872796178
Eval: 2022-05-06 15:07:58.757000: total loss: 0.000216985251743987, mse:0.0004339704933495111, ic :0.023443664985035903, sharpe5:-0.8026641992479563, irr5:-0.1671386957168579, ndcg5:0.8528891301177897, pnl5:1.0305482149124146 
train 1, step: 0, loss: 0.0003260122612118721, grad_norm: 0.00030026995078171533, ic: -0.03370223793215379
train 1, step: 600, loss: 0.00011062608245993033, grad_norm: 1.175020247969134e-06, ic: -0.024966544163834162
Epoch 1: 2022-05-06 15:08:10.342168: train loss: 0.00021453241945867352
Eval step 0: eval loss: 0.00018786618602462113
Eval: 2022-05-06 15:08:12.940541: total loss: 0.00019014087750979938, mse:0.00038028175262428256, ic :0.02006948806251051, sharpe5:-0.9628022688254714, irr5:-0.20467299222946167, ndcg5:0.8522163792265754, pnl5:1.0177305936813354 
train 2, step: 0, loss: 0.00027933900128118694, grad_norm: 0.00014578826958179013, ic: 0.008793397063680878
train 2, step: 600, loss: 0.0003045039193239063, grad_norm: 0.0001762871688569782, ic: -0.0445306400000434
Epoch 2: 2022-05-06 15:08:24.628706: train loss: 0.00021185437925285786
Eval step 0: eval loss: 0.00019346745102666318
Eval: 2022-05-06 15:08:27.338922: total loss: 0.0001892616545119875, mse:0.00037852331056227465, ic :0.022898275499539066, sharpe5:-0.9852911796793341, irr5:-0.20943421125411987, ndcg5:0.8560694706359124, pnl5:1.0140838623046875 
train 3, step: 0, loss: 0.00016669051547069103, grad_norm: 7.06793747740823e-05, ic: 0.04284145795489006
train 3, step: 600, loss: 0.00018274912144988775, grad_norm: 0.0001520403934703233, ic: 0.048838231244287864
Epoch 3: 2022-05-06 15:08:39.040508: train loss: 0.00021008550625206348
Eval step 0: eval loss: 0.00018061199807561934
Eval: 2022-05-06 15:08:41.615829: total loss: 0.00019846163452123567, mse:0.00039692326833984723, ic :0.031013592152001064, sharpe5:-0.9515793332085013, irr5:-0.20229020714759827, ndcg5:0.8554822965931079, pnl5:1.001264214515686 
train 4, step: 0, loss: 0.00021256186300888658, grad_norm: 3.0944336210318123e-06, ic: 0.05544774371352713
train 4, step: 600, loss: 0.0003810410271398723, grad_norm: 0.0004036846744393237, ic: 0.008798100319599047
Epoch 4: 2022-05-06 15:08:53.311429: train loss: 0.00021039833923045868
Eval step 0: eval loss: 0.00018611089035402983
Eval: 2022-05-06 15:08:56.038309: total loss: 0.0001906616932884221, mse:0.00038132338120169514, ic :0.018720108834373746, sharpe5:-0.9138140768185258, irr5:-0.19501405954360962, ndcg5:0.8613976505369938, pnl5:1.0268043279647827 
train 5, step: 0, loss: 0.0005940913106314838, grad_norm: 4.9153640081646596e-05, ic: 0.03761719273091507
train 5, step: 600, loss: 0.00016063754446804523, grad_norm: 1.3479201762237669e-05, ic: -0.006863068401424506
Epoch 5: 2022-05-06 15:09:07.832967: train loss: 0.0002083163093924963
Eval step 0: eval loss: 0.00019325448374729604
Eval: 2022-05-06 15:09:10.467570: total loss: 0.00018930271639524458, mse:0.0003786054314437958, ic :0.020288617969121094, sharpe5:-1.0548212718218564, irr5:-0.22452253103256226, ndcg5:0.8444810732154265, pnl5:1.0023852586746216 
train 6, step: 0, loss: 0.00016334661631844938, grad_norm: 8.613405653219266e-06, ic: -0.08758409967627334
train 6, step: 600, loss: 0.00017493190534878522, grad_norm: 6.692182254032562e-07, ic: 0.018665214330172427
Epoch 6: 2022-05-06 15:09:21.997145: train loss: 0.0002095067500114375
Eval step 0: eval loss: 0.0001865532249212265
Eval: 2022-05-06 15:09:24.627273: total loss: 0.0001905007552625759, mse:0.0003810015063601556, ic :0.021913550254917067, sharpe5:-0.9999024803191423, irr5:-0.21371406316757202, ndcg5:0.8508119852407909, pnl5:1.0304697751998901 
train 7, step: 0, loss: 0.00020194027456454933, grad_norm: 3.353187775837357e-07, ic: 0.04965120151047827
train 7, step: 600, loss: 0.00022014811111148447, grad_norm: 0.00010939112769302786, ic: -0.04194111493825977
Epoch 7: 2022-05-06 15:09:36.104246: train loss: 0.00020871469955513808
Eval step 0: eval loss: 0.00018502204329706728
Eval: 2022-05-06 15:09:38.737335: total loss: 0.0001912124252696922, mse:0.00038242484693542156, ic :0.02579334429786201, sharpe5:-0.9706433426588773, irr5:-0.2060878872871399, ndcg5:0.8503917374392828, pnl5:1.0164014101028442 
train 8, step: 0, loss: 8.747849642531946e-05, grad_norm: 1.2784939548652274e-06, ic: 0.059900371267390534
train 8, step: 600, loss: 0.00025109483976848423, grad_norm: 0.00012280406993052942, ic: 0.039807654669888046
Epoch 8: 2022-05-06 15:09:50.348724: train loss: 0.00020880964381118444
Eval step 0: eval loss: 0.00019286888709757477
Eval: 2022-05-06 15:09:52.996976: total loss: 0.0001893008403504811, mse:0.00037860167990623423, ic :0.0308243065738417, sharpe5:-1.0222910048067568, irr5:-0.21745038032531738, ndcg5:0.8494192420525345, pnl5:1.0266531705856323 
train 9, step: 0, loss: 8.705403888598084e-05, grad_norm: 3.1144304532721605e-07, ic: 0.04705958917225361
train 9, step: 600, loss: 0.00023527703888248652, grad_norm: 0.0001653794333443076, ic: 0.01610137608185013
Epoch 9: 2022-05-06 15:10:04.684709: train loss: 0.00020976312142109336
Eval step 0: eval loss: 0.00018229523266199976
Eval: 2022-05-06 15:10:07.307227: total loss: 0.0001928481155225788, mse:0.0003856962267207279, ic :-0.011280757340371612, sharpe5:-10.35321178793907, irr5:-1.838008165359497, ndcg5:0.8632964197823934, pnl5:0.31829214096069336 
train 10, step: 0, loss: 0.00012091060489183292, grad_norm: 2.980187580351767e-06, ic: 0.03941459389934515
train 10, step: 600, loss: 0.00010983832908095792, grad_norm: 1.3453532768971192e-05, ic: 0.03635618476485148
Epoch 10: 2022-05-06 15:10:19.242109: train loss: 0.00020933871738954032
Eval step 0: eval loss: 0.00018533739785198122
Eval: 2022-05-06 15:10:22.002438: total loss: 0.0001909313939419065, mse:0.00038186278657284853, ic :-0.013638330114536234, sharpe5:-2.78229362860322, irr5:-0.13705307245254517, ndcg5:0.8597717980901964, pnl5:0.2983303964138031 
train 11, step: 0, loss: 0.00018408990581519902, grad_norm: 5.75807706877563e-05, ic: -0.0446995906666937
train 11, step: 600, loss: 0.00021419029508251697, grad_norm: 2.3849517102914352e-06, ic: -0.07759305233901259
Epoch 11: 2022-05-06 15:10:33.728454: train loss: 0.0002088720068698151
Eval step 0: eval loss: 0.00019276223611086607
Eval: 2022-05-06 15:10:36.347078: total loss: 0.00018933916950258068, mse:0.0003786783335431414, ic :0.008618269694820999, sharpe5:-0.9515795105695724, irr5:-0.20229020714759827, ndcg5:0.8605940228595036, pnl5:1.001264214515686 
train 12, step: 0, loss: 0.0001478817721363157, grad_norm: 8.230914631083185e-09, ic: 0.01057484851819529
train 12, step: 600, loss: 0.00017237185966223478, grad_norm: 7.601530322591645e-05, ic: 0.018255043211259793
Epoch 12: 2022-05-06 15:10:48.079871: train loss: 0.0002093236185091145
Eval step 0: eval loss: 0.00021831088815815747
Eval: 2022-05-06 15:10:50.638932: total loss: 0.00019464956035356067, mse:0.0003892991189700372, ic :0.018697544596166023, sharpe5:-1.0014568727463484, irr5:-0.2128095030784607, ndcg5:0.8542070036407872, pnl5:1.0303231477737427 
train 13, step: 0, loss: 0.00014962206478230655, grad_norm: 1.8519974052784733e-05, ic: -0.012311062188498215
train 13, step: 600, loss: 0.00017140270210802555, grad_norm: 2.4135702822700088e-05, ic: 0.06034342074824478
Epoch 13: 2022-05-06 15:11:02.443350: train loss: 0.0002086898986768525
Eval step 0: eval loss: 0.00019700307166203856
Eval: 2022-05-06 15:11:05.105900: total loss: 0.00018942633024005985, mse:0.0003788526573952014, ic :0.021064262727090013, sharpe5:-1.0082642271369695, irr5:-0.21447229385375977, ndcg5:0.8449724223595695, pnl5:1.0105594396591187 
train 14, step: 0, loss: 0.00024132455291692168, grad_norm: 0.00015194289381837434, ic: 0.02669922256513408
train 14, step: 600, loss: 0.00017835119797382504, grad_norm: 0.00011928010364015739, ic: -0.0719153245287745
Epoch 14: 2022-05-06 15:11:16.768559: train loss: 0.0002096025724657355
Eval step 0: eval loss: 0.00021197236492298543
Eval: 2022-05-06 15:11:19.357225: total loss: 0.0001925292057240681, mse:0.0003850584108385164, ic :0.02095250643800855, sharpe5:-0.8592510125041007, irr5:-0.1826002299785614, ndcg5:0.8580517729672906, pnl5:0.9278121590614319 
train 15, step: 0, loss: 0.0006320323445834219, grad_norm: 0.00012463603638254156, ic: -0.024052516168731587
train 15, step: 600, loss: 0.00010981277591781691, grad_norm: 1.7972973263420776e-06, ic: 0.030250270695800635
Epoch 15: 2022-05-06 15:11:31.718094: train loss: 0.00020877997429960413
Eval step 0: eval loss: 0.00018540583550930023
Eval: 2022-05-06 15:11:34.009362: total loss: 0.0001909029837966395, mse:0.0003818059686191175, ic :-0.021352362085919445, sharpe5:-2.4588251084089277, irr5:-0.12042424827814102, ndcg5:0.8543634082866984, pnl5:0.2962377071380615 
train 16, step: 0, loss: 0.00026695127598941326, grad_norm: 0.00018815761963922973, ic: 0.016572434677255592
train 16, step: 600, loss: 0.000135443449835293, grad_norm: 1.081165448846437e-06, ic: -0.021409417261279727
Epoch 16: 2022-05-06 15:11:44.826682: train loss: 0.00020911082629518696
Eval step 0: eval loss: 0.00017792846483644098
Eval: 2022-05-06 15:11:47.441019: total loss: 0.00020058777436010364, mse:0.0004011755433200771, ic :-0.03292118675651505, sharpe5:-3.348423546105623, irr5:-0.178533136844635, ndcg5:0.8620805442706235, pnl5:0.2604774534702301 
train 17, step: 0, loss: 0.0002469810424372554, grad_norm: 5.6564515639940973e-08, ic: -0.018278399266187306
train 17, step: 600, loss: 0.00018223295046482235, grad_norm: 2.2055288257259318e-05, ic: 0.026177086680794825
Epoch 17: 2022-05-06 15:11:59.216950: train loss: 0.00020982093986743634
Eval step 0: eval loss: 0.00021811756596434861
Eval: 2022-05-06 15:12:01.681750: total loss: 0.00019457959678636155, mse:0.0003891591887964383, ic :0.013837851803532293, sharpe5:-1.0364972718805074, irr5:-0.2212783247232437, ndcg5:0.8494847026861263, pnl5:1.0068758726119995 
train 18, step: 0, loss: 0.00022309903579298407, grad_norm: 0.00025908160895158315, ic: -0.02562943120746042
train 18, step: 600, loss: 0.00011644263577181846, grad_norm: 4.6767683893088785e-06, ic: -0.016864978854638883
Epoch 18: 2022-05-06 15:12:12.943689: train loss: 0.00020938051814949643
Eval step 0: eval loss: 0.00021194698638282716
Eval: 2022-05-06 15:12:15.551649: total loss: 0.00019252106396042072, mse:0.000385042123428884, ic :0.024291897437044598, sharpe5:0.6356566989049315, irr5:0.17922718822956085, ndcg5:0.8557703785345161, pnl5:1.1476274728775024 
train 19, step: 0, loss: 0.0001855135924415663, grad_norm: 0.00010678957677420325, ic: 0.0011981465426311715
train 19, step: 600, loss: 0.0003012070374097675, grad_norm: 0.00014088134745303223, ic: 0.05235951272751744
Epoch 19: 2022-05-06 15:12:27.121462: train loss: 0.00020981529236745996
Eval step 0: eval loss: 0.00019049717229790986
Eval: 2022-05-06 15:12:29.716783: total loss: 0.00018953165799016935, mse:0.00037906331439896103, ic :0.021753680013862457, sharpe5:-1.0585287094116211, irr5:-0.22531133890151978, ndcg5:0.8531200211826508, pnl5:1.0017814636230469 
train 20, step: 0, loss: 0.0004801613395102322, grad_norm: 0.000603612158679805, ic: -0.032953795304243784
train 20, step: 600, loss: 0.00012341243564151227, grad_norm: 8.128226780734395e-06, ic: -0.03453284226720289
Epoch 20: 2022-05-06 15:12:41.197161: train loss: 0.00020902508612060636
Eval step 0: eval loss: 0.0002002099499804899
Eval: 2022-05-06 15:12:43.755972: total loss: 0.00018978484228571532, mse:0.0003795696780355451, ic :0.0038977286539603204, sharpe5:-1.023496232405305, irr5:-0.21809786558151245, ndcg5:0.856713199621533, pnl5:1.0085010528564453 
train 21, step: 0, loss: 0.00022705744777340442, grad_norm: 0.00016018616140582912, ic: 0.028185481302632428
train 21, step: 600, loss: 0.00010248047328786924, grad_norm: 1.9603999436606485e-07, ic: -0.1204722374831678
Epoch 21: 2022-05-06 15:12:55.340628: train loss: 0.00020970767154476316
Eval step 0: eval loss: 0.00021442901925183833
Eval: 2022-05-06 15:12:57.919776: total loss: 0.00019331760231744733, mse:0.0003866351946622236, ic :-0.022730657640177603, sharpe5:-0.7002064330503344, irr5:-0.14983856678009033, ndcg5:0.8427598896526842, pnl5:0.9936604499816895 
train 22, step: 0, loss: 0.0001317761925747618, grad_norm: 2.1228081190091926e-05, ic: 0.04544871509404527
train 22, step: 600, loss: 0.0001731102092890069, grad_norm: 3.566143520839018e-05, ic: 0.015718633804085908
Epoch 22: 2022-05-06 15:13:09.584061: train loss: 0.00020855768848009206
Eval step 0: eval loss: 0.00018385026487521827
Eval: 2022-05-06 15:13:12.228329: total loss: 0.0001917217472740407, mse:0.0003834434922246075, ic :0.003397713753660988, sharpe5:-4.301479410231114, irr5:-0.1762336790561676, ndcg5:0.8563309133692142, pnl5:0.28705018758773804 
train 23, step: 0, loss: 0.0001900002680486068, grad_norm: 6.601011424880977e-06, ic: 0.011074709736018668
train 23, step: 600, loss: 0.00012021073052892461, grad_norm: 6.631987147239816e-05, ic: 0.04665059264260199
Epoch 23: 2022-05-06 15:13:23.803234: train loss: 0.00020922153093419477
Eval step 0: eval loss: 0.0002136885595973581
Eval: 2022-05-06 15:13:26.488613: total loss: 0.00019306830219804346, mse:0.00038613659936358776, ic :-0.020893914759876227, sharpe5:-0.5783443606272339, irr5:-0.12469801306724548, ndcg5:0.8583087035813194, pnl5:1.0157067775726318 
train 24, step: 0, loss: 0.00042411399772390723, grad_norm: 0.00016510399983919646, ic: -0.03567473990445414
train 24, step: 600, loss: 0.00016797817079350352, grad_norm: 7.511917292757173e-05, ic: -0.01912615764090374
Epoch 24: 2022-05-06 15:13:37.990790: train loss: 0.00020928498085374264
Eval step 0: eval loss: 0.0001835119619499892
Eval: 2022-05-06 15:13:40.555779: total loss: 0.00019193666750603097, mse:0.0003838733333759554, ic :-0.0063145764090184004, sharpe5:-1.0585287094116211, irr5:-0.22531139850616455, ndcg5:0.8534496897387629, pnl5:1.0017814636230469 
train 25, step: 0, loss: 0.00011544944572960958, grad_norm: 5.096194490213371e-05, ic: -0.015343674802431989
train 25, step: 600, loss: 0.00012373646313790232, grad_norm: 2.340927843608392e-05, ic: 0.06638086604380208
Epoch 25: 2022-05-06 15:13:52.063168: train loss: 0.00021014113144947506
Eval step 0: eval loss: 0.00017914606723934412
Eval: 2022-05-06 15:13:54.725543: total loss: 0.0001970494629702493, mse:0.0003940989230145227, ic :-0.0030143496446146754, sharpe5:-1.062716795504093, irr5:-0.2259642481803894, ndcg5:0.8524896003262546, pnl5:1.0193166732788086 
train 26, step: 0, loss: 0.00025127275148406625, grad_norm: 0.00026212162505502443, ic: -0.001146123020573618
train 26, step: 600, loss: 0.00017227049102075398, grad_norm: 2.097383698462227e-05, ic: -0.05731331009813145
Epoch 26: 2022-05-06 15:14:06.264630: train loss: 0.00020937432208656162
Eval step 0: eval loss: 0.00018895833636634052
Eval: 2022-05-06 15:14:08.948508: total loss: 0.00018978661682922393, mse:0.00037957322635783045, ic :-0.0015560785372754243, sharpe5:-1.0627169137448071, irr5:-0.2259642481803894, ndcg5:0.8558694641354717, pnl5:1.0193166732788086 
train 27, step: 0, loss: 0.0002544242306612432, grad_norm: 0.00017440344656151363, ic: 0.06699386174132449
train 27, step: 600, loss: 9.6347757789772e-05, grad_norm: 1.0267108599769936e-06, ic: -0.007341287658218447
Epoch 27: 2022-05-06 15:14:20.461416: train loss: 0.0002094158263414126
Eval step 0: eval loss: 0.00020266482897568494
Eval: 2022-05-06 15:14:23.043779: total loss: 0.00019019383117208907, mse:0.0003803876601202261, ic :0.018946281537028653, sharpe5:-0.9635746171697974, irr5:-0.20513561367988586, ndcg5:0.8392387207166299, pnl5:1.0175094604492188 
train 28, step: 0, loss: 0.0001181080806418322, grad_norm: 1.333864811434938e-05, ic: -0.002124119625256403
train 28, step: 600, loss: 0.0001410387922078371, grad_norm: 6.106554909118187e-06, ic: -0.034228221452423456
Epoch 28: 2022-05-06 15:14:34.537530: train loss: 0.00020895563711992754
Eval step 0: eval loss: 0.0001874044246505946
Eval: 2022-05-06 15:14:37.142199: total loss: 0.00019017055818212653, mse:0.000380341110173627, ic :0.021811784163854556, sharpe5:-0.9445210129022598, irr5:-0.1953926682472229, ndcg5:0.8541330227557264, pnl5:1.042588710784912 
train 29, step: 0, loss: 0.00012518605217337608, grad_norm: 1.8440632680872657e-05, ic: 0.016431392361470745
train 29, step: 600, loss: 0.0003093176055699587, grad_norm: 0.00010017597029086546, ic: 0.008211682540384136
Epoch 29: 2022-05-06 15:14:48.696864: train loss: 0.00020917114010985275
Eval step 0: eval loss: 0.00019248423632234335
Eval: 2022-05-06 15:14:51.260845: total loss: 0.000189352743213046, mse:0.00037870548362926984, ic :0.011973669887114222, sharpe5:-1.387891292721033, irr5:-0.3183535039424896, ndcg5:0.8447724585353498, pnl5:0.9755030274391174 
train 30, step: 0, loss: 0.00016865502402652055, grad_norm: 4.749430552315579e-05, ic: 0.02931658784068993
train 30, step: 600, loss: 0.00023263643379323184, grad_norm: 1.1244076995568417e-05, ic: 0.07963442450253994
Epoch 30: 2022-05-06 15:15:02.785362: train loss: 0.00020968868726855804
Eval step 0: eval loss: 0.00018543010810390115
Eval: 2022-05-06 15:15:05.476648: total loss: 0.00019089339184574783, mse:0.0003817867816006405, ic :0.0071509107178179925, sharpe5:-1.0863527595251798, irr5:-0.231215238571167, ndcg5:0.8535347321201089, pnl5:0.9967823028564453 
train 31, step: 0, loss: 0.0001437338796677068, grad_norm: 2.1671348666687925e-05, ic: 0.051044575622336566
train 31, step: 600, loss: 0.00018505222396925092, grad_norm: 1.3276045051145123e-05, ic: 0.05308800695756464
Epoch 31: 2022-05-06 15:15:17.063848: train loss: 0.00020906102206051425
Eval step 0: eval loss: 0.00018017287948168814
Eval: 2022-05-06 15:15:19.659428: total loss: 0.00019705927912598873, mse:0.00039411855418400386, ic :0.016004998472317723, sharpe5:-0.9138141359388828, irr5:-0.19501405954360962, ndcg5:0.852403363119044, pnl5:1.0268040895462036 
train 32, step: 0, loss: 0.0001518545759608969, grad_norm: 1.104955196761408e-06, ic: 0.0005736871923827692
train 32, step: 600, loss: 0.00016294819943141192, grad_norm: 1.53140817690931e-05, ic: -0.01313989418285733
Epoch 32: 2022-05-06 15:15:31.334860: train loss: 0.00020940136888089616
Eval step 0: eval loss: 0.00017751484119798988
Eval: 2022-05-06 15:15:33.940021: total loss: 0.00020339111881794163, mse:0.00040678223080558884, ic :-0.025652915186538876, sharpe5:-3.175283904969692, irr5:-0.16396230459213257, ndcg5:0.8514446952773708, pnl5:0.26179301738739014 
train 33, step: 0, loss: 0.00016842747572809458, grad_norm: 8.430937427256276e-07, ic: -0.05735137429416122
train 33, step: 600, loss: 0.00010698795085772872, grad_norm: 4.057331919373734e-05, ic: -0.018455651452070142
Epoch 33: 2022-05-06 15:15:45.678409: train loss: 0.000209828609547765
Eval step 0: eval loss: 0.00021575993741862476
Eval: 2022-05-06 15:15:48.239146: total loss: 0.00019375361832452948, mse:0.00038750723437794987, ic :0.0029093810519507123, sharpe5:-1.090061143040657, irr5:-0.2320041060447693, ndcg5:0.8569463141665736, pnl5:0.9961833357810974 
train 34, step: 0, loss: 0.0001487737608840689, grad_norm: 6.0282325831255826e-05, ic: 0.01724323858578551
train 34, step: 600, loss: 0.00015208993863780051, grad_norm: 0.00014147830275055033, ic: -0.010728677047323894
Epoch 34: 2022-05-06 15:15:59.883399: train loss: 0.0002087564244140742
Eval step 0: eval loss: 0.0001902296207845211
Eval: 2022-05-06 15:16:02.546737: total loss: 0.0001895680686269836, mse:0.00037913613581207797, ic :-0.001461589663560532, sharpe5:-1.0585289458930491, irr5:-0.22531133890151978, ndcg5:0.8569713560286263, pnl5:1.0017814636230469 
train 35, step: 0, loss: 9.69871980487369e-05, grad_norm: 2.788533098436312e-05, ic: 0.0068255061132278675
train 35, step: 600, loss: 0.0002374567702645436, grad_norm: 1.7413599497957757e-05, ic: 0.015977256137520768
Epoch 35: 2022-05-06 15:16:14.273944: train loss: 0.00020890588891996084
Eval step 0: eval loss: 0.00018516719865147024
Eval: 2022-05-06 15:16:16.853460: total loss: 0.000191012435072266, mse:0.00038202486921080984, ic :-0.005309005764430947, sharpe5:1.7707818020135164, irr5:0.2939874231815338, ndcg5:0.8535391005882723, pnl5:1.1492747068405151 
train 36, step: 0, loss: 8.811178850010037e-05, grad_norm: 1.742008462687042e-05, ic: -0.010430019199316784
train 36, step: 600, loss: 0.00010706102330004796, grad_norm: 9.370013251532806e-06, ic: -0.06459187038669566
Epoch 36: 2022-05-06 15:16:28.473104: train loss: 0.00020918313284464356
Eval step 0: eval loss: 0.00019716203678399324
Eval: 2022-05-06 15:16:31.071893: total loss: 0.00018943918616578354, mse:0.000378878370076351, ic :-0.018958966794639796, sharpe5:-3.877738980799913, irr5:-0.1547926515340805, ndcg5:0.8407201052932708, pnl5:0.2909354865550995 
train 37, step: 0, loss: 0.00020183788728900254, grad_norm: 7.967039275609594e-05, ic: 0.031234409454486026
train 37, step: 600, loss: 0.00011586143227759749, grad_norm: 1.2428869229390946e-06, ic: 0.01699524872850589
Epoch 37: 2022-05-06 15:16:42.612540: train loss: 0.00020913783748157487
Eval step 0: eval loss: 0.00019256662926636636
Eval: 2022-05-06 15:16:45.157543: total loss: 0.0001893482421278823, mse:0.00037869647921549366, ic :0.019522764144816775, sharpe5:-1.1312370528280735, irr5:-0.24083206057548523, ndcg5:0.8545976461281576, pnl5:1.0074408054351807 
train 38, step: 0, loss: 0.0003246733103878796, grad_norm: 3.794949073635237e-06, ic: -0.015499226273741552
train 38, step: 600, loss: 0.00041676833643577993, grad_norm: 0.00045329299283857025, ic: 0.001131775435047732
Epoch 38: 2022-05-06 15:16:56.698552: train loss: 0.0002093075232649524
Eval step 0: eval loss: 0.00018976729188580066
Eval: 2022-05-06 15:16:59.318117: total loss: 0.0001896386372180428, mse:0.0003792772705137845, ic :0.0034917554972492496, sharpe5:-0.9837055717036127, irr5:-0.20904254913330078, ndcg5:0.8593408947286835, pnl5:1.0147939920425415 
train 39, step: 0, loss: 0.0001403868373017758, grad_norm: 5.1203126999542645e-08, ic: 0.012614713824192091
train 39, step: 600, loss: 0.000246034178417176, grad_norm: 1.43268876844681e-06, ic: 0.038596686217382534
Epoch 39: 2022-05-06 15:17:11.051844: train loss: 0.00020847540983743023
Eval step 0: eval loss: 0.00018846774764824659
Eval: 2022-05-06 15:17:13.586298: total loss: 0.00018989147325530986, mse:0.00037978294505572097, ic :1.632423863394261e-05, sharpe5:-0.8817513335868716, irr5:-0.18821130692958832, ndcg5:0.8519930508057579, pnl5:1.0184237957000732 
train 40, step: 0, loss: 0.0001770234084688127, grad_norm: 3.537530838735449e-05, ic: 0.00030829975857946893
train 40, step: 600, loss: 0.00026783233624882996, grad_norm: 0.00017379938770659164, ic: 0.056841825165630785
Epoch 40: 2022-05-06 15:17:25.194184: train loss: 0.00020916085836565675
Eval step 0: eval loss: 0.00019937779870815575
Eval: 2022-05-06 15:17:28.029910: total loss: 0.00018967042620608802, mse:0.0003793408479364717, ic :0.0010195839212958093, sharpe5:-1.090061143040657, irr5:-0.2320041060447693, ndcg5:0.8562226743305845, pnl5:0.9961833357810974 
train 41, step: 0, loss: 0.0004205055593047291, grad_norm: 0.0002365171237795536, ic: 0.08195004403073758
train 41, step: 600, loss: 0.00013275128731038421, grad_norm: 1.1699375018701379e-06, ic: -0.15389202626374984
Epoch 41: 2022-05-06 15:17:39.751343: train loss: 0.00020913771612056834
Eval step 0: eval loss: 0.00021103878680150956
Eval: 2022-05-06 15:17:42.386749: total loss: 0.00019224823981405518, mse:0.0003844964762216937, ic :0.004410202539068687, sharpe5:-2.5609432281553746, irr5:-0.2549208998680115, ndcg5:0.8483378819410665, pnl5:0.813407301902771 
train 42, step: 0, loss: 0.0003799543483182788, grad_norm: 0.00012329043721315592, ic: 0.026660169397908915
train 42, step: 600, loss: 0.00020369928097352386, grad_norm: 3.4001162300963496e-05, ic: 0.0583736063122594
Epoch 42: 2022-05-06 15:17:54.090012: train loss: 0.00020953419094144624
Eval step 0: eval loss: 0.00020015978952869773
Eval: 2022-05-06 15:17:56.678706: total loss: 0.000189778300673054, mse:0.000379556597302262, ic :0.005303896245929376, sharpe5:-3.406064238846302, irr5:-0.17766916751861572, ndcg5:0.8644192642669672, pnl5:0.2814939618110657 
train 43, step: 0, loss: 0.00011706720397341996, grad_norm: 2.982869666758039e-06, ic: 0.024230465361233085
train 43, step: 600, loss: 0.0002625495835673064, grad_norm: 7.213173465724497e-05, ic: -0.013984962850200568
Epoch 43: 2022-05-06 15:18:08.235862: train loss: 0.00020835773050478294
Eval step 0: eval loss: 0.00020222323655616492
Eval: 2022-05-06 15:18:10.668362: total loss: 0.00019011271211326046, mse:0.0003802254147813027, ic :0.018576814834847234, sharpe5:-0.4098776516318321, irr5:-0.08970826864242554, ndcg5:0.8471865679259191, pnl5:0.9912236332893372 
train 44, step: 0, loss: 0.00017692909750621766, grad_norm: 4.544202438497843e-06, ic: 0.031194188025847773
train 44, step: 600, loss: 0.00022684063878841698, grad_norm: 4.509750115402162e-05, ic: 0.08511586548739339
Epoch 44: 2022-05-06 15:18:21.258510: train loss: 0.0002096357914647465
Eval step 0: eval loss: 0.0002132134686689824
Eval: 2022-05-06 15:18:23.780646: total loss: 0.00019285175034078892, mse:0.0003857034946817129, ic :0.017870616874833715, sharpe5:-1.058528591170907, irr5:-0.22531133890151978, ndcg5:0.8553808976663057, pnl5:1.0017814636230469 
train 45, step: 0, loss: 8.846665878081694e-05, grad_norm: 6.5160577769816116e-06, ic: 0.07551575501997693
train 45, step: 600, loss: 0.00016667955787852407, grad_norm: 3.800023303104592e-07, ic: -0.018459665125262596
Epoch 45: 2022-05-06 15:18:35.556949: train loss: 0.00020915905131767284
Eval step 0: eval loss: 0.00018655967141967267
Eval: 2022-05-06 15:18:37.978742: total loss: 0.0001904476636863204, mse:0.00038089532006089144, ic :0.004288517435705743, sharpe5:-1.0585289458930491, irr5:-0.22531139850616455, ndcg5:0.8541300408738889, pnl5:1.0017814636230469 
train 46, step: 0, loss: 0.00014955272490624338, grad_norm: 7.231223150488921e-05, ic: -0.0057979731924685425
train 46, step: 600, loss: 0.0005901852855458856, grad_norm: 0.000511154944810461, ic: 0.10585007516478101
Epoch 46: 2022-05-06 15:18:48.777377: train loss: 0.00021017634295473014
Eval step 0: eval loss: 0.0001956450578290969
Eval: 2022-05-06 15:18:51.349127: total loss: 0.00018934304419693186, mse:0.00037868608276169023, ic :0.00043628821417428444, sharpe5:-1.0260004524886608, irr5:-0.21823924779891968, ndcg5:0.8500979042534574, pnl5:1.0260318517684937 
train 47, step: 0, loss: 0.00014025165000930429, grad_norm: 2.9955861282095714e-06, ic: -0.010478933656365007
train 47, step: 600, loss: 0.0001887519028969109, grad_norm: 4.816202859757169e-05, ic: -0.07568635353504544
Epoch 47: 2022-05-06 15:19:02.967614: train loss: 0.0002093823880558547
Eval step 0: eval loss: 0.00018747257126960903
Eval: 2022-05-06 15:19:05.575187: total loss: 0.00019014598249944507, mse:0.0003802919596577154, ic :0.00022102263429076967, sharpe5:-1.0014568727463484, irr5:-0.21280953288078308, ndcg5:0.8508942041669296, pnl5:1.0303230285644531 
train 48, step: 0, loss: 0.00023583124857395887, grad_norm: 0.00013297354732024253, ic: -0.05470475527448144
train 48, step: 600, loss: 0.00019858035375364125, grad_norm: 7.853409544549206e-06, ic: 0.010650927166721176
Epoch 48: 2022-05-06 15:19:17.206942: train loss: 0.00020961811133020093
Eval step 0: eval loss: 0.00018823728896677494
Eval: 2022-05-06 15:19:19.840012: total loss: 0.00018994732640317021, mse:0.0003798946494462293, ic :0.0063714578811647545, sharpe5:-0.6233975016698241, irr5:-0.06491976231336594, ndcg5:0.8537739743034631, pnl5:0.9100221991539001 
train 49, step: 0, loss: 8.049513417063281e-05, grad_norm: 7.767507610419937e-08, ic: 0.080391621861748
train 49, step: 600, loss: 0.00021012092474848032, grad_norm: 0.0001733537737492463, ic: 0.028260508404216764
Epoch 49: 2022-05-06 15:19:31.486917: train loss: 0.0002090394065079808
Eval step 0: eval loss: 0.00019076997705269605
Eval: 2022-05-06 15:19:34.143865: total loss: 0.00018949790264988673, mse:0.00037899580464860716, ic :-0.01496486069279856, sharpe5:-3.970219536423683, irr5:-0.15806561708450317, ndcg5:0.8507949324402718, pnl5:0.29436659812927246 
train 50, step: 0, loss: 0.00018863281002268195, grad_norm: 1.4117354237576706e-05, ic: -0.04735413141350253
train 50, step: 600, loss: 0.0002989409549627453, grad_norm: 0.0003009268514951465, ic: -0.00825599098884236
Epoch 50: 2022-05-06 15:19:45.789813: train loss: 0.00020880333058075111
Eval step 0: eval loss: 0.0001915237953653559
Eval: 2022-05-06 15:19:48.389605: total loss: 0.00018941993121641406, mse:0.0003788398578389696, ic :-0.0010070277967706702, sharpe5:-1.0585287094116211, irr5:-0.22531139850616455, ndcg5:0.8595061000633132, pnl5:1.0017814636230469 
train 51, step: 0, loss: 0.0001976582279894501, grad_norm: 6.220522187767066e-05, ic: 0.06217707145480506
train 51, step: 600, loss: 0.00022285619343165308, grad_norm: 0.00010020791136166516, ic: -0.055081735064366116
Epoch 51: 2022-05-06 15:19:59.975582: train loss: 0.0002096821404848015
Eval step 0: eval loss: 0.0001927310659084469
Eval: 2022-05-06 15:20:02.567467: total loss: 0.00018933964504073354, mse:0.0003786792884688592, ic :0.001049390774975985, sharpe5:-1.0585290641337632, irr5:-0.22531139850616455, ndcg5:0.8489148808732028, pnl5:1.0017814636230469 
train 52, step: 0, loss: 0.0003404873423278332, grad_norm: 8.572263546994898e-05, ic: 0.0563163274879462
train 52, step: 600, loss: 9.13119365577586e-05, grad_norm: 5.444348852354558e-06, ic: 0.011507543451860619
Epoch 52: 2022-05-06 15:20:14.328562: train loss: 0.0002095772279308467
Eval step 0: eval loss: 0.00021168857347220182
Eval: 2022-05-06 15:20:16.980455: total loss: 0.0001924434301182122, mse:0.00038488685712956657, ic :-0.00532628767869185, sharpe5:-0.5277890653163194, irr5:-0.12326027452945709, ndcg5:0.8445967844052261, pnl5:0.9899603128433228 
train 53, step: 0, loss: 0.00013486578245647252, grad_norm: 3.30211037908155e-05, ic: 0.013571142366732961
train 53, step: 600, loss: 0.00014034764899406582, grad_norm: 1.4027129718739685e-05, ic: 0.04001769996877977
Epoch 53: 2022-05-06 15:20:28.823662: train loss: 0.00020929066802735278
Eval step 0: eval loss: 0.00018549752712715417
Eval: 2022-05-06 15:20:31.408172: total loss: 0.00019086422901748093, mse:0.00038172845311846784, ic :0.0024515042098940177, sharpe5:-1.0399980247020721, irr5:-0.22138386964797974, ndcg5:0.8593142442310774, pnl5:0.986926257610321 
train 54, step: 0, loss: 0.00016820142627693713, grad_norm: 1.2512378905165671e-05, ic: -0.003730692422624759
train 54, step: 600, loss: 0.00013445783406496048, grad_norm: 9.724547906656796e-06, ic: -0.014429800539065743
Epoch 54: 2022-05-06 15:20:43.106018: train loss: 0.00020909872434237293
Eval step 0: eval loss: 0.00022473573335446417
Eval: 2022-05-06 15:20:45.820157: total loss: 0.0001971240321527724, mse:0.0003942480636616375, ic :-0.006843637964688446, sharpe5:-1.0585287094116211, irr5:-0.22531139850616455, ndcg5:0.8520154264885481, pnl5:1.0017814636230469 
train 55, step: 0, loss: 0.00020065458375029266, grad_norm: 0.00012206889387657695, ic: -0.011422268378761539
