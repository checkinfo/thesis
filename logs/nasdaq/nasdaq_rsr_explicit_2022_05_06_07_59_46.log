Namespace(adj_path='../Temporal_Relational_Stock_Ranking/data/relation/sector_industry/NASDAQ_industry_relation.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=True, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=1, market='NASDAQ', mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1026, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=False)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
relation encoding shape: torch.Size([1026, 1026, 97]) torch.float32
relation mask shape: torch.Size([1026, 1026]) torch.float32
97592
ReRaLSTM(
  (rnn1): LSTM(5, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=97, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.00027929700445383787, grad_norm: 0.00019503523809744002, ic: -0.04636111358067544
train 0, step: 500, loss: 0.00012189741391921416, grad_norm: 4.332429596921214e-10, ic: -0.03476858113720478
Epoch 0: 2022-05-06 20:01:10.953214: train loss: 0.0002077421773077838
Eval step 0: eval loss: 0.00015092751709744334
Eval: 2022-05-06 20:01:13.575251: total loss: 0.0001895458320388062, mse:0.00037909166177857944, ic :0.022018911724929886, sharpe5:-0.9536000670120119, irr5:-0.2069167196750641, ndcg5:0.8510243933193592, pnl5:0.9421778917312622 
train 1, step: 0, loss: 0.00010644062422215939, grad_norm: 4.438324213074003e-09, ic: 0.0009549224430861307
train 1, step: 500, loss: 0.00018606522644404322, grad_norm: 1.7892787027049628e-08, ic: 0.04330308827423171
Epoch 1: 2022-05-06 20:01:19.916942: train loss: 0.00020693453495276477
Eval step 0: eval loss: 0.00014674937119707465
Eval: 2022-05-06 20:01:22.577319: total loss: 0.000189006827446565, mse:0.0003780136537875179, ic :0.004607059031164878, sharpe5:1.9675107020884752, irr5:0.2698482871055603, ndcg5:0.8460539583742374, pnl5:1.1976910829544067 
train 2, step: 0, loss: 0.00014091783668845892, grad_norm: 1.7110714643157959e-09, ic: -0.0075132224619710464
train 2, step: 500, loss: 0.00010922742512775585, grad_norm: 4.787398788534975e-11, ic: 0.02224961617549872
Epoch 2: 2022-05-06 20:01:29.046791: train loss: 0.00020701408001596891
Eval step 0: eval loss: 0.00014681862376164645
Eval: 2022-05-06 20:01:31.754217: total loss: 0.00018900867201302477, mse:0.0003780173434736626, ic :0.014260798329769942, sharpe5:-1.7218850100785492, irr5:-0.22547797858715057, ndcg5:0.8515400871556614, pnl5:0.8746873140335083 
train 3, step: 0, loss: 0.00013389815285336226, grad_norm: 1.0596291002890485e-10, ic: -0.07955294940322022
train 3, step: 500, loss: 0.0002576661354396492, grad_norm: 1.46166901032027e-08, ic: 0.04080051540794797
Epoch 3: 2022-05-06 20:01:38.405357: train loss: 0.00020671555637546165
Eval step 0: eval loss: 0.00014978092804085463
Eval: 2022-05-06 20:01:40.970006: total loss: 0.0001893692705058391, mse:0.00037873853814748436, ic :0.021847017799391296, sharpe5:-0.9225380540639162, irr5:-0.16983653604984283, ndcg5:0.8485024804448162, pnl5:1.0062307119369507 
train 4, step: 0, loss: 0.00014332050341181457, grad_norm: 1.1059644622826717e-09, ic: -0.0025671153241511833
train 4, step: 500, loss: 0.00023340914049185812, grad_norm: 5.643925054162207e-09, ic: 0.1117006584898754
Epoch 4: 2022-05-06 20:01:47.320749: train loss: 0.00020680378432622035
Eval step 0: eval loss: 0.00014816029579378664
Eval: 2022-05-06 20:01:50.025032: total loss: 0.00018916067277263305, mse:0.0003783213409214577, ic :0.013011827062073622, sharpe5:-0.7106548919901251, irr5:-0.13258957862854004, ndcg5:0.8594965850833783, pnl5:1.061861515045166 
train 5, step: 0, loss: 0.00023169060295913368, grad_norm: 8.760126437387026e-09, ic: 0.04019739193445441
train 5, step: 500, loss: 0.0005734573351219296, grad_norm: 4.8956936390599674e-08, ic: 0.05199963474676561
Epoch 5: 2022-05-06 20:01:56.641725: train loss: 0.0002069003059056648
Eval step 0: eval loss: 0.00014957245730329305
Eval: 2022-05-06 20:01:59.192576: total loss: 0.00018934038593906575, mse:0.0003786807679993544, ic :0.021446180590754874, sharpe5:-1.097125198021531, irr5:-0.20444276928901672, ndcg5:0.8521624313762295, pnl5:0.9780689477920532 
train 6, step: 0, loss: 0.00016007342492230237, grad_norm: 1.1809476041358023e-08, ic: 0.06774362792141808
train 6, step: 500, loss: 0.00012284907279536128, grad_norm: 5.628415197686717e-09, ic: 0.0666041603380351
Epoch 6: 2022-05-06 20:02:05.640300: train loss: 0.00020698373713759385
Eval step 0: eval loss: 0.00014899420784786344
Eval: 2022-05-06 20:02:08.271035: total loss: 0.00018927021946338123, mse:0.00037854043675064446, ic :0.007049175524243189, sharpe5:-1.2616713405400515, irr5:-0.26271238923072815, ndcg5:0.8532310858607884, pnl5:0.8951743841171265 
train 7, step: 0, loss: 0.00020647674682550132, grad_norm: 6.134713259261513e-10, ic: 0.11826121787463718
train 7, step: 500, loss: 0.00033313652966171503, grad_norm: 7.23798403199059e-09, ic: 0.18058244098247145
Epoch 7: 2022-05-06 20:02:14.603061: train loss: 0.00020686655475668993
Eval step 0: eval loss: 0.00014828622806817293
Eval: 2022-05-06 20:02:17.159648: total loss: 0.00018917583853721122, mse:0.0003783516709547377, ic :0.012087842233510303, sharpe5:-0.8993074192106724, irr5:-0.18670225143432617, ndcg5:0.8501865496191819, pnl5:0.844738781452179 
train 8, step: 0, loss: 0.00015019830607343465, grad_norm: 2.9555590114002135e-10, ic: 0.09326755873097439
train 8, step: 500, loss: 0.0001608512829989195, grad_norm: 5.161302012366063e-09, ic: 0.0019992646843144113
Epoch 8: 2022-05-06 20:02:23.933451: train loss: 0.0002067332185339805
Eval step 0: eval loss: 0.00014674487465526909
Eval: 2022-05-06 20:02:26.637542: total loss: 0.0001890014248097409, mse:0.0003780028512825536, ic :0.02176511329387856, sharpe5:-0.6127547141164541, irr5:-0.09436170011758804, ndcg5:0.8506980772519221, pnl5:0.9452335834503174 
train 9, step: 0, loss: 0.00013918282638769597, grad_norm: 1.6013368290582765e-09, ic: 0.02282837612335465
train 9, step: 500, loss: 8.290475670946762e-05, grad_norm: 5.355989894644478e-10, ic: 0.029533967666342004
Epoch 9: 2022-05-06 20:02:33.183295: train loss: 0.00020685717928162458
Eval step 0: eval loss: 0.00014925752475392073
Eval: 2022-05-06 20:02:35.919246: total loss: 0.0001893013412441436, mse:0.00037860267883117223, ic :0.01979367139348248, sharpe5:-0.5368622073903679, irr5:-0.09936410188674927, ndcg5:0.849222118164753, pnl5:1.0399044752120972 
train 10, step: 0, loss: 9.71115950960666e-05, grad_norm: 1.0453567154508314e-09, ic: 0.045543485948889406
train 10, step: 500, loss: 0.00026165141025558114, grad_norm: 1.7052836268313013e-08, ic: 0.012934832657618325
Epoch 10: 2022-05-06 20:02:42.594795: train loss: 0.00020756085922813634
Eval step 0: eval loss: 0.00015013906522653997
Eval: 2022-05-06 20:02:45.338621: total loss: 0.00018942801048724982, mse:0.00037885601977289324, ic :0.024207443653123, sharpe5:-0.7320900416001677, irr5:-0.1516750454902649, ndcg5:0.8445631639129811, pnl5:0.9144483208656311 
train 11, step: 0, loss: 0.00023265453637577593, grad_norm: 9.104348968450917e-13, ic: 0.018214234104412048
train 11, step: 500, loss: 0.00022506798268295825, grad_norm: 9.811272114628533e-10, ic: 0.005208332875373374
Epoch 11: 2022-05-06 20:02:51.979845: train loss: 0.0002069275645415979
Eval step 0: eval loss: 0.0001496270706411451
Eval: 2022-05-06 20:02:54.758517: total loss: 0.00018935352142551492, mse:0.00037870703827797, ic :0.02331192436195597, sharpe5:-1.021787181124091, irr5:-0.17101627588272095, ndcg5:0.846599731315241, pnl5:0.8611171245574951 
train 12, step: 0, loss: 0.0001490823196945712, grad_norm: 3.759135099563294e-09, ic: 0.018244128021921626
train 12, step: 500, loss: 0.000141916360007599, grad_norm: 1.8089009306388327e-09, ic: 0.043896469576908015
Epoch 12: 2022-05-06 20:03:01.195672: train loss: 0.00020686296455310453
Eval step 0: eval loss: 0.0001478172343922779
Eval: 2022-05-06 20:03:03.906148: total loss: 0.00018911680885195107, mse:0.0003782336149447017, ic :0.021400976229382904, sharpe5:-0.3637543434463441, irr5:-0.07266397774219513, ndcg5:0.8522182231597419, pnl5:0.8830291628837585 
train 13, step: 0, loss: 0.00016967818373814225, grad_norm: 1.583807367489718e-09, ic: 0.0023106405320867506
train 13, step: 500, loss: 0.00012347941810730845, grad_norm: 9.844778247428822e-13, ic: 0.03364878344573872
Epoch 13: 2022-05-06 20:03:10.547091: train loss: 0.0002067787752208645
Eval step 0: eval loss: 0.0001477226905990392
Eval: 2022-05-06 20:03:13.172178: total loss: 0.00018910491291543378, mse:0.0003782098235255434, ic :0.02173853681985576, sharpe5:-1.4240540327131748, irr5:-0.22028350830078125, ndcg5:0.8495790271877398, pnl5:0.8963549137115479 
train 14, step: 0, loss: 0.00020684031187556684, grad_norm: 7.275298494601096e-10, ic: 0.09952708219953377
train 14, step: 500, loss: 0.00017339647456537932, grad_norm: 5.092732368187175e-10, ic: -0.014187787686785117
Epoch 14: 2022-05-06 20:03:19.708130: train loss: 0.00020674924802305586
Eval step 0: eval loss: 0.000147102284245193
Eval: 2022-05-06 20:03:22.362180: total loss: 0.0001890366327555903, mse:0.000378073260360075, ic :0.025770773156202263, sharpe5:0.605340075418353, irr5:0.16541390120983124, ndcg5:0.8537057120665058, pnl5:0.9666709303855896 
train 15, step: 0, loss: 0.0001436635066056624, grad_norm: 1.4488257909755037e-09, ic: 0.0988945772178869
train 15, step: 500, loss: 0.00010648473835317418, grad_norm: 6.817189508679223e-10, ic: -0.05307574971064838
Epoch 15: 2022-05-06 20:03:28.696270: train loss: 0.00020672659204799194
Eval step 0: eval loss: 0.00014655997802037746
Eval: 2022-05-06 20:03:31.347852: total loss: 0.00018898603920957, mse:0.00037797207402756535, ic :0.038708282427903626, sharpe5:2.45579743668437, irr5:0.4822840392589569, ndcg5:0.8622044570986922, pnl5:1.1412397623062134 
train 16, step: 0, loss: 0.00023589079501107335, grad_norm: 6.943957170642438e-09, ic: -0.00010085104803995429
train 16, step: 500, loss: 0.0001390631659887731, grad_norm: 4.607812472815896e-09, ic: 0.051807733628118566
Epoch 16: 2022-05-06 20:03:37.959270: train loss: 0.00020708508429651798
Eval step 0: eval loss: 0.00014941341942176223
Eval: 2022-05-06 20:03:40.596042: total loss: 0.00018932764132087237, mse:0.00037865527708283935, ic :0.02057202127064584, sharpe5:1.490415451079607, irr5:0.3752286434173584, ndcg5:0.854095674696797, pnl5:1.2588351964950562 
train 17, step: 0, loss: 0.00014300104521680623, grad_norm: 1.4177036676370795e-10, ic: -0.0014921254926736445
train 17, step: 500, loss: 8.054851787164807e-05, grad_norm: 2.433518505283047e-11, ic: -0.04831755538822055
Epoch 17: 2022-05-06 20:03:47.150841: train loss: 0.00020686440054796645
Eval step 0: eval loss: 0.00014746503438800573
Eval: 2022-05-06 20:03:49.720726: total loss: 0.00018908248323511016, mse:0.00037816496562781854, ic :0.01905888093158837, sharpe5:-0.8974945525825023, irr5:-0.20401528477668762, ndcg5:0.8556255634019134, pnl5:0.9394649863243103 
train 18, step: 0, loss: 0.000363767147064209, grad_norm: 2.7865982952921794e-08, ic: 0.0142648341254304
train 18, step: 500, loss: 0.00026671960949897766, grad_norm: 2.0387523359632826e-08, ic: 0.03255905956829751
Epoch 18: 2022-05-06 20:03:56.290538: train loss: 0.00020678306307497665
Eval step 0: eval loss: 0.0001481694052927196
Eval: 2022-05-06 20:03:58.985159: total loss: 0.00018916554086486804, mse:0.000378331078676471, ic :0.021179339270894864, sharpe5:1.8339008235186338, irr5:0.5363970398902893, ndcg5:0.8538864566410652, pnl5:1.0916773080825806 
train 19, step: 0, loss: 0.00021611472766380757, grad_norm: 1.6924765030887366e-08, ic: -0.04901629342167976
train 19, step: 500, loss: 0.00020685225899796933, grad_norm: 2.5121695348893786e-11, ic: 0.03599433064504255
Epoch 19: 2022-05-06 20:04:05.564877: train loss: 0.00020702250156727313
Eval step 0: eval loss: 0.00014978641411289573
Eval: 2022-05-06 20:04:08.133622: total loss: 0.0001893775883869382, mse:0.00037875517257167417, ic :0.02282263531916807, sharpe5:0.030049704312114043, irr5:0.006108498200774193, ndcg5:0.854238975503127, pnl5:0.8972941040992737 
train 20, step: 0, loss: 0.00023100731777958572, grad_norm: 1.029501001548599e-09, ic: -0.03069271350066218
train 20, step: 500, loss: 0.00010414102871436626, grad_norm: 2.815614212518459e-10, ic: -0.04713800825880685
Epoch 20: 2022-05-06 20:04:14.862360: train loss: 0.00020710311227617847
Eval step 0: eval loss: 0.00014874896442051977
Eval: 2022-05-06 20:04:17.365219: total loss: 0.000189233189255536, mse:0.00037846637536008545, ic :0.022903580424553163, sharpe5:-0.17201827576383946, irr5:-0.031620122492313385, ndcg5:0.8627020487009357, pnl5:0.962539792060852 
train 21, step: 0, loss: 0.0003680929366964847, grad_norm: 3.889608660216442e-08, ic: -0.044053218683230394
train 21, step: 500, loss: 0.00019861610780935735, grad_norm: 1.2666245165545384e-07, ic: 0.05537739482819366
Epoch 21: 2022-05-06 20:04:23.456775: train loss: 0.00020734186365252316
Eval step 0: eval loss: 0.00014973133511375636
Eval: 2022-05-06 20:04:26.174902: total loss: 0.00018936675839409777, mse:0.0003787335138501672, ic :0.024478525884272788, sharpe5:0.15361767061986029, irr5:0.03017229586839676, ndcg5:0.8648246812959105, pnl5:1.1111787557601929 
train 22, step: 0, loss: 0.00012641699868254364, grad_norm: 6.897096991454759e-10, ic: 0.0008979610513393521
train 22, step: 500, loss: 0.00014266812650021166, grad_norm: 9.217192112318249e-09, ic: 0.035369797070330666
Epoch 22: 2022-05-06 20:04:32.984311: train loss: 0.00020699873255551133
Eval step 0: eval loss: 0.0001480353093938902
Eval: 2022-05-06 20:04:35.646024: total loss: 0.00018914305269092884, mse:0.00037828610421224753, ic :0.024953069388860518, sharpe5:-0.6856756543368101, irr5:-0.1292668879032135, ndcg5:0.8550470438464572, pnl5:1.030140995979309 
train 23, step: 0, loss: 0.00018231540161650628, grad_norm: 3.459624680410121e-09, ic: 0.003079713988556561
train 23, step: 500, loss: 0.00012372495257295668, grad_norm: 8.067676362615485e-09, ic: 0.016226313384448573
Epoch 23: 2022-05-06 20:04:42.370571: train loss: 0.00020744858774898777
Eval step 0: eval loss: 0.0001496904151281342
Eval: 2022-05-06 20:04:44.830459: total loss: 0.00018936375558414948, mse:0.0003787275107632098, ic :0.023763238608131374, sharpe5:-0.8159413899108767, irr5:-0.1552850753068924, ndcg5:0.860223522042731, pnl5:0.864349901676178 
train 24, step: 0, loss: 0.00016585405683144927, grad_norm: 1.0059512161062692e-09, ic: 0.0031765256415205462
train 24, step: 500, loss: 0.00020921166287735105, grad_norm: 3.3161276477804973e-09, ic: 0.02833088630594147
Epoch 24: 2022-05-06 20:04:51.221314: train loss: 0.0002068999527834037
Eval step 0: eval loss: 0.00014830140571575612
Eval: 2022-05-06 20:04:53.870112: total loss: 0.00018917815667637074, mse:0.00037835630894534397, ic :0.02627570286093041, sharpe5:-1.7724925086647272, irr5:-0.22988289594650269, ndcg5:0.8573825818010422, pnl5:0.9071361422538757 
train 25, step: 0, loss: 0.00014063110575079918, grad_norm: 1.0561245184170493e-08, ic: 0.0029266752494293575
train 25, step: 500, loss: 0.0001811747788451612, grad_norm: 1.4694873044866866e-08, ic: -0.035366159995701835
Epoch 25: 2022-05-06 20:05:00.223770: train loss: 0.00020684581081671478
Eval step 0: eval loss: 0.00014768952678423375
Eval: 2022-05-06 20:05:02.793344: total loss: 0.00018910448852693662, mse:0.0003782089723648338, ic :0.024387635195043434, sharpe5:-0.16846594043076038, irr5:-0.031725574284791946, ndcg5:0.8503379419361974, pnl5:1.0152086019515991 
train 26, step: 0, loss: 0.00015357203665189445, grad_norm: 2.199265800077276e-08, ic: 0.07316203254498681
train 26, step: 500, loss: 7.472142169717699e-05, grad_norm: 2.6102879825126548e-09, ic: 0.0017418702466815697
Epoch 26: 2022-05-06 20:05:09.353372: train loss: 0.00020681209049328763
Eval step 0: eval loss: 0.00014845914847683161
Eval: 2022-05-06 20:05:11.925108: total loss: 0.00018919669997860073, mse:0.00037839339514168514, ic :0.021374113794652948, sharpe5:-0.8122633351385593, irr5:-0.14867639541625977, ndcg5:0.8499862639141742, pnl5:0.9747099280357361 
train 27, step: 0, loss: 0.00020212795061524957, grad_norm: 8.888485657676104e-09, ic: -0.021947401373167176
train 27, step: 500, loss: 0.0001758735452312976, grad_norm: 3.80768869267237e-09, ic: -0.012592202290027351
Epoch 27: 2022-05-06 20:05:18.832144: train loss: 0.0002069332230334073
Eval step 0: eval loss: 0.00014926410221960396
Eval: 2022-05-06 20:05:21.525133: total loss: 0.0001893048444747575, mse:0.00037860968662837766, ic :0.01939651925304546, sharpe5:-0.4014340231195092, irr5:-0.07540822774171829, ndcg5:0.8510399962546561, pnl5:1.064213752746582 
train 28, step: 0, loss: 0.0003153523139189929, grad_norm: 1.048413777115314e-09, ic: -0.0014757637977373672
train 28, step: 500, loss: 0.00017983555153477937, grad_norm: 4.28238633766189e-09, ic: 0.019907463600161348
Epoch 28: 2022-05-06 20:05:28.253777: train loss: 0.00020689230074729854
Eval step 0: eval loss: 0.00014789383567404002
Eval: 2022-05-06 20:05:30.821719: total loss: 0.00018912761485637226, mse:0.0003782552264202289, ic :0.02370600827666332, sharpe5:-0.379290995914489, irr5:-0.06581809371709824, ndcg5:0.8520379283980867, pnl5:1.0153008699417114 
train 29, step: 0, loss: 0.0001806633808882907, grad_norm: 1.5930058133436602e-10, ic: 0.050454391128402526
train 29, step: 500, loss: 0.00012463220627978444, grad_norm: 1.4278782834435397e-09, ic: 0.021391011661991432
Epoch 29: 2022-05-06 20:05:37.188005: train loss: 0.00020683193166006728
Eval step 0: eval loss: 0.000149334708112292
Eval: 2022-05-06 20:05:39.858503: total loss: 0.00018931682101871786, mse:0.0003786336384339819, ic :0.015900165454670098, sharpe5:-0.25346960362046955, irr5:-0.04771706461906433, ndcg5:0.8627633308649787, pnl5:0.983232855796814 
train 30, step: 0, loss: 0.00015128334052860737, grad_norm: 3.763053514807397e-09, ic: 0.04472121406873699
train 30, step: 500, loss: 0.0002201548486482352, grad_norm: 6.797710010518044e-10, ic: 0.03882802510258344
Epoch 30: 2022-05-06 20:05:46.572151: train loss: 0.00020704689145750892
Eval step 0: eval loss: 0.00015025408356450498
Eval: 2022-05-06 20:05:49.276049: total loss: 0.00018944795455429783, mse:0.00037889590686095544, ic :0.011566638282632291, sharpe5:-1.0388804134726524, irr5:-0.2145046591758728, ndcg5:0.8514059919033522, pnl5:0.8379678726196289 
train 31, step: 0, loss: 0.00012329606397543103, grad_norm: 4.032920625951388e-09, ic: 0.06810272665132054
train 31, step: 500, loss: 0.00012774107744917274, grad_norm: 2.2350514383484465e-09, ic: 0.014148189543508563
Epoch 31: 2022-05-06 20:05:55.881254: train loss: 0.00020688793513868478
Eval step 0: eval loss: 0.00014700503379572183
Eval: 2022-05-06 20:05:58.450109: total loss: 0.0001890293424049246, mse:0.0003780586831526095, ic :0.018121009667896402, sharpe5:-1.1640850326418877, irr5:-0.2421189248561859, ndcg5:0.8467709618307873, pnl5:0.8062174320220947 
train 32, step: 0, loss: 0.00020585671882145107, grad_norm: 1.405823561033432e-07, ic: 0.0695905957891655
train 32, step: 500, loss: 0.00017561948334332556, grad_norm: 1.2881801267801294e-12, ic: 0.02139857503590812
Epoch 32: 2022-05-06 20:06:05.092859: train loss: 0.0002068790884010393
Eval step 0: eval loss: 0.00014835021283943206
Eval: 2022-05-06 20:06:07.690733: total loss: 0.00018920889295847052, mse:0.00037841778101408845, ic :0.001181824300456457, sharpe5:-1.2624908669292927, irr5:-0.2524425685405731, ndcg5:0.8528817760222626, pnl5:0.8595086932182312 
train 33, step: 0, loss: 0.0001741815940476954, grad_norm: 6.672645107793452e-10, ic: 0.06327430884500641
train 33, step: 500, loss: 8.252871339209378e-05, grad_norm: 2.839634420173656e-10, ic: 0.06442880313903404
Epoch 33: 2022-05-06 20:06:14.428395: train loss: 0.00020684126523028585
Eval step 0: eval loss: 0.00014805189857725054
Eval: 2022-05-06 20:06:17.071455: total loss: 0.00018914530928628966, mse:0.00037829061243419427, ic :0.025783829540192156, sharpe5:-1.3526822823286055, irr5:-0.28101885318756104, ndcg5:0.8591444016598904, pnl5:0.9540519714355469 
train 34, step: 0, loss: 0.0001733505487209186, grad_norm: 1.6913171530280986e-10, ic: -0.013790397141933808
train 34, step: 500, loss: 0.0001402409397996962, grad_norm: 4.625323115433416e-09, ic: 0.01773339763750377
Epoch 34: 2022-05-06 20:06:23.788656: train loss: 0.00020689210744319735
Eval step 0: eval loss: 0.0001479633356211707
Eval: 2022-05-06 20:06:26.503230: total loss: 0.00018913066488061319, mse:0.0003782613309538708, ic :0.025761501029420656, sharpe5:-0.9340463636443018, irr5:-0.1928340196609497, ndcg5:0.8568256827665434, pnl5:0.8280757665634155 
train 35, step: 0, loss: 0.0004137110081501305, grad_norm: 5.608582360432832e-08, ic: -0.0059742610325450585
train 35, step: 500, loss: 0.00030116591369733214, grad_norm: 1.7602120588181513e-07, ic: -0.015376581324765264
Epoch 35: 2022-05-06 20:06:33.077458: train loss: 0.00020684029357867343
Eval step 0: eval loss: 0.00014812612789683044
Eval: 2022-05-06 20:06:35.846108: total loss: 0.0001891534022481575, mse:0.0003783068002027944, ic :0.03026964526131104, sharpe5:-0.5471991653367877, irr5:-0.10555577278137207, ndcg5:0.8528416878148831, pnl5:1.021397590637207 
train 36, step: 0, loss: 0.00025385303888469934, grad_norm: 1.8960331643720796e-08, ic: 0.0607422204300726
train 36, step: 500, loss: 0.0004682383150793612, grad_norm: 1.662026549929551e-08, ic: -0.012826502278347827
Epoch 36: 2022-05-06 20:06:42.629325: train loss: 0.00020675471302108339
Eval step 0: eval loss: 0.00014808648847974837
Eval: 2022-05-06 20:06:45.298486: total loss: 0.00018914181371290628, mse:0.0003782836250227871, ic :0.02407986001374671, sharpe5:-1.6333457721769808, irr5:-0.23220786452293396, ndcg5:0.8532078156045699, pnl5:0.8674934506416321 
train 37, step: 0, loss: 0.0002795920881908387, grad_norm: 2.9060177269277747e-08, ic: 0.025478735626396982
train 37, step: 500, loss: 0.0001565024722367525, grad_norm: 1.6671065181015274e-11, ic: 0.034784490432816076
Epoch 37: 2022-05-06 20:06:51.933873: train loss: 0.0002068701218046375
Eval step 0: eval loss: 0.0001481732033425942
Eval: 2022-05-06 20:06:54.637590: total loss: 0.00018915048497042712, mse:0.00037830096670598976, ic :0.02663026373861024, sharpe5:-1.0773597255349159, irr5:-0.15437257289886475, ndcg5:0.8547469112079489, pnl5:0.8892273902893066 
train 38, step: 0, loss: 0.00015802649431861937, grad_norm: 3.329109290850152e-12, ic: -0.008883352261921119
train 38, step: 500, loss: 0.0003013355890288949, grad_norm: 5.966865691262036e-11, ic: 0.058943669624405594
Epoch 38: 2022-05-06 20:07:01.247044: train loss: 0.00020702145521550496
Eval step 0: eval loss: 0.00014910697063896805
Eval: 2022-05-06 20:07:03.812645: total loss: 0.00018927556424204456, mse:0.0003785511232629775, ic :0.03319816757413223, sharpe5:-0.8898469205573201, irr5:-0.16398636996746063, ndcg5:0.845265512384538, pnl5:0.9275285005569458 
train 39, step: 0, loss: 0.00036706350510939956, grad_norm: 2.891653932040627e-08, ic: 0.008585159357368546
train 39, step: 500, loss: 0.0001854377769632265, grad_norm: 2.565414817875343e-09, ic: -0.06399202526209602
Epoch 39: 2022-05-06 20:07:10.122204: train loss: 0.000206818962377483
Eval step 0: eval loss: 0.00014805015234742314
Eval: 2022-05-06 20:07:12.714083: total loss: 0.00018913526566878092, mse:0.0003782705294573129, ic :0.027310153960200974, sharpe5:-0.7722998065128922, irr5:-0.15921726822853088, ndcg5:0.8556963979145809, pnl5:0.9147014021873474 
