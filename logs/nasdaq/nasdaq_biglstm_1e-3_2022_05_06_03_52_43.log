Namespace(adj_path='./data/graphs/NASDAQ_1026_1026.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQAdjSeqTimeDataset', dout=0.3, epochs=60, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=True, label_cnt=1, lr=0.001, lstm_layers=1, market='NASDAQ', mask_adj=True, mask_type='soft', model_type='BiGLSTM', normalize_adj=True, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=True)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
97185
BiGLSTM(
  (input_to_hidden): Linear(in_features=5, out_features=128, bias=True)
  (forward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (backward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (fc0): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (w_out): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.013495445251464844, grad_norm: 0.18257718841530407, ic: 0.034132549935573096
train 0, step: 500, loss: 0.0001609660976100713, grad_norm: 3.2665095562508805e-06, ic: 0.019884294473159515
Epoch 0: 2022-05-06 15:54:48.071945: train loss: 0.0006114968452790166
Eval step 0: eval loss: 0.00016481452621519566
Eval: 2022-05-06 15:54:57.575493: total loss: 0.0001928332266443527, mse:0.0003856664516578281, ic :0.035783450957057074, sharpe5:2.0602909979224204, irr5:0.5170057415962219, ndcg5:0.8524706695436436, pnl5:1.043168067932129 
train 1, step: 0, loss: 0.0001373088452965021, grad_norm: 6.288394979428624e-05, ic: 0.019192826698024985
train 1, step: 500, loss: 0.00016743229934945703, grad_norm: 8.287092238426795e-05, ic: -0.01538514145259112
Epoch 1: 2022-05-06 15:55:48.856113: train loss: 0.00023254418960141508
Eval step 0: eval loss: 0.00014967069728299975
Eval: 2022-05-06 15:55:58.467986: total loss: 0.00018944147399547367, mse:0.00037888294798229074, ic :0.018115566329998178, sharpe5:-0.639706561602652, irr5:-0.13496705889701843, ndcg5:0.850816912432362, pnl5:1.0358597040176392 
train 2, step: 0, loss: 0.00015290324517991394, grad_norm: 2.0915291421168093e-05, ic: 0.007555547308523813
train 2, step: 500, loss: 0.00011409080616431311, grad_norm: 4.676131064051642e-08, ic: 0.01972076726985303
Epoch 2: 2022-05-06 15:56:48.971191: train loss: 0.00022143589746962455
Eval step 0: eval loss: 0.00012153523857705295
Eval: 2022-05-06 15:56:58.612162: total loss: 0.00019518583388968602, mse:0.00039037166689021897, ic :0.01800930807048182, sharpe5:-1.0093033265322446, irr5:-0.21916234493255615, ndcg5:0.8501713302292253, pnl5:0.9856426119804382 
train 3, step: 0, loss: 0.00014518680109176785, grad_norm: 1.5909275796606462e-05, ic: 0.003123086588338932
train 3, step: 500, loss: 0.00022263872961048037, grad_norm: 7.789053835021627e-05, ic: 0.05920440893814559
Epoch 3: 2022-05-06 15:57:49.032985: train loss: 0.00021806686006864298
Eval step 0: eval loss: 0.00016991083975881338
Eval: 2022-05-06 15:57:57.340040: total loss: 0.00019447801341851726, mse:0.0003889560238834311, ic :0.015649862948745156, sharpe5:-1.1177553648501635, irr5:-0.24245581030845642, ndcg5:0.8496091058060049, pnl5:0.9839646816253662 
train 4, step: 0, loss: 0.00015358347445726395, grad_norm: 2.7696526700626276e-05, ic: -0.0038061515340732446
train 4, step: 500, loss: 0.00024068346829153597, grad_norm: 7.086009715084115e-05, ic: -0.023691878226606775
Epoch 4: 2022-05-06 15:58:48.781670: train loss: 0.00021393304659747195
Eval step 0: eval loss: 0.00012858207628596574
Eval: 2022-05-06 15:58:58.509540: total loss: 0.0001905478594464242, mse:0.0003810957149755272, ic :0.01642519661748164, sharpe5:-1.1764682643860578, irr5:-0.25385650992393494, ndcg5:0.8402580632507033, pnl5:0.9900314807891846 
train 5, step: 0, loss: 0.00020813749870285392, grad_norm: 4.055411249667196e-05, ic: 0.016079230760530312
train 5, step: 500, loss: 0.0006693851901218295, grad_norm: 0.0007002620781401836, ic: -0.01614503601497718
Epoch 5: 2022-05-06 15:59:49.948243: train loss: 0.0002108839367296737
Eval step 0: eval loss: 0.00019473271095193923
Eval: 2022-05-06 15:59:59.677272: total loss: 0.0002041802629492933, mse:0.0004083605223250769, ic :0.015311376037522854, sharpe5:-1.105001684948802, irr5:-0.2375950664281845, ndcg5:0.8507433507849644, pnl5:1.0022211074829102 
train 6, step: 0, loss: 0.0002141474251402542, grad_norm: 0.0002270861295414598, ic: 0.03201369701631086
train 6, step: 500, loss: 0.00010583599214442074, grad_norm: 2.4004539337853664e-05, ic: 0.10693330822027602
Epoch 6: 2022-05-06 16:00:51.993244: train loss: 0.0002105344351329548
Eval step 0: eval loss: 0.00014613530947826803
Eval: 2022-05-06 16:01:01.831972: total loss: 0.00018892550546631184, mse:0.0003778510040556292, ic :0.01578010028109821, sharpe5:-0.9949775180965662, irr5:-0.21467778086662292, ndcg5:0.8640750826613393, pnl5:0.9877457618713379 
train 7, step: 0, loss: 0.00020642949675675482, grad_norm: 8.86382117621156e-06, ic: 0.11675133425304209
train 7, step: 500, loss: 0.0003743551787920296, grad_norm: 0.0001580328523792488, ic: 0.10626236661545768
Epoch 7: 2022-05-06 16:01:54.213590: train loss: 0.00020919544265215955
Eval step 0: eval loss: 0.00014160633145365864
Eval: 2022-05-06 16:02:03.941220: total loss: 0.0001886374128760778, mse:0.0003772748203169115, ic :0.0163811056588542, sharpe5:-1.057578290551901, irr5:-0.22839146852493286, ndcg5:0.8544852478463536, pnl5:0.9768548011779785 
train 8, step: 0, loss: 0.00015158775204326957, grad_norm: 6.82993884349235e-06, ic: 0.08842712172021007
train 8, step: 500, loss: 0.0001597431837581098, grad_norm: 4.810650805570612e-05, ic: 0.078383929549668
Epoch 8: 2022-05-06 16:02:56.315710: train loss: 0.00020872936999602094
Eval step 0: eval loss: 0.0001367297227261588
Eval: 2022-05-06 16:03:06.328583: total loss: 0.00018877235691644673, mse:0.00037754471352675705, ic :0.016440657487584637, sharpe5:-1.0558598982542753, irr5:-0.2280876636505127, ndcg5:0.860746235850137, pnl5:0.9946338534355164 
train 9, step: 0, loss: 0.0001343774056294933, grad_norm: 6.0984949315773695e-06, ic: 0.0387651657013274
train 9, step: 500, loss: 8.126534521579742e-05, grad_norm: 1.910631089171424e-06, ic: 0.02172641839484106
Epoch 9: 2022-05-06 16:03:57.898371: train loss: 0.0002082237544021928
Eval step 0: eval loss: 0.00012579809117596596
Eval: 2022-05-06 16:04:07.593674: total loss: 0.00019187330672853955, mse:0.000383746612501489, ic :0.016876566649185413, sharpe5:-1.010755086019635, irr5:-0.21790935099124908, ndcg5:0.8485267945563224, pnl5:0.9844728112220764 
train 10, step: 0, loss: 9.233050514012575e-05, grad_norm: 7.934141905041662e-07, ic: 0.03753604710465647
train 10, step: 500, loss: 0.0002231085381936282, grad_norm: 8.917941975264288e-05, ic: 0.051006035602285345
Epoch 10: 2022-05-06 16:05:00.001104: train loss: 0.00020891410741584007
Eval step 0: eval loss: 0.000173829379491508
Eval: 2022-05-06 16:05:09.389943: total loss: 0.00019583115772945058, mse:0.0003916623094242465, ic :0.016160303856077918, sharpe5:-0.9245718534663319, irr5:-0.19918349385261536, ndcg5:0.8630040909958183, pnl5:0.9824472665786743 
train 11, step: 0, loss: 0.00023626275651622564, grad_norm: 4.724399034118231e-06, ic: -0.05920950247900287
train 11, step: 500, loss: 0.0002225147618446499, grad_norm: 4.8594235108619665e-06, ic: 0.05650266970200203
Epoch 11: 2022-05-06 16:05:59.679367: train loss: 0.00020901802737964006
Eval step 0: eval loss: 0.0001372167025692761
Eval: 2022-05-06 16:06:09.213837: total loss: 0.00018877625603540944, mse:0.00037755250593325587, ic :0.012777729540345513, sharpe5:-1.1088446263968943, irr5:-0.24020645022392273, ndcg5:0.8585701929056591, pnl5:0.9173594117164612 
train 12, step: 0, loss: 0.00016126844275277108, grad_norm: 6.244771677676956e-05, ic: 0.10858949307263267
train 12, step: 500, loss: 0.00013539633073378354, grad_norm: 4.1146979540867215e-06, ic: -0.0024007125804015057
Epoch 12: 2022-05-06 16:06:59.450999: train loss: 0.00020839471658607722
Eval step 0: eval loss: 0.0001478189224144444
Eval: 2022-05-06 16:07:08.815535: total loss: 0.00018911790129409362, mse:0.0003782358002238353, ic :0.013389359857662113, sharpe5:-1.0375704246014357, irr5:-0.22579926252365112, ndcg5:0.8630419333784267, pnl5:0.9446635246276855 
train 13, step: 0, loss: 0.00016964525275398046, grad_norm: 1.485497977467174e-05, ic: 0.05099150365470475
train 13, step: 500, loss: 0.00012365412840154022, grad_norm: 1.0453185810296874e-07, ic: -0.03149986131927825
Epoch 13: 2022-05-06 16:07:58.905189: train loss: 0.00020904613228337054
Eval step 0: eval loss: 0.00016357656568288803
Eval: 2022-05-06 16:08:08.473119: total loss: 0.00019238246022723615, mse:0.00038476491356443624, ic :0.010396399796706975, sharpe5:-1.0782477132976054, irr5:-0.23227286338806152, ndcg5:0.8610168050693702, pnl5:0.971761167049408 
train 14, step: 0, loss: 0.00020352497813291848, grad_norm: 7.872090209600804e-07, ic: 0.07273120419199189
train 14, step: 500, loss: 0.0001734205725369975, grad_norm: 3.368108744471417e-06, ic: -0.047906748818162814
Epoch 14: 2022-05-06 16:08:58.210882: train loss: 0.00020897074021129149
Eval step 0: eval loss: 0.0001283869205508381
Eval: 2022-05-06 16:09:07.724790: total loss: 0.00019091256621815304, mse:0.00038182512632313286, ic :-0.006022078766593443, sharpe5:-3.759944270700216, irr5:-0.18449075520038605, ndcg5:0.8517293027277144, pnl5:0.3341571092605591 
train 15, step: 0, loss: 0.00013760096044279635, grad_norm: 5.89723966222117e-07, ic: -0.11587761718713667
train 15, step: 500, loss: 0.00010348879004595801, grad_norm: 3.646786215250682e-07, ic: -0.04938627790223732
Epoch 15: 2022-05-06 16:09:58.896439: train loss: 0.00020835166029467274
Eval step 0: eval loss: 0.00012106135545764118
Eval: 2022-05-06 16:10:08.566155: total loss: 0.00019625233371658697, mse:0.00039250466102745067, ic :0.008108260608975, sharpe5:-1.0908482714742422, irr5:-0.23586004972457886, ndcg5:0.8469798551079708, pnl5:0.9530887603759766 
train 16, step: 0, loss: 0.0002081780694425106, grad_norm: 1.1417414539132358e-05, ic: 0.02173925601142241
train 16, step: 500, loss: 0.00012008287740172818, grad_norm: 2.1928248150661168e-06, ic: -0.00014074011282478802
Epoch 16: 2022-05-06 16:11:00.141865: train loss: 0.00020974554411715512
Eval step 0: eval loss: 0.00018393930804450065
Eval: 2022-05-06 16:11:09.797381: total loss: 0.00019935007295678023, mse:0.00039870014354458, ic :0.0040695719990588835, sharpe5:-1.2530810344219208, irr5:-0.26803889870643616, ndcg5:0.8454558159865546, pnl5:0.9583696722984314 
train 17, step: 0, loss: 0.00014452006143983454, grad_norm: 5.097722505857567e-06, ic: 0.10705938062208553
train 17, step: 500, loss: 8.054909994825721e-05, grad_norm: 1.3487066888592415e-07, ic: -0.055229588783274386
Epoch 17: 2022-05-06 16:11:58.714141: train loss: 0.00020950182012473276
Eval step 0: eval loss: 0.0001587610022397712
Eval: 2022-05-06 16:12:08.096549: total loss: 0.00019111411685279598, mse:0.00038222823125472145, ic :0.004077519710619983, sharpe5:-0.9353963769972324, irr5:-0.20328325033187866, ndcg5:0.8568440117579129, pnl5:0.9634371995925903 
train 18, step: 0, loss: 0.00038531978498212993, grad_norm: 0.0003004569023676446, ic: 0.04567018011841671
train 18, step: 500, loss: 0.0003007357590831816, grad_norm: 0.00026319451060010366, ic: -0.09927899582972696
Epoch 18: 2022-05-06 16:12:58.493571: train loss: 0.00020990458079251116
Eval step 0: eval loss: 0.00013344189210329205
Eval: 2022-05-06 16:13:07.982946: total loss: 0.0001893601648831805, mse:0.00037872032355574793, ic :-0.000442323451767714, sharpe5:-0.9225368716567754, irr5:-0.19995585083961487, ndcg5:0.8554455711545679, pnl5:0.9825727939605713 
train 19, step: 0, loss: 0.0002464221615809947, grad_norm: 0.00022429988995229986, ic: -0.005204902160699083
train 19, step: 500, loss: 0.00020673195831477642, grad_norm: 1.1338380933251307e-08, ic: 0.0207498158858618
Epoch 19: 2022-05-06 16:13:58.292961: train loss: 0.00020810852245942667
Eval step 0: eval loss: 0.00013511009456124157
Eval: 2022-05-06 16:14:07.679738: total loss: 0.00018907448997610254, mse:0.00037814897795536087, ic :0.0009815125773633185, sharpe5:-1.2578259160369634, irr5:-0.269552618265152, ndcg5:0.8517054408180159, pnl5:0.9413597583770752 
train 20, step: 0, loss: 0.0002266805968247354, grad_norm: 1.2062946341295933e-06, ic: -0.041642007307952374
train 20, step: 500, loss: 0.00010342302994104102, grad_norm: 1.1196540404494187e-06, ic: -0.02031871136257239
Epoch 20: 2022-05-06 16:14:59.487162: train loss: 0.00020852633796382183
Eval step 0: eval loss: 0.00014132988872006536
Eval: 2022-05-06 16:15:08.775503: total loss: 0.00018869038559669247, mse:0.0003773807671103385, ic :0.002093403771349705, sharpe5:-1.2671873880922793, irr5:-0.27151980996131897, ndcg5:0.8448478841106178, pnl5:0.9562988877296448 
train 21, step: 0, loss: 0.0003868642670568079, grad_norm: 0.00039346669863642343, ic: 0.08071515397987646
train 21, step: 500, loss: 0.00018008597544394433, grad_norm: 2.7159761921999358e-05, ic: -0.06926814489240121
Epoch 21: 2022-05-06 16:15:58.612160: train loss: 0.0002084696012330668
Eval step 0: eval loss: 0.00016141693049576133
Eval: 2022-05-06 16:16:08.247444: total loss: 0.00019178221939644048, mse:0.0003835644381467071, ic :0.0008051496611523366, sharpe5:-1.1679191060364247, irr5:-0.2485664188861847, ndcg5:0.862172746915402, pnl5:0.9226515293121338 
train 22, step: 0, loss: 0.0001304861216340214, grad_norm: 1.4645905239103374e-05, ic: 0.030682022994317867
train 22, step: 500, loss: 0.00012406765017658472, grad_norm: 4.4182307941110936e-05, ic: 0.006964952644294484
Epoch 22: 2022-05-06 16:16:58.779109: train loss: 0.00020837309600507255
Eval step 0: eval loss: 0.00012691051233559847
Eval: 2022-05-06 16:17:08.275887: total loss: 0.00019156680663276918, mse:0.0003831336074924698, ic :0.0012773327721459409, sharpe5:-1.2487440832704304, irr5:-0.26759234070777893, ndcg5:0.8431045498627997, pnl5:0.942750871181488 
train 23, step: 0, loss: 0.00020581501303240657, grad_norm: 7.608561467687766e-05, ic: 0.09566173727717468
train 23, step: 500, loss: 0.0001074926185538061, grad_norm: 3.594887058867412e-05, ic: -0.021665959549122177
Epoch 23: 2022-05-06 16:17:59.404714: train loss: 0.0002093598235232468
Eval step 0: eval loss: 0.00013890043192077428
Eval: 2022-05-06 16:18:08.767143: total loss: 0.00018873382007701152, mse:0.0003774676391215987, ic :-0.000245796065013592, sharpe5:-1.2487440832704304, irr5:-0.26759228110313416, ndcg5:0.8466387985959702, pnl5:0.942750871181488 
train 24, step: 0, loss: 0.00016263144789263606, grad_norm: 2.1452539190994724e-06, ic: 0.03001119076563103
train 24, step: 500, loss: 0.0002417551149846986, grad_norm: 9.266348059370756e-05, ic: -0.01679921522623959
Epoch 24: 2022-05-06 16:18:57.541423: train loss: 0.00020895378319325578
Eval step 0: eval loss: 0.0001582703844178468
Eval: 2022-05-06 16:19:06.898661: total loss: 0.00019100086987689624, mse:0.0003820017344105821, ic :0.0007496720500916689, sharpe5:-1.1786333701014517, irr5:-0.25271591544151306, ndcg5:0.8427379182716951, pnl5:0.9379846453666687 
train 25, step: 0, loss: 0.00015188065299298614, grad_norm: 0.00010954275854066174, ic: 0.08309662971180144
train 25, step: 500, loss: 0.00019237904052715749, grad_norm: 0.00014852715195906328, ic: 0.026382688946078425
Epoch 25: 2022-05-06 16:19:57.888314: train loss: 0.00020929334173671574
Eval step 0: eval loss: 0.0001320579758612439
Eval: 2022-05-06 16:20:07.552104: total loss: 0.0001896626954833676, mse:0.00037932538867159775, ic :-8.741028504238845e-05, sharpe5:-1.2174311044067143, irr5:-0.2608109414577484, ndcg5:0.8505806215887373, pnl5:0.9479697942733765 
train 26, step: 0, loss: 0.0001414590806234628, grad_norm: 1.764269615815955e-05, ic: -0.017103569718071
train 26, step: 500, loss: 6.563342321896926e-05, grad_norm: 4.336231853340066e-06, ic: 0.01653389319477356
Epoch 26: 2022-05-06 16:20:57.623019: train loss: 0.00020935959655811443
Eval step 0: eval loss: 0.00014944745635148138
Eval: 2022-05-06 16:21:06.895545: total loss: 0.00018932760490931156, mse:0.00037865520933858513, ic :0.0006532738711824763, sharpe5:-1.224968122243881, irr5:-0.2625756561756134, ndcg5:0.847034947509127, pnl5:0.9305986762046814 
train 27, step: 0, loss: 0.0002011122414842248, grad_norm: 7.438441660472707e-05, ic: 0.030182416769793982
train 27, step: 500, loss: 0.00017278760788030922, grad_norm: 2.783103694217489e-05, ic: 0.03703428544996167
Epoch 27: 2022-05-06 16:21:58.424392: train loss: 0.0002095614493258651
Eval step 0: eval loss: 0.0001265371247427538
Eval: 2022-05-06 16:22:07.893901: total loss: 0.00019177979253096237, mse:0.00038355957768870065, ic :-0.000777179079917815, sharpe5:-0.9923460710048675, irr5:-0.21560072898864746, ndcg5:0.857401493623744, pnl5:0.9702901840209961 
train 28, step: 0, loss: 0.00031120283529162407, grad_norm: 3.3188105011327374e-07, ic: 0.00043781142202181916
train 28, step: 500, loss: 0.00019640028767753392, grad_norm: 7.108333363262252e-05, ic: 0.005057603464884122
Epoch 28: 2022-05-06 16:22:58.638657: train loss: 0.0002087068356889755
Eval step 0: eval loss: 0.0001511948648840189
Eval: 2022-05-06 16:23:08.100297: total loss: 0.00018958659973768234, mse:0.00037917319816869744, ic :-0.0018698427619526505, sharpe5:-1.2985599602758884, irr5:-0.2782125771045685, ndcg5:0.8494117468747849, pnl5:0.9509231448173523 
train 29, step: 0, loss: 0.0001798202283680439, grad_norm: 6.156186045816023e-07, ic: 0.1099913500199462
train 29, step: 500, loss: 0.00012304553820285946, grad_norm: 9.926125267063176e-06, ic: 0.11575454385679311
Epoch 29: 2022-05-06 16:24:00.471619: train loss: 0.0002089958893691042
Eval step 0: eval loss: 0.00017456566274631768
Eval: 2022-05-06 16:24:10.270368: total loss: 0.00019581813316163913, mse:0.00039163626196192156, ic :-0.0011356284954580145, sharpe5:-1.1786333701014517, irr5:-0.25271591544151306, ndcg5:0.8669052601522965, pnl5:0.9379847645759583 
train 30, step: 0, loss: 0.00016973829769995064, grad_norm: 7.147073223221915e-05, ic: 0.006083335073546463
train 30, step: 500, loss: 0.00021748311701230705, grad_norm: 9.944786675587664e-07, ic: 0.03375528465098994
Epoch 30: 2022-05-06 16:25:01.854277: train loss: 0.00020969263073676366
Eval step 0: eval loss: 0.00017080434190575033
Eval: 2022-05-06 16:25:11.491958: total loss: 0.00019455766373956536, mse:0.0003891153243900117, ic :-0.002005877577075274, sharpe5:-1.1989937116205691, irr5:-0.2568833529949188, ndcg5:0.8477382166667573, pnl5:0.9345639944076538 
train 31, step: 0, loss: 0.00013898967881686985, grad_norm: 6.888580075734421e-05, ic: 0.04312379448131493
train 31, step: 500, loss: 0.00013597145152743906, grad_norm: 3.698940159301534e-05, ic: 0.01261017614860073
Epoch 31: 2022-05-06 16:26:01.451381: train loss: 0.00020913408250751984
Eval step 0: eval loss: 0.0001222089194925502
Eval: 2022-05-06 16:26:10.750186: total loss: 0.00019505656093402713, mse:0.0003901131201159094, ic :0.0005409635204217205, sharpe5:-1.1786331336200238, irr5:-0.2527158558368683, ndcg5:0.8645730939239132, pnl5:0.9379846453666687 
train 32, step: 0, loss: 0.00017557402316015214, grad_norm: 2.3963511924536938e-05, ic: 0.055347933951348405
train 32, step: 500, loss: 0.00017788817058317363, grad_norm: 4.501332657948632e-06, ic: 0.004072722671583727
Epoch 32: 2022-05-06 16:27:01.522234: train loss: 0.00020904327179607966
Eval step 0: eval loss: 0.00012795547081623226
Eval: 2022-05-06 16:27:11.126317: total loss: 0.00019109184787899467, mse:0.00038218369475131894, ic :0.002237549961931192, sharpe5:-1.1602182065695523, irr5:-0.24878838658332825, ndcg5:0.8604260488594758, pnl5:0.9247373342514038 
train 33, step: 0, loss: 0.00017964295693673193, grad_norm: 1.027854444665838e-05, ic: 0.029426604417165533
train 33, step: 500, loss: 8.327762043336406e-05, grad_norm: 3.911882549610226e-06, ic: 0.02894265335479573
Epoch 33: 2022-05-06 16:28:02.382359: train loss: 0.00020901208200791097
Eval step 0: eval loss: 0.00016142657841555774
Eval: 2022-05-06 16:28:11.835064: total loss: 0.0001917764301489079, mse:0.0003835528563680835, ic :-0.0033070016438927776, sharpe5:-1.24468783557415, irr5:-0.2667762339115143, ndcg5:0.8615396346993276, pnl5:0.9437114596366882 
train 34, step: 0, loss: 0.00017242884496226907, grad_norm: 6.628184068554544e-08, ic: 0.05525485292157592
train 34, step: 500, loss: 0.00012255115143489093, grad_norm: 6.526831217355185e-06, ic: -0.0350932398379712
Epoch 34: 2022-05-06 16:29:02.385879: train loss: 0.00020857541516851533
Eval step 0: eval loss: 0.00012473436072468758
Eval: 2022-05-06 16:29:11.808127: total loss: 0.0001930222357203879, mse:0.00038604446822192693, ic :0.003138915917329037, sharpe5:-1.1602183248102664, irr5:-0.24878838658332825, ndcg5:0.8563362034261821, pnl5:0.9247375130653381 
train 35, step: 0, loss: 0.0003276118659414351, grad_norm: 0.0003333712210844112, ic: 0.04545277228841067
train 35, step: 500, loss: 0.0003281493845861405, grad_norm: 0.00017652018260155372, ic: 0.024703149638951594
Epoch 35: 2022-05-06 16:30:02.269872: train loss: 0.00020915388257681164
Eval step 0: eval loss: 0.00013959375792182982
Eval: 2022-05-06 16:30:11.762228: total loss: 0.00018871073019090942, mse:0.0003774214524611865, ic :-0.0010454821622847708, sharpe5:-1.1786331336200238, irr5:-0.25271591544151306, ndcg5:0.8638219962703358, pnl5:0.9379847645759583 
train 36, step: 0, loss: 0.0002393002505414188, grad_norm: 0.0001431999122829797, ic: 0.00870671301873462
train 36, step: 500, loss: 0.0005068000755272806, grad_norm: 0.00022788687572971106, ic: -0.019715586670801005
Epoch 36: 2022-05-06 16:31:03.365625: train loss: 0.00020858495082164757
Eval step 0: eval loss: 0.0001821020123315975
Eval: 2022-05-06 16:31:13.297155: total loss: 0.00019861870866236337, mse:0.0003972374103038701, ic :0.0007320298516041538, sharpe5:-1.0581417075544595, irr5:-0.22568941116333008, ndcg5:0.8599129589698287, pnl5:0.9413610100746155 
train 37, step: 0, loss: 0.0003402707807254046, grad_norm: 0.00038157849567755557, ic: 0.0218387952189225
train 37, step: 500, loss: 0.00016523999511264265, grad_norm: 1.8472366772232233e-05, ic: 0.052474998417091086
Epoch 37: 2022-05-06 16:32:05.087956: train loss: 0.00020923703454036756
Eval step 0: eval loss: 0.0001485891843913123
Eval: 2022-05-06 16:32:14.814484: total loss: 0.00018921509080344819, mse:0.00037843017625622356, ic :-0.0009756078416412454, sharpe5:-1.0459028477221728, irr5:-0.22310292720794678, ndcg5:0.8570553674468648, pnl5:0.9272099137306213 
train 38, step: 0, loss: 0.0001580458483658731, grad_norm: 8.37565589506405e-09, ic: -0.024906527899851115
train 38, step: 500, loss: 0.00031208936707116663, grad_norm: 2.1729523313467496e-05, ic: -0.031953398872520335
Epoch 38: 2022-05-06 16:33:06.148328: train loss: 0.00020806451655828138
Eval step 0: eval loss: 0.00012833112850785255
Eval: 2022-05-06 16:33:16.166181: total loss: 0.00019089892255848956, mse:0.000381797843512466, ic :0.0021091849238420017, sharpe5:-1.0581417075544595, irr5:-0.22568941116333008, ndcg5:0.8504808496553917, pnl5:0.9413609504699707 
train 39, step: 0, loss: 0.00031970441341400146, grad_norm: 0.00016970204856679426, ic: 0.0944156038797854
train 39, step: 500, loss: 0.00018234156596008688, grad_norm: 1.613858814979207e-05, ic: -0.09381101461115257
Epoch 39: 2022-05-06 16:34:08.141396: train loss: 0.00020888156749980922
Eval step 0: eval loss: 0.0001782655162969604
Eval: 2022-05-06 16:34:17.868723: total loss: 0.00019717189103596758, mse:0.00039434377667726223, ic :0.0022264236147483897, sharpe5:-1.0581415893137454, irr5:-0.2256893515586853, ndcg5:0.8534614088846909, pnl5:0.941361129283905 
train 40, step: 0, loss: 0.00020239248988218606, grad_norm: 5.928671136823592e-05, ic: -0.031831644355411706
train 40, step: 500, loss: 0.00032692516106180847, grad_norm: 6.494786944440616e-05, ic: 0.10818393263433984
Epoch 40: 2022-05-06 16:35:09.437745: train loss: 0.00020874588729525459
Eval step 0: eval loss: 0.00011916225048480555
Eval: 2022-05-06 16:35:19.326366: total loss: 0.00019924565362383094, mse:0.000398491301306748, ic :0.00420722664826057, sharpe5:-1.0310168147832155, irr5:-0.21985405683517456, ndcg5:0.8569177760080757, pnl5:0.9136656522750854 
train 41, step: 0, loss: 0.0001773056574165821, grad_norm: 2.8246221056965576e-05, ic: 0.04022475950525531
train 41, step: 500, loss: 0.00014681214815936983, grad_norm: 6.472930434313703e-05, ic: -0.08726034761190682
Epoch 41: 2022-05-06 16:36:10.953626: train loss: 0.00020836532632801633
Eval step 0: eval loss: 0.00016734532255213708
Eval: 2022-05-06 16:36:20.599291: total loss: 0.0001934819847043384, mse:0.00038696396510810334, ic :0.00668700396141997, sharpe5:-1.0622153366357088, irr5:-0.22895097732543945, ndcg5:0.8616989332869939, pnl5:0.9084588885307312 
train 42, step: 0, loss: 0.0001169364113593474, grad_norm: 3.5028918782533674e-05, ic: 0.009835843935865559
train 42, step: 500, loss: 0.00030107091879472136, grad_norm: 5.87133390470052e-07, ic: 0.03744422550956069
Epoch 42: 2022-05-06 16:37:12.626648: train loss: 0.00020910765490656373
Eval step 0: eval loss: 0.000131936656543985
Eval: 2022-05-06 16:37:22.525242: total loss: 0.00018964246161715188, mse:0.0003792849236968106, ic :0.009146712823412584, sharpe5:-1.0666876734048127, irr5:-0.22828584909439087, ndcg5:0.8528922603905469, pnl5:0.8762985467910767 
train 43, step: 0, loss: 0.00017597904661670327, grad_norm: 8.802842122126658e-05, ic: -0.01198817865358736
train 43, step: 500, loss: 0.00020012383174616843, grad_norm: 8.823983141289852e-05, ic: 0.0429214117646083
Epoch 43: 2022-05-06 16:38:14.751711: train loss: 0.0002089194067399236
Eval step 0: eval loss: 0.0001403751812176779
Eval: 2022-05-06 16:38:24.498827: total loss: 0.00018868404353524488, mse:0.00037736808379326486, ic :0.0059627780313382455, sharpe5:-1.0371940644085407, irr5:-0.22110891342163086, ndcg5:0.8484780722232228, pnl5:0.9125968217849731 
train 44, step: 0, loss: 0.00018241450015921146, grad_norm: 4.876528025504624e-06, ic: 0.01688343939750996
train 44, step: 500, loss: 0.00016467530804220587, grad_norm: 5.78223096030385e-05, ic: 0.11988149276678094
Epoch 44: 2022-05-06 16:39:15.801938: train loss: 0.00020876425489093665
Eval step 0: eval loss: 0.00012670760042965412
Eval: 2022-05-06 16:39:25.621813: total loss: 0.00019160306444528867, mse:0.0003832061220057162, ic :0.010186764445218616, sharpe5:-1.1296089964359999, irr5:-0.24425169825553894, ndcg5:0.8501726880457365, pnl5:0.9131962656974792 
train 45, step: 0, loss: 0.000363020459190011, grad_norm: 8.948474033925707e-06, ic: 0.002009452226838463
train 45, step: 500, loss: 0.00011331347195664421, grad_norm: 4.037253779711159e-06, ic: 0.011524870976154018
Epoch 45: 2022-05-06 16:40:14.662552: train loss: 0.00020880944621872173
Eval step 0: eval loss: 0.00015296223864424974
Eval: 2022-05-06 16:40:24.244084: total loss: 0.0001898970260863359, mse:0.0003797940489344468, ic :0.009767358519000966, sharpe5:-1.1591503746807574, irr5:-0.25099292397499084, ndcg5:0.8487949758923667, pnl5:0.908559262752533 
train 46, step: 0, loss: 0.0002507814788259566, grad_norm: 9.875488480161892e-05, ic: 0.018425258087769233
train 46, step: 500, loss: 0.00010021241178037599, grad_norm: 1.2498521418875426e-07, ic: 0.01738330969971583
Epoch 46: 2022-05-06 16:41:14.921160: train loss: 0.00020884249458119974
Eval step 0: eval loss: 0.000143094701343216
Eval: 2022-05-06 16:41:24.444841: total loss: 0.00018872407353462807, mse:0.0003774481421372112, ic :0.008365371544826009, sharpe5:-1.1554585448652506, irr5:-0.2467060387134552, ndcg5:0.8596224189550064, pnl5:0.8766552805900574 
train 47, step: 0, loss: 0.00020355565357021987, grad_norm: 0.0001317156473673519, ic: 0.13027092555979353
train 47, step: 500, loss: 0.00013577667414210737, grad_norm: 2.293924471429192e-07, ic: 0.04728697434511604
Epoch 47: 2022-05-06 16:42:14.377657: train loss: 0.00020914781201094822
Eval step 0: eval loss: 0.00013950069842394441
Eval: 2022-05-06 16:42:23.577109: total loss: 0.00018865681925303544, mse:0.0003773136367230236, ic :0.014914379986783136, sharpe5:-1.1005603272467852, irr5:-0.23818211257457733, ndcg5:0.8635989279572325, pnl5:0.9020109176635742 
train 48, step: 0, loss: 0.00022568958229385316, grad_norm: 8.951993164057195e-05, ic: -0.0531118100869999
train 48, step: 500, loss: 0.00015773324412293732, grad_norm: 1.4410346548371275e-05, ic: 0.04125670885451152
Epoch 48: 2022-05-06 16:43:15.407659: train loss: 0.00020891364883596604
Eval step 0: eval loss: 0.00013044879597146064
Eval: 2022-05-06 16:43:24.905834: total loss: 0.00018997533086358924, mse:0.00037995065733198186, ic :0.014295521617417078, sharpe5:-1.103196858689189, irr5:-0.23874464631080627, ndcg5:0.8521220908994482, pnl5:0.9015410542488098 
train 49, step: 0, loss: 0.0001808192319003865, grad_norm: 5.135984615366896e-06, ic: -0.08042874042218093
train 49, step: 500, loss: 7.164078124333173e-05, grad_norm: 1.8829257107553218e-06, ic: -0.010010575634019019
Epoch 49: 2022-05-06 16:44:15.693402: train loss: 0.00020813794405371408
Eval step 0: eval loss: 0.00014850935258436948
Eval: 2022-05-06 16:44:25.043604: total loss: 0.00018920230685060186, mse:0.0003784046097517422, ic :0.011865009208853312, sharpe5:-1.0125496253371238, irr5:-0.21813476085662842, ndcg5:0.8527687538553149, pnl5:0.9004154205322266 
train 50, step: 0, loss: 0.0003907281788997352, grad_norm: 0.00016158662548247747, ic: 0.07207468107194231
train 50, step: 500, loss: 0.00017433069297112525, grad_norm: 6.002099047328648e-05, ic: 0.00464926139060113
Epoch 50: 2022-05-06 16:45:15.924864: train loss: 0.000208225077318168
