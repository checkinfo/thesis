Namespace(adj_path='../Temporal_Relational_Stock_Ranking/data/relation/sector_industry/NASDAQ_industry_relation.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=1, market='NASDAQ', mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1026, test_mask_path='./data/NASDAQ/test_mask_237_1026.npy', test_path='./data/NASDAQ/test_237_1026_6.npy', top_stocks=5, train_mask_path='./data/NASDAQ/train_mask_756_1026.npy', train_path='./data/NASDAQ/train_756_1026_6.npy', use_adj=False)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
#tickers selected: 1026
single EOD data shape: (1245, 6)
(1026, 1245, 5) (1026, 1245) (1026, 1245) (1026, 1245)
relation encoding shape: torch.Size([1026, 1026, 97]) torch.float32
relation mask shape: torch.Size([1026, 1026]) torch.float32
79164
ReRaLSTM(
  (rnn1): LSTM(5, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=97, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.0002788109995890409, grad_norm: 0.00019344677327558346, ic: -0.04627709661564381
train 0, step: 500, loss: 0.00012237433111295104, grad_norm: 5.006496485092894e-10, ic: 0.00477381318992063
Epoch 0: 2022-05-06 19:34:57.455744: train loss: 0.00020750506577956804
Eval step 0: eval loss: 0.00014915972133167088
Eval: 2022-05-06 19:35:00.206513: total loss: 0.00018928538128813957, mse:0.00037857075862495973, ic :0.022123114278083493, sharpe5:-1.3224899889528752, irr5:-0.27909138798713684, ndcg5:0.8512363417029937, pnl5:0.9568966031074524 
train 1, step: 0, loss: 0.00010532778105698526, grad_norm: 3.5592331783191467e-09, ic: 0.014289316397299665
train 1, step: 500, loss: 0.00018821968114934862, grad_norm: 1.9124844859955167e-08, ic: 0.039617554443889626
Epoch 1: 2022-05-06 19:35:07.209593: train loss: 0.00020694938744383304
Eval step 0: eval loss: 0.0001464447268517688
Eval: 2022-05-06 19:35:09.789112: total loss: 0.00018897487439558836, mse:0.0003779497455169251, ic :0.01179614213769098, sharpe5:2.9412108036875724, irr5:0.4593000113964081, ndcg5:0.8557427811420035, pnl5:1.0779261589050293 
train 2, step: 0, loss: 0.00014081617700867355, grad_norm: 1.5916299284033e-09, ic: -0.07052781812931569
train 2, step: 500, loss: 0.00010911562276305631, grad_norm: 2.276782759908659e-11, ic: 0.051675749720335756
Epoch 2: 2022-05-06 19:35:16.757252: train loss: 0.00020680033499217794
Eval step 0: eval loss: 0.0001466110988985747
Eval: 2022-05-06 19:35:19.428105: total loss: 0.00018899031645591943, mse:0.0003779806312169587, ic :0.022072981052161187, sharpe5:-0.38186651514843106, irr5:-0.04469448700547218, ndcg5:0.838923363738327, pnl5:0.944331169128418 
train 3, step: 0, loss: 0.00013379758456721902, grad_norm: 8.595679321042151e-11, ic: -0.024641440025281857
train 3, step: 500, loss: 0.0002534342638682574, grad_norm: 1.3819300787745382e-08, ic: -0.011981755672086859
Epoch 3: 2022-05-06 19:35:26.209923: train loss: 0.00020739236852558164
Eval step 0: eval loss: 0.00014764937805011868
Eval: 2022-05-06 19:35:28.994019: total loss: 0.00018909967670422534, mse:0.0003781993499283771, ic :0.021794362905387457, sharpe5:-0.2503354856930673, irr5:-0.041317202150821686, ndcg5:0.8507917450121888, pnl5:1.0938631296157837 
train 4, step: 0, loss: 0.0001424699294148013, grad_norm: 9.831459641190803e-10, ic: 0.0411944166283499
train 4, step: 500, loss: 0.00023390777641907334, grad_norm: 6.5885077572525274e-09, ic: 0.06528638174978756
Epoch 4: 2022-05-06 19:35:36.130567: train loss: 0.00020706944600689097
Eval step 0: eval loss: 0.0001484953536419198
Eval: 2022-05-06 19:35:38.646393: total loss: 0.0001891937266855285, mse:0.00037838744877167265, ic :0.023715680084559345, sharpe5:-0.5099730866029858, irr5:-0.0931047797203064, ndcg5:0.860685343036309, pnl5:1.0090758800506592 
train 5, step: 0, loss: 0.00023193616652861238, grad_norm: 9.746881054802626e-09, ic: 0.0695759908848967
train 5, step: 500, loss: 0.0005710095865651965, grad_norm: 5.140309858476206e-08, ic: 0.016929923036897596
Epoch 5: 2022-05-06 19:35:45.798570: train loss: 0.00020684995445512163
Eval step 0: eval loss: 0.00014755598385818303
Eval: 2022-05-06 19:35:48.484901: total loss: 0.0001890863695814311, mse:0.00037817273828738237, ic :0.024081638714338875, sharpe5:-1.052729593589902, irr5:-0.21607908606529236, ndcg5:0.8538503480165791, pnl5:0.7925243377685547 
train 6, step: 0, loss: 0.00015745819837320596, grad_norm: 1.157775851030797e-08, ic: 0.07006135333939612
train 6, step: 500, loss: 0.00012166415399406105, grad_norm: 5.734587911701548e-09, ic: 0.0600514140422848
Epoch 6: 2022-05-06 19:35:55.368962: train loss: 0.00020686580665595704
Eval step 0: eval loss: 0.00014813458255957812
Eval: 2022-05-06 19:35:57.788252: total loss: 0.00018915243819966, mse:0.0003783048709155865, ic :0.025590896138975926, sharpe5:0.042708697419147935, irr5:0.006825702264904976, ndcg5:0.864587725795385, pnl5:1.0896987915039062 
train 7, step: 0, loss: 0.00020673740073107183, grad_norm: 7.044465419481104e-10, ic: 0.06565541338585291
train 7, step: 500, loss: 0.0003353264182806015, grad_norm: 1.4578808708537632e-09, ic: 0.0978926988545567
Epoch 7: 2022-05-06 19:36:04.555563: train loss: 0.00020674510767244807
Eval step 0: eval loss: 0.00014752292190678418
Eval: 2022-05-06 19:36:07.256593: total loss: 0.00018908584466398242, mse:0.0003781716860280643, ic :0.024561581237678883, sharpe5:-0.4695675150677562, irr5:-0.08449850231409073, ndcg5:0.8490755900369439, pnl5:1.0538570880889893 
train 8, step: 0, loss: 0.000150401217979379, grad_norm: 3.4136200289220926e-10, ic: 0.03579778340293182
train 8, step: 500, loss: 0.00016355651314370334, grad_norm: 5.7328553525766545e-09, ic: 0.027979596074347926
Epoch 8: 2022-05-06 19:36:14.707446: train loss: 0.00020705062318722442
Eval step 0: eval loss: 0.00014871695020701736
Eval: 2022-05-06 19:36:17.479160: total loss: 0.00018923026698948532, mse:0.0003784605317033343, ic :0.02295955680076141, sharpe5:-1.15204209767282, irr5:-0.23607230186462402, ndcg5:0.8463936784586071, pnl5:0.8226116299629211 
train 9, step: 0, loss: 0.00014016032218933105, grad_norm: 1.8541740480377446e-09, ic: 0.026112653973546455
train 9, step: 500, loss: 8.367217378690839e-05, grad_norm: 6.983472700607258e-10, ic: 0.0464503619823512
Epoch 9: 2022-05-06 19:36:24.498957: train loss: 0.00020685550726072852
Eval step 0: eval loss: 0.00014712441770825535
Eval: 2022-05-06 19:36:26.942532: total loss: 0.00018903953726067896, mse:0.0003780790724528129, ic :0.02554471366812835, sharpe5:-0.4692905066348612, irr5:-0.08385266363620758, ndcg5:0.8680674616706018, pnl5:0.8542992472648621 
train 10, step: 0, loss: 9.627421241020784e-05, grad_norm: 9.588786594280732e-10, ic: 0.035403639208077
train 10, step: 500, loss: 0.0002591889933682978, grad_norm: 1.662788690992972e-08, ic: 0.07691340128506811
Epoch 10: 2022-05-06 19:36:34.149932: train loss: 0.0002068408268587032
Eval step 0: eval loss: 0.0001471569121349603
Eval: 2022-05-06 19:36:36.751327: total loss: 0.00018904506295332765, mse:0.00037809012416047116, ic :0.025406349851446023, sharpe5:-1.1902148115634918, irr5:-0.24756988883018494, ndcg5:0.8359392377157924, pnl5:0.969551682472229 
train 11, step: 0, loss: 0.00023270575911737978, grad_norm: 1.7712154086945024e-11, ic: 0.03557735980778047
train 11, step: 500, loss: 0.0002252239064546302, grad_norm: 9.36541116307829e-10, ic: 0.008236803928595826
Epoch 11: 2022-05-06 19:36:43.602524: train loss: 0.0002067725706528726
Eval step 0: eval loss: 0.00014710752293467522
Eval: 2022-05-06 19:36:46.207423: total loss: 0.00018903879975182245, mse:0.00037807759680428686, ic :0.024277286656717995, sharpe5:-1.4292009327560662, irr5:-0.3052901327610016, ndcg5:0.8514941493982814, pnl5:0.9594129920005798 
train 12, step: 0, loss: 0.00015107910439837724, grad_norm: 4.240238284473538e-09, ic: -0.005145989544926212
train 12, step: 500, loss: 0.00014081034169066697, grad_norm: 1.5732995084439184e-09, ic: 0.0131257991910462
Epoch 12: 2022-05-06 19:36:53.259802: train loss: 0.0002067156622027088
Eval step 0: eval loss: 0.00014705490320920944
Eval: 2022-05-06 19:36:55.965345: total loss: 0.00018903388044192948, mse:0.00037806775759869005, ic :0.025253869905566537, sharpe5:-1.445621138960123, irr5:-0.2937050759792328, ndcg5:0.8444530062560162, pnl5:0.8896682858467102 
train 13, step: 0, loss: 0.0001700359716778621, grad_norm: 1.5985759641279124e-09, ic: 0.04716895006588153
train 13, step: 500, loss: 0.0001234912488143891, grad_norm: 5.257573323333688e-14, ic: 0.015578745116315752
Epoch 13: 2022-05-06 19:37:03.084855: train loss: 0.00020680203791157583
Eval step 0: eval loss: 0.00014722338528372347
Eval: 2022-05-06 19:37:05.674337: total loss: 0.00018905076774891556, mse:0.0003781015306427664, ic :0.020912396300465683, sharpe5:-1.3030169257521629, irr5:-0.17122751474380493, ndcg5:0.8546556872490991, pnl5:0.9327566623687744 
train 14, step: 0, loss: 0.00020704884082078934, grad_norm: 7.472608632283675e-10, ic: 0.05333247093476246
train 14, step: 500, loss: 0.00017333071446046233, grad_norm: 5.231062191559509e-10, ic: -0.031453764555133996
Epoch 14: 2022-05-06 19:37:12.813177: train loss: 0.0002067955421350531
Eval step 0: eval loss: 0.00014663270849268883
Eval: 2022-05-06 19:37:15.486945: total loss: 0.0001889990834129352, mse:0.0003779981618761863, ic :-0.01858945853311045, sharpe5:-4.2187638822197915, irr5:-0.5153964757919312, ndcg5:0.8523766453848538, pnl5:0.6649638414382935 
train 15, step: 0, loss: 0.00014359166380017996, grad_norm: 9.054145026146488e-10, ic: -0.026754386580304587
train 15, step: 500, loss: 0.0001066065815393813, grad_norm: 7.029723686896514e-10, ic: -0.031867878720541476
Epoch 15: 2022-05-06 19:37:22.406781: train loss: 0.00020703231724750133
Eval step 0: eval loss: 0.00014858742360956967
Eval: 2022-05-06 19:37:25.011253: total loss: 0.00018921526841306856, mse:0.00037843053476501967, ic :0.015204555897904358, sharpe5:-0.814804387204349, irr5:-0.15203839540481567, ndcg5:0.8499778448691032, pnl5:1.0083309412002563 
train 16, step: 0, loss: 0.00023800147755537182, grad_norm: 7.603937624005792e-09, ic: -0.00027942243171844364
train 16, step: 500, loss: 0.00014158408157527447, grad_norm: 4.6561595250954505e-09, ic: 0.060301760470224
Epoch 16: 2022-05-06 19:37:31.944523: train loss: 0.0002071437126497989
Eval step 0: eval loss: 0.00014977501996327192
Eval: 2022-05-06 19:37:34.576090: total loss: 0.00018937667781196324, mse:0.0003787533519137741, ic :0.023406778395113882, sharpe5:-0.9845699113234877, irr5:-0.2174559235572815, ndcg5:0.8534186088923958, pnl5:0.9566212892532349 
train 17, step: 0, loss: 0.0001429004332749173, grad_norm: 1.326532017818194e-10, ic: 0.07377889479199704
train 17, step: 500, loss: 8.043556590564549e-05, grad_norm: 1.3621627967906922e-11, ic: 0.050491462849301644
Epoch 17: 2022-05-06 19:37:41.949182: train loss: 0.0002070800330115804
Eval step 0: eval loss: 0.00014881737297400832
Eval: 2022-05-06 19:37:44.665157: total loss: 0.0001892407055103879, mse:0.0003784814059502508, ic :0.019157338940477022, sharpe5:-0.815793234296143, irr5:-0.1738337278366089, ndcg5:0.8504672500546917, pnl5:0.9523664712905884 
train 18, step: 0, loss: 0.0003663149254862219, grad_norm: 2.868126262529723e-08, ic: 0.03407256732640773
train 18, step: 500, loss: 0.00026754362625069916, grad_norm: 2.212256585015719e-08, ic: 0.020878175219144396
Epoch 18: 2022-05-06 19:37:51.445213: train loss: 0.0002068125700742211
Eval step 0: eval loss: 0.00014688173541799188
Eval: 2022-05-06 19:37:54.083529: total loss: 0.0001890169075074073, mse:0.00037803381229983336, ic :0.03530034176196766, sharpe5:-0.7241558532044291, irr5:-0.11340922117233276, ndcg5:0.8602535178909654, pnl5:0.8962704539299011 
train 19, step: 0, loss: 0.00021809509780723602, grad_norm: 2.460461217236459e-08, ic: -0.011970503146671379
train 19, step: 500, loss: 0.00020667251374106854, grad_norm: 2.1329881700089953e-12, ic: 0.06616065066171717
Epoch 19: 2022-05-06 19:38:01.007913: train loss: 0.0002067398614443734
Eval step 0: eval loss: 0.00014798935444559902
Eval: 2022-05-06 19:38:03.535151: total loss: 0.00018913826279140863, mse:0.00037827652315201567, ic :0.01957738883243074, sharpe5:-0.609620093666017, irr5:-0.1368468701839447, ndcg5:0.8451344933623937, pnl5:0.9373312592506409 
train 20, step: 0, loss: 0.000230325385928154, grad_norm: 9.389006423231044e-10, ic: -0.03491674162393226
train 20, step: 500, loss: 0.00010360903979744762, grad_norm: 1.8563737924368336e-10, ic: -0.016377429253392542
Epoch 20: 2022-05-06 19:38:10.830469: train loss: 0.00020677393493383412
Eval step 0: eval loss: 0.00015042177983559668
Eval: 2022-05-06 19:38:13.422159: total loss: 0.00018946763894273636, mse:0.0003789352781084854, ic :0.019911775587582507, sharpe5:-0.6763154238089919, irr5:-0.14347895979881287, ndcg5:0.8499061369593722, pnl5:0.867211103439331 
train 21, step: 0, loss: 0.00036416371585801244, grad_norm: 3.6002017906366165e-08, ic: -0.00949152413364882
train 21, step: 500, loss: 0.00020339722686912864, grad_norm: 7.839116629513352e-09, ic: 0.011581693417553109
Epoch 21: 2022-05-06 19:38:20.475523: train loss: 0.00020736858341527728
Eval step 0: eval loss: 0.00014910363825038075
Eval: 2022-05-06 19:38:23.142615: total loss: 0.00018928120654065154, mse:0.00037856240772299625, ic :0.021934720877904622, sharpe5:-0.8372571163997053, irr5:-0.15277722477912903, ndcg5:0.856280856105914, pnl5:1.0227426290512085 
train 22, step: 0, loss: 0.00012623575457837433, grad_norm: 6.505158518299444e-10, ic: 0.009364395235921655
train 22, step: 500, loss: 0.00014361340436153114, grad_norm: 8.989887997848646e-09, ic: 0.0003100746974464951
Epoch 22: 2022-05-06 19:38:30.232011: train loss: 0.00020695514022154774
Eval step 0: eval loss: 0.000147127007949166
Eval: 2022-05-06 19:38:32.937561: total loss: 0.00018904465924888468, mse:0.0003780893129845406, ic :0.019898628498406637, sharpe5:-0.8054368848726153, irr5:-0.17172807455062866, ndcg5:0.8521621016112002, pnl5:0.8591363430023193 
train 23, step: 0, loss: 0.0001829241227824241, grad_norm: 4.20433250510534e-09, ic: -0.004754680127374693
train 23, step: 500, loss: 0.00012204704398754984, grad_norm: 7.17240344801369e-09, ic: 0.025590998427476946
Epoch 23: 2022-05-06 19:38:40.163402: train loss: 0.00020682145669831606
Eval step 0: eval loss: 0.00014675475540570915
Eval: 2022-05-06 19:38:42.782909: total loss: 0.00018900568473994667, mse:0.0003780113679451029, ic :0.01975224706809007, sharpe5:-1.0483662747591733, irr5:-0.20383012294769287, ndcg5:0.8516363467187786, pnl5:0.8683831095695496 
train 24, step: 0, loss: 0.00016467185923829675, grad_norm: 2.8007479418175823e-08, ic: 0.04132364072898488
train 24, step: 500, loss: 0.00021009525517001748, grad_norm: 3.2588867027174396e-09, ic: 0.050183352078460836
Epoch 24: 2022-05-06 19:38:50.087891: train loss: 0.00020694627125721356
Eval step 0: eval loss: 0.00014850620937068015
Eval: 2022-05-06 19:38:52.599968: total loss: 0.00018920687465866475, mse:0.0003784137474059646, ic :0.010942439632046214, sharpe5:-0.4108446537517011, irr5:-0.07610506564378738, ndcg5:0.8501364248355294, pnl5:1.1407667398452759 
train 25, step: 0, loss: 0.00014111620839685202, grad_norm: 9.678596381443831e-09, ic: 0.037143981358693456
train 25, step: 500, loss: 0.00017948116874322295, grad_norm: 1.3668261436297467e-08, ic: -0.03607896555036658
Epoch 25: 2022-05-06 19:38:59.723560: train loss: 0.00020683143522673197
Eval step 0: eval loss: 0.00014807628758717328
Eval: 2022-05-06 19:39:02.385745: total loss: 0.0001891521651764994, mse:0.0003783043269580632, ic :0.015226020736982511, sharpe5:-0.1563710534479469, irr5:-0.03663202375173569, ndcg5:0.8589807083763756, pnl5:0.9473513960838318 
train 26, step: 0, loss: 0.00015397790411952883, grad_norm: 4.733470744333075e-09, ic: 0.05648886632695356
train 26, step: 500, loss: 7.502111839130521e-05, grad_norm: 2.5435659109240165e-09, ic: 0.05867051978839672
Epoch 26: 2022-05-06 19:39:09.608814: train loss: 0.00020683832603036258
Eval step 0: eval loss: 0.00015034743410069495
Eval: 2022-05-06 19:39:12.177072: total loss: 0.00018946065481774524, mse:0.00037892130654285056, ic :0.021580826940541576, sharpe5:-0.0057377160977921445, irr5:-0.0009037712588906288, ndcg5:0.8533258677566642, pnl5:1.0807602405548096 
train 27, step: 0, loss: 0.00020003924146294594, grad_norm: 7.573360662142495e-09, ic: 0.040699686165895414
train 27, step: 500, loss: 0.00017706031212583184, grad_norm: 3.994537557135564e-09, ic: -0.09007572490726486
Epoch 27: 2022-05-06 19:39:19.381942: train loss: 0.00020686582902855398
Eval step 0: eval loss: 0.0001482021907577291
Eval: 2022-05-06 19:39:22.162516: total loss: 0.00018916526110588643, mse:0.00037833051625361523, ic :0.01579065139780452, sharpe5:-0.5533229110389948, irr5:-0.11614972352981567, ndcg5:0.8622220905641643, pnl5:1.0137608051300049 
train 28, step: 0, loss: 0.00031491651316173375, grad_norm: 9.382540902434777e-10, ic: -0.007945754739409457
train 28, step: 500, loss: 0.00017993818619288504, grad_norm: 4.26522782538165e-09, ic: 0.02400262958878064
Epoch 28: 2022-05-06 19:39:29.359612: train loss: 0.0002068037379128089
Eval step 0: eval loss: 0.0001481338549638167
Eval: 2022-05-06 19:39:31.994779: total loss: 0.00018915822144214463, mse:0.0003783164382153711, ic :0.025129279068504207, sharpe5:-0.7455447115749121, irr5:-0.14310021698474884, ndcg5:0.8446213561531352, pnl5:0.8452115058898926 
train 29, step: 0, loss: 0.00018076250853482634, grad_norm: 1.5170554522572282e-10, ic: -0.05242997916965805
train 29, step: 500, loss: 0.00012465668260119855, grad_norm: 1.4263917022965789e-09, ic: 0.015136808181534539
Epoch 29: 2022-05-06 19:39:39.103061: train loss: 0.0002069218133931919
Eval step 0: eval loss: 0.00014739378821104765
Eval: 2022-05-06 19:39:41.676083: total loss: 0.00018907326612190454, mse:0.00037814652901143253, ic :0.023190124812836617, sharpe5:1.114755716174841, irr5:0.3363806903362274, ndcg5:0.8487208066042408, pnl5:0.8929914236068726 
train 30, step: 0, loss: 0.0001498326746514067, grad_norm: 3.537456937418496e-09, ic: 0.02003994027602204
train 30, step: 500, loss: 0.00022071409330237657, grad_norm: 7.774279481644835e-10, ic: 0.05435587561617984
Epoch 30: 2022-05-06 19:39:48.660828: train loss: 0.00020682824689821454
Eval step 0: eval loss: 0.00015184895892161876
Eval: 2022-05-06 19:39:51.328279: total loss: 0.0001896983018911578, mse:0.0003793966015774632, ic :0.013207779805615343, sharpe5:-0.4622591156512499, irr5:-0.07417282462120056, ndcg5:0.8532161750617491, pnl5:1.113448977470398 
train 31, step: 0, loss: 0.00012442059232853353, grad_norm: 4.1177601336368385e-09, ic: 0.06547719908563814
train 31, step: 500, loss: 0.0001263841986656189, grad_norm: 1.9277377905358696e-09, ic: -0.042078728948257184
Epoch 31: 2022-05-06 19:39:58.707131: train loss: 0.00020699193005554813
Eval step 0: eval loss: 0.0001485860993852839
Eval: 2022-05-06 19:40:01.271881: total loss: 0.00018921451431884142, mse:0.00037842902511845257, ic :0.021951235724841294, sharpe5:-1.063938103839755, irr5:-0.22059571743011475, ndcg5:0.8576894877800169, pnl5:0.8522624969482422 
train 32, step: 0, loss: 0.000208811616175808, grad_norm: 9.939107447709218e-09, ic: 0.06808870504028525
train 32, step: 500, loss: 0.00017573876539245248, grad_norm: 7.496966930641352e-12, ic: -0.05419365511649964
Epoch 32: 2022-05-06 19:40:08.580852: train loss: 0.0002068688009751501
Eval step 0: eval loss: 0.00014766285312362015
Eval: 2022-05-06 19:40:11.254682: total loss: 0.00018910178364997762, mse:0.0003782035588193164, ic :0.017396367074132345, sharpe5:-0.018784102272475137, irr5:-0.0036944327875971794, ndcg5:0.845071133580172, pnl5:1.0232511758804321 
train 33, step: 0, loss: 0.0001746593479765579, grad_norm: 7.41521902985942e-13, ic: 0.001222805764017551
train 33, step: 500, loss: 8.247538789873943e-05, grad_norm: 2.5592514081389855e-10, ic: 0.008391614407056384
Epoch 33: 2022-05-06 19:40:18.337132: train loss: 0.00020681527525678035
Eval step 0: eval loss: 0.00014721615298185498
Eval: 2022-05-06 19:40:20.942725: total loss: 0.00018905195779691746, mse:0.000378103910221993, ic :0.021641185865844202, sharpe5:-0.2085705893486738, irr5:-0.040371041744947433, ndcg5:0.8493462846039127, pnl5:0.9736043214797974 
train 34, step: 0, loss: 0.0001734815741656348, grad_norm: 2.0273606103444156e-10, ic: -0.0014575244489449298
train 34, step: 500, loss: 0.00014011790335644037, grad_norm: 4.521706481938933e-09, ic: 0.048023690096785955
Epoch 34: 2022-05-06 19:40:28.068621: train loss: 0.0002068210139592134
Eval step 0: eval loss: 0.0001486448891228065
Eval: 2022-05-06 19:40:30.625459: total loss: 0.00018922360046480998, mse:0.00037844719244154845, ic :0.02085226491160875, sharpe5:-1.296084236204624, irr5:-0.28315243124961853, ndcg5:0.8473947970719852, pnl5:0.9217391610145569 
train 35, step: 0, loss: 0.00041564597631804645, grad_norm: 5.446269791478409e-08, ic: 0.03133340546586218
train 35, step: 500, loss: 0.0002980580320581794, grad_norm: 1.2415948439589435e-08, ic: -0.017363954546340016
Epoch 35: 2022-05-06 19:40:37.755598: train loss: 0.00020681232894626217
Eval step 0: eval loss: 0.00014711529365740716
Eval: 2022-05-06 19:40:40.310329: total loss: 0.0001890426045692908, mse:0.00037808520486199386, ic :0.02471998581492075, sharpe5:-0.9681567995622754, irr5:-0.20781010389328003, ndcg5:0.8593473245593156, pnl5:0.9772250056266785 
train 36, step: 0, loss: 0.00025225465651601553, grad_norm: 1.861515416799388e-08, ic: -0.0314998597494407
train 36, step: 500, loss: 0.0004679130797740072, grad_norm: 1.6448144369476234e-08, ic: 0.01049158075107717
Epoch 36: 2022-05-06 19:40:47.213196: train loss: 0.00020682030986440597
Eval step 0: eval loss: 0.0001477501355111599
Eval: 2022-05-06 19:40:49.745400: total loss: 0.0001891106099902457, mse:0.0003782212160684419, ic :0.021729143427102422, sharpe5:-1.2294204763323069, irr5:-0.1743755340576172, ndcg5:0.8394758997711635, pnl5:0.8372658491134644 
train 37, step: 0, loss: 0.0002793256426230073, grad_norm: 2.8103362146931807e-08, ic: 0.0740093836639957
train 37, step: 500, loss: 0.00015652261208742857, grad_norm: 1.4147734345214809e-11, ic: 0.005833747211627704
Epoch 37: 2022-05-06 19:40:56.924049: train loss: 0.00020678990611797642
Eval step 0: eval loss: 0.00014747504610568285
Eval: 2022-05-06 19:40:59.599111: total loss: 0.00018908001843297967, mse:0.0003781600371678046, ic :0.023262453832106386, sharpe5:-0.49199476338922976, irr5:-0.08877250552177429, ndcg5:0.8548187160316181, pnl5:1.0464378595352173 
train 38, step: 0, loss: 0.00015803781570866704, grad_norm: 6.8656753647234304e-12, ic: -0.01123304799901962
train 38, step: 500, loss: 0.0003013575333170593, grad_norm: 5.43125293466528e-11, ic: 0.04714771415768551
Epoch 38: 2022-05-06 19:41:07.005207: train loss: 0.00020680890499052648
Eval step 0: eval loss: 0.00014714780263602734
Eval: 2022-05-06 19:41:09.599622: total loss: 0.00018904707648722237, mse:0.00037809414839083493, ic :0.017196182367627873, sharpe5:-0.4642429287917912, irr5:-0.10224517434835434, ndcg5:0.8496255627867857, pnl5:0.9608988165855408 
train 39, step: 0, loss: 0.0003631873696576804, grad_norm: 2.790698681102e-08, ic: 0.000578796871528741
train 39, step: 500, loss: 0.00018543022451922297, grad_norm: 2.5155239922850072e-09, ic: -0.02635842702541473
Epoch 39: 2022-05-06 19:41:16.932938: train loss: 0.00020687518252497465
Eval step 0: eval loss: 0.0001482363441027701
Eval: 2022-05-06 19:41:19.528438: total loss: 0.00018917291026611255, mse:0.0003783458172797909, ic :0.0158909068268633, sharpe5:-0.10286661302670835, irr5:-0.019091349095106125, ndcg5:0.8433161006981572, pnl5:1.1406155824661255 
