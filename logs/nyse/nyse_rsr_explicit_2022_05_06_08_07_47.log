Namespace(adj_path='../Temporal_Relational_Stock_Ranking/data/relation/sector_industry/NYSE_industry_relation.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=True, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=1, market='NYSE', mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1737, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=False)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
relation encoding shape: torch.Size([1737, 1737, 108]) torch.float32
relation mask shape: torch.Size([1737, 1737]) torch.float32
8424
ReRaLSTM(
  (rnn1): LSTM(5, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=108, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.00011516064841998741, grad_norm: 5.183413454290516e-11, ic: -0.02197273995249586
train 0, step: 500, loss: 6.99593874742277e-05, grad_norm: 7.706327230800695e-10, ic: 0.013937509284502853
Epoch 0: 2022-05-06 20:10:07.685496: train loss: 0.000125781903974673
Eval step 0: eval loss: 6.64799299556762e-05
Eval: 2022-05-06 20:10:10.605654: total loss: 0.00011286407235517232, mse:0.00022572814686968318, ic :0.012365105269288646, sharpe5:0.12029718613252043, irr5:0.016303302720189095, ndcg5:0.8597299867607253, pnl5:1.0655591487884521 
train 1, step: 0, loss: 9.451793448533863e-05, grad_norm: 4.4541263756642185e-09, ic: 0.041281971364883485
train 1, step: 500, loss: 9.002930164569989e-05, grad_norm: 3.8561307505739685e-09, ic: 0.014716684966325663
Epoch 1: 2022-05-06 20:10:19.998386: train loss: 0.00012573442720829254
Eval step 0: eval loss: 6.621683860430494e-05
Eval: 2022-05-06 20:10:23.092850: total loss: 0.00011281430059520317, mse:0.00022562860329689835, ic :0.011769480955674313, sharpe5:0.5005027739703655, irr5:0.12214453518390656, ndcg5:0.8591995372204294, pnl5:1.1947753429412842 
train 2, step: 0, loss: 8.028656156966463e-05, grad_norm: 4.474389014868364e-10, ic: 0.05313040319516332
train 2, step: 500, loss: 7.160318637033924e-05, grad_norm: 6.656554016650704e-11, ic: 0.061213898509823214
Epoch 2: 2022-05-06 20:10:32.524849: train loss: 0.00012571366686823114
Eval step 0: eval loss: 6.656838377239183e-05
Eval: 2022-05-06 20:10:35.526204: total loss: 0.00011288205567873428, mse:0.00022576411555688027, ic :0.006060444344384789, sharpe5:0.7092937640100717, irr5:0.24034897983074188, ndcg5:0.8463348934519295, pnl5:0.9876976013183594 
train 3, step: 0, loss: 0.00010285311145707965, grad_norm: 5.2982387038323984e-11, ic: -0.18631983561957924
train 3, step: 500, loss: 0.00012964726192876697, grad_norm: 4.152617913354339e-09, ic: -0.002796883459543731
Epoch 3: 2022-05-06 20:10:44.916741: train loss: 0.0001257842607915798
Eval step 0: eval loss: 6.677482451777905e-05
Eval: 2022-05-06 20:10:48.035744: total loss: 0.00011292500896089585, mse:0.00022585002021536924, ic :0.0056395665812272976, sharpe5:0.30803426418453456, irr5:0.10018664598464966, ndcg5:0.8476165246405732, pnl5:1.1182324886322021 
train 4, step: 0, loss: 7.423489296343178e-05, grad_norm: 8.069178445227145e-11, ic: -0.019362652342681686
train 4, step: 500, loss: 8.016110223252326e-05, grad_norm: 8.240650075544354e-10, ic: 0.003990929586052494
Epoch 4: 2022-05-06 20:10:57.495587: train loss: 0.00012571649320326642
Eval step 0: eval loss: 6.641234358539805e-05
Eval: 2022-05-06 20:11:00.577404: total loss: 0.00011285145247675881, mse:0.00022570290774681398, ic :0.008503893023156706, sharpe5:0.5828751083090901, irr5:0.19512012600898743, ndcg5:0.8520269820531142, pnl5:0.9496844410896301 
train 5, step: 0, loss: 0.00016613845946267247, grad_norm: 1.2044819331823048e-08, ic: 0.1593486922451357
train 5, step: 500, loss: 0.0004807527584489435, grad_norm: 5.10459379874045e-08, ic: -0.11512668738154563
Epoch 5: 2022-05-06 20:11:09.864080: train loss: 0.0001257720986004302
Eval step 0: eval loss: 6.701330858049914e-05
Eval: 2022-05-06 20:11:12.712133: total loss: 0.00011297712612103602, mse:0.00022595425815148847, ic :0.007681877085772997, sharpe5:0.29696273580193516, irr5:0.09413974732160568, ndcg5:0.8542124845033375, pnl5:1.0054954290390015 
train 6, step: 0, loss: 8.303033246193081e-05, grad_norm: 1.1148237487753054e-09, ic: 0.13578904198495623
train 6, step: 500, loss: 8.00497509771958e-05, grad_norm: 3.091514375302865e-09, ic: -0.03698488118231043
Epoch 6: 2022-05-06 20:11:22.034398: train loss: 0.00012579318064384482
Eval step 0: eval loss: 6.675642362097278e-05
Eval: 2022-05-06 20:11:24.911922: total loss: 0.00011292059293121514, mse:0.00022584119017339066, ic :0.002127740755784545, sharpe5:0.187568082511425, irr5:0.05971784144639969, ndcg5:0.8585247362237923, pnl5:1.116158127784729 
train 7, step: 0, loss: 9.848664922174066e-05, grad_norm: 8.100021883801444e-12, ic: 0.020490603119836245
train 7, step: 500, loss: 0.00020085684082005173, grad_norm: 4.826381047123267e-10, ic: -0.019037482998752617
Epoch 7: 2022-05-06 20:11:33.856940: train loss: 0.0001257087368573598
Eval step 0: eval loss: 6.594239675905555e-05
Eval: 2022-05-06 20:11:36.843361: total loss: 0.00011276891938317669, mse:0.00022553784023781836, ic :-0.000998068721877078, sharpe5:0.22932727374136447, irr5:0.0729127824306488, ndcg5:0.8560694217828371, pnl5:0.9435058832168579 
train 8, step: 0, loss: 9.188986587105319e-05, grad_norm: 7.646450154007795e-10, ic: 0.023772517561710643
train 8, step: 500, loss: 8.143026934703812e-05, grad_norm: 2.512471017408668e-11, ic: -0.10623764506297628
Epoch 8: 2022-05-06 20:11:46.399893: train loss: 0.00012564298257418163
Eval step 0: eval loss: 6.603314977837726e-05
Eval: 2022-05-06 20:11:49.477433: total loss: 0.00011278367022753441, mse:0.0002255673422287152, ic :0.0018776475067589751, sharpe5:0.7359686917439103, irr5:0.24181315302848816, ndcg5:0.8604633629900494, pnl5:1.100967288017273 
train 9, step: 0, loss: 0.00011639601143542677, grad_norm: 6.78224505177673e-10, ic: -0.043454247884432126
train 9, step: 500, loss: 5.2657505875686184e-05, grad_norm: 3.055986534947441e-10, ic: 0.03135398956223556
Epoch 9: 2022-05-06 20:11:58.387756: train loss: 0.0001256369855752533
Eval step 0: eval loss: 6.566195224877447e-05
Eval: 2022-05-06 20:12:01.496239: total loss: 0.00011272722527061438, mse:0.00022545445793249803, ic :0.0019667632820229088, sharpe5:0.6100927609205246, irr5:0.20048995316028595, ndcg5:0.8544954253461805, pnl5:1.1366651058197021 
train 10, step: 0, loss: 5.2724939450854436e-05, grad_norm: 1.2668445917890927e-09, ic: -0.052091912995387596
train 10, step: 500, loss: 0.00013307196786627173, grad_norm: 5.357166145525507e-09, ic: 0.11845513972286463
Epoch 10: 2022-05-06 20:12:10.812757: train loss: 0.00012569561958977396
Eval step 0: eval loss: 6.600930646527559e-05
Eval: 2022-05-06 20:12:13.755786: total loss: 0.00011277986907981759, mse:0.00022555973939472927, ic :0.005883366643495634, sharpe5:0.3948652489297092, irr5:0.13005505502223969, ndcg5:0.8499287515282836, pnl5:0.9368903636932373 
train 11, step: 0, loss: 9.565237269271165e-05, grad_norm: 2.9684682494498295e-12, ic: -0.011940385538221472
train 11, step: 500, loss: 8.52346420288086e-05, grad_norm: 2.773280331995656e-10, ic: 0.05609423699488066
Epoch 11: 2022-05-06 20:12:23.149023: train loss: 0.00012565866657686053
Eval step 0: eval loss: 6.590400880668312e-05
Eval: 2022-05-06 20:12:26.173722: total loss: 0.00011276297632380648, mse:0.0002255259568291411, ic :0.0026699689341486573, sharpe5:0.25867816619575024, irr5:0.08146186918020248, ndcg5:0.8524200186862496, pnl5:1.051985502243042 
train 12, step: 0, loss: 8.29222408356145e-05, grad_norm: 6.602611988079345e-10, ic: 0.0023045206516814163
train 12, step: 500, loss: 7.996703789103776e-05, grad_norm: 3.749991669705246e-10, ic: 0.07372535506836798
Epoch 12: 2022-05-06 20:12:35.593804: train loss: 0.00012562596641953587
Eval step 0: eval loss: 6.575044972123578e-05
Eval: 2022-05-06 20:12:38.626583: total loss: 0.00011273994056256813, mse:0.000225479883311756, ic :0.0019717804390677303, sharpe5:0.5070206159725785, irr5:0.1622188687324524, ndcg5:0.8534330547164335, pnl5:1.1773746013641357 
train 13, step: 0, loss: 8.268097008112818e-05, grad_norm: 1.2821892926588098e-09, ic: 0.012832286358110616
train 13, step: 500, loss: 6.163232319522649e-05, grad_norm: 6.9589044793024e-11, ic: 0.016178412257104643
Epoch 13: 2022-05-06 20:12:47.975686: train loss: 0.00012566780651711615
Eval step 0: eval loss: 6.598704203497618e-05
Eval: 2022-05-06 20:12:50.995175: total loss: 0.00011277634853306003, mse:0.0002255527017114637, ic :0.002026351761244327, sharpe5:0.3783391877263784, irr5:0.12201446294784546, ndcg5:0.8405936517941542, pnl5:1.1109830141067505 
train 14, step: 0, loss: 9.844909800449386e-05, grad_norm: 4.690007886508094e-13, ic: 0.0013152923896616823
train 14, step: 500, loss: 0.00011673664994305, grad_norm: 7.128505139405039e-10, ic: 0.03579447309477998
Epoch 14: 2022-05-06 20:13:00.262770: train loss: 0.00012569896255670872
Eval step 0: eval loss: 6.584309448953718e-05
Eval: 2022-05-06 20:13:03.204646: total loss: 0.00011275268019244124, mse:0.0002255053658402224, ic :0.008952758163111857, sharpe5:0.03357593246502802, irr5:0.010451728478074074, ndcg5:0.8486029973602459, pnl5:0.9294780492782593 
train 15, step: 0, loss: 7.667670433875173e-05, grad_norm: 1.3887010003427591e-09, ic: 0.03978355711691358
train 15, step: 500, loss: 8.299532782984897e-05, grad_norm: 3.341720407835649e-09, ic: 0.06231473151120125
Epoch 15: 2022-05-06 20:13:12.563848: train loss: 0.00012567059623404657
Eval step 0: eval loss: 6.57276323181577e-05
Eval: 2022-05-06 20:13:15.516944: total loss: 0.00011273281922699644, mse:0.0002254656426555964, ic :0.008713907423501812, sharpe5:-0.10149229381699114, irr5:-0.03203611075878143, ndcg5:0.8553299104834035, pnl5:0.9580216407775879 
train 16, step: 0, loss: 0.0001120691595133394, grad_norm: 4.385305149407236e-09, ic: -0.12802886504196162
train 16, step: 500, loss: 9.309119923273101e-05, grad_norm: 1.8398701697423964e-09, ic: 0.07649098618173861
Epoch 16: 2022-05-06 20:13:24.901761: train loss: 0.0001258910580318456
Eval step 0: eval loss: 6.707121065119281e-05
Eval: 2022-05-06 20:13:28.026447: total loss: 0.00011299171338343838, mse:0.00022598342884909937, ic :0.00967278228333832, sharpe5:0.48088746719062325, irr5:0.160133957862854, ndcg5:0.8493096336814875, pnl5:0.9502540230751038 
train 17, step: 0, loss: 7.800274761393666e-05, grad_norm: 5.083123849898709e-10, ic: 0.05260046958727477
train 17, step: 500, loss: 7.572174945380539e-05, grad_norm: 1.1345169799891417e-09, ic: 0.048497170456986496
Epoch 17: 2022-05-06 20:13:37.287434: train loss: 0.00012576072170688768
Eval step 0: eval loss: 6.68882712488994e-05
Eval: 2022-05-06 20:13:40.343302: total loss: 0.00011294971531695243, mse:0.00022589943410442355, ic :0.006800658165747695, sharpe5:0.8287955152988433, irr5:0.2644498944282532, ndcg5:0.8475968277329993, pnl5:0.9544999599456787 
train 18, step: 0, loss: 0.00020436596241779625, grad_norm: 1.8106135417328445e-08, ic: 0.057118289937588745
train 18, step: 500, loss: 0.00018083951727021486, grad_norm: 1.49250173211536e-08, ic: -0.011120107581022182
Epoch 18: 2022-05-06 20:13:49.672116: train loss: 0.00012573303471840445
Eval step 0: eval loss: 6.630930147366598e-05
Eval: 2022-05-06 20:13:52.595860: total loss: 0.00011283196933685973, mse:0.000225663941921613, ic :0.010763825706736204, sharpe5:0.394870599322021, irr5:0.12318557500839233, ndcg5:0.8516304584865477, pnl5:0.9031957983970642 
train 19, step: 0, loss: 0.00014055648352950811, grad_norm: 8.160132392882937e-09, ic: -0.08930194864387245
train 19, step: 500, loss: 0.000121830846183002, grad_norm: 3.167098266925597e-09, ic: 0.0267164491582962
Epoch 19: 2022-05-06 20:14:01.916641: train loss: 0.00012572274623224872
Eval step 0: eval loss: 6.678982026642188e-05
Eval: 2022-05-06 20:14:04.772129: total loss: 0.00011292846515196717, mse:0.00022585693357657062, ic :0.008936125483976464, sharpe5:0.6479258874803782, irr5:0.18695056438446045, ndcg5:0.8509429675717753, pnl5:0.9762116074562073 
train 20, step: 0, loss: 0.00011053601338062435, grad_norm: 1.082326893260183e-11, ic: -0.07414113766137864
train 20, step: 500, loss: 9.813894575927407e-05, grad_norm: 2.321922299235638e-09, ic: 0.04843071267796249
Epoch 20: 2022-05-06 20:14:14.100714: train loss: 0.0001257730189604323
Eval step 0: eval loss: 6.683897663606331e-05
Eval: 2022-05-06 20:14:17.072031: total loss: 0.00011293783693487438, mse:0.00022587567862810442, ic :0.011934899627439453, sharpe5:0.8294244376569986, irr5:0.2575882375240326, ndcg5:0.8474879448177405, pnl5:0.9368443489074707 
train 21, step: 0, loss: 0.00014814826135989279, grad_norm: 8.235048923232464e-09, ic: 0.005032136105413178
train 21, step: 500, loss: 9.324578422820196e-05, grad_norm: 4.516949834632243e-09, ic: -0.005397803170034386
Epoch 21: 2022-05-06 20:14:26.432944: train loss: 0.00012571717802845883
Eval step 0: eval loss: 6.617750477744266e-05
Eval: 2022-05-06 20:14:29.432390: total loss: 0.00011280808772171917, mse:0.00022561617881536975, ic :0.007090344872786593, sharpe5:0.545831120274961, irr5:0.1797817051410675, ndcg5:0.8484176022990078, pnl5:1.013058066368103 
train 22, step: 0, loss: 0.00013899877376388758, grad_norm: 7.076501152590459e-10, ic: -0.03956384345816135
train 22, step: 500, loss: 0.00012268556747585535, grad_norm: 9.110697267374636e-09, ic: -0.02962876956633365
Epoch 22: 2022-05-06 20:14:38.738934: train loss: 0.00012572543838033844
Eval step 0: eval loss: 6.59697107039392e-05
Eval: 2022-05-06 20:14:41.756291: total loss: 0.00011277304988712332, mse:0.00022554610286546278, ic :0.010472323256294679, sharpe5:0.5268619398772716, irr5:0.17279258370399475, ndcg5:0.8498255317697142, pnl5:1.1198773384094238 
train 23, step: 0, loss: 8.560132118873298e-05, grad_norm: 4.153263905211394e-09, ic: 0.017318662523127273
train 23, step: 500, loss: 7.914954039733857e-05, grad_norm: 2.7091431162641805e-09, ic: 0.05407960580440557
Epoch 23: 2022-05-06 20:14:51.268618: train loss: 0.00012629030485954826
Eval step 0: eval loss: 6.795568333473057e-05
Eval: 2022-05-06 20:14:54.252923: total loss: 0.00011321528648307413, mse:0.0002264305752808651, ic :0.012889748198329182, sharpe5:-0.4352749884501099, irr5:-0.1323692798614502, ndcg5:0.8407209014692033, pnl5:0.9246447682380676 
train 24, step: 0, loss: 0.00010927016410278156, grad_norm: 1.0030818872369243e-09, ic: 0.05499315522032084
train 24, step: 500, loss: 0.00017284529167227447, grad_norm: 4.931298436320561e-09, ic: -0.041253199253553904
Epoch 24: 2022-05-06 20:15:03.532692: train loss: 0.00012581131129913445
Eval step 0: eval loss: 6.642013613600284e-05
Eval: 2022-05-06 20:15:06.514314: total loss: 0.00011285238759617594, mse:0.00022570477792021394, ic :0.01366980975960808, sharpe5:0.09604156686924398, irr5:0.02933325432240963, ndcg5:0.8509897197315308, pnl5:0.9555250406265259 
train 25, step: 0, loss: 0.00010251408093608916, grad_norm: 6.713641064780014e-09, ic: -0.01160289170511171
train 25, step: 500, loss: 8.912070916267112e-05, grad_norm: 4.148186820120734e-09, ic: 0.011810342517029532
Epoch 25: 2022-05-06 20:15:15.709878: train loss: 0.00012570892632893788
Eval step 0: eval loss: 6.594261503778398e-05
Eval: 2022-05-06 20:15:18.682706: total loss: 0.00011276765133309641, mse:0.0002255353070355391, ic :0.015974781647456738, sharpe5:-0.11373650404158979, irr5:-0.0357075035572052, ndcg5:0.853246859776186, pnl5:0.9561325907707214 
train 26, step: 0, loss: 8.986577449832112e-05, grad_norm: 1.9420062303754804e-09, ic: 0.018546678563454284
train 26, step: 500, loss: 5.270511610433459e-05, grad_norm: 3.2487069175026295e-10, ic: -0.012231588542435752
Epoch 26: 2022-05-06 20:15:27.920014: train loss: 0.00012582699501972408
Eval step 0: eval loss: 6.70517110847868e-05
Eval: 2022-05-06 20:15:30.988398: total loss: 0.00011298710252331187, mse:0.00022597420955491177, ic :0.010874773256173942, sharpe5:1.4644125444442033, irr5:0.45065850019454956, ndcg5:0.8444336534715386, pnl5:1.1390043497085571 
train 27, step: 0, loss: 9.5064562628977e-05, grad_norm: 1.365969046643328e-09, ic: -0.029435620068364785
train 27, step: 500, loss: 0.00013680802658200264, grad_norm: 1.6617053686360155e-09, ic: -0.03781553934330507
Epoch 27: 2022-05-06 20:15:40.303515: train loss: 0.00012573678025103952
Eval step 0: eval loss: 6.655044126091525e-05
Eval: 2022-05-06 20:15:43.351487: total loss: 0.00011287794998929812, mse:0.0002257559037028318, ic :0.012683562927289404, sharpe5:1.351931690275669, irr5:0.39535820484161377, ndcg5:0.853241531625293, pnl5:1.1413698196411133 
train 28, step: 0, loss: 0.0001682029542280361, grad_norm: 1.297825049976869e-09, ic: -0.010255270696452004
train 28, step: 500, loss: 7.70704064052552e-05, grad_norm: 1.2633366882829065e-09, ic: 0.003301235739116396
Epoch 28: 2022-05-06 20:15:52.684101: train loss: 0.00012569751439309949
Eval step 0: eval loss: 6.61686499370262e-05
Eval: 2022-05-06 20:15:55.694625: total loss: 0.00011280489058968892, mse:0.00022560978495831809, ic :0.01621093726789172, sharpe5:0.30874766953289506, irr5:0.07718632370233536, ndcg5:0.849397373280388, pnl5:1.1187249422073364 
train 29, step: 0, loss: 0.00011505837028380483, grad_norm: 1.6211145073813304e-11, ic: -0.006943548860888876
train 29, step: 500, loss: 9.708744619274512e-05, grad_norm: 5.000861340991275e-09, ic: -0.023062323150288666
Epoch 29: 2022-05-06 20:16:05.183151: train loss: 0.0001257518280451519
Eval step 0: eval loss: 6.615824531763792e-05
Eval: 2022-05-06 20:16:08.302503: total loss: 0.00011280415579740174, mse:0.00022560831486919276, ic :0.013844254642732803, sharpe5:0.7461590903252363, irr5:0.2085871398448944, ndcg5:0.8410713926728446, pnl5:1.0451403856277466 
train 30, step: 0, loss: 0.00011368614650564268, grad_norm: 1.4375884278034695e-09, ic: 0.028065161888889217
train 30, step: 500, loss: 0.0001823099737521261, grad_norm: 5.958205607864118e-10, ic: -0.03201316261039147
Epoch 30: 2022-05-06 20:16:17.847145: train loss: 0.00012571391264579935
Eval step 0: eval loss: 6.731058965669945e-05
Eval: 2022-05-06 20:16:20.834408: total loss: 0.00011304754104366624, mse:0.00022609508544035878, ic :0.011834465597273794, sharpe5:0.8021418117731809, irr5:0.23967088758945465, ndcg5:0.853837211243274, pnl5:1.0217092037200928 
train 31, step: 0, loss: 4.782520409207791e-05, grad_norm: 9.343255194365483e-10, ic: 0.06453023785995346
train 31, step: 500, loss: 6.52355738566257e-05, grad_norm: 1.4748145520756814e-10, ic: -0.025123318360869683
Epoch 31: 2022-05-06 20:16:30.298240: train loss: 0.00012574951617771052
Eval step 0: eval loss: 6.66492705931887e-05
Eval: 2022-05-06 20:16:33.280550: total loss: 0.00011289801074173627, mse:0.00022579602576650474, ic :0.011557331483044045, sharpe5:1.0530331175029277, irr5:0.2998456656932831, ndcg5:0.8546939323932998, pnl5:1.0837651491165161 
train 32, step: 0, loss: 9.179957123706117e-05, grad_norm: 3.5932540389758255e-09, ic: 0.05074958759148561
train 32, step: 500, loss: 0.000141962431371212, grad_norm: 5.234118824643188e-10, ic: 0.010938770841613033
Epoch 32: 2022-05-06 20:16:42.715448: train loss: 0.00012576309683041511
Eval step 0: eval loss: 6.632826261920854e-05
Eval: 2022-05-06 20:16:45.654100: total loss: 0.0001128341487880062, mse:0.0002256683014810767, ic :0.016525265587592826, sharpe5:0.600581773482263, irr5:0.15091529488563538, ndcg5:0.8479936982588462, pnl5:1.0052707195281982 
train 33, step: 0, loss: 9.489078365731984e-05, grad_norm: 4.334037576688336e-11, ic: 0.04981563596347022
train 33, step: 500, loss: 5.525245796889067e-05, grad_norm: 2.8819935675706745e-10, ic: 0.013337404956782047
Epoch 33: 2022-05-06 20:16:55.020796: train loss: 0.00012572971097244863
Eval step 0: eval loss: 6.631737778661773e-05
Eval: 2022-05-06 20:16:57.898860: total loss: 0.0001128334817034294, mse:0.00022566696673052944, ic :0.007145256964384087, sharpe5:0.36100353235378857, irr5:0.12430830299854279, ndcg5:0.8532992295116104, pnl5:1.0523440837860107 
train 34, step: 0, loss: 7.578896475024521e-05, grad_norm: 1.1181976587913672e-09, ic: -0.06966030369078186
train 34, step: 500, loss: 9.306013089371845e-05, grad_norm: 1.7283443894779475e-09, ic: -0.005003928012215013
Epoch 34: 2022-05-06 20:17:07.194107: train loss: 0.00012573951694491522
Eval step 0: eval loss: 6.635063618887216e-05
Eval: 2022-05-06 20:17:10.191386: total loss: 0.00011284033357438746, mse:0.0002256806698257791, ic :0.0051801755550697015, sharpe5:0.304074914753437, irr5:0.09795500338077545, ndcg5:0.8608912576744915, pnl5:1.024667739868164 
train 35, step: 0, loss: 0.00026063816039822996, grad_norm: 2.992055064952517e-08, ic: 0.20740623350991902
train 35, step: 500, loss: 0.00017519462562631816, grad_norm: 8.606752830551308e-09, ic: -0.0961402313832128
Epoch 35: 2022-05-06 20:17:19.502443: train loss: 0.00012576701277414837
Eval step 0: eval loss: 6.71363013680093e-05
Eval: 2022-05-06 20:17:22.571842: total loss: 0.00011300595875526473, mse:0.0002260119191972228, ic :0.003032722594913028, sharpe5:0.21092960983514786, irr5:0.06541123241186142, ndcg5:0.8480820348501926, pnl5:0.9904245138168335 
train 36, step: 0, loss: 0.0002668698725756258, grad_norm: 1.4835622244512028e-08, ic: 0.09986858141263222
train 36, step: 500, loss: 0.0003305349382571876, grad_norm: 1.0604007859715031e-08, ic: 0.07311811650662414
Epoch 36: 2022-05-06 20:17:31.898209: train loss: 0.00012571992056839134
Eval step 0: eval loss: 6.640220817644149e-05
Eval: 2022-05-06 20:17:34.838960: total loss: 0.00011284972206975626, mse:0.00022569944762566315, ic :0.007040572259901986, sharpe5:-0.0011455382080748676, irr5:-0.00036028027534484863, ndcg5:0.8503921280333455, pnl5:1.008583664894104 
train 37, step: 0, loss: 0.00017974662478081882, grad_norm: 1.7971455489048182e-08, ic: 0.08447667889651855
train 37, step: 500, loss: 9.448909986531362e-05, grad_norm: 1.778718651327848e-09, ic: 0.011851579878835537
Epoch 37: 2022-05-06 20:17:44.180972: train loss: 0.00012568034468948459
Eval step 0: eval loss: 6.62905877106823e-05
Eval: 2022-05-06 20:17:47.266041: total loss: 0.00011282882057882715, mse:0.0002256576445048504, ic :0.006686227849009361, sharpe5:0.23117069081403313, irr5:0.07419595867395401, ndcg5:0.8486424955879666, pnl5:1.0661506652832031 
train 38, step: 0, loss: 9.36877477215603e-05, grad_norm: 6.439252960907975e-10, ic: -0.012448449294322945
train 38, step: 500, loss: 0.0001537751086289063, grad_norm: 8.721987708170774e-10, ic: 0.06740285942696185
Epoch 38: 2022-05-06 20:17:56.754576: train loss: 0.00012572671419226988
Eval step 0: eval loss: 6.635253521380946e-05
Eval: 2022-05-06 20:17:59.704890: total loss: 0.00011284020734128876, mse:0.00022568041825680213, ic :0.009359497300671754, sharpe5:0.6070785686373711, irr5:0.17657089233398438, ndcg5:0.8514020885944579, pnl5:0.9876945614814758 
train 39, step: 0, loss: 0.00020241938182152808, grad_norm: 1.842235356556111e-08, ic: 0.024253484390202983
train 39, step: 500, loss: 0.0001239995181094855, grad_norm: 2.614618967559617e-09, ic: -0.045205220081942304
Epoch 39: 2022-05-06 20:18:09.087668: train loss: 0.0001257505672763601
Eval step 0: eval loss: 6.628988921875134e-05
Eval: 2022-05-06 20:18:11.997129: total loss: 0.00011282879603438499, mse:0.0002256575965973955, ic :0.006528809878410215, sharpe5:0.15019869603216648, irr5:0.052538417279720306, ndcg5:0.8460557365110931, pnl5:1.0343434810638428 
