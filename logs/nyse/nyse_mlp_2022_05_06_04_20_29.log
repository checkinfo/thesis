Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.0004, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='MlpModel', normalize_adj=True, num_days=1, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
21300
MlpModel(
  (fc1): Linear(in_features=5, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): ReLU()
)
train 0, step: 0, loss: 0.00018743358668871224, grad_norm: 0.00033551219958546604, ic: 0.2547518540513789
train 0, step: 500, loss: 0.00023316113220062107, grad_norm: 3.385764609498745e-06, ic: 0.014510872467262508
Epoch 0: 2022-05-06 16:22:41.622431: train loss: 0.0001398122016410266
Eval step 0: eval loss: 0.00018433178775012493
Eval: 2022-05-06 16:22:44.011317: total loss: 0.00012071174062269057, mse:0.00024142348255662356, ic :0.012739770764347149, sharpe5:0.33620993262156845, irr5:0.10474545508623123, ndcg5:0.8479790047892459, pnl5:1.0037788152694702 
train 1, step: 0, loss: 0.00010347241186536849, grad_norm: 1.2508030680003591e-05, ic: 0.01565595754245592
train 1, step: 500, loss: 0.0002645998611114919, grad_norm: 6.793869606695376e-05, ic: -0.2625202923526778
Epoch 1: 2022-05-06 16:22:48.482723: train loss: 0.00013007575552370892
Eval step 0: eval loss: 9.018760465551168e-05
Eval: 2022-05-06 16:22:50.855956: total loss: 0.00013142220976047704, mse:0.00026284441983808046, ic :0.01379303624109384, sharpe5:-0.15378271987661718, irr5:-0.04930392652750015, ndcg5:0.8533560712106147, pnl5:1.0439326763153076 
train 2, step: 0, loss: 0.00012747483560815454, grad_norm: 2.6541185274346628e-05, ic: 0.3242141685233474
train 2, step: 500, loss: 0.00011268227535765618, grad_norm: 1.4158514561799515e-05, ic: 0.06265308950195356
Epoch 2: 2022-05-06 16:22:55.243756: train loss: 0.0001294410292998601
Eval step 0: eval loss: 0.00014873086183797568
Eval: 2022-05-06 16:22:57.619817: total loss: 0.0001128930702395599, mse:0.00022578613804660427, ic :0.010636714436797295, sharpe5:0.20525061179883777, irr5:0.06452535092830658, ndcg5:0.8642300409770594, pnl5:1.051179051399231 
train 3, step: 0, loss: 6.144122744444758e-05, grad_norm: 6.715959245458891e-07, ic: 0.06478922582925108
train 3, step: 500, loss: 6.084459528210573e-05, grad_norm: 2.9318260765288712e-05, ic: -0.09506836614923796
Epoch 3: 2022-05-06 16:23:02.087689: train loss: 0.00012807590678405164
Eval step 0: eval loss: 0.00018529000226408243
Eval: 2022-05-06 16:23:04.537316: total loss: 0.00011877932637755787, mse:0.00023755865048339208, ic :0.008771414310708898, sharpe5:0.17457396011799572, irr5:0.05460372567176819, ndcg5:0.8557247153122981, pnl5:0.9943938851356506 
train 4, step: 0, loss: 0.00012650457210838795, grad_norm: 0.00011002821440808819, ic: 0.15397076784569758
train 4, step: 500, loss: 0.00028236903017386794, grad_norm: 0.0003020818895899214, ic: -0.0295023062406475
Epoch 4: 2022-05-06 16:23:08.962144: train loss: 0.0001276321183937904
Eval step 0: eval loss: 0.00016719861014280468
Eval: 2022-05-06 16:23:11.297343: total loss: 0.00011513732996240448, mse:0.0002302746571759972, ic :0.011459290006235582, sharpe5:0.353117024526, irr5:0.11247272044420242, ndcg5:0.8427263294873953, pnl5:0.98949134349823 
train 5, step: 0, loss: 7.534751784987748e-05, grad_norm: 5.016374555156986e-05, ic: 0.1448565458749247
train 5, step: 500, loss: 6.994822615524754e-05, grad_norm: 8.556879548929773e-06, ic: 0.0694482001378309
Epoch 5: 2022-05-06 16:23:15.707945: train loss: 0.00012710751931045038
Eval step 0: eval loss: 0.00014198418648447841
Eval: 2022-05-06 16:23:18.040917: total loss: 0.0001125761030272184, mse:0.00022515220387714298, ic :0.01409483598686775, sharpe5:0.05053498007822781, irr5:0.01598045416176319, ndcg5:0.8398504578904378, pnl5:0.9912300705909729 
train 6, step: 0, loss: 0.0001364280906273052, grad_norm: 5.445493083114127e-07, ic: 0.06387874137233926
train 6, step: 500, loss: 0.00019703641009982675, grad_norm: 0.00010445373926372445, ic: -0.1369374771622451
Epoch 6: 2022-05-06 16:23:22.456678: train loss: 0.00012737481117815964
Eval step 0: eval loss: 0.00015075971896294504
Eval: 2022-05-06 16:23:24.812065: total loss: 0.00011295478095034614, mse:0.00022590956031924887, ic :0.015381716579793954, sharpe5:0.04101525021716952, irr5:0.012789098545908928, ndcg5:0.845280678462937, pnl5:1.0066341161727905 
train 7, step: 0, loss: 0.0003992498677689582, grad_norm: 0.0003874767884311913, ic: -0.30872454643522323
train 7, step: 500, loss: 0.0001568703301018104, grad_norm: 3.1695850571993407e-05, ic: 0.2773009989328747
Epoch 7: 2022-05-06 16:23:29.244970: train loss: 0.0001272827894149336
Eval step 0: eval loss: 0.00013249204494059086
Eval: 2022-05-06 16:23:31.713566: total loss: 0.00011286643508602707, mse:0.00022573286819446033, ic :0.012644037240658056, sharpe5:0.5536733173951507, irr5:0.18373996019363403, ndcg5:0.8520539286025557, pnl5:1.0231972932815552 
train 8, step: 0, loss: 0.00025225980789400637, grad_norm: 0.00023484823664050581, ic: 0.13083405516070112
train 8, step: 500, loss: 0.00013615190982818604, grad_norm: 1.5318416645529883e-06, ic: 0.03250878610908965
Epoch 8: 2022-05-06 16:23:36.204657: train loss: 0.00012695183258080417
Eval step 0: eval loss: 0.00014412979362532496
Eval: 2022-05-06 16:23:38.563338: total loss: 0.00011260463666615779, mse:0.00022520927374964093, ic :0.01298239414921998, sharpe5:0.6239283433556556, irr5:0.2033316195011139, ndcg5:0.8522979140424206, pnl5:1.021087884902954 
train 9, step: 0, loss: 0.00010726625623647124, grad_norm: 1.5624311657970408e-05, ic: -0.02431136350708274
train 9, step: 500, loss: 0.00011693193664541468, grad_norm: 4.403717792647119e-06, ic: -0.01216181600070506
Epoch 9: 2022-05-06 16:23:43.047044: train loss: 0.0001271238851652786
Eval step 0: eval loss: 0.0001308667560806498
Eval: 2022-05-06 16:23:45.417779: total loss: 0.00011296811076675313, mse:0.00022593621862780793, ic :0.012990848924605742, sharpe5:0.5000305205583572, irr5:0.16102397441864014, ndcg5:0.8400302809050777, pnl5:1.0312198400497437 
train 10, step: 0, loss: 0.00011683219054248184, grad_norm: 2.6605147915225433e-06, ic: 0.11474917812300528
train 10, step: 500, loss: 0.00010038109758170322, grad_norm: 5.063536915475629e-06, ic: -0.13083337135345588
Epoch 10: 2022-05-06 16:23:49.783509: train loss: 0.00012735977131601218
Eval step 0: eval loss: 0.00013684302393812686
Eval: 2022-05-06 16:23:52.120104: total loss: 0.00011262484902976736, mse:0.0002252496963975735, ic :0.014412506060607334, sharpe5:-0.663126381598413, irr5:-0.16999725997447968, ndcg5:0.8501925560498051, pnl5:0.8985217809677124 
train 11, step: 0, loss: 0.00025825086049735546, grad_norm: 3.7234106908011477e-06, ic: -0.016524297929092338
train 11, step: 500, loss: 7.65644435887225e-05, grad_norm: 3.785205288172423e-05, ic: 0.014706178080161947
Epoch 11: 2022-05-06 16:23:56.528448: train loss: 0.000126694957981085
Eval step 0: eval loss: 0.00012745664571411908
Eval: 2022-05-06 16:23:58.986957: total loss: 0.00011339000829431856, mse:0.0002267800140850848, ic :0.017581194282265972, sharpe5:0.16437237300910054, irr5:0.046309567987918854, ndcg5:0.8494884747368561, pnl5:1.0272457599639893 
train 12, step: 0, loss: 0.0003454521356616169, grad_norm: 0.0004494170059998244, ic: -0.010965636428735914
train 12, step: 500, loss: 0.00012995798897463828, grad_norm: 4.508395662686909e-06, ic: -0.01819167115879768
Epoch 12: 2022-05-06 16:24:03.391371: train loss: 0.00012720113217141418
Eval step 0: eval loss: 0.00014881057722959667
Eval: 2022-05-06 16:24:05.807520: total loss: 0.0001128235605962908, mse:0.0002256471169591142, ic :-0.0015971732254514222, sharpe5:0.17661971661262213, irr5:0.055204346776008606, ndcg5:0.8397465180387648, pnl5:0.9616443514823914 
train 13, step: 0, loss: 0.00019915919983759522, grad_norm: 2.1453649215628108e-05, ic: 0.10864397394296867
train 13, step: 500, loss: 5.018648153054528e-05, grad_norm: 1.0830253252612542e-07, ic: -0.08027730129156974
Epoch 13: 2022-05-06 16:24:10.233764: train loss: 0.000126397065854545
Eval step 0: eval loss: 0.00014077684318181127
Eval: 2022-05-06 16:24:12.643771: total loss: 0.00011256883083090434, mse:0.00022513765952416058, ic :0.01363375579209836, sharpe5:0.4371232090517878, irr5:0.12495686858892441, ndcg5:0.8546451287306339, pnl5:1.1146293878555298 
train 14, step: 0, loss: 6.54079340165481e-05, grad_norm: 5.983525157541467e-06, ic: 0.02926537477764763
train 14, step: 500, loss: 6.723354454152286e-05, grad_norm: 1.9758740238123317e-05, ic: -0.02044211299324928
Epoch 14: 2022-05-06 16:24:17.168899: train loss: 0.00012636558260284487
Eval step 0: eval loss: 0.00013274414232000709
Eval: 2022-05-06 16:24:19.528842: total loss: 0.00011281826106315455, mse:0.0002256365203268076, ic :0.01667922359816256, sharpe5:0.2042339337989688, irr5:0.06404076516628265, ndcg5:0.8501110061384528, pnl5:0.9659250378608704 
train 15, step: 0, loss: 0.00017081671103369445, grad_norm: 9.823696546860319e-05, ic: -0.07372265303179593
train 15, step: 500, loss: 8.493828499922529e-05, grad_norm: 3.2037311749483086e-06, ic: 0.13632866918757217
Epoch 15: 2022-05-06 16:24:23.951290: train loss: 0.0001266412989790351
Eval step 0: eval loss: 0.00018982465553563088
Eval: 2022-05-06 16:24:26.487027: total loss: 0.00012172308163564471, mse:0.00024344616218278334, ic :0.012657530525241836, sharpe5:0.14968548699282108, irr5:0.046812504529953, ndcg5:0.8528765732420658, pnl5:1.0072704553604126 
train 16, step: 0, loss: 0.00013076582399662584, grad_norm: 5.276310510074059e-05, ic: 0.10355646938261437
train 16, step: 500, loss: 9.985996439354494e-05, grad_norm: 1.8987558328341396e-06, ic: 0.12687253510110927
Epoch 16: 2022-05-06 16:24:30.933942: train loss: 0.0001262446966146378
Eval step 0: eval loss: 0.00010287789336871356
Eval: 2022-05-06 16:24:33.335778: total loss: 0.00012162936697785557, mse:0.00024325873168718886, ic :0.009498020744493685, sharpe5:0.15773201884701848, irr5:0.046914760023355484, ndcg5:0.8447648868268617, pnl5:0.9435975551605225 
train 17, step: 0, loss: 0.00012826953025069088, grad_norm: 0.00013345327805995807, ic: 0.06171396107657983
train 17, step: 500, loss: 0.00016639767272863537, grad_norm: 0.00010718586850424453, ic: 0.06140867678688196
Epoch 17: 2022-05-06 16:24:37.629668: train loss: 0.0001263864410868445
Eval step 0: eval loss: 0.00013627816224470735
Eval: 2022-05-06 16:24:39.976332: total loss: 0.00011265970115962742, mse:0.00022531940128247077, ic :0.010884000502249684, sharpe5:-0.1398459086101502, irr5:-0.03987334296107292, ndcg5:0.8514169294354497, pnl5:0.9285940527915955 
train 18, step: 0, loss: 0.00011133121006423607, grad_norm: 9.616603292936255e-06, ic: 0.10046295457529482
train 18, step: 500, loss: 8.531850471626967e-05, grad_norm: 1.86026588148566e-05, ic: 0.21579861839723974
Epoch 18: 2022-05-06 16:24:44.550763: train loss: 0.0001265268409283545
Eval step 0: eval loss: 0.00011475211067590863
Eval: 2022-05-06 16:24:46.946773: total loss: 0.00011603751416691536, mse:0.0002320750289654281, ic :0.012378065637447226, sharpe5:0.3839329194277525, irr5:0.10963278263807297, ndcg5:0.8615354204752225, pnl5:1.1013692617416382 
train 19, step: 0, loss: 0.00013807161303702742, grad_norm: 0.0001563864256974132, ic: -0.24294165443941895
train 19, step: 500, loss: 7.1333946834784e-05, grad_norm: 1.858986914889936e-06, ic: 0.06894870130355962
Epoch 19: 2022-05-06 16:24:51.409912: train loss: 0.0001269356870670288
Eval step 0: eval loss: 0.00013743925956077874
Eval: 2022-05-06 16:24:53.725357: total loss: 0.0001125844836509313, mse:0.00022516896618346346, ic :0.019034950525395392, sharpe5:0.9920433747768401, irr5:0.2776784896850586, ndcg5:0.8543047664915192, pnl5:1.0596550703048706 
train 20, step: 0, loss: 0.00011507685849210247, grad_norm: 1.5541199145854954e-05, ic: 0.21773718000062894
train 20, step: 500, loss: 7.987883145688102e-05, grad_norm: 3.8695279540148846e-07, ic: 0.08099444464793304
Epoch 20: 2022-05-06 16:24:58.244822: train loss: 0.0001267773309041783
Eval step 0: eval loss: 0.0001486316614318639
Eval: 2022-05-06 16:25:00.593287: total loss: 0.00011286754360591689, mse:0.00022573508408845594, ic :0.011477491134147335, sharpe5:0.28574169203639027, irr5:0.0891077071428299, ndcg5:0.8402677541911656, pnl5:0.9787623286247253 
train 21, step: 0, loss: 8.984254236565903e-05, grad_norm: 3.9434081442582945e-05, ic: 0.02830880562089082
train 21, step: 500, loss: 0.00010836961882887408, grad_norm: 1.4771230450482842e-05, ic: 0.29416143659933464
Epoch 21: 2022-05-06 16:25:05.034084: train loss: 0.0001264759027586081
Eval step 0: eval loss: 0.0001409007963957265
Eval: 2022-05-06 16:25:07.425479: total loss: 0.00011266701226381652, mse:0.00022533402195786627, ic :0.008899163688993265, sharpe5:0.24309001989662646, irr5:0.07603196054697037, ndcg5:0.851275348396432, pnl5:0.9720901250839233 
train 22, step: 0, loss: 0.00010742737504187971, grad_norm: 4.360121961019042e-05, ic: -0.24548310470238183
train 22, step: 500, loss: 9.16328135645017e-05, grad_norm: 5.7172545807307005e-05, ic: 0.15927885623576166
Epoch 22: 2022-05-06 16:25:11.978505: train loss: 0.00012616116128744717
Eval step 0: eval loss: 0.00014133464719634503
Eval: 2022-05-06 16:25:14.290417: total loss: 0.00011273951661108077, mse:0.00022547903312451005, ic :0.013661247992480953, sharpe5:0.2715841696970165, irr5:0.0850880891084671, ndcg5:0.8537589758011962, pnl5:0.9766050577163696 
train 23, step: 0, loss: 8.993952360469848e-05, grad_norm: 1.1775650079768287e-05, ic: 0.07094825686033902
train 23, step: 500, loss: 0.00013840320752933621, grad_norm: 1.4798435132170224e-05, ic: -0.46733921658785804
Epoch 23: 2022-05-06 16:25:18.835078: train loss: 0.00012635144320068362
Eval step 0: eval loss: 0.0001663241710048169
Eval: 2022-05-06 16:25:21.202883: total loss: 0.00011538228261350137, mse:0.0002307645626314638, ic :0.01524156142301447, sharpe5:0.27158428793773054, irr5:0.0850881040096283, ndcg5:0.8477075567178064, pnl5:0.9766050577163696 
train 24, step: 0, loss: 0.0003455048135947436, grad_norm: 5.638191949070654e-07, ic: 0.04391978421260267
train 24, step: 500, loss: 0.00013578016660176218, grad_norm: 3.518984291162651e-06, ic: 0.1857291218601882
Epoch 24: 2022-05-06 16:25:25.627680: train loss: 0.00012658405340209585
Eval step 0: eval loss: 0.00016010143735911697
Eval: 2022-05-06 16:25:27.963498: total loss: 0.0001141902332658331, mse:0.00022838046432025914, ic :0.015962635434708786, sharpe5:0.2635790664330125, irr5:0.08259683102369308, ndcg5:0.8607909920728863, pnl5:0.975246012210846 
train 25, step: 0, loss: 6.724800186930224e-05, grad_norm: 3.260737308149215e-07, ic: 0.12400111147425184
train 25, step: 500, loss: 8.064066059887409e-05, grad_norm: 2.051864708396687e-06, ic: 0.050806634111867775
Epoch 25: 2022-05-06 16:25:32.105847: train loss: 0.00012576907481119307
Eval step 0: eval loss: 0.0001246739411726594
Eval: 2022-05-06 16:25:34.301280: total loss: 0.00011366054910097974, mse:0.0002273210956544111, ic :0.012324530919954231, sharpe5:-0.2663689560815692, irr5:-0.07987379282712936, ndcg5:0.846489344369335, pnl5:1.060282826423645 
train 26, step: 0, loss: 0.0001266373583348468, grad_norm: 7.951093677508e-05, ic: -0.18140631948903507
train 26, step: 500, loss: 0.0001601060212124139, grad_norm: 1.9695382446841052e-05, ic: -0.061445626762271915
Epoch 26: 2022-05-06 16:25:38.435290: train loss: 0.0001260953822023997
Eval step 0: eval loss: 0.0001353382394881919
Eval: 2022-05-06 16:25:40.719951: total loss: 0.0001127797158606897, mse:0.0002255594300398774, ic :0.012749733219547175, sharpe5:0.2259153788164258, irr5:0.07147791981697083, ndcg5:0.8442384791733116, pnl5:0.9692856073379517 
train 27, step: 0, loss: 0.00012189361586933956, grad_norm: 4.532352046848208e-05, ic: -0.0997281655459934
train 27, step: 500, loss: 7.970823935465887e-05, grad_norm: 2.3303471327138995e-08, ic: 0.08417166652999819
Epoch 27: 2022-05-06 16:25:45.251733: train loss: 0.00012618487898668194
Eval step 0: eval loss: 0.00016818662697914988
Eval: 2022-05-06 16:25:47.594505: total loss: 0.00011545580002995725, mse:0.00023091159885262207, ic :0.006900722139559627, sharpe5:0.2328650506865233, irr5:0.07309691607952118, ndcg5:0.8461280770050951, pnl5:0.9703114032745361 
train 28, step: 0, loss: 6.755759386578575e-05, grad_norm: 1.689443879387294e-05, ic: -0.13791468094192805
train 28, step: 500, loss: 9.488016803516075e-05, grad_norm: 1.348816395680603e-05, ic: 0.20608834079282545
Epoch 28: 2022-05-06 16:25:52.032236: train loss: 0.0001260374156117905
Eval step 0: eval loss: 0.00016184058040380478
Eval: 2022-05-06 16:25:54.360576: total loss: 0.00011444091767586188, mse:0.00022888183523546917, ic :0.015671055062095623, sharpe5:0.24282318016514182, irr5:0.07630394399166107, ndcg5:0.8555499500365683, pnl5:0.9718859195709229 
train 29, step: 0, loss: 0.00010834398563019931, grad_norm: 3.0343277614088473e-05, ic: 0.06285977324997634
train 29, step: 500, loss: 6.0054804635001346e-05, grad_norm: 2.4232386853953005e-06, ic: 0.10590340467805683
Epoch 29: 2022-05-06 16:25:58.658352: train loss: 0.0001261807295803323
Eval step 0: eval loss: 0.0001717899285722524
Eval: 2022-05-06 16:26:00.834635: total loss: 0.00011622970911140961, mse:0.0002324594183171731, ic :0.010492561115856693, sharpe5:0.24282304714433847, irr5:0.07630396634340286, ndcg5:0.8515429093071077, pnl5:0.9718859195709229 
train 30, step: 0, loss: 0.00017293762357439846, grad_norm: 9.736296336656246e-06, ic: 0.3304301244868947
train 30, step: 500, loss: 0.00043435729457996786, grad_norm: 9.163211568181228e-05, ic: -0.09288404421168558
Epoch 30: 2022-05-06 16:26:05.002217: train loss: 0.00012598120805380297
Eval step 0: eval loss: 0.00014141047722660005
Eval: 2022-05-06 16:26:07.417447: total loss: 0.00011268113139830332, mse:0.0002253622603291014, ic :0.008816233597467641, sharpe5:0.250667062215507, irr5:0.07873255014419556, ndcg5:0.8447069371804724, pnl5:0.9731196761131287 
train 31, step: 0, loss: 8.874285413185135e-05, grad_norm: 4.312440101411419e-08, ic: 0.021063900296426512
train 31, step: 500, loss: 0.00023956975201144814, grad_norm: 0.0002241649945139168, ic: -0.23629037890150498
Epoch 31: 2022-05-06 16:26:11.788304: train loss: 0.0001258629162528703
Eval step 0: eval loss: 0.00016685300215613097
Eval: 2022-05-06 16:26:14.105818: total loss: 0.00011522378387734673, mse:0.00023044756725162084, ic :0.01376816190236698, sharpe5:0.25066721001639963, irr5:0.07873255759477615, ndcg5:0.850097454913086, pnl5:0.9731196761131287 
train 32, step: 0, loss: 0.00013684101577382535, grad_norm: 0.00011507680900904025, ic: 0.18768300992191383
train 32, step: 500, loss: 8.637089194962755e-05, grad_norm: 3.3841226572336416e-07, ic: 0.119290351164905
Epoch 32: 2022-05-06 16:26:18.582971: train loss: 0.00012583236657399128
Eval step 0: eval loss: 0.00014241132885217667
Eval: 2022-05-06 16:26:20.882462: total loss: 0.00011277378743508992, mse:0.00022554757284019776, ic :0.0036987433045906188, sharpe5:0.24944897593930362, irr5:0.07834412157535553, ndcg5:0.857075719225409, pnl5:0.9729287624359131 
train 33, step: 0, loss: 0.00012047415657434613, grad_norm: 6.0699566744883604e-05, ic: 0.08017992673820512
train 33, step: 500, loss: 0.00014110469783190638, grad_norm: 1.7686641995453123e-06, ic: 0.03501837109420357
Epoch 33: 2022-05-06 16:26:25.245413: train loss: 0.0001257421898346052
Eval step 0: eval loss: 0.00014747823297511786
Eval: 2022-05-06 16:26:27.542907: total loss: 0.00011287386305257777, mse:0.00022574772304731011, ic :0.004373712679933993, sharpe5:0.2494489168189466, irr5:0.07834415137767792, ndcg5:0.8554994362437585, pnl5:0.9729287624359131 
train 34, step: 0, loss: 6.718902295688167e-05, grad_norm: 1.0755895631424037e-07, ic: -0.05446197835724721
train 34, step: 500, loss: 0.00013887743989471346, grad_norm: 7.611605418814808e-05, ic: 0.087153322534621
Epoch 34: 2022-05-06 16:26:31.969391: train loss: 0.00012588473556321176
Eval step 0: eval loss: 0.00014328781981021166
Eval: 2022-05-06 16:26:34.320867: total loss: 0.00011270249911307228, mse:0.00022540499571556115, ic :0.017973861957431014, sharpe5:0.2494489463791251, irr5:0.07834410667419434, ndcg5:0.8578505825555466, pnl5:0.9729287028312683 
train 35, step: 0, loss: 0.00020022857643198222, grad_norm: 0.00019462316065328066, ic: -0.04104869751035808
train 35, step: 500, loss: 8.164312748704106e-05, grad_norm: 1.1026757250067463e-05, ic: 0.03048343370615637
Epoch 35: 2022-05-06 16:26:38.609063: train loss: 0.000125657979149174
Eval step 0: eval loss: 0.00014731897681485862
Eval: 2022-05-06 16:26:40.967978: total loss: 0.00011287306223478528, mse:0.0002257461240222907, ic :0.0028572449940892017, sharpe5:0.24944903505966065, irr5:0.07834409177303314, ndcg5:0.8602912998715982, pnl5:0.9729288816452026 
train 36, step: 0, loss: 0.00011064343561884016, grad_norm: 6.312004181586336e-05, ic: -0.18684294541766694
train 36, step: 500, loss: 0.00010556627239566296, grad_norm: 8.016803079700214e-06, ic: 0.005900347734056028
Epoch 36: 2022-05-06 16:26:45.417249: train loss: 0.00012594221100258943
Eval step 0: eval loss: 0.00016676679661031812
Eval: 2022-05-06 16:26:47.697127: total loss: 0.0001150353707659741, mse:0.00023007074265048776, ic :0.004027052557914902, sharpe5:0.24707009101286528, irr5:0.07763438671827316, ndcg5:0.8540115214784613, pnl5:0.9725580215454102 
train 37, step: 0, loss: 0.00014583887241315097, grad_norm: 9.405316494519202e-07, ic: 0.2213799473889455
train 37, step: 500, loss: 7.281059515662491e-05, grad_norm: 1.084281380676976e-06, ic: 0.09444778523427008
Epoch 37: 2022-05-06 16:26:52.027777: train loss: 0.00012558570680199253
Eval step 0: eval loss: 0.00014767053653486073
Eval: 2022-05-06 16:26:54.374480: total loss: 0.00011283000892914153, mse:0.0002256600183780965, ic :0.0027763551863536438, sharpe5:0.24585230033844707, irr5:0.07724601775407791, ndcg5:0.8487330611397784, pnl5:0.9723670482635498 
train 38, step: 0, loss: 0.00015282511594705284, grad_norm: 0.000167613607412129, ic: -0.039751714777036866
train 38, step: 500, loss: 0.00013083383964840323, grad_norm: 1.1485808560640079e-05, ic: -0.06936754780629753
Epoch 38: 2022-05-06 16:26:58.818974: train loss: 0.00012583097074175446
Eval step 0: eval loss: 0.00018317450303584337
Eval: 2022-05-06 16:27:01.121944: total loss: 0.00011829445079687718, mse:0.00023658889911922623, ic :0.004131635509119195, sharpe5:0.25127381443977354, irr5:0.0789213478565216, ndcg5:0.8565820560198882, pnl5:0.9732162952423096 
train 39, step: 0, loss: 7.699288107687607e-05, grad_norm: 2.479458709385619e-05, ic: 0.072030048210177
train 39, step: 500, loss: 0.00013485206000041217, grad_norm: 3.282463903180844e-05, ic: 0.3100864657789597
Epoch 39: 2022-05-06 16:27:05.642357: train loss: 0.00012594094780479583
Eval step 0: eval loss: 0.00014709297101944685
Eval: 2022-05-06 16:27:08.020565: total loss: 0.00011279797967043863, mse:0.00022559595747578183, ic :0.0018628609597757058, sharpe5:0.25127366663888095, irr5:0.0789213478565216, ndcg5:0.8493298301554, pnl5:0.9732162952423096 
