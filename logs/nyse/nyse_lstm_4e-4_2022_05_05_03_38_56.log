Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.0004, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='BaseLSTM', normalize_adj=True, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
66837
BaseLSTM(
  (rnn1): LSTM(5, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (predict): Linear(in_features=128, out_features=1, bias=True)
  (relu): PReLU(num_parameters=1)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.002369281370192766, grad_norm: 0.006746624654649862, ic: 0.01870503770159404
train 0, step: 500, loss: 8.211081149056554e-05, grad_norm: 4.973395722402815e-08, ic: -0.022054331231925062
Epoch 0: 2022-05-05 15:41:18.930218: train loss: 0.00016471844771530643
Eval step 0: eval loss: 7.43570490158163e-05
Eval: 2022-05-05 15:41:21.403068: total loss: 0.00011621699809538013, mse:0.00023243400274942482, ic :0.012804170249344268, sharpe5:0.3172643708065152, irr5:0.0970621332526207, ndcg5:0.8506378252234351, pnl5:0.9737852811813354 
train 1, step: 0, loss: 0.00011311772686894983, grad_norm: 8.016246727419814e-05, ic: 0.07660021851100153
train 1, step: 500, loss: 8.613324462203309e-05, grad_norm: 2.0628903495281736e-05, ic: 0.015222514907025586
Epoch 1: 2022-05-05 15:41:27.254116: train loss: 0.00014154507571122893
Eval step 0: eval loss: 6.216441397555172e-05
Eval: 2022-05-05 15:41:29.790213: total loss: 0.00011325844894107391, mse:0.00022651690081205511, ic :0.010035841898304105, sharpe5:0.23534891858696935, irr5:0.07130458205938339, ndcg5:0.856457849668649, pnl5:0.9773984551429749 
train 2, step: 0, loss: 8.388939750147983e-05, grad_norm: 3.62821778497791e-07, ic: 0.028876533838845662
train 2, step: 500, loss: 7.519977225456387e-05, grad_norm: 1.1182814279894122e-06, ic: 0.040713539572846555
Epoch 2: 2022-05-05 15:41:35.462102: train loss: 0.0001353268567242745
Eval step 0: eval loss: 5.99531049374491e-05
Eval: 2022-05-05 15:41:37.908635: total loss: 0.00011635740099443778, mse:0.00023271480479129453, ic :0.010098890872412997, sharpe5:0.1813344616256654, irr5:0.05537001043558121, ndcg5:0.8487203341379637, pnl5:0.9520294666290283 
train 3, step: 0, loss: 0.00011638593423413113, grad_norm: 1.9794437934352912e-05, ic: -0.029341119612138075
train 3, step: 500, loss: 0.00012394871737342328, grad_norm: 2.4068760168400673e-05, ic: -0.0003008874405452007
Epoch 3: 2022-05-05 15:41:43.407114: train loss: 0.00013397566915002127
Eval step 0: eval loss: 7.408012606902048e-05
Eval: 2022-05-05 15:41:45.837721: total loss: 0.00011643734127351726, mse:0.00023287468675496897, ic :0.00970969768153283, sharpe5:0.3355357536301017, irr5:0.1019493117928505, ndcg5:0.844969908181596, pnl5:0.9762651920318604 
train 4, step: 0, loss: 8.110159251373261e-05, grad_norm: 6.775021034228334e-06, ic: -0.009234772310441692
train 4, step: 500, loss: 8.168961358023807e-05, grad_norm: 5.510538109711849e-06, ic: -0.015368452885338016
Epoch 4: 2022-05-05 15:41:51.380266: train loss: 0.00013016491358579767
Eval step 0: eval loss: 6.017005944158882e-05
Eval: 2022-05-05 15:41:53.810818: total loss: 0.00011823758653933934, mse:0.00023647517943620197, ic :-0.010221255583888903, sharpe5:-9.026130039095879, irr5:-1.366732120513916, ndcg5:0.8488057063366398, pnl5:0.2201666235923767 
train 5, step: 0, loss: 0.00013344087346922606, grad_norm: 4.989172417183957e-05, ic: -0.02413157228964129
train 5, step: 500, loss: 0.0005552127840928733, grad_norm: 0.0006668958002029345, ic: -0.14693882524021168
Epoch 5: 2022-05-05 15:41:59.366229: train loss: 0.00012927490060585288
Eval step 0: eval loss: 8.348663686774671e-05
Eval: 2022-05-05 15:42:01.768953: total loss: 0.00012065015928835027, mse:0.0002413003185377162, ic :0.009408522553751764, sharpe5:0.4861568941734731, irr5:0.15454697608947754, ndcg5:0.8583758465735228, pnl5:1.021573543548584 
train 6, step: 0, loss: 9.82039055088535e-05, grad_norm: 4.3020844234396514e-05, ic: 0.06586164636330008
train 6, step: 500, loss: 7.340290176216513e-05, grad_norm: 1.7471125836542727e-05, ic: 0.039016876545627924
Epoch 6: 2022-05-05 15:42:07.232580: train loss: 0.00012856393619041292
Eval step 0: eval loss: 7.024827937129885e-05
Eval: 2022-05-05 15:42:09.625953: total loss: 0.00011463600339080252, mse:0.0002292720107311628, ic :0.009592731113698901, sharpe5:0.27958992328494786, irr5:0.08487240225076675, ndcg5:0.8495211753622407, pnl5:0.9844550490379333 
train 7, step: 0, loss: 0.0001002198550850153, grad_norm: 1.081799297458052e-06, ic: 0.004088384404047605
train 7, step: 500, loss: 0.00020559935364872217, grad_norm: 1.670782754491266e-05, ic: 0.0779885157230212
Epoch 7: 2022-05-05 15:42:15.038145: train loss: 0.00012778654755897016
Eval step 0: eval loss: 6.534608110086992e-05
Eval: 2022-05-05 15:42:17.458197: total loss: 0.00011275600449486603, mse:0.00022551201377333193, ic :0.00953543628223471, sharpe5:0.3192095487937331, irr5:0.09694533795118332, ndcg5:0.8587534494981623, pnl5:0.9908741116523743 
train 8, step: 0, loss: 9.262040111934766e-05, grad_norm: 8.660393079665953e-06, ic: 0.01644250297042936
train 8, step: 500, loss: 8.078234532149509e-05, grad_norm: 3.455309748076372e-08, ic: 0.08108822070160154
Epoch 8: 2022-05-05 15:42:23.279592: train loss: 0.00012753890866362664
Eval step 0: eval loss: 6.184835365274921e-05
Eval: 2022-05-05 15:42:25.747533: total loss: 0.0001130523824309127, mse:0.00022610476864386346, ic :0.009279965298562422, sharpe5:0.3615598549135029, irr5:0.1096968874335289, ndcg5:0.8533226506258277, pnl5:0.9805687069892883 
train 9, step: 0, loss: 0.00011343783262418583, grad_norm: 1.1442376603155914e-06, ic: 0.03726349843473206
train 9, step: 500, loss: 5.205784327699803e-05, grad_norm: 8.434504850291169e-07, ic: -0.028508939698667253
Epoch 9: 2022-05-05 15:42:31.461498: train loss: 0.00012685481030340673
Eval step 0: eval loss: 6.110628601163626e-05
Eval: 2022-05-05 15:42:33.883365: total loss: 0.00011352782894391567, mse:0.00022705566114563242, ic :0.009153852702908662, sharpe5:0.35826871331781146, irr5:0.10874650627374649, ndcg5:0.8521401478565028, pnl5:0.9802223443984985 
train 10, step: 0, loss: 4.791278115590103e-05, grad_norm: 2.973701301860452e-06, ic: 0.02648641829666988
train 10, step: 500, loss: 0.00011792105942731723, grad_norm: 2.3903596501542545e-05, ic: 0.08453492873703028
Epoch 10: 2022-05-05 15:42:39.362015: train loss: 0.0001269418706915579
Eval step 0: eval loss: 7.573558832518756e-05
Eval: 2022-05-05 15:42:41.904471: total loss: 0.000116643471122637, mse:0.00023328694792105909, ic :0.009074025099445817, sharpe5:0.3568467209301889, irr5:0.10820010304450989, ndcg5:0.8507325803454364, pnl5:0.9971403479576111 
train 11, step: 0, loss: 9.841006249189377e-05, grad_norm: 4.820999215490093e-06, ic: -0.00820941980644
train 11, step: 500, loss: 8.4590537881013e-05, grad_norm: 1.6618074601128194e-06, ic: 0.040333656809075746
Epoch 11: 2022-05-05 15:42:47.558515: train loss: 0.00012671870654668314
Eval step 0: eval loss: 6.221758667379618e-05
Eval: 2022-05-05 15:42:49.978465: total loss: 0.00011290452340691488, mse:0.00022580904899059573, ic :0.008512337310938912, sharpe5:0.31396190766245125, irr5:0.09420870244503021, ndcg5:0.8501430379775151, pnl5:0.9730179905891418 
train 12, step: 0, loss: 8.750802226131782e-05, grad_norm: 1.5512273037074364e-05, ic: -0.00968280980935363
train 12, step: 500, loss: 7.807098882040009e-05, grad_norm: 3.8655141655690106e-07, ic: 0.06691221932695618
Epoch 12: 2022-05-05 15:42:55.566446: train loss: 0.00012624142596360862
Eval step 0: eval loss: 6.439169374061748e-05
Eval: 2022-05-05 15:42:57.947199: total loss: 0.00011262409926296057, mse:0.0002252482025763224, ic :0.008907579022090013, sharpe5:0.3432309775426984, irr5:0.10429207235574722, ndcg5:0.8505673856871945, pnl5:0.9774576425552368 
train 13, step: 0, loss: 8.437173528363928e-05, grad_norm: 1.5828210944694592e-05, ic: -0.04232470477916557
train 13, step: 500, loss: 6.238000059965998e-05, grad_norm: 1.2191661983630867e-06, ic: -0.05092922524871565
Epoch 13: 2022-05-05 15:43:03.408755: train loss: 0.000126446138761471
Eval step 0: eval loss: 7.030339475022629e-05
Eval: 2022-05-05 15:43:05.887417: total loss: 0.0001140651905518503, mse:0.00022813038560761298, ic :0.008953553984655522, sharpe5:0.3404195089638233, irr5:0.1033170148730278, ndcg5:0.8506156634592116, pnl5:0.977168619632721 
train 14, step: 0, loss: 9.90832268144004e-05, grad_norm: 1.3204825381072336e-06, ic: 0.016921042311644895
train 14, step: 500, loss: 0.00011525685113156214, grad_norm: 4.454799841935752e-06, ic: 0.04710442110294477
Epoch 14: 2022-05-05 15:43:11.474555: train loss: 0.00012602971853867495
Eval step 0: eval loss: 6.250904698390514e-05
Eval: 2022-05-05 15:43:13.861105: total loss: 0.00011282754061396913, mse:0.00022565508613373633, ic :0.006039710249009227, sharpe5:0.37350816775113344, irr5:0.11346467584371567, ndcg5:0.8412749490479332, pnl5:0.9653005599975586 
train 15, step: 0, loss: 7.269134948728606e-05, grad_norm: 6.480544286916663e-06, ic: 0.15478587178310915
train 15, step: 500, loss: 8.525625889888033e-05, grad_norm: 3.5685040440523836e-05, ic: 0.09423516186925232
Epoch 15: 2022-05-05 15:43:19.193494: train loss: 0.00012622529737851961
Eval step 0: eval loss: 6.09343551332131e-05
Eval: 2022-05-05 15:43:21.598053: total loss: 0.00011386169310606809, mse:0.00022772338940133747, ic :0.0026170173971983256, sharpe5:0.3272023550234735, irr5:0.099416084587574, ndcg5:0.8539502370652811, pnl5:0.9921534657478333 
train 16, step: 0, loss: 0.00010012669372372329, grad_norm: 2.0450790998670842e-05, ic: 0.17951192284795542
train 16, step: 500, loss: 8.925490692490712e-05, grad_norm: 9.980993200918328e-06, ic: 0.10330359758440649
Epoch 16: 2022-05-05 15:43:27.032441: train loss: 0.00012641625653973058
Eval step 0: eval loss: 6.889629730721936e-05
Eval: 2022-05-05 15:43:29.454980: total loss: 0.000113511642035225, mse:0.00022702329007437584, ic :0.006595278354712442, sharpe5:0.3376361225545406, irr5:0.10257173329591751, ndcg5:0.8552044484437321, pnl5:0.9765998125076294 
train 17, step: 0, loss: 7.702556467847899e-05, grad_norm: 3.1713335064549577e-06, ic: 0.0774170338537053
train 17, step: 500, loss: 7.592945621581748e-05, grad_norm: 1.1305159030064143e-05, ic: 0.1080246747797602
Epoch 17: 2022-05-05 15:43:35.001632: train loss: 0.0001264101668015243
Eval step 0: eval loss: 6.886202754685655e-05
Eval: 2022-05-05 15:43:37.407901: total loss: 0.00011353817800866688, mse:0.0002270763612962711, ic :0.003123734106807952, sharpe5:0.3432310662232339, irr5:0.104292131960392, ndcg5:0.8512831337950122, pnl5:0.977457582950592 
train 18, step: 0, loss: 0.00021058035781607032, grad_norm: 0.00018932204197714855, ic: 0.23377570242302356
train 18, step: 500, loss: 0.00018043239833787084, grad_norm: 0.00013657929897628517, ic: 0.0012905190395295953
Epoch 18: 2022-05-05 15:43:42.833542: train loss: 0.00012606821154011725
Eval step 0: eval loss: 6.704778206767514e-05
Eval: 2022-05-05 15:43:45.259865: total loss: 0.000113176020697536, mse:0.00022635204406215923, ic :0.002067882448105529, sharpe5:0.35951290123164653, irr5:0.10909169167280197, ndcg5:0.8565631974087333, pnl5:0.9802399277687073 
train 19, step: 0, loss: 0.00014344607188832015, grad_norm: 7.776325492587417e-05, ic: -0.13663646093629758
train 19, step: 500, loss: 0.00011609981447691098, grad_norm: 2.001581972634077e-05, ic: 0.019111466988786265
Epoch 19: 2022-05-05 15:43:50.833988: train loss: 0.00012611043819726382
Eval step 0: eval loss: 6.438863783841953e-05
Eval: 2022-05-05 15:43:53.287510: total loss: 0.0001126212933645726, mse:0.00022524258907727834, ic :0.0013520685186320467, sharpe5:0.32720247326418755, irr5:0.09941612929105759, ndcg5:0.8500366929810098, pnl5:0.9921534657478333 
train 20, step: 0, loss: 0.00011069027823396027, grad_norm: 1.6957213879896073e-07, ic: -0.13723149901600676
train 20, step: 500, loss: 9.70562468864955e-05, grad_norm: 1.9688255660244807e-05, ic: 0.08899371650881363
Epoch 20: 2022-05-05 15:43:58.693736: train loss: 0.00012622665099845234
Eval step 0: eval loss: 6.391492206603289e-05
Eval: 2022-05-05 15:44:01.149453: total loss: 0.00011290211598635408, mse:0.00022580423557270617, ic :-0.00018042740171416604, sharpe5:0.3432310366630554, irr5:0.10429204255342484, ndcg5:0.8484606328262229, pnl5:0.9774576425552368 
train 21, step: 0, loss: 0.0001571530883666128, grad_norm: 9.843756981975709e-05, ic: -0.048176382300470055
train 21, step: 500, loss: 8.69655268616043e-05, grad_norm: 1.0164768418170575e-05, ic: 0.13342250685617812
Epoch 21: 2022-05-05 15:44:06.521929: train loss: 0.00012631341460437787
Eval step 0: eval loss: 6.986717198742554e-05
Eval: 2022-05-05 15:44:08.977701: total loss: 0.0001138305476546139, mse:0.00022766110059139192, ic :-0.002518624821659031, sharpe5:0.3272024141438305, irr5:0.09941606968641281, ndcg5:0.847088221088992, pnl5:0.9921534657478333 
train 22, step: 0, loss: 0.00014193788229022175, grad_norm: 1.2570367969558103e-05, ic: -0.02157122113333416
train 22, step: 500, loss: 0.00011079983232775703, grad_norm: 6.218949187217917e-05, ic: 0.14634833091904517
Epoch 22: 2022-05-05 15:44:14.478026: train loss: 0.00012620411640931764
Eval step 0: eval loss: 6.217983172973618e-05
Eval: 2022-05-05 15:44:16.897395: total loss: 0.00011293412902426507, mse:0.0002258682630405252, ic :0.006907750364564076, sharpe5:0.3272023550234735, irr5:0.09941611438989639, ndcg5:0.856328902527294, pnl5:0.9921534657478333 
train 23, step: 0, loss: 9.573411080054939e-05, grad_norm: 5.9899108123344266e-05, ic: 0.034451277283131077
train 23, step: 500, loss: 7.127151911845431e-05, grad_norm: 9.46082041309227e-06, ic: 0.05685435584038964
Epoch 23: 2022-05-05 15:44:22.332746: train loss: 0.00012649957737748455
Eval step 0: eval loss: 6.457603012677282e-05
Eval: 2022-05-05 15:44:24.805781: total loss: 0.00011263878227251696, mse:0.00022527756776623918, ic :0.0026025973829353673, sharpe5:0.319209371432662, irr5:0.0969453826546669, ndcg5:0.8554236651417869, pnl5:0.9908741116523743 
train 24, step: 0, loss: 0.000106668914668262, grad_norm: 4.695006381621089e-06, ic: 0.060655343455000385
train 24, step: 500, loss: 0.00018290893058292568, grad_norm: 6.591350914170906e-05, ic: -0.08528125543608628
Epoch 24: 2022-05-05 15:44:30.389353: train loss: 0.00012603615196374275
Eval step 0: eval loss: 6.603993097087368e-05
Eval: 2022-05-05 15:44:32.856099: total loss: 0.00011281026774477499, mse:0.00022562053747894443, ic :0.004849306078603612, sharpe5:0.31920946011319756, irr5:0.09694533795118332, ndcg5:0.8520653446565559, pnl5:0.9908741116523743 
train 25, step: 0, loss: 0.0001009766710922122, grad_norm: 5.7381779839737475e-05, ic: 0.08871281207759335
train 25, step: 500, loss: 8.871565660228953e-05, grad_norm: 3.538486864665651e-05, ic: 0.0015929517815580115
Epoch 25: 2022-05-05 15:44:38.163164: train loss: 0.000126659612357025
Eval step 0: eval loss: 6.151203706394881e-05
Eval: 2022-05-05 15:44:40.675899: total loss: 0.00011334824007244447, mse:0.00022669648460029102, ic :-0.0011212688055551455, sharpe5:0.25270970011129973, irr5:0.0765414908528328, ndcg5:0.8619956597017894, pnl5:0.9801580309867859 
train 26, step: 0, loss: 8.281032205559313e-05, grad_norm: 9.952092440659098e-06, ic: 0.11945293678174006
train 26, step: 500, loss: 5.150938159204088e-05, grad_norm: 2.4448864223917715e-07, ic: -0.07033990944808241
Epoch 26: 2022-05-05 15:44:45.600503: train loss: 0.00012625210139355567
Eval step 0: eval loss: 7.394824206130579e-05
Eval: 2022-05-05 15:44:48.058199: total loss: 0.00011550251634203825, mse:0.00023100503716636192, ic :0.0009464050252543096, sharpe5:0.319209371432662, irr5:0.09694529324769974, ndcg5:0.8509810466459241, pnl5:0.9908741116523743 
train 27, step: 0, loss: 9.080994641408324e-05, grad_norm: 4.105904164678091e-06, ic: -0.030475435250591612
train 27, step: 500, loss: 0.0001346344652120024, grad_norm: 8.738767118438992e-06, ic: -0.23790865272789627
Epoch 27: 2022-05-05 15:44:53.691643: train loss: 0.00012661592608733592
Eval step 0: eval loss: 6.506210775114596e-05
Eval: 2022-05-05 15:44:56.106272: total loss: 0.00011271752702279675, mse:0.0002254350562874013, ic :-0.000271491364406071, sharpe5:0.32720247326418755, irr5:0.09941606968641281, ndcg5:0.847939665340894, pnl5:0.9921534657478333 
train 28, step: 0, loss: 0.00016720464918762445, grad_norm: 9.173782757775157e-06, ic: -0.07913381143655396
train 28, step: 500, loss: 7.886379171395674e-05, grad_norm: 1.5495581116902557e-05, ic: 0.1337412855843326
Epoch 28: 2022-05-05 15:45:01.737907: train loss: 0.00012605406980699938
Eval step 0: eval loss: 6.48501081741415e-05
Eval: 2022-05-05 15:45:04.282820: total loss: 0.0001126579300670246, mse:0.00022531586458125345, ic :0.0014521575256249276, sharpe5:0.3272023550234735, irr5:0.0994160994887352, ndcg5:0.8503019114096835, pnl5:0.9921534657478333 
train 29, step: 0, loss: 0.00011511981574585661, grad_norm: 3.66621382305954e-10, ic: -0.08395671584491396
train 29, step: 500, loss: 9.647825936554e-05, grad_norm: 4.730965820927734e-05, ic: 0.24842035730645168
Epoch 29: 2022-05-05 15:45:09.426009: train loss: 0.00012624396430009437
Eval step 0: eval loss: 7.131023448891938e-05
Eval: 2022-05-05 15:45:11.811869: total loss: 0.00011438652049489808, mse:0.0002287730454848443, ic :0.005521735842332348, sharpe5:0.32720247326418755, irr5:0.09941611438989639, ndcg5:0.8502837850939194, pnl5:0.9921534657478333 
train 30, step: 0, loss: 0.00011866181739605963, grad_norm: 2.355970048228546e-05, ic: 0.08619767210475854
train 30, step: 500, loss: 0.00018099238513968885, grad_norm: 3.0306027841455196e-06, ic: 0.020754444807633814
Epoch 30: 2022-05-05 15:45:17.249635: train loss: 0.0001264172938889603
Eval step 0: eval loss: 7.052977161947638e-05
Eval: 2022-05-05 15:45:19.660768: total loss: 0.00011410055194415079, mse:0.00022820110842566564, ic :0.00044175702386713573, sharpe5:0.3272025915049016, irr5:0.09941611438989639, ndcg5:0.8584007907948822, pnl5:0.9921534657478333 
train 31, step: 0, loss: 5.006329229217954e-05, grad_norm: 1.4053436873001626e-05, ic: 0.14362055260954776
train 31, step: 500, loss: 6.469065556302667e-05, grad_norm: 4.096915524718395e-07, ic: 0.03232072104781138
Epoch 31: 2022-05-05 15:45:25.242977: train loss: 0.00012632316087605587
Eval step 0: eval loss: 6.118647434050217e-05
Eval: 2022-05-05 15:45:27.657616: total loss: 0.00011358751770702198, mse:0.0002271750377840019, ic :-0.0020989220291523043, sharpe5:0.3272023550234735, irr5:0.0994160920381546, ndcg5:0.8543307901518209, pnl5:0.9921534657478333 
train 32, step: 0, loss: 8.144837920553982e-05, grad_norm: 1.4037300654180927e-05, ic: 0.1272000467028706
train 32, step: 500, loss: 0.00014254936832003295, grad_norm: 6.142790796041736e-06, ic: -0.0075092895179863514
Epoch 32: 2022-05-05 15:45:33.047793: train loss: 0.00012634688941287164
Eval step 0: eval loss: 6.329346069833264e-05
Eval: 2022-05-05 15:45:35.480958: total loss: 0.00011269434852252092, mse:0.00022538870038975778, ic :-0.0012758559073529502, sharpe5:0.32720256194472314, irr5:0.099416084587574, ndcg5:0.8524359092427317, pnl5:0.9921534657478333 
train 33, step: 0, loss: 9.581125777913257e-05, grad_norm: 2.628560124705596e-06, ic: 0.12135569491212836
train 33, step: 500, loss: 5.4638319852529094e-05, grad_norm: 1.3513153371837648e-06, ic: -0.06645135963609258
Epoch 33: 2022-05-05 15:45:40.904502: train loss: 0.00012644647842612869
Eval step 0: eval loss: 6.813849904574454e-05
Eval: 2022-05-05 15:45:43.383641: total loss: 0.00011329759856547213, mse:0.00022659520027557643, ic :-0.0017500033283158565, sharpe5:0.32720247326418755, irr5:0.09941611438989639, ndcg5:0.8514560660981496, pnl5:0.9921534657478333 
train 34, step: 0, loss: 7.456590537913144e-05, grad_norm: 7.965176198976681e-06, ic: -0.015382934443033883
train 34, step: 500, loss: 8.935399091569707e-05, grad_norm: 9.700489294565316e-06, ic: 0.06983019867822934
Epoch 34: 2022-05-05 15:45:48.839375: train loss: 0.00012622539234046642
Eval step 0: eval loss: 6.192772707436234e-05
Eval: 2022-05-05 15:45:51.379218: total loss: 0.00011308820438497562, mse:0.0002261764117482437, ic :-0.0014690460733949805, sharpe5:0.32720256194472314, irr5:0.09941614419221878, ndcg5:0.843386555255168, pnl5:0.9921534657478333 
train 35, step: 0, loss: 0.00023451476590707898, grad_norm: 0.0002327930157598243, ic: 0.12804641090170976
train 35, step: 500, loss: 0.00018676035688258708, grad_norm: 0.00010439859608484556, ic: -0.13875229764314356
Epoch 35: 2022-05-05 15:45:56.690096: train loss: 0.00012638249867411304
Eval step 0: eval loss: 6.439347635023296e-05
Eval: 2022-05-05 15:45:59.060130: total loss: 0.00011266256820404898, mse:0.000225325138421624, ic :0.006145644070814141, sharpe5:0.3574765596538782, irr5:0.10858870297670364, ndcg5:0.8495398023721507, pnl5:0.9798263907432556 
train 36, step: 0, loss: 0.0002550442877691239, grad_norm: 0.0001236065957212853, ic: 0.1257373939582494
train 36, step: 500, loss: 0.0003202127991244197, grad_norm: 7.540699201890443e-05, ic: 0.010000281293794551
Epoch 36: 2022-05-05 15:46:04.500764: train loss: 0.0001260832194137349
Eval step 0: eval loss: 7.740857836324722e-05
Eval: 2022-05-05 15:46:07.033572: total loss: 0.00011725981002554041, mse:0.00023451962392968283, ic :0.006982303645365519, sharpe5:0.32720247326418755, irr5:0.0994160920381546, ndcg5:0.8478536342392381, pnl5:0.9921534657478333 
train 37, step: 0, loss: 0.00021001409913878888, grad_norm: 0.00023249464216719672, ic: 0.2835693428603814
train 37, step: 500, loss: 9.642541408538818e-05, grad_norm: 2.0949067624121796e-05, ic: 0.08053345316198994
Epoch 37: 2022-05-05 15:46:12.510899: train loss: 0.00012649425191637147
Eval step 0: eval loss: 6.537954322993755e-05
Eval: 2022-05-05 15:46:14.994911: total loss: 0.0001127039363124056, mse:0.00022540787473638782, ic :-0.0008104839454931055, sharpe5:0.32720247326418755, irr5:0.09941614419221878, ndcg5:0.8493044793276788, pnl5:0.9921534657478333 
train 38, step: 0, loss: 9.443525050301105e-05, grad_norm: 7.35488932730271e-06, ic: -0.08306012601136727
train 38, step: 500, loss: 0.00015003840962890536, grad_norm: 6.377073789994054e-07, ic: 0.03408257405586157
Epoch 38: 2022-05-05 15:46:20.435562: train loss: 0.00012615750936791612
Eval step 0: eval loss: 6.132102134870365e-05
Eval: 2022-05-05 15:46:22.857242: total loss: 0.00011349407642788465, mse:0.0002269881562860656, ic :-0.002411672400512648, sharpe5:0.3272022663429379, irr5:0.099416084587574, ndcg5:0.8549133962184636, pnl5:0.9921534657478333 
train 39, step: 0, loss: 0.00017850109725259244, grad_norm: 0.0001247195689105996, ic: 0.17086987268058665
train 39, step: 500, loss: 0.0001229874906130135, grad_norm: 2.1219745951679283e-05, ic: -0.2948646268362225
Epoch 39: 2022-05-05 15:46:28.264962: train loss: 0.00012609678527134387
Eval step 0: eval loss: 6.926245259819552e-05
Eval: 2022-05-05 15:46:30.701227: total loss: 0.00011363108213785039, mse:0.0002272621661597088, ic :-0.00045598895110923244, sharpe5:0.3272022663429379, irr5:0.099416084587574, ndcg5:0.8499791725318723, pnl5:0.9921534657478333 
