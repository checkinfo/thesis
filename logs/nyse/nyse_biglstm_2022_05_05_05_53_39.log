Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQAdjSeqTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=True, label_cnt=1, lr=0.0004, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='BiGLSTM', normalize_adj=True, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
23234
BiGLSTM(
  (input_to_hidden): Linear(in_features=5, out_features=128, bias=True)
  (forward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (backward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (fc0): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (w_out): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.01590569317340851, grad_norm: 0.2514014363091677, ic: -0.01536432436510039
train 0, step: 500, loss: 0.00011986588651780039, grad_norm: 3.476083281306995e-06, ic: -0.0025663545108320363
Epoch 0: 2022-05-05 17:56:59.577257: train loss: 0.00035424102809198294
Eval step 0: eval loss: 7.130632002372295e-05
Eval: 2022-05-05 17:57:15.654187: total loss: 0.00011449185955337163, mse:0.00022898372236749916, ic :0.012007941003904317, sharpe5:0.31167063910514115, irr5:0.10165780037641525, ndcg5:0.8482438836077013, pnl5:1.2216192483901978 
train 1, step: 0, loss: 0.00012711815361399204, grad_norm: 8.423254907934574e-05, ic: 0.03437602425112286
train 1, step: 500, loss: 9.935600246535614e-05, grad_norm: 2.929637914150991e-05, ic: -0.036207686327312937
Epoch 1: 2022-05-05 17:58:23.933923: train loss: 0.000149808538320512
Eval step 0: eval loss: 6.301902612904087e-05
Eval: 2022-05-05 17:58:40.137511: total loss: 0.00011285987026724095, mse:0.00022571974081934701, ic :0.007630529215615409, sharpe5:0.4143882392719388, irr5:0.13283708691596985, ndcg5:0.853546638266838, pnl5:1.0087165832519531 
train 2, step: 0, loss: 8.759895717957988e-05, grad_norm: 1.964427940384711e-06, ic: 0.035154288695359664
train 2, step: 500, loss: 7.669061596971005e-05, grad_norm: 4.089188412079112e-07, ic: 0.04765643159489716
Epoch 2: 2022-05-05 17:59:50.213524: train loss: 0.00013809876138578481
Eval step 0: eval loss: 5.998146298225038e-05
Eval: 2022-05-05 18:00:05.974951: total loss: 0.00011647848724275746, mse:0.00023295697808567822, ic :0.007740553595312697, sharpe5:0.5956728919968008, irr5:0.19172784686088562, ndcg5:0.8443260007125262, pnl5:1.040350317955017 
train 3, step: 0, loss: 0.00011755455489037558, grad_norm: 2.437496153090554e-05, ic: 0.019082913883703582
train 3, step: 500, loss: 0.00012033426901325583, grad_norm: 1.4007136991199973e-05, ic: -0.04326756943690058
Epoch 3: 2022-05-05 18:01:15.990872: train loss: 0.00013534293181453874
Eval step 0: eval loss: 7.419130997732282e-05
Eval: 2022-05-05 18:01:32.030431: total loss: 0.00011586741578366656, mse:0.00023173483552849387, ic :0.006658480503871348, sharpe5:0.5450377842038869, irr5:0.1749836504459381, ndcg5:0.8556484648512851, pnl5:1.0319294929504395 
train 4, step: 0, loss: 7.969226862769574e-05, grad_norm: 7.556288911637746e-06, ic: 0.025797660502415106
train 4, step: 500, loss: 8.151232032105327e-05, grad_norm: 5.877315024085713e-06, ic: -0.012629596178407608
Epoch 4: 2022-05-05 18:02:42.442423: train loss: 0.0001310733972747784
Eval step 0: eval loss: 6.010535798850469e-05
Eval: 2022-05-05 18:02:58.542281: total loss: 0.00011830389756769325, mse:0.00023660779829272718, ic :0.007517285667785407, sharpe5:0.4917954391054809, irr5:0.15588229894638062, ndcg5:0.856265658881008, pnl5:1.0220457315444946 
train 5, step: 0, loss: 0.00013002312334720045, grad_norm: 4.81489962160581e-05, ic: 0.04249366508933129
train 5, step: 500, loss: 0.0005432513426057994, grad_norm: 0.0006747077934001921, ic: -0.08642409708965254
Epoch 5: 2022-05-05 18:04:08.580339: train loss: 0.00012974341374268365
Eval step 0: eval loss: 8.462457481073216e-05
Eval: 2022-05-05 18:04:24.107604: total loss: 0.00012134329760782664, mse:0.00024268659537024574, ic :0.006063818744665509, sharpe5:0.5375158420577645, irr5:0.1732492297887802, ndcg5:0.84708165908036, pnl5:1.0304607152938843 
train 6, step: 0, loss: 9.980979666579515e-05, grad_norm: 4.635993384891568e-05, ic: 0.022670471518484947
train 6, step: 500, loss: 7.490073767257854e-05, grad_norm: 2.139465207716763e-05, ic: 0.04781616962562743
Epoch 6: 2022-05-05 18:05:35.241529: train loss: 0.00012881379541036746
Eval step 0: eval loss: 7.01190292602405e-05
Eval: 2022-05-05 18:05:51.439209: total loss: 0.00011402868805745491, mse:0.0002280573795040069, ic :0.006154214266087104, sharpe5:0.5364397333189845, irr5:0.1729215532541275, ndcg5:0.8639956709299033, pnl5:1.030053973197937 
train 7, step: 0, loss: 9.996262815548107e-05, grad_norm: 1.3363367707737256e-06, ic: -0.009886844196294108
train 7, step: 500, loss: 0.00020609551575034857, grad_norm: 1.8266467623734705e-05, ic: 0.0844167976408293
Epoch 7: 2022-05-05 18:07:06.470966: train loss: 0.00012769188124658155
Eval step 0: eval loss: 6.558099994435906e-05
Eval: 2022-05-05 18:07:22.966698: total loss: 0.00011275348588559923, mse:0.00022550697653989674, ic :0.006440126049551287, sharpe5:0.5220846603065729, irr5:0.16772715747356415, ndcg5:0.85616038770511, pnl5:1.0277290344238281 
train 8, step: 0, loss: 9.182811481878161e-05, grad_norm: 8.418608668339615e-06, ic: 0.06161040487081402
train 8, step: 500, loss: 8.137041731970385e-05, grad_norm: 1.9365614287459332e-07, ic: 0.029349576816898596
Epoch 8: 2022-05-05 18:08:33.595187: train loss: 0.00012735302693897362
Eval step 0: eval loss: 6.390683847712353e-05
Eval: 2022-05-05 18:08:50.038334: total loss: 0.00011264802640843852, mse:0.00022529605752589753, ic :0.006069546474295389, sharpe5:0.5213571843132376, irr5:0.16751404106616974, ndcg5:0.8436715201491164, pnl5:1.0276740789413452 
train 9, step: 0, loss: 0.00011479819659143686, grad_norm: 3.8268457013876624e-06, ic: 0.030799978278801106
train 9, step: 500, loss: 5.163585228729062e-05, grad_norm: 4.676919687755026e-07, ic: -0.028324743788881092
Epoch 9: 2022-05-05 18:10:02.402402: train loss: 0.0001265446414441019
Eval step 0: eval loss: 6.24067397438921e-05
Eval: 2022-05-05 18:10:19.073796: total loss: 0.00011285599259487821, mse:0.00022571198835928127, ic :0.0061582178102061345, sharpe5:0.5480597212538123, irr5:0.17596864700317383, ndcg5:0.848545922953058, pnl5:1.0324934720993042 
train 10, step: 0, loss: 4.9284073611488566e-05, grad_norm: 5.935527365489655e-06, ic: 0.03746696752165001
train 10, step: 500, loss: 0.00011915532377315685, grad_norm: 2.6436484060772198e-05, ic: 0.11265345096871782
Epoch 10: 2022-05-05 18:11:30.017765: train loss: 0.00012639920038677238
Eval step 0: eval loss: 7.208007446024567e-05
Eval: 2022-05-05 18:11:45.940783: total loss: 0.00011474594110867016, mse:0.00022949188732729377, ic :0.006746384902488297, sharpe5:0.6038346346467733, irr5:0.19377455115318298, ndcg5:0.8481511739382273, pnl5:1.0243209600448608 
train 11, step: 0, loss: 9.699552174424753e-05, grad_norm: 2.5726772140696957e-06, ic: -0.004572308165443034
train 11, step: 500, loss: 8.458075899397954e-05, grad_norm: 1.4178436219062238e-06, ic: 0.021475834399561928
Epoch 11: 2022-05-05 18:12:55.798011: train loss: 0.00012649027714243546
Eval step 0: eval loss: 6.2701350543648e-05
Eval: 2022-05-05 18:13:13.354080: total loss: 0.00011277909571542323, mse:0.00022555819759529584, ic :0.004058881166774707, sharpe5:0.23992696255445478, irr5:0.07677590101957321, ndcg5:0.8547336754871881, pnl5:1.014392375946045 
train 12, step: 0, loss: 8.695938595337793e-05, grad_norm: 1.4239842773233542e-05, ic: -0.03844131016358029
train 12, step: 500, loss: 7.822901534382254e-05, grad_norm: 3.550393100428326e-07, ic: 0.026538933465625265
Epoch 12: 2022-05-05 18:14:27.727762: train loss: 0.00012626311251945623
Eval step 0: eval loss: 6.463196041295305e-05
Eval: 2022-05-05 18:14:44.011660: total loss: 0.0001126266410504417, mse:0.00022525328577579587, ic :0.006180342695530515, sharpe5:0.5347956553101539, irr5:0.1718904972076416, ndcg5:0.8552113276314942, pnl5:1.012076735496521 
train 13, step: 0, loss: 8.396478369832039e-05, grad_norm: 1.5334754919817572e-05, ic: -0.02281925261238374
train 13, step: 500, loss: 6.17967380094342e-05, grad_norm: 1.203159164773491e-07, ic: -0.04252565455093703
Epoch 13: 2022-05-05 18:15:54.962837: train loss: 0.00012652090563619215
Eval step 0: eval loss: 6.95855705998838e-05
Eval: 2022-05-05 18:16:11.363665: total loss: 0.00011374890386415686, mse:0.00022749781303769834, ic :0.00600465450161352, sharpe5:0.5399147096648812, irr5:0.17077231407165527, ndcg5:0.852265533740028, pnl5:1.0120563507080078 
train 14, step: 0, loss: 9.890363435260952e-05, grad_norm: 9.928422845992116e-07, ic: 0.02241340969972869
train 14, step: 500, loss: 0.00011529734183568507, grad_norm: 4.400911847580761e-06, ic: 0.04795275559002251
Epoch 14: 2022-05-05 18:17:22.023482: train loss: 0.00012604262082992223
Eval step 0: eval loss: 6.240602670004591e-05
Eval: 2022-05-05 18:17:38.358650: total loss: 0.00011285378758256186, mse:0.0002257075798479871, ic :0.004959367056099986, sharpe5:0.5186104525253177, irr5:0.163729727268219, ndcg5:0.8520475101012563, pnl5:1.026145100593567 
train 15, step: 0, loss: 7.276832184288651e-05, grad_norm: 6.1393464992415366e-06, ic: 0.13045626449371883
train 15, step: 500, loss: 8.537986286683008e-05, grad_norm: 3.543199003749661e-05, ic: -0.05080908743338726
Epoch 15: 2022-05-05 18:18:47.384835: train loss: 0.0001263205097524999
Eval step 0: eval loss: 6.084948836360127e-05
Eval: 2022-05-05 18:19:03.852323: total loss: 0.00011383791225817457, mse:0.00022767582982291214, ic :0.005224222871725547, sharpe5:0.5910657016932964, irr5:0.1890779733657837, ndcg5:0.856346644454062, pnl5:1.0391545295715332 
train 16, step: 0, loss: 0.00010023691720562056, grad_norm: 2.012819782567029e-05, ic: 0.15547274883131146
train 16, step: 500, loss: 8.925811562221497e-05, grad_norm: 9.79046224823136e-06, ic: 0.09135181141430138
Epoch 16: 2022-05-05 18:20:15.166113: train loss: 0.00012645822465233786
Eval step 0: eval loss: 7.399015157716349e-05
Eval: 2022-05-05 18:20:31.575568: total loss: 0.00011547457116811565, mse:0.00023094914364949528, ic :-0.01407171797358504, sharpe5:-0.053566213804297144, irr5:-0.01649361103773117, ndcg5:0.843669107512709, pnl5:0.9828348159790039 
train 17, step: 0, loss: 7.603027188451961e-05, grad_norm: 4.3231906863767044e-07, ic: -0.03733552323827015
train 17, step: 500, loss: 7.61701594456099e-05, grad_norm: 1.140916600812254e-05, ic: -0.026028912932596897
Epoch 17: 2022-05-05 18:21:42.467603: train loss: 0.0001265135750748506
Eval step 0: eval loss: 6.876841507619247e-05
Eval: 2022-05-05 18:21:59.180782: total loss: 0.00011347286092695947, mse:0.00022694572403303423, ic :0.0052361599149969235, sharpe5:0.6564173443615436, irr5:0.21798411011695862, ndcg5:0.8490036799892703, pnl5:1.0315122604370117 
train 18, step: 0, loss: 0.00021033755911048502, grad_norm: 0.00018831885644698566, ic: 0.21198959121774483
train 18, step: 500, loss: 0.00018841508426703513, grad_norm: 0.00015271027802194191, ic: -0.007237203843942093
Epoch 18: 2022-05-05 18:23:10.128078: train loss: 0.00012626843885115514
Eval step 0: eval loss: 6.73322647344321e-05
Eval: 2022-05-05 18:23:26.544515: total loss: 0.00011310805457946133, mse:0.00022621611338665144, ic :0.0036703033602130874, sharpe5:0.7451769829541445, irr5:0.24760578572750092, ndcg5:0.8483351532755773, pnl5:1.0468295812606812 
train 19, step: 0, loss: 0.00014040993119124323, grad_norm: 7.386004653490584e-05, ic: -0.14004284680673537
train 19, step: 500, loss: 0.00011619266297202557, grad_norm: 2.0313448969748684e-05, ic: 0.031123633487827727
Epoch 19: 2022-05-05 18:24:38.969877: train loss: 0.0001261482020903626
Eval step 0: eval loss: 6.427557673305273e-05
Eval: 2022-05-05 18:24:55.309324: total loss: 0.00011261774649409939, mse:0.00022523549568164586, ic :0.0033580398603808275, sharpe5:0.687871207036078, irr5:0.22686974704265594, ndcg5:0.8558147132470102, pnl5:1.0014034509658813 
train 20, step: 0, loss: 0.00011063462443416938, grad_norm: 2.0586848843404276e-07, ic: -0.07853592022742198
train 20, step: 500, loss: 9.700041118776426e-05, grad_norm: 1.9269094131030574e-05, ic: 0.05404111285738121
Epoch 20: 2022-05-05 18:26:04.180675: train loss: 0.00012625817643880207
Eval step 0: eval loss: 6.414729432435706e-05
Eval: 2022-05-05 18:26:21.476218: total loss: 0.00011266355115732719, mse:0.00022532710822861533, ic :0.002840024012665918, sharpe5:0.6984718417748809, irr5:0.2313656508922577, ndcg5:0.862649013217721, pnl5:1.0386658906936646 
train 21, step: 0, loss: 0.00015586700465064496, grad_norm: 9.639371078759515e-05, ic: -0.050194467821669045
train 21, step: 500, loss: 8.7048472778406e-05, grad_norm: 1.0104466277514455e-05, ic: 0.14482846981312564
Epoch 21: 2022-05-05 18:27:34.116440: train loss: 0.0001262993185356758
Eval step 0: eval loss: 7.05518905306235e-05
Eval: 2022-05-05 18:27:50.213387: total loss: 0.0001141106818087641, mse:0.00022822136651121745, ic :0.00194385450807954, sharpe5:0.6888511860743165, irr5:0.2283627986907959, ndcg5:0.8580417326579535, pnl5:1.036980152130127 
train 22, step: 0, loss: 0.00014227740757633, grad_norm: 1.361215530711881e-05, ic: 0.03424649968547154
train 22, step: 500, loss: 0.00011049554450437427, grad_norm: 6.18728360678344e-05, ic: 0.17203376632391465
Epoch 22: 2022-05-05 18:29:00.766009: train loss: 0.00012617881218509008
Eval step 0: eval loss: 6.213831511558965e-05
Eval: 2022-05-05 18:29:17.774540: total loss: 0.00011300788945762448, mse:0.00022601578159598925, ic :0.0015935771021577145, sharpe5:0.6871326164156198, irr5:0.2281625121831894, ndcg5:0.852084235988722, pnl5:1.0547410249710083 
train 23, step: 0, loss: 9.590354602551088e-05, grad_norm: 6.020371289650607e-05, ic: 0.02964399208116504
train 23, step: 500, loss: 7.132586324587464e-05, grad_norm: 9.222824429830877e-06, ic: -0.07790316384339657
Epoch 23: 2022-05-05 18:30:29.848446: train loss: 0.00012662707818005163
Eval step 0: eval loss: 6.470895459642634e-05
Eval: 2022-05-05 18:30:45.891856: total loss: 0.00011263542375085046, mse:0.00022527085034868574, ic :9.916166590565955e-05, sharpe5:0.7361218725889921, irr5:0.24370133876800537, ndcg5:0.8404705425002464, pnl5:1.0270761251449585 
train 24, step: 0, loss: 0.00010682641732273623, grad_norm: 4.844679847289525e-06, ic: 0.03051964767293473
train 24, step: 500, loss: 0.0001826687657739967, grad_norm: 6.553377598101386e-05, ic: -0.10202377105613343
Epoch 24: 2022-05-05 18:31:56.140981: train loss: 0.0001260240752213226
Eval step 0: eval loss: 6.585042137885466e-05
Eval: 2022-05-05 18:32:12.501939: total loss: 0.00011277140104074608, mse:0.0002255428042606165, ic :0.0008384569305641638, sharpe5:0.7413271244242787, irr5:0.2484358251094818, ndcg5:0.8589122153774906, pnl5:1.064620018005371 
train 25, step: 0, loss: 0.00010044022201327607, grad_norm: 5.6212686293429235e-05, ic: 0.0763853392903277
train 25, step: 500, loss: 9.123964991886169e-05, grad_norm: 4.050433395504143e-05, ic: 0.014465543327675138
Epoch 25: 2022-05-05 18:33:21.212469: train loss: 0.00012669923957131453
Eval step 0: eval loss: 6.122815830167383e-05
Eval: 2022-05-05 18:33:37.748954: total loss: 0.00011351724525336095, mse:0.0002270344940447587, ic :0.00017770807824518022, sharpe5:0.714110654219985, irr5:0.23771902918815613, ndcg5:0.8461290919452009, pnl5:1.0237507820129395 
train 26, step: 0, loss: 8.234760025516152e-05, grad_norm: 8.877404705042224e-06, ic: 0.10649545822650865
train 26, step: 500, loss: 5.1428181905066594e-05, grad_norm: 2.9872041021625606e-07, ic: -0.03652273918680411
Epoch 26: 2022-05-05 18:34:48.515367: train loss: 0.0001262789121349616
Eval step 0: eval loss: 7.400377216981724e-05
Eval: 2022-05-05 18:35:04.945908: total loss: 0.00011552000663209683, mse:0.0002310400170006412, ic :-0.0006759035857392528, sharpe5:0.8043602440506219, irr5:0.2644541263580322, ndcg5:0.8561824980514552, pnl5:1.0383409261703491 
train 27, step: 0, loss: 9.090774256037548e-05, grad_norm: 4.081228983664553e-06, ic: -0.059525649764350236
train 27, step: 500, loss: 0.00013475437299348414, grad_norm: 8.996776844369868e-06, ic: -0.2525582338965377
Epoch 27: 2022-05-05 18:36:15.229682: train loss: 0.00012666988474463814
Eval step 0: eval loss: 6.578566535608843e-05
Eval: 2022-05-05 18:36:31.562239: total loss: 0.00011278160295004887, mse:0.00022556320961158167, ic :-0.000667419581396394, sharpe5:0.7895631872490048, irr5:0.2620083689689636, ndcg5:0.8546764547126972, pnl5:1.0359363555908203 
train 28, step: 0, loss: 0.00016794238763395697, grad_norm: 1.0547264052066375e-05, ic: -0.0723335308899557
train 28, step: 500, loss: 7.913280569482595e-05, grad_norm: 1.59839099038555e-05, ic: 0.11765717788140287
Epoch 28: 2022-05-05 18:37:41.268526: train loss: 0.00012615075574235002
Eval step 0: eval loss: 6.497843423858285e-05
Eval: 2022-05-05 18:37:57.138439: total loss: 0.00011265898476315125, mse:0.00022531797348555765, ic :-0.001453577397507719, sharpe5:0.8043602440506219, irr5:0.2644541263580322, ndcg5:0.8534260011703841, pnl5:1.0383409261703491 
train 29, step: 0, loss: 0.00011504172289278358, grad_norm: 1.9643669607866703e-09, ic: -0.04079523117353278
train 29, step: 500, loss: 9.663021774031222e-05, grad_norm: 4.74831073553179e-05, ic: 0.21462672239923822
Epoch 29: 2022-05-05 18:39:09.518231: train loss: 0.00012625659338788773
Eval step 0: eval loss: 7.203006680356339e-05
Eval: 2022-05-05 18:39:24.891144: total loss: 0.00011465088439219241, mse:0.00022930177161122783, ic :-0.0006485100382753798, sharpe5:0.7341704278439283, irr5:0.24511928856372833, ndcg5:0.8511367941150549, pnl5:1.063133716583252 
train 30, step: 0, loss: 0.00011940718832192943, grad_norm: 2.4955088646708003e-05, ic: 0.06535980372453044
train 30, step: 500, loss: 0.00018101827299688011, grad_norm: 3.2046752650359057e-06, ic: 0.04066670039709532
Epoch 30: 2022-05-05 18:40:33.418937: train loss: 0.00012645915577064092
Eval step 0: eval loss: 7.064391684252769e-05
Eval: 2022-05-05 18:40:50.241587: total loss: 0.0001141361147438544, mse:0.0002282722337406131, ic :0.0006117584119552155, sharpe5:0.6816438824683427, irr5:0.22706633806228638, ndcg5:0.8594152438120424, pnl5:1.0359848737716675 
train 31, step: 0, loss: 5.0067850679624826e-05, grad_norm: 1.4115774311915326e-05, ic: 0.1283103620159322
train 31, step: 500, loss: 6.52810194878839e-05, grad_norm: 1.6327859534082132e-06, ic: 0.042405662663923815
Epoch 31: 2022-05-05 18:42:00.366400: train loss: 0.00012654879678434966
Eval step 0: eval loss: 6.12251678830944e-05
Eval: 2022-05-05 18:42:16.457297: total loss: 0.00011352609103854631, mse:0.0002270521866308102, ic :-0.000884703651706795, sharpe5:0.5567362248525023, irr5:0.17864593863487244, ndcg5:0.85291146651046, pnl5:1.03302800655365 
train 32, step: 0, loss: 8.170426008291543e-05, grad_norm: 1.4144163995577233e-05, ic: 0.08358183592347074
train 32, step: 500, loss: 0.00014293123967945576, grad_norm: 7.027002122234285e-06, ic: 0.02279962286790283
Epoch 32: 2022-05-05 18:43:27.375267: train loss: 0.00012636712712906848
Eval step 0: eval loss: 6.284172559389845e-05
Eval: 2022-05-05 18:43:43.329070: total loss: 0.00011276623064676995, mse:0.00022553246573782834, ic :-0.000974636584140076, sharpe5:0.7387374163046478, irr5:0.24037247896194458, ndcg5:0.8566263150250765, pnl5:1.0272377729415894 
train 33, step: 0, loss: 9.608764230506495e-05, grad_norm: 3.316783598379334e-06, ic: 0.13027077967520187
train 33, step: 500, loss: 5.4877778893569484e-05, grad_norm: 1.7986461561370478e-06, ic: -0.07607566955552782
Epoch 33: 2022-05-05 18:44:54.036138: train loss: 0.00012639073295705363
Eval step 0: eval loss: 6.834425585111603e-05
Eval: 2022-05-05 18:45:09.998210: total loss: 0.00011336111236939626, mse:0.00022672223011318613, ic :-0.00043138696401829907, sharpe5:0.6921651776880026, irr5:0.23063582181930542, ndcg5:0.8507241608542773, pnl5:1.0377393960952759 
train 34, step: 0, loss: 7.467105751857162e-05, grad_norm: 7.78468471528397e-06, ic: -0.05788227888422771
train 34, step: 500, loss: 8.863889524945989e-05, grad_norm: 8.332852492110018e-06, ic: 0.07309570475576369
Epoch 34: 2022-05-05 18:46:18.783188: train loss: 0.00012619343235619357
Eval step 0: eval loss: 6.139263859950006e-05
Eval: 2022-05-05 18:46:34.254088: total loss: 0.00011338408898567785, mse:0.0002267681793957429, ic :-0.00023085192705905993, sharpe5:0.7395641553774476, irr5:0.24485895037651062, ndcg5:0.8457894188561624, pnl5:1.0276727676391602 
train 35, step: 0, loss: 0.00022990549041423947, grad_norm: 0.00022370332355523229, ic: 0.17854316022478328
train 35, step: 500, loss: 0.0001869653642643243, grad_norm: 0.00010485904123334352, ic: -0.13698544073314622
Epoch 35: 2022-05-05 18:47:43.813496: train loss: 0.00012634870411257288
Eval step 0: eval loss: 6.514494452858344e-05
Eval: 2022-05-05 18:48:00.581162: total loss: 0.00011273810073024671, mse:0.00022547620641018485, ic :-1.14165161358666e-05, sharpe5:0.6823345855996013, irr5:0.22736263275146484, ndcg5:0.8489150642409622, pnl5:1.0543464422225952 
train 36, step: 0, loss: 0.00025836110580712557, grad_norm: 0.00012977663608029655, ic: 0.11529192248232045
train 36, step: 500, loss: 0.00032061731326393783, grad_norm: 7.699269544315777e-05, ic: 0.04449252036701001
Epoch 36: 2022-05-05 18:49:13.452852: train loss: 0.00012612359867800703
Eval step 0: eval loss: 7.731363439233974e-05
Eval: 2022-05-05 18:49:29.570703: total loss: 0.00011713621881434605, mse:0.00023427244478998343, ic :0.0019744041057289732, sharpe5:0.808719542697072, irr5:0.2705862522125244, ndcg5:0.8405004439573607, pnl5:1.076289176940918 
train 37, step: 0, loss: 0.00021037962869741023, grad_norm: 0.0002323856039556711, ic: 0.23015333667285737
train 37, step: 500, loss: 9.371661144541577e-05, grad_norm: 1.5937514031828523e-05, ic: 0.10342791560621416
Epoch 37: 2022-05-05 18:50:40.305601: train loss: 0.00012672164658314696
Eval step 0: eval loss: 6.755675713066012e-05
Eval: 2022-05-05 18:50:57.069908: total loss: 0.00011312458450666031, mse:0.00022624917484043915, ic :-0.00021033580468509888, sharpe5:0.8616877171397209, irr5:0.2835378050804138, ndcg5:0.8560024569825984, pnl5:1.0481895208358765 
train 38, step: 0, loss: 9.292172762798145e-05, grad_norm: 4.423853127121487e-06, ic: -0.034171079126823975
train 38, step: 500, loss: 0.00014981499407440424, grad_norm: 8.478838123438533e-08, ic: 0.01726427904509536
Epoch 38: 2022-05-05 18:52:08.465036: train loss: 0.0001261906348088542
Eval step 0: eval loss: 6.117380689829588e-05
Eval: 2022-05-05 18:52:24.805341: total loss: 0.00011356299313870117, mse:0.00022712598841364954, ic :-0.00018646880744578568, sharpe5:0.8592296109348535, irr5:0.28227436542510986, ndcg5:0.8570668644901641, pnl5:1.0297185182571411 
train 39, step: 0, loss: 0.00017765306984074414, grad_norm: 0.0001225326440753791, ic: 0.15563540138397536
train 39, step: 500, loss: 0.00012295052874833345, grad_norm: 2.144591731952607e-05, ic: -0.2177158323366684
Epoch 39: 2022-05-05 18:53:34.685592: train loss: 0.00012611233094814676
Eval step 0: eval loss: 7.111010199878365e-05
Eval: 2022-05-05 18:53:48.984409: total loss: 0.00011429789165804045, mse:0.000228595784951829, ic :0.0005420852061042341, sharpe5:0.8078023494780063, irr5:0.26550427079200745, ndcg5:0.8447832404856672, pnl5:1.0389550924301147 
