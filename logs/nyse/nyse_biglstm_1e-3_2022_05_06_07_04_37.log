Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQAdjSeqTimeDataset', dout=0.3, epochs=60, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=True, label_cnt=1, lr=0.001, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='BiGLSTM', normalize_adj=True, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
65441
BiGLSTM(
  (input_to_hidden): Linear(in_features=5, out_features=128, bias=True)
  (forward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (backward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (fc0): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (w_out): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.01590569317340851, grad_norm: 0.2514014363091677, ic: -0.01536432436510039
train 0, step: 500, loss: 0.00011160494614159688, grad_norm: 2.035056274137431e-06, ic: -0.026596124453970926
Epoch 0: 2022-05-06 19:08:00.410720: train loss: 0.0005665969089839924
Eval step 0: eval loss: 7.044504309305921e-05
Eval: 2022-05-06 19:08:16.032196: total loss: 0.00011422679303369005, mse:0.00022845358942035962, ic :0.016655612494956857, sharpe5:0.5874373671412467, irr5:0.16613629460334778, ndcg5:0.8466351508774279, pnl5:1.0848290920257568 
train 1, step: 0, loss: 0.00012613741273526102, grad_norm: 8.50772513216304e-05, ic: 0.022796675377881027
train 1, step: 500, loss: 9.82936326181516e-05, grad_norm: 2.601357143363127e-05, ic: -0.05328535796537884
Epoch 1: 2022-05-06 19:09:28.505137: train loss: 0.0001494146061664398
Eval step 0: eval loss: 6.04771776124835e-05
Eval: 2022-05-06 19:09:45.331919: total loss: 0.00011443197937538913, mse:0.00022886396330413573, ic :0.008030161040680604, sharpe5:0.3308196045085788, irr5:0.10650747269392014, ndcg5:0.8530895840525042, pnl5:1.0118136405944824 
train 2, step: 0, loss: 8.59773499541916e-05, grad_norm: 2.9352697852230786e-08, ic: 0.04717076194065396
train 2, step: 500, loss: 7.560137601103634e-05, grad_norm: 2.029421989293952e-07, ic: 0.056286007813612794
Epoch 2: 2022-05-06 19:10:57.551542: train loss: 0.0001390806934253495
Eval step 0: eval loss: 6.026980918250047e-05
Eval: 2022-05-06 19:11:14.365083: total loss: 0.00011920434453674108, mse:0.0002384086940130285, ic :0.007618100338052597, sharpe5:0.5815473833307624, irr5:0.18694356083869934, ndcg5:0.8484796739689521, pnl5:0.9844338297843933 
train 3, step: 0, loss: 0.00012134788994444534, grad_norm: 3.30728465959347e-05, ic: 0.011225408357983996
train 3, step: 500, loss: 0.00011455714411567897, grad_norm: 2.9380461060789594e-06, ic: -0.03405714735642537
Epoch 3: 2022-05-06 19:12:28.571252: train loss: 0.00013593231802772797
Eval step 0: eval loss: 6.260850204853341e-05
Eval: 2022-05-06 19:12:45.836877: total loss: 0.00011287668178035415, mse:0.00022575336834111822, ic :0.006277877020423296, sharpe5:0.5142729692906141, irr5:0.16561052203178406, ndcg5:0.8554718367701305, pnl5:1.0262751579284668 
train 4, step: 0, loss: 7.637829548912123e-05, grad_norm: 1.3921273355286283e-07, ic: 0.021567465677777516
train 4, step: 500, loss: 7.901728531578556e-05, grad_norm: 1.913282797402642e-06, ic: -0.006342874131019305
Epoch 4: 2022-05-06 19:13:58.561649: train loss: 0.0001316182943533192
Eval step 0: eval loss: 6.08211885264609e-05
Eval: 2022-05-06 19:14:15.329649: total loss: 0.00011386400161808718, mse:0.00022772800760861167, ic :0.006022163585237922, sharpe5:0.5061192078888416, irr5:0.1627826690673828, ndcg5:0.8541129799783673, pnl5:1.024994134902954 
train 5, step: 0, loss: 0.00014324048242997378, grad_norm: 7.91268498694964e-05, ic: 0.05772459027583001
train 5, step: 500, loss: 0.000511362508405, grad_norm: 0.0006042761548451901, ic: -0.1253367567886255
Epoch 5: 2022-05-06 19:15:25.647587: train loss: 0.00013010710009113345
Eval step 0: eval loss: 7.820138853276148e-05
Eval: 2022-05-06 19:15:42.083988: total loss: 0.00011769012137462067, mse:0.00023538024823811625, ic :0.004818291862524015, sharpe5:0.427834632396698, irr5:0.1373731940984726, ndcg5:0.8526527122581546, pnl5:1.0288301706314087 
train 6, step: 0, loss: 9.41614416660741e-05, grad_norm: 3.4463585815758436e-05, ic: 0.013759651328686246
train 6, step: 500, loss: 8.50226788315922e-05, grad_norm: 4.304548550468327e-05, ic: 0.05027274059246811
Epoch 6: 2022-05-06 19:16:52.933382: train loss: 0.00012999888864496971
Eval step 0: eval loss: 7.823234773240983e-05
Eval: 2022-05-06 19:17:09.512144: total loss: 0.00011770456596153106, mse:0.0002354091355440405, ic :0.004753940221075555, sharpe5:0.3686827642098069, irr5:0.11861627548933029, ndcg5:0.8576955712728433, pnl5:1.0367240905761719 
train 7, step: 0, loss: 0.00010263770673191175, grad_norm: 7.587271367401906e-06, ic: -0.015220884941552569
train 7, step: 500, loss: 0.000201200891751796, grad_norm: 8.265496140482023e-06, ic: 0.11621986224861394
Epoch 7: 2022-05-06 19:18:22.056943: train loss: 0.00012842767144339987
Eval step 0: eval loss: 6.760808901162818e-05
Eval: 2022-05-06 19:18:38.644301: total loss: 0.00011316868642105632, mse:0.000226337377036645, ic :0.004878209996012541, sharpe5:0.45578620512038465, irr5:0.14670845866203308, ndcg5:0.8535606727873049, pnl5:1.0161523818969727 
train 8, step: 0, loss: 9.026185580296442e-05, grad_norm: 5.228545212682487e-06, ic: 0.07290820204845849
train 8, step: 500, loss: 8.111578790703788e-05, grad_norm: 1.4346458308542948e-07, ic: 0.06342472281022339
Epoch 8: 2022-05-06 19:19:50.243932: train loss: 0.00012811544586153095
Eval step 0: eval loss: 6.0320886404952034e-05
Eval: 2022-05-06 19:20:06.849777: total loss: 0.00011473914990776044, mse:0.00022947830339116853, ic :0.0047483566527786085, sharpe5:0.402983951959759, irr5:0.1295929253101349, ndcg5:0.8505175637943706, pnl5:1.0247719287872314 
train 9, step: 0, loss: 0.00011314334551570937, grad_norm: 2.271687920750282e-09, ic: -0.006875288674182813
train 9, step: 500, loss: 5.2092524128966033e-05, grad_norm: 1.6990635345398336e-06, ic: -0.020561377836665486
Epoch 9: 2022-05-06 19:21:19.077193: train loss: 0.00012706391188011158
Eval step 0: eval loss: 6.0401918744901195e-05
Eval: 2022-05-06 19:21:35.984760: total loss: 0.00011455071607719513, mse:0.00022910143492755434, ic :0.004844576212349527, sharpe5:0.38765064395964144, irr5:0.12467914819717407, ndcg5:0.849770561331925, pnl5:1.022148609161377 
train 10, step: 0, loss: 4.694195740739815e-05, grad_norm: 1.3218205611484897e-06, ic: 0.050604402190997606
train 10, step: 500, loss: 0.00012019458517897874, grad_norm: 2.8332936168179e-05, ic: 0.14769535380785798
Epoch 10: 2022-05-06 19:22:46.002975: train loss: 0.00012774569846043501
Eval step 0: eval loss: 7.45745564927347e-05
Eval: 2022-05-06 19:23:02.914143: total loss: 0.00011582817654425327, mse:0.0002316563564151647, ic :0.0050016593827990384, sharpe5:0.5691985596343875, irr5:0.18344025313854218, ndcg5:0.8504127587139048, pnl5:1.0182243585586548 
train 11, step: 0, loss: 9.791044431040064e-05, grad_norm: 4.429293132934854e-06, ic: -0.005701279274458495
train 11, step: 500, loss: 8.468567830277607e-05, grad_norm: 1.7777967183912978e-06, ic: 0.033162447166750514
Epoch 11: 2022-05-06 19:24:14.832320: train loss: 0.00012746519741071058
Eval step 0: eval loss: 6.547494558617473e-05
Eval: 2022-05-06 19:24:31.631205: total loss: 0.00011270482086550595, mse:0.00022540964636151158, ic :0.004068794991866467, sharpe5:0.3936858273670077, irr5:0.12237494438886642, ndcg5:0.8625487854062871, pnl5:1.0408298969268799 
train 12, step: 0, loss: 8.348345727426931e-05, grad_norm: 7.428212252972967e-06, ic: -0.034270660836445484
train 12, step: 500, loss: 7.830288086552173e-05, grad_norm: 3.3823412582113996e-07, ic: -0.010344218768624151
Epoch 12: 2022-05-06 19:25:44.176093: train loss: 0.00012716282523607736
Eval step 0: eval loss: 6.45371837890707e-05
Eval: 2022-05-06 19:26:00.997995: total loss: 0.00011262508196205685, mse:0.0002252501668258693, ic :0.002856570227437029, sharpe5:0.6186206950619817, irr5:0.19830557703971863, ndcg5:0.8475045174220965, pnl5:0.9900791645050049 
train 13, step: 0, loss: 8.411747694481164e-05, grad_norm: 1.5667748044530027e-05, ic: -0.02407742458637576
train 13, step: 500, loss: 6.142371421447024e-05, grad_norm: 1.5130478775596207e-07, ic: -0.010267885848488988
Epoch 13: 2022-05-06 19:27:12.887838: train loss: 0.00012777461410816982
Eval step 0: eval loss: 7.277784607140347e-05
Eval: 2022-05-06 19:27:29.231672: total loss: 0.00011496662417570064, mse:0.00022993325162989827, ic :0.003812250115621028, sharpe5:0.48991062300279736, irr5:0.15479151904582977, ndcg5:0.8426515712501044, pnl5:1.0213913917541504 
train 14, step: 0, loss: 9.985398355638608e-05, grad_norm: 2.8208938153215994e-06, ic: 0.005656773007015648
train 14, step: 500, loss: 0.00011594296665862203, grad_norm: 5.517356333954087e-06, ic: 0.02280942543009394
Epoch 14: 2022-05-06 19:28:41.677167: train loss: 0.00012700547817328766
Eval step 0: eval loss: 6.105504871811718e-05
Eval: 2022-05-06 19:28:56.597055: total loss: 0.00011370929818972539, mse:0.0002274185996823799, ic :0.00024147183724506526, sharpe5:-1.9139730803668498, irr5:-0.24442486464977264, ndcg5:0.850329256997443, pnl5:0.8227723836898804 
train 15, step: 0, loss: 7.127768913051113e-05, grad_norm: 2.7864190503638875e-06, ic: 0.011017204175539282
train 15, step: 500, loss: 7.788454240653664e-05, grad_norm: 2.0662873523603406e-05, ic: 0.040109399361374365
Epoch 15: 2022-05-06 19:30:07.476762: train loss: 0.00012721421466325566
Eval step 0: eval loss: 6.036781633156352e-05
Eval: 2022-05-06 19:30:24.260014: total loss: 0.00011475187659024172, mse:0.0002295037569995311, ic :0.0014185269524313144, sharpe5:0.6036025281250477, irr5:0.1936662495136261, ndcg5:0.8500075746788843, pnl5:1.0243794918060303 
train 16, step: 0, loss: 9.85952137853019e-05, grad_norm: 1.5845763581332585e-05, ic: 0.09992760136131663
train 16, step: 500, loss: 8.590600918978453e-05, grad_norm: 2.6793413465701275e-06, ic: 0.04922849376957313
Epoch 16: 2022-05-06 19:31:38.537939: train loss: 0.0001279497371962696
Eval step 0: eval loss: 8.604707545600832e-05
Eval: 2022-05-06 19:31:55.103158: total loss: 0.00012196745227132192, mse:0.00024393491064380566, ic :0.006969584576312441, sharpe5:0.19466945721767842, irr5:0.04632151871919632, ndcg5:0.8616372727989325, pnl5:0.9745943546295166 
train 17, step: 0, loss: 7.638829993084073e-05, grad_norm: 1.5873702979273145e-06, ic: -0.009365606182204741
train 17, step: 500, loss: 7.4629599112086e-05, grad_norm: 8.4509761436233e-06, ic: 0.016038020900393753
Epoch 17: 2022-05-06 19:33:08.129303: train loss: 0.0001282538065901521
Eval step 0: eval loss: 8.320343476952985e-05
Eval: 2022-05-06 19:33:25.084788: total loss: 0.00012029477768891803, mse:0.00024058956059063358, ic :0.0008582381185221481, sharpe5:0.3751966451480985, irr5:0.11424491554498672, ndcg5:0.8407291422247404, pnl5:0.9823541641235352 
train 18, step: 0, loss: 0.0002503916039131582, grad_norm: 0.0002680700348711133, ic: 0.03103801649355407
train 18, step: 500, loss: 0.00021429575281217694, grad_norm: 0.00020504404667656115, ic: 0.023369228385920218
Epoch 18: 2022-05-06 19:34:37.125179: train loss: 0.0001280582394764664
Eval step 0: eval loss: 6.496874266304076e-05
Eval: 2022-05-06 19:34:53.610611: total loss: 0.00011265095898474356, mse:0.00022530192200379605, ic :-0.0009755846262951996, sharpe5:0.47787960078567265, irr5:0.1538960039615631, ndcg5:0.8530759040167405, pnl5:1.0380375385284424 
train 19, step: 0, loss: 0.00014420630759559572, grad_norm: 8.337692798394043e-05, ic: -0.10761216001417556
train 19, step: 500, loss: 0.00011824560351669788, grad_norm: 2.420488716151059e-05, ic: -0.024392297789781213
Epoch 19: 2022-05-06 19:36:05.041603: train loss: 0.0001269771102602257
Eval step 0: eval loss: 6.1747086874675e-05
Eval: 2022-05-06 19:36:22.380568: total loss: 0.00011316283605865704, mse:0.00022632567440111857, ic :-0.0005918723135735583, sharpe5:0.48582883531227705, irr5:0.15619635581970215, ndcg5:0.8474854984422014, pnl5:1.0393484830856323 
train 20, step: 0, loss: 0.00011159131827298552, grad_norm: 2.2768503077096955e-06, ic: -0.07736377059498228
train 20, step: 500, loss: 9.525249333819374e-05, grad_norm: 1.54769420818388e-05, ic: -0.006385973218815982
Epoch 20: 2022-05-06 19:37:33.411707: train loss: 0.00012752046071627627
Eval step 0: eval loss: 6.762589327991009e-05
Eval: 2022-05-06 19:37:50.347264: total loss: 0.00011312628598458248, mse:0.0002262525758810677, ic :-0.00016533196260023702, sharpe5:0.45142182212322945, irr5:0.14541177451610565, ndcg5:0.8523714926805391, pnl5:1.051598310470581 
train 21, step: 0, loss: 0.00014635405386798084, grad_norm: 7.794101118156993e-05, ic: -0.02430428317903899
train 21, step: 500, loss: 8.523569704266265e-05, grad_norm: 5.83843791394562e-06, ic: -0.004691977582129073
Epoch 21: 2022-05-06 19:39:03.243092: train loss: 0.00012773037826536407
Eval step 0: eval loss: 7.903255755081773e-05
Eval: 2022-05-06 19:39:19.877396: total loss: 0.00011798204188110555, mse:0.00023596408911425628, ic :0.0022856162393385896, sharpe5:0.6032159992307424, irr5:0.08521325141191483, ndcg5:0.8462674528757252, pnl5:1.0274049043655396 
train 22, step: 0, loss: 0.00014950704644434154, grad_norm: 2.7846741890241637e-05, ic: -0.006603442218901509
train 22, step: 500, loss: 0.00010773996473290026, grad_norm: 5.4202891254784574e-05, ic: -0.007338258301179251
Epoch 22: 2022-05-06 19:40:32.449732: train loss: 0.0001273390830914757
Eval step 0: eval loss: 6.309364835033193e-05
Eval: 2022-05-06 19:40:49.394793: total loss: 0.00011270725089237176, mse:0.00022541450637177246, ic :-0.00038648225053756205, sharpe5:0.5340032060444355, irr5:0.1712411344051361, ndcg5:0.86264366245023, pnl5:1.0472757816314697 
train 23, step: 0, loss: 9.218205377692357e-05, grad_norm: 5.262349776385705e-05, ic: -0.023387387512249176
train 23, step: 500, loss: 7.869290857343003e-05, grad_norm: 2.40026273308429e-05, ic: -0.0432616412892089
Epoch 23: 2022-05-06 19:42:02.889436: train loss: 0.00012794237336298552
Eval step 0: eval loss: 6.423238664865494e-05
Eval: 2022-05-06 19:42:19.582463: total loss: 0.00011261978342861759, mse:0.00022523957048375089, ic :-0.0013647078360544543, sharpe5:0.4937210778146982, irr5:0.15831732749938965, ndcg5:0.8523099468731647, pnl5:1.0407288074493408 
train 24, step: 0, loss: 0.00010651160118868575, grad_norm: 4.1401886404242806e-06, ic: 0.03804196256557587
train 24, step: 500, loss: 0.00020415824837982655, grad_norm: 0.00010960390302485011, ic: 0.01473854794296958
Epoch 24: 2022-05-06 19:43:30.783283: train loss: 0.00012721647159624435
Eval step 0: eval loss: 7.154030754463747e-05
Eval: 2022-05-06 19:43:46.179623: total loss: 0.00011443786869116848, mse:0.00022887574006475058, ic :-0.001449907953420089, sharpe5:0.49360094524919984, irr5:0.159046933054924, ndcg5:0.8424715088072503, pnl5:1.0408304929733276 
train 25, step: 0, loss: 0.00011273612471995875, grad_norm: 8.031230842413217e-05, ic: 0.009086933049286575
train 25, step: 500, loss: 9.27787841646932e-05, grad_norm: 4.3533593987640464e-05, ic: -0.04873371069615423
Epoch 25: 2022-05-06 19:44:58.845689: train loss: 0.00012790882419478857
Eval step 0: eval loss: 6.862605368951336e-05
Eval: 2022-05-06 19:45:15.362025: total loss: 0.00011340704439365505, mse:0.00022681409266935818, ic :-0.0005822084390230151, sharpe5:0.5240651922672986, irr5:0.16903981566429138, ndcg5:0.8565423404112125, pnl5:1.0279544591903687 
train 26, step: 0, loss: 9.369179315399379e-05, grad_norm: 3.101577522334941e-05, ic: -0.00874110956158402
train 26, step: 500, loss: 5.118528861203231e-05, grad_norm: 3.360327522780992e-08, ic: 0.006878200219160427
Epoch 26: 2022-05-06 19:46:27.816900: train loss: 0.00012757947918442096
Eval step 0: eval loss: 7.527251727879047e-05
Eval: 2022-05-06 19:46:44.508153: total loss: 0.00011607984434032922, mse:0.00023215969283092152, ic :0.00188140293266924, sharpe5:-1.1783034785091877, irr5:-0.17668190598487854, ndcg5:0.8596915978733346, pnl5:0.9392063021659851 
train 27, step: 0, loss: 9.028812200995162e-05, grad_norm: 3.2103019555450225e-06, ic: 0.002669168640715546
train 27, step: 500, loss: 0.00014245427155401558, grad_norm: 2.65301039162202e-05, ic: -0.04116243750348654
Epoch 27: 2022-05-06 19:47:57.259471: train loss: 0.00012808470167713004
Eval step 0: eval loss: 6.0093872889410704e-05
Eval: 2022-05-06 19:48:14.637893: total loss: 0.00011775100534879928, mse:0.00023550201448380333, ic :0.0026358232002582026, sharpe5:-0.5219681340828538, irr5:-0.10229060798883438, ndcg5:0.8553805029338087, pnl5:0.82198566198349 
train 28, step: 0, loss: 0.0001623241842025891, grad_norm: 2.1702147856491572e-07, ic: 0.004899642254388794
train 28, step: 500, loss: 8.37247644085437e-05, grad_norm: 2.5084401286409784e-05, ic: -0.02476751302827542
Epoch 28: 2022-05-06 19:49:27.179249: train loss: 0.00012716854502880238
Eval step 0: eval loss: 6.699129880871624e-05
Eval: 2022-05-06 19:49:43.783635: total loss: 0.00011297206458046943, mse:0.00022594413300458017, ic :-0.0011343948282744828, sharpe5:0.380548012945801, irr5:0.11961965262889862, ndcg5:0.8585035543766587, pnl5:1.0208773612976074 
train 29, step: 0, loss: 0.00011520968109834939, grad_norm: 3.6857502418612155e-07, ic: -0.009849273346759129
train 29, step: 500, loss: 9.657961345510557e-05, grad_norm: 4.618566665154348e-05, ic: 0.020236677460966454
Epoch 29: 2022-05-06 19:50:53.924597: train loss: 0.00012750443190810603
Eval step 0: eval loss: 8.076489029917866e-05
Eval: 2022-05-06 19:51:10.629043: total loss: 0.00011891864764292655, mse:0.00023783730005450153, ic :-0.0022317539690013084, sharpe5:0.5483366410061716, irr5:0.17672358453273773, ndcg5:0.8429767118047832, pnl5:1.032240390777588 
train 30, step: 0, loss: 0.00012869139027316123, grad_norm: 4.317907674908089e-05, ic: 0.010737942614309635
train 30, step: 500, loss: 0.00018064683536067605, grad_norm: 2.2608849928719116e-06, ic: 0.009890985013077495
Epoch 30: 2022-05-06 19:52:23.691529: train loss: 0.00012824740679207025
Eval step 0: eval loss: 8.602471643825993e-05
Eval: 2022-05-06 19:52:40.614679: total loss: 0.00012195218467510988, mse:0.00024390437344365084, ic :0.0008125059645623114, sharpe5:-7.781368421316146, irr5:-0.4188440442085266, ndcg5:0.847197319060846, pnl5:0.54315584897995 
train 31, step: 0, loss: 6.423454760806635e-05, grad_norm: 4.1508842667672026e-05, ic: -0.020692981249749137
train 31, step: 500, loss: 6.728424341417849e-05, grad_norm: 5.5395392298696445e-06, ic: 0.0011761179842867363
Epoch 31: 2022-05-06 19:53:53.156043: train loss: 0.00012822258297558954
Eval step 0: eval loss: 6.0432364989537746e-05
Eval: 2022-05-06 19:54:09.709304: total loss: 0.00011463361457318137, mse:0.00022926723299099551, ic :0.001242948217990728, sharpe5:-7.330850963294505, irr5:-0.6204003095626831, ndcg5:0.8501066945732537, pnl5:0.679949939250946 
train 32, step: 0, loss: 7.947554695419967e-05, grad_norm: 9.599059102640822e-06, ic: 0.02937184818863939
train 32, step: 500, loss: 0.0001473729353165254, grad_norm: 1.5929310026830257e-05, ic: 0.02150826600811205
Epoch 32: 2022-05-06 19:55:22.421880: train loss: 0.0001274838328306961
Eval step 0: eval loss: 6.011906225467101e-05
Eval: 2022-05-06 19:55:38.964852: total loss: 0.00011574743246249386, mse:0.00023149487174813988, ic :0.0012625684888611002, sharpe5:-7.837780120074749, irr5:-0.6649296283721924, ndcg5:0.8518484807262591, pnl5:0.41214174032211304 
train 33, step: 0, loss: 0.00010193062189500779, grad_norm: 1.442945424109753e-05, ic: -0.009563579746040253
train 33, step: 500, loss: 5.475043872138485e-05, grad_norm: 1.7077329376418974e-06, ic: -0.0037612699325270072
Epoch 33: 2022-05-06 19:56:51.535260: train loss: 0.0001278398077243414
Eval step 0: eval loss: 7.439099863404408e-05
Eval: 2022-05-06 19:57:08.729940: total loss: 0.00011566649248590185, mse:0.00023133299069709538, ic :-0.0011377262674947969, sharpe5:0.4674351029098034, irr5:0.14942915737628937, ndcg5:0.8447895095179809, pnl5:1.0358105897903442 
train 34, step: 0, loss: 7.151040335884318e-05, grad_norm: 2.0713903598894804e-06, ic: -0.04532793709484892
train 34, step: 500, loss: 8.671251271152869e-05, grad_norm: 4.144819481211357e-06, ic: 0.0010588885708367173
Epoch 34: 2022-05-06 19:58:18.418015: train loss: 0.00012765753934432082
Eval step 0: eval loss: 6.004819442750886e-05
Eval: 2022-05-06 19:58:34.954301: total loss: 0.00011652724330763914, mse:0.0002330544922514334, ic :-0.0012448309606279016, sharpe5:0.5160296715795993, irr5:0.1663854718208313, ndcg5:0.8438552803190115, pnl5:1.0264723300933838 
train 35, step: 0, loss: 0.0002083735162159428, grad_norm: 0.00017995899420977893, ic: 0.03865154584445698
train 35, step: 500, loss: 0.0002208941150456667, grad_norm: 0.00017396222109773582, ic: 0.025620369140290554
Epoch 35: 2022-05-06 19:59:48.047073: train loss: 0.00012825356838522159
Eval step 0: eval loss: 6.398183904821053e-05
Eval: 2022-05-06 20:00:04.792685: total loss: 0.00011262312843098293, mse:0.00022524625901518497, ic :-0.0012410999997172698, sharpe5:0.5268556731194257, irr5:0.1693820059299469, ndcg5:0.847819390005134, pnl5:1.04654860496521 
train 36, step: 0, loss: 0.0002558303240220994, grad_norm: 0.00012274841889833426, ic: 0.0069064378681520655
train 36, step: 500, loss: 0.00033762541715987027, grad_norm: 0.00011039253451243835, ic: 0.028503739803628053
Epoch 36: 2022-05-06 20:01:17.084133: train loss: 0.00012727188758505695
Eval step 0: eval loss: 8.374926983378828e-05
Eval: 2022-05-06 20:01:33.734744: total loss: 0.00012060922759447316, mse:0.00024121846065483388, ic :0.0012818091662161375, sharpe5:-9.895453741550446, irr5:-0.8787059187889099, ndcg5:0.8582697412337139, pnl5:0.3239729702472687 
train 37, step: 0, loss: 0.00022855943825561553, grad_norm: 0.00026660143876363566, ic: -0.09039299983965739
train 37, step: 500, loss: 8.687707304488868e-05, grad_norm: 1.3074066067085852e-06, ic: 0.02157018675014513
Epoch 37: 2022-05-06 20:02:46.220983: train loss: 0.00012757746677905324
Eval step 0: eval loss: 7.147482392610982e-05
Eval: 2022-05-06 20:03:02.850486: total loss: 0.00011441187933595713, mse:0.00022882376360510633, ic :-0.001407734864586859, sharpe5:0.5730242379382252, irr5:0.18422755599021912, ndcg5:0.858584939378368, pnl5:1.03641676902771 
train 38, step: 0, loss: 9.135800792137161e-05, grad_norm: 1.4948624221445215e-06, ic: 0.04815169657574624
train 38, step: 500, loss: 0.00014983830624260008, grad_norm: 7.637028802674661e-08, ic: -0.008444788730069536
Epoch 38: 2022-05-06 20:04:14.728827: train loss: 0.00012722823542871456
Eval step 0: eval loss: 6.175627640914172e-05
Eval: 2022-05-06 20:04:30.147146: total loss: 0.00011315816500507332, mse:0.0002263163359552822, ic :0.0015987879514238919, sharpe5:-1.280312935039401, irr5:-0.19445303082466125, ndcg5:0.8532965324422236, pnl5:0.8097318410873413 
train 39, step: 0, loss: 0.00018159129831474274, grad_norm: 0.0001298702551962344, ic: 0.004685102227602156
train 39, step: 500, loss: 0.00012174925359431654, grad_norm: 1.983864546415397e-05, ic: 0.018777675115924264
Epoch 39: 2022-05-06 20:05:42.004159: train loss: 0.00012709463610426514
Eval step 0: eval loss: 7.760868174955249e-05
Eval: 2022-05-06 20:05:58.915709: total loss: 0.00011723689887699097, mse:0.00023447380006929764, ic :-0.0020156535914902514, sharpe5:0.35953651981428264, irr5:0.10880789905786514, ndcg5:0.8522017164798523, pnl5:0.9803710579872131 
train 40, step: 0, loss: 0.00011101002746727318, grad_norm: 1.987778465221992e-05, ic: -0.007535297865271529
train 40, step: 500, loss: 0.00016558637435082346, grad_norm: 1.646560878146943e-05, ic: 0.028438124934793238
Epoch 40: 2022-05-06 20:07:12.352569: train loss: 0.00012715340307523854
Eval step 0: eval loss: 6.200061034178361e-05
Eval: 2022-05-06 20:07:29.667845: total loss: 0.00012445821196837737, mse:0.00024891642793082555, ic :0.0014309167669602672, sharpe5:-1.1719144597649573, irr5:-0.14690402150154114, ndcg5:0.8489817165646784, pnl5:0.891974925994873 
train 41, step: 0, loss: 7.530593575211242e-05, grad_norm: 3.05991709981705e-05, ic: 0.03145984561659284
train 41, step: 500, loss: 0.00011001215898431838, grad_norm: 3.674608279764129e-05, ic: -0.07872155672791675
Epoch 41: 2022-05-06 20:08:42.505622: train loss: 0.00012714378206578537
Eval step 0: eval loss: 7.954323518788442e-05
Eval: 2022-05-06 20:08:59.047105: total loss: 0.0001182534649823772, mse:0.00023650692995751143, ic :-0.0010553814994398137, sharpe5:0.3272023550234735, irr5:0.09941605478525162, ndcg5:0.8683687763732669, pnl5:0.9921534657478333 
train 42, step: 0, loss: 5.419191438704729e-05, grad_norm: 2.4791818092157847e-05, ic: -0.005759631733162607
train 42, step: 500, loss: 0.00015636046009603888, grad_norm: 1.333284286328164e-05, ic: 0.02339763953826586
Epoch 42: 2022-05-06 20:10:12.003329: train loss: 0.0001273157716236394
Eval step 0: eval loss: 6.2541090301238e-05
Eval: 2022-05-06 20:10:28.538979: total loss: 0.00011283327692811577, mse:0.00022566655702222258, ic :0.0009945477672337038, sharpe5:0.08796792833134531, irr5:0.018159156665205956, ndcg5:0.8517680335316241, pnl5:1.0061814785003662 
train 43, step: 0, loss: 7.364543853327632e-05, grad_norm: 1.1922118997395466e-05, ic: 0.007574194732633259
train 43, step: 500, loss: 0.00012971156684216112, grad_norm: 0.00012180494012116386, ic: 0.0032451153745037924
Epoch 43: 2022-05-06 20:11:39.646787: train loss: 0.0001278692135410844
Eval step 0: eval loss: 7.37164809834212e-05
Eval: 2022-05-06 20:11:56.171057: total loss: 0.000115360061305206, mse:0.00023072012627280077, ic :0.0012286428512037297, sharpe5:-0.6120787319540977, irr5:-0.061154887080192566, ndcg5:0.8496584158640266, pnl5:0.9229062795639038 
train 44, step: 0, loss: 0.00011719571193680167, grad_norm: 4.436697869732129e-06, ic: 0.007094191071908973
train 44, step: 500, loss: 0.0001965331903193146, grad_norm: 7.930281146795042e-05, ic: -0.0645119556605136
Epoch 44: 2022-05-06 20:13:08.728889: train loss: 0.00012680553580645345
Eval step 0: eval loss: 6.0779391787946224e-05
Eval: 2022-05-06 20:13:25.219911: total loss: 0.00012102430680571999, mse:0.00024204861825177077, ic :0.0013099475684315012, sharpe5:-4.392172875702381, irr5:-0.31156352162361145, ndcg5:0.8569934321570826, pnl5:0.6209347248077393 
train 45, step: 0, loss: 0.00023294751008506864, grad_norm: 6.819164520368354e-05, ic: -0.017395180537612392
train 45, step: 500, loss: 0.00010743112943600863, grad_norm: 2.933238071323643e-07, ic: -0.0032314226389947853
Epoch 45: 2022-05-06 20:14:37.054208: train loss: 0.00012774532781945782
Eval step 0: eval loss: 7.046995597193018e-05
Eval: 2022-05-06 20:14:53.714861: total loss: 0.00011402800486409857, mse:0.00022805601248319064, ic :0.0014847326541684257, sharpe5:-1.3120623403787612, irr5:-0.17991432547569275, ndcg5:0.8540855739622493, pnl5:0.894692599773407 
train 46, step: 0, loss: 0.00011443433322710916, grad_norm: 5.434137359973808e-05, ic: -0.02757835153048949
train 46, step: 500, loss: 5.153416350367479e-05, grad_norm: 5.692127552337458e-06, ic: 0.004883909536936846
Epoch 46: 2022-05-06 20:16:06.108290: train loss: 0.000127375638747613
Eval step 0: eval loss: 7.307891792152077e-05
Eval: 2022-05-06 20:16:22.812590: total loss: 0.0001150788401420519, mse:0.0002301576829392289, ic :0.0012936204604616743, sharpe5:1.6596842459589243, irr5:0.47721800208091736, ndcg5:0.8482810991546164, pnl5:1.0952032804489136 
train 47, step: 0, loss: 0.00010346572526032105, grad_norm: 4.8450669337000456e-05, ic: 0.012745853723763205
train 47, step: 500, loss: 9.760077227838337e-05, grad_norm: 6.609996236018819e-07, ic: 0.004929769135802056
Epoch 47: 2022-05-06 20:17:35.465607: train loss: 0.00012702785911131745
Eval step 0: eval loss: 6.350224430207163e-05
Eval: 2022-05-06 20:17:52.111875: total loss: 0.00011265326134873734, mse:0.00022530652797759663, ic :0.0012474874797864005, sharpe5:-9.099422255158425, irr5:-0.5295440554618835, ndcg5:0.853053473605868, pnl5:0.3980666399002075 
train 48, step: 0, loss: 0.00018996295693796128, grad_norm: 6.530536816510841e-05, ic: -0.022234741527401375
train 48, step: 500, loss: 9.082442556973547e-05, grad_norm: 1.2087143479269714e-05, ic: 0.013815829938076382
Epoch 48: 2022-05-06 20:19:04.583724: train loss: 0.00012752426928127144
Eval step 0: eval loss: 6.0703423514496535e-05
Eval: 2022-05-06 20:19:20.667417: total loss: 0.00011413309728667265, mse:0.00022826619630505148, ic :-0.001188240687589168, sharpe5:0.4714233917556703, irr5:0.15155915915966034, ndcg5:0.8532008719242146, pnl5:1.055145263671875 
train 49, step: 0, loss: 0.00011602500308072194, grad_norm: 1.8698647623779382e-06, ic: 0.006615153344281634
train 49, step: 500, loss: 5.179611616767943e-05, grad_norm: 4.898963244360089e-07, ic: -0.01654567609134566
Epoch 49: 2022-05-06 20:20:33.095880: train loss: 0.00012674565224348472
Eval step 0: eval loss: 6.537250010296702e-05
Eval: 2022-05-06 20:20:49.784365: total loss: 0.00011269060200803169, mse:0.00022538120707423837, ic :-0.0008572133483732388, sharpe5:0.36974775832146406, irr5:0.1153094545006752, ndcg5:0.8589958611245603, pnl5:1.0365581512451172 
train 50, step: 0, loss: 0.00015221485227812082, grad_norm: 1.7708079749435405e-05, ic: -0.002416471716576359
train 50, step: 500, loss: 0.00010352083336329088, grad_norm: 2.7945748731496143e-05, ic: 0.044840573959317245
Epoch 50: 2022-05-06 20:22:03.033791: train loss: 0.00012747969983386363
Eval step 0: eval loss: 6.269962614169344e-05
Eval: 2022-05-06 20:22:20.023655: total loss: 0.00011279008762215012, mse:0.0002255801790879943, ic :0.0012601725550188336, sharpe5:-5.642274244129657, irr5:-0.3473169505596161, ndcg5:0.8528843214018613, pnl5:0.635478138923645 
train 51, step: 0, loss: 8.582219743402675e-05, grad_norm: 2.0594426389699186e-05, ic: 0.008841664674864337
train 51, step: 500, loss: 0.00011886174615938216, grad_norm: 1.2712626717619828e-06, ic: -0.014057737788417301
Epoch 51: 2022-05-06 20:23:31.913197: train loss: 0.00012735615252208382
Eval step 0: eval loss: 6.900181324454024e-05
Eval: 2022-05-06 20:23:48.692553: total loss: 0.00011352362248723245, mse:0.0002270472499781763, ic :-0.0016281176252164996, sharpe5:0.4801178088225424, irr5:0.1505257934331894, ndcg5:0.8518610023082, pnl5:1.037116527557373 
train 52, step: 0, loss: 8.97742502274923e-05, grad_norm: 2.6046453419235623e-05, ic: -0.004169078812508137
train 52, step: 500, loss: 0.00024874068913049996, grad_norm: 7.94699724627775e-05, ic: 0.0007958201798718544
Epoch 52: 2022-05-06 20:25:01.517412: train loss: 0.00012767085961404228
Eval step 0: eval loss: 6.475003465311602e-05
Eval: 2022-05-06 20:25:18.104150: total loss: 0.0001126359194373777, mse:0.00022527184423745282, ic :-0.0014194828469774896, sharpe5:0.5981697811558843, irr5:0.18897342681884766, ndcg5:0.8514075805540332, pnl5:1.0401629209518433 
train 53, step: 0, loss: 0.0001199759281007573, grad_norm: 3.151373618571857e-05, ic: -0.03480145350175348
train 53, step: 500, loss: 9.297086216975003e-05, grad_norm: 8.573488351234203e-06, ic: -0.032062493650444966
Epoch 53: 2022-05-06 20:26:28.981597: train loss: 0.00012697926101092383
Eval step 0: eval loss: 7.416471635224298e-05
Eval: 2022-05-06 20:26:45.479882: total loss: 0.00011556270099819463, mse:0.0002311254077187487, ic :-0.0014114416651674205, sharpe5:0.4714233917556703, irr5:0.15155915915966034, ndcg5:0.8391137346230405, pnl5:1.055145263671875 
train 54, step: 0, loss: 0.00012029014033032581, grad_norm: 5.8509968739464486e-05, ic: -0.00453166110404658
train 54, step: 500, loss: 8.248977974290028e-05, grad_norm: 8.753635466842244e-06, ic: -0.04521661132848316
Epoch 54: 2022-05-06 20:27:58.184660: train loss: 0.000127852923493936
Eval step 0: eval loss: 6.061062958906405e-05
Eval: 2022-05-06 20:28:15.284847: total loss: 0.00011428274421044727, mse:0.00022856549291986757, ic :0.0014202229014041972, sharpe5:-2.0931122553348542, irr5:-0.2564760446548462, ndcg5:0.8529326163546299, pnl5:0.7614798545837402 
train 55, step: 0, loss: 6.406750617315993e-05, grad_norm: 3.5264186150415954e-06, ic: 0.0035574962403508437
train 55, step: 500, loss: 0.0002115764218615368, grad_norm: 1.7879328405700535e-05, ic: -0.07059468204086268
Epoch 55: 2022-05-06 20:29:30.874838: train loss: 0.00012737231843536445
Eval step 0: eval loss: 6.438900891225785e-05
Eval: 2022-05-06 20:29:48.947102: total loss: 0.00011262157310766787, mse:0.0002252431508706792, ic :-0.0019021477188053018, sharpe5:0.5655352258309722, irr5:0.1817832589149475, ndcg5:0.8437506837440389, pnl5:1.0352052450180054 
train 56, step: 0, loss: 0.0001001477794488892, grad_norm: 2.240454837747051e-05, ic: 0.010117728643223682
train 56, step: 500, loss: 0.00011334438022458926, grad_norm: 3.70033944428085e-06, ic: -0.013136389153010039
Epoch 56: 2022-05-06 20:31:04.427603: train loss: 0.00012769757949838658
Eval step 0: eval loss: 6.422747537726536e-05
Eval: 2022-05-06 20:31:21.797429: total loss: 0.0001126197916736438, mse:0.00022523958685233213, ic :-0.0015011160780302134, sharpe5:0.43864112421870227, irr5:0.14025655388832092, ndcg5:0.8479469757989235, pnl5:1.0488837957382202 
train 57, step: 0, loss: 9.885932377073914e-05, grad_norm: 3.61467269365386e-05, ic: -0.014406542302333236
train 57, step: 500, loss: 0.000169278122484684, grad_norm: 1.462512495631455e-07, ic: -0.024681345108868415
Epoch 57: 2022-05-06 20:32:37.314889: train loss: 0.00012695300929262495
Eval step 0: eval loss: 6.117193697718903e-05
Eval: 2022-05-06 20:32:54.917046: total loss: 0.00011358063039357171, mse:0.00022716126588384205, ic :3.0360997266382302e-05, sharpe5:1.1036733687669038, irr5:0.29867810010910034, ndcg5:0.8514438107965633, pnl5:1.1725828647613525 
train 58, step: 0, loss: 0.00012877870176453143, grad_norm: 7.877301725962435e-05, ic: -0.02562307540459382
train 58, step: 500, loss: 6.254235631786287e-05, grad_norm: 2.770695342554052e-05, ic: -0.01202215326195298
Epoch 58: 2022-05-06 20:34:07.281860: train loss: 0.0001275105277598676
Eval step 0: eval loss: 7.305281178560108e-05
Eval: 2022-05-06 20:34:24.971445: total loss: 0.0001150675034534296, mse:0.0002301350105815199, ic :0.0011254540930047128, sharpe5:-1.2900928609818219, irr5:-0.28408974409103394, ndcg5:0.8540600906739544, pnl5:0.8521286845207214 
train 59, step: 0, loss: 8.676977449795231e-05, grad_norm: 2.2410812622144316e-05, ic: -0.0011867241336917696
train 59, step: 500, loss: 4.1812705603661016e-05, grad_norm: 2.7673106065139983e-08, ic: -0.0254725341664681
Epoch 59: 2022-05-06 20:35:38.432114: train loss: 0.0001265474307135804
Eval step 0: eval loss: 8.238706504926085e-05
Eval: 2022-05-06 20:35:55.334427: total loss: 0.00011982677727655557, mse:0.0002396535584091933, ic :-0.0016920499196652861, sharpe5:0.34323080018162727, irr5:0.10429205745458603, ndcg5:0.8634633219516179, pnl5:0.9774576425552368 
