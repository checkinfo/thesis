Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQAdjSeqTimeDataset', dout=0.3, epochs=60, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=True, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=True, label_cnt=1, lr=0.0001, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='BiGLSTM', normalize_adj=True, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
75317
BiGLSTM(
  (input_to_hidden): Linear(in_features=5, out_features=128, bias=True)
  (forward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (backward_cells): ModuleList(
    (0): GLSTMCell(
      (dropout): Dropout(p=0.3, inplace=False)
      (Wh): Linear(in_features=128, out_features=640, bias=False)
      (Wn): Linear(in_features=128, out_features=640, bias=False)
      (Wt): Linear(in_features=128, out_features=640, bias=False)
      (U): Linear(in_features=128, out_features=640, bias=False)
      (V): Linear(in_features=128, out_features=640, bias=True)
      (relu): LeakyReLU(negative_slope=0.01)
      (gnn): ModuleList(
        (0): RGCN(
          (attention): ModuleList(
            (0): GraphAttentionLayer (128 -> 128)
          )
          (lin_rel): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=True)
          )
          (lin_root): ModuleList(
            (0): Linear(in_features=128, out_features=128, bias=False)
          )
          (lin_gate): Linear(in_features=128, out_features=128, bias=True)
        )
      )
    )
  )
  (fc0): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (w_out): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.01590569317340851, grad_norm: 0.2514014363091677, ic: -0.01536432436510039
train 0, step: 500, loss: 0.00021755980560556054, grad_norm: 1.4005831292031148e-05, ic: 0.007085068584195159
Epoch 0: 2022-05-05 22:05:12.885635: train loss: 0.0005663403841260046
Eval step 0: eval loss: 6.754953938070685e-05
Eval: 2022-05-05 22:05:29.246132: total loss: 0.00011314003767156425, mse:0.00022628008137672863, ic :0.016150686367601603, sharpe5:1.2422777350991965, irr5:0.31931349635124207, ndcg5:0.8452164396790114, pnl5:1.1879957914352417 
train 1, step: 0, loss: 0.00018505463958717883, grad_norm: 9.612704771139427e-05, ic: 0.01655126470353718
train 1, step: 500, loss: 0.0001488671696279198, grad_norm: 5.3917539182923846e-05, ic: -0.02930560354167945
Epoch 1: 2022-05-05 22:06:39.011636: train loss: 0.00019228333908820805
Eval step 0: eval loss: 6.493712862720713e-05
Eval: 2022-05-05 22:06:54.829251: total loss: 0.00011299803769981029, mse:0.0002259960783061964, ic :0.01009655435453451, sharpe5:0.0057362487120553845, irr5:0.001843772828578949, ndcg5:0.8509165299594542, pnl5:1.0275204181671143 
train 2, step: 0, loss: 0.00011721468035830185, grad_norm: 8.355272443189438e-06, ic: 0.03231582075791615
train 2, step: 500, loss: 9.773320925887674e-05, grad_norm: 5.698995829181468e-07, ic: 0.037950802734854426
Epoch 2: 2022-05-05 22:08:04.609767: train loss: 0.00016038309531042012
Eval step 0: eval loss: 6.0711692640325055e-05
Eval: 2022-05-05 22:08:21.747913: total loss: 0.0001139512827347173, mse:0.00022790256972684056, ic :0.010720579487355096, sharpe5:0.2226418698672205, irr5:0.07460294663906097, ndcg5:0.851713357972101, pnl5:1.0470266342163086 
train 3, step: 0, loss: 0.00012897144188173115, grad_norm: 1.4198549588884385e-05, ic: 0.02344418331111516
train 3, step: 500, loss: 0.00014787745021749288, grad_norm: 4.777846269616126e-05, ic: -0.038145428461010045
Epoch 3: 2022-05-05 22:09:34.281549: train loss: 0.00014895077426206596
Eval step 0: eval loss: 7.691523933317512e-05
Eval: 2022-05-05 22:09:50.396080: total loss: 0.0001175165206480387, mse:0.0002350330441358316, ic :0.008081001462678455, sharpe5:0.3543254150636494, irr5:0.11420664191246033, ndcg5:0.8573371955718583, pnl5:1.052133321762085 
train 4, step: 0, loss: 9.163082722807303e-05, grad_norm: 1.2800941679245985e-05, ic: 0.035009382481020104
train 4, step: 500, loss: 9.142469934886321e-05, grad_norm: 5.418324464981638e-06, ic: -0.016606334410905078
Epoch 4: 2022-05-05 22:11:01.822835: train loss: 0.00014057344794509165
Eval step 0: eval loss: 6.0053756897104904e-05
Eval: 2022-05-05 22:11:18.979850: total loss: 0.00011800811749930782, mse:0.00023601623847019853, ic :0.010087737602321916, sharpe5:-0.2290457573812455, irr5:-0.07108432054519653, ndcg5:0.84898736260828, pnl5:0.9722616672515869 
train 5, step: 0, loss: 0.00013930183195043355, grad_norm: 5.421782972614848e-05, ic: 0.010515368848982083
train 5, step: 500, loss: 0.0005556021351367235, grad_norm: 0.000750695691949084, ic: -0.07563051679822981
Epoch 5: 2022-05-05 22:12:31.822963: train loss: 0.00013671909744001056
Eval step 0: eval loss: 8.547132165404037e-05
Eval: 2022-05-05 22:12:49.206573: total loss: 0.00012193378468382673, mse:0.00024386757357938615, ic :0.006443433137065263, sharpe5:0.42802083196118473, irr5:0.13734683394432068, ndcg5:0.843969298521577, pnl5:1.0284931659698486 
train 6, step: 0, loss: 0.00010687921167118475, grad_norm: 5.1222312037522216e-05, ic: -0.009612139727009772
train 6, step: 500, loss: 7.792135875206441e-05, grad_norm: 1.9764790743027588e-05, ic: 0.034823638354943565
Epoch 6: 2022-05-05 22:14:01.887168: train loss: 0.0001341513999264901
Eval step 0: eval loss: 6.991109694354236e-05
Eval: 2022-05-05 22:14:18.469040: total loss: 0.00011407199263492372, mse:0.00022814399141416811, ic :0.006655238035607887, sharpe5:0.5458534086495638, irr5:0.1751539707183838, ndcg5:0.8537628982852686, pnl5:1.0313689708709717 
train 7, step: 0, loss: 0.00010522784577915445, grad_norm: 1.3558580265624464e-06, ic: -0.008499853396152356
train 7, step: 500, loss: 0.0002090535854222253, grad_norm: 1.927691173677972e-05, ic: 0.039233143120303175
Epoch 7: 2022-05-05 22:15:30.939399: train loss: 0.00013211081297053422
Eval step 0: eval loss: 6.645573739660904e-05
Eval: 2022-05-05 22:15:47.557026: total loss: 0.0001129369166850999, mse:0.00022587383793501404, ic :0.007027982328196302, sharpe5:0.3693408329039812, irr5:0.11190628260374069, ndcg5:0.8614187657768763, pnl5:0.9648460745811462 
train 8, step: 0, loss: 9.488806244917214e-05, grad_norm: 8.24951380256744e-06, ic: 0.026590858975312753
train 8, step: 500, loss: 8.541950955986977e-05, grad_norm: 2.642719533631609e-08, ic: -0.011210820646912647
Epoch 8: 2022-05-05 22:17:00.590364: train loss: 0.00013123520633316583
Eval step 0: eval loss: 6.134260183898732e-05
Eval: 2022-05-05 22:17:18.597649: total loss: 0.00011341575125253182, mse:0.00022683150574435724, ic :0.006750725157452567, sharpe5:0.5209137816354632, irr5:0.16689477860927582, ndcg5:0.8568851146951773, pnl5:1.027538537979126 
train 9, step: 0, loss: 0.00011557069956324995, grad_norm: 5.699564733717871e-07, ic: 0.03103442053709755
train 9, step: 500, loss: 5.4317162721417844e-05, grad_norm: 1.8560952734150004e-06, ic: 0.02051225221737626
Epoch 9: 2022-05-05 22:18:33.183727: train loss: 0.0001297690100508915
Eval step 0: eval loss: 6.055669655324891e-05
Eval: 2022-05-05 22:18:50.667563: total loss: 0.00011430698925808203, mse:0.00022861398340092806, ic :0.006654291658176543, sharpe5:0.5461693478375673, irr5:0.1756300926208496, ndcg5:0.8533503013537532, pnl5:1.031879186630249 
train 10, step: 0, loss: 4.936040932079777e-05, grad_norm: 2.0583248090901937e-06, ic: 0.035220677421379826
train 10, step: 500, loss: 0.00012392367352731526, grad_norm: 3.444200215154811e-05, ic: 0.027743756982822367
Epoch 10: 2022-05-05 22:20:04.887557: train loss: 0.00012971028506744624
Eval step 0: eval loss: 7.703057053731754e-05
Eval: 2022-05-05 22:20:22.949936: total loss: 0.00011712950370915023, mse:0.00023425901054798277, ic :0.00505410720165208, sharpe5:0.5244804536551236, irr5:0.16911733150482178, ndcg5:0.8381871128928344, pnl5:1.0279052257537842 
train 11, step: 0, loss: 0.00010141811071662232, grad_norm: 6.425188865362682e-06, ic: -0.03040612926931543
train 11, step: 500, loss: 8.739136683288962e-05, grad_norm: 2.450510308517352e-06, ic: -0.012279622364071305
Epoch 11: 2022-05-05 22:21:38.514362: train loss: 0.00012898514461099733
Eval step 0: eval loss: 6.240612856345251e-05
Eval: 2022-05-05 22:21:56.947036: total loss: 0.00011285327048120739, mse:0.000225706541944902, ic :0.005473232416144597, sharpe5:0.5503378059715033, irr5:0.17682074010372162, ndcg5:0.8521757931556855, pnl5:1.0325759649276733 
train 12, step: 0, loss: 8.834711479721591e-05, grad_norm: 1.561321923364436e-05, ic: 0.018177962917297494
train 12, step: 500, loss: 7.889483822509646e-05, grad_norm: 8.640621021870599e-08, ic: 0.04254991179047768
Epoch 12: 2022-05-05 22:23:12.914270: train loss: 0.00012816108396521334
Eval step 0: eval loss: 6.475943519035354e-05
Eval: 2022-05-05 22:23:31.311876: total loss: 0.00011266222221478942, mse:0.00022532444839546675, ic :0.005746943759579025, sharpe5:0.5435325799137354, irr5:0.17462337017059326, ndcg5:0.8463009596498742, pnl5:1.0314258337020874 
train 13, step: 0, loss: 8.491076005157083e-05, grad_norm: 1.6232504756613656e-05, ic: 0.022800199382919273
train 13, step: 500, loss: 6.278856744756922e-05, grad_norm: 1.6167930623893862e-07, ic: 0.006569633031945693
Epoch 13: 2022-05-05 22:24:46.355936: train loss: 0.00012794742391351827
Eval step 0: eval loss: 7.228281901916489e-05
Eval: 2022-05-05 22:25:03.771245: total loss: 0.0001148252360675002, mse:0.00022965047443200583, ic :0.0048266962715358495, sharpe5:0.563573494143784, irr5:0.18073022365570068, ndcg5:0.8471482425003315, pnl5:1.03481125831604 
train 14, step: 0, loss: 0.00010105474939337, grad_norm: 2.575316514029454e-06, ic: -0.015543292016051074
train 14, step: 500, loss: 0.0001170324394479394, grad_norm: 5.317699271998877e-06, ic: -0.002333231965501079
Epoch 14: 2022-05-05 22:26:17.271217: train loss: 0.00012743602182258096
Eval step 0: eval loss: 6.280121306190267e-05
Eval: 2022-05-05 22:26:34.784527: total loss: 0.00011281483472674662, mse:0.00022562967648336575, ic :0.0053218677826256024, sharpe5:0.5295530394092202, irr5:0.169743150472641, ndcg5:0.8484173734467191, pnl5:1.02902090549469 
train 15, step: 0, loss: 7.364201883319765e-05, grad_norm: 7.66296668037014e-06, ic: 0.05965240231238681
train 15, step: 500, loss: 8.345043170265853e-05, grad_norm: 3.0970424145415326e-05, ic: -0.014176418253258605
Epoch 15: 2022-05-05 22:27:49.181800: train loss: 0.00012738156494699926
Eval step 0: eval loss: 6.079475861042738e-05
Eval: 2022-05-05 22:28:07.364929: total loss: 0.00011398155488062133, mse:0.00022796311364139076, ic :0.0054949779221960034, sharpe5:0.5146398111060262, irr5:0.1652127355337143, ndcg5:0.8512625512135703, pnl5:1.0264695882797241 
train 16, step: 0, loss: 0.00010018957982538268, grad_norm: 2.1034536302821002e-05, ic: 0.08351326867365089
train 16, step: 500, loss: 9.046464401762933e-05, grad_norm: 1.1762467490920602e-05, ic: 0.03973986053364545
Epoch 16: 2022-05-05 22:29:23.999396: train loss: 0.0001275637703578867
Eval step 0: eval loss: 7.325434853555635e-05
Eval: 2022-05-05 22:29:42.868640: total loss: 0.00011522657566540671, mse:0.00023045315451642752, ic :0.0034044890545716485, sharpe5:0.6232433157786726, irr5:0.19998514652252197, ndcg5:0.8472662561127541, pnl5:1.044859528541565 
train 17, step: 0, loss: 7.65844524721615e-05, grad_norm: 9.059280232704246e-07, ic: 0.01219782910921539
train 17, step: 500, loss: 7.790144445607439e-05, grad_norm: 1.3591583628879941e-05, ic: -0.013391925440995394
Epoch 17: 2022-05-05 22:30:59.240237: train loss: 0.00012738933708504114
Eval step 0: eval loss: 7.012690184637904e-05
Eval: 2022-05-05 22:31:17.454484: total loss: 0.0001140101871877201, mse:0.00022802037776878175, ic :0.004461671761460142, sharpe5:0.5390928184613585, irr5:0.17324045300483704, ndcg5:0.8480869085699021, pnl5:1.030638337135315 
train 18, step: 0, loss: 0.00021605069923680276, grad_norm: 0.00020580664994845603, ic: 0.007979289381372085
train 18, step: 500, loss: 0.00017729196406435221, grad_norm: 0.00013280021575064167, ic: -0.03481700380048948
Epoch 18: 2022-05-05 22:32:34.373382: train loss: 0.0001268117135856923
Eval step 0: eval loss: 6.755521462764591e-05
Eval: 2022-05-05 22:32:52.326560: total loss: 0.00011324611441364439, mse:0.00022649223026457709, ic :0.004376481808881425, sharpe5:0.547196504920721, irr5:0.17578110098838806, ndcg5:0.8592017540498932, pnl5:1.03208589553833 
train 19, step: 0, loss: 0.00014229549560695887, grad_norm: 7.730608079492681e-05, ic: -0.09953758991129416
train 19, step: 500, loss: 0.00011651055683614686, grad_norm: 2.0476779421778927e-05, ic: 0.0031704161506946925
Epoch 19: 2022-05-05 22:34:10.166123: train loss: 0.00012663786745247186
Eval step 0: eval loss: 6.401324208127335e-05
Eval: 2022-05-05 22:34:27.660571: total loss: 0.00011264598613778255, mse:0.00022529197524334414, ic :0.0042785900028974, sharpe5:0.2189645688794553, irr5:0.06645103543996811, ndcg5:0.8486969257468772, pnl5:0.9750493764877319 
train 20, step: 0, loss: 0.0001118349828175269, grad_norm: 3.4110364753952896e-07, ic: -0.03656694953916775
train 20, step: 500, loss: 9.873872477328405e-05, grad_norm: 2.1830642994960054e-05, ic: -0.006756933928956318
Epoch 20: 2022-05-05 22:35:42.711814: train loss: 0.00012667123416241352
Eval step 0: eval loss: 6.409359775716439e-05
Eval: 2022-05-05 22:36:01.905988: total loss: 0.00011273161461119291, mse:0.00022546323412729353, ic :0.004615917596314489, sharpe5:0.5459953566268086, irr5:0.17396888136863708, ndcg5:0.8522917153786946, pnl5:1.0316263437271118 
train 21, step: 0, loss: 0.0001561301323818043, grad_norm: 9.899325801422556e-05, ic: -0.02405026373785103
train 21, step: 500, loss: 8.65529800648801e-05, grad_norm: 1.0525875905565689e-05, ic: 0.10276768588778434
Epoch 21: 2022-05-05 22:37:20.087300: train loss: 0.00012662811906512435
Eval step 0: eval loss: 7.193757483037189e-05
Eval: 2022-05-05 22:37:38.595766: total loss: 0.00011470543957004267, mse:0.00022941088214069414, ic :0.004138348066835717, sharpe5:0.5390929367020726, irr5:0.17324045300483704, ndcg5:0.8499550711572766, pnl5:1.0306382179260254 
train 22, step: 0, loss: 0.00014390813885256648, grad_norm: 1.5933696051448715e-05, ic: -0.014493198122323126
train 22, step: 500, loss: 0.0001113872931455262, grad_norm: 6.517464908610408e-05, ic: 0.10255128334770205
Epoch 22: 2022-05-05 22:38:55.990445: train loss: 0.000126530277059872
Eval step 0: eval loss: 6.22348889010027e-05
Eval: 2022-05-05 22:39:14.316730: total loss: 0.00011297221070330379, mse:0.00022594442451740756, ic :0.005082425822285595, sharpe5:0.5371226916834712, irr5:0.17195680737495422, ndcg5:0.8442749062372987, pnl5:1.0293383598327637 
train 23, step: 0, loss: 9.657089685788378e-05, grad_norm: 6.235937579551775e-05, ic: -0.001898619125786068
train 23, step: 500, loss: 7.127662684069946e-05, grad_norm: 9.85153901507167e-06, ic: 0.05022312210482088
Epoch 23: 2022-05-05 22:40:28.460299: train loss: 0.00012673162926022053
Eval step 0: eval loss: 6.47881388431415e-05
Eval: 2022-05-05 22:40:46.773580: total loss: 0.00011268872824242322, mse:0.0002253774607779844, ic :0.004222470039920574, sharpe5:0.266301588434726, irr5:0.08101872354745865, ndcg5:0.8526888332355765, pnl5:0.9825648665428162 
train 24, step: 0, loss: 0.00010723811283241957, grad_norm: 5.071569251328616e-06, ic: 0.0028646286783237385
train 24, step: 500, loss: 0.00018212573195341974, grad_norm: 6.536164671783857e-05, ic: -0.029178515867187248
Epoch 24: 2022-05-05 22:42:04.043779: train loss: 0.0001261763222025954
Eval step 0: eval loss: 6.621858483413234e-05
Eval: 2022-05-05 22:42:22.811269: total loss: 0.00011289990522317165, mse:0.00022579981499356135, ic :0.004966552612760892, sharpe5:0.5836965265497565, irr5:0.18688130378723145, ndcg5:0.8503223591176354, pnl5:1.0372191667556763 
train 25, step: 0, loss: 0.00010081177606480196, grad_norm: 5.8260819480588776e-05, ic: 0.05362547591633601
train 25, step: 500, loss: 8.897957013687119e-05, grad_norm: 3.639715112960162e-05, ic: 0.0068527334927654445
Epoch 25: 2022-05-05 22:43:40.014082: train loss: 0.0001265777885670046
Eval step 0: eval loss: 6.16533579886891e-05
Eval: 2022-05-05 22:43:58.997479: total loss: 0.00011321664730955716, mse:0.00022643329747048673, ic :0.004844307912638734, sharpe5:0.5924293127283453, irr5:0.18963167071342468, ndcg5:0.8556504074261825, pnl5:1.0207915306091309 
train 26, step: 0, loss: 8.326170063810423e-05, grad_norm: 1.0892522998940266e-05, ic: 0.055723428464378374
train 26, step: 500, loss: 5.1845705456798896e-05, grad_norm: 5.001303550976735e-07, ic: -0.02683110227602637
Epoch 26: 2022-05-05 22:45:16.596283: train loss: 0.00012625921109845652
Eval step 0: eval loss: 7.414176070597023e-05
Eval: 2022-05-05 22:45:35.095036: total loss: 0.00011570367418617462, mse:0.00023140735132466501, ic :0.005135077001129708, sharpe5:0.5929914882034063, irr5:0.1897577941417694, ndcg5:0.8478097854053014, pnl5:1.0209558010101318 
train 27, step: 0, loss: 9.121630864683539e-05, grad_norm: 4.0710089780454245e-06, ic: -0.04097510663978519
train 27, step: 500, loss: 0.00013637224037665874, grad_norm: 9.669461192899873e-06, ic: -0.18530901907645436
Epoch 27: 2022-05-05 22:46:53.007071: train loss: 0.00012653219656546272
Eval step 0: eval loss: 6.557798042194918e-05
Eval: 2022-05-05 22:47:10.737909: total loss: 0.00011277468198926624, mse:0.00022554936539667555, ic :0.005536464612292793, sharpe5:0.6059003590419888, irr5:0.19226419925689697, ndcg5:0.850387215482646, pnl5:1.0229452848434448 
train 28, step: 0, loss: 0.00016809346561785787, grad_norm: 1.0351816912217423e-05, ic: -0.05581345769272322
train 28, step: 500, loss: 7.876550080254674e-05, grad_norm: 1.6443237445269933e-05, ic: 0.09934491179564045
Epoch 28: 2022-05-05 22:48:22.974404: train loss: 0.0001260631910904546
Eval step 0: eval loss: 6.458101415773854e-05
Eval: 2022-05-05 22:48:41.587013: total loss: 0.00011266933444747091, mse:0.00022533867121072077, ic :0.005518363471737279, sharpe5:0.5924294900894165, irr5:0.18963167071342468, ndcg5:0.8526844987231648, pnl5:1.0207915306091309 
train 29, step: 0, loss: 0.00011530479969223961, grad_norm: 4.688828075502766e-09, ic: -0.017694590657173576
train 29, step: 500, loss: 9.592165588401258e-05, grad_norm: 4.716743779497625e-05, ic: 0.13165941654575664
Epoch 29: 2022-05-05 22:49:59.094769: train loss: 0.00012609155157678712
Eval step 0: eval loss: 6.952801049919799e-05
Eval: 2022-05-05 22:50:17.217913: total loss: 0.00011381598364985771, mse:0.00022763197081458915, ic :0.006357409478925848, sharpe5:0.5574161089584231, irr5:0.17840291559696198, ndcg5:0.8522806749128189, pnl5:1.0327569246292114 
train 30, step: 0, loss: 0.00011615500989137217, grad_norm: 1.9198288839399916e-05, ic: 0.06629226634520594
train 30, step: 500, loss: 0.0001809444511309266, grad_norm: 3.3523348081252073e-06, ic: 0.03740749485489518
Epoch 30: 2022-05-05 22:51:35.543845: train loss: 0.00012611759658688108
Eval step 0: eval loss: 7.050323620205745e-05
Eval: 2022-05-05 22:51:52.550137: total loss: 0.00011424181192877446, mse:0.0002284836288904212, ic :0.006795019403001002, sharpe5:0.3357907988503575, irr5:0.10227850824594498, ndcg5:0.8483832390884444, pnl5:0.9936096668243408 
train 31, step: 0, loss: 4.922462176182307e-05, grad_norm: 1.3183711624364891e-05, ic: 0.137306015606576
train 31, step: 500, loss: 6.461641169153154e-05, grad_norm: 2.876860872174245e-09, ic: -0.007131729274991958
Epoch 31: 2022-05-05 22:53:06.291594: train loss: 0.00012601851426430867
Eval step 0: eval loss: 6.203912198543549e-05
Eval: 2022-05-05 22:53:23.577759: total loss: 0.00011298759028254032, mse:0.0002259751832343073, ic :0.00609836944431257, sharpe5:0.33445367373526097, irr5:0.10190140455961227, ndcg5:0.8484301703013545, pnl5:0.9934061765670776 
train 32, step: 0, loss: 8.332552533829585e-05, grad_norm: 1.8215280461643077e-05, ic: 0.06981228366949944
train 32, step: 500, loss: 0.0001426728704245761, grad_norm: 5.7718031526578845e-06, ic: -0.02427647770959665
Epoch 32: 2022-05-05 22:54:37.806283: train loss: 0.00012601127534793324
Eval step 0: eval loss: 6.435215618694201e-05
Eval: 2022-05-05 22:54:56.392761: total loss: 0.00011265657341865697, mse:0.00022531314936249117, ic :0.006759558270369354, sharpe5:0.6167610642313957, irr5:0.197459414601326, ndcg5:0.8558254977862452, pnl5:1.0248758792877197 
train 33, step: 0, loss: 9.503374167252332e-05, grad_norm: 1.6221941665390366e-06, ic: 0.08890377672355604
train 33, step: 500, loss: 5.504616638063453e-05, grad_norm: 2.0091568672723318e-06, ic: -0.012817846214896723
Epoch 33: 2022-05-05 22:56:11.465833: train loss: 0.00012600543300201307
Eval step 0: eval loss: 6.697355274809524e-05
Eval: 2022-05-05 22:56:30.418637: total loss: 0.00011308722143169741, mse:0.00022617444309795795, ic :0.007579036257674402, sharpe5:0.34195684516802427, irr5:0.10417117923498154, ndcg5:0.8552620246442955, pnl5:0.9773924946784973 
train 34, step: 0, loss: 7.629772881045938e-05, grad_norm: 1.0241868598146338e-05, ic: -0.06801138173794868
train 34, step: 500, loss: 9.046524064615369e-05, grad_norm: 1.2437464412792585e-05, ic: 0.07525364452367869
Epoch 34: 2022-05-05 22:57:48.004229: train loss: 0.00012585720824889987
Eval step 0: eval loss: 6.49494759272784e-05
Eval: 2022-05-05 22:58:06.127377: total loss: 0.00011273747509321011, mse:0.00022547495487910225, ic :0.0068927812654509145, sharpe5:0.36770677579566835, irr5:0.11194141954183578, ndcg5:0.8507518802716991, pnl5:0.9815924167633057 
train 35, step: 0, loss: 0.00024948138161562383, grad_norm: 0.00026856420919432945, ic: 0.2876736938136586
train 35, step: 500, loss: 0.00018335049389861524, grad_norm: 9.688634369077443e-05, ic: -0.1507871632190559
Epoch 35: 2022-05-05 22:59:20.654627: train loss: 0.00012576599040969505
Eval step 0: eval loss: 6.384841253748164e-05
Eval: 2022-05-05 22:59:39.052635: total loss: 0.00011278784738975072, mse:0.00022557569912095735, ic :0.008128952431318413, sharpe5:0.3793790852464735, irr5:0.11544442921876907, ndcg5:0.8405266179160896, pnl5:0.9834976196289062 
train 36, step: 0, loss: 0.0002506377932149917, grad_norm: 0.0001175159619205409, ic: 0.16445290518992622
train 36, step: 500, loss: 0.00032294949050992727, grad_norm: 8.281754288979236e-05, ic: 0.07048880876855103
Epoch 36: 2022-05-05 23:00:54.464307: train loss: 0.00012571315008555982
Eval step 0: eval loss: 7.00665041222237e-05
Eval: 2022-05-05 23:01:10.479354: total loss: 0.00011401091297243531, mse:0.00022802182674393906, ic :0.007860258623514669, sharpe5:0.30246131328865883, irr5:0.09224462509155273, ndcg5:0.8583694457821907, pnl5:0.9881570339202881 
train 37, step: 0, loss: 0.00018809313769452274, grad_norm: 0.0001905752320291332, ic: 0.31996628172335756
train 37, step: 500, loss: 9.695773769635707e-05, grad_norm: 2.1922115133496698e-05, ic: 0.049911906219307356
Epoch 37: 2022-05-05 23:02:22.780687: train loss: 0.00012589087608426915
Eval step 0: eval loss: 6.658826168859378e-05
Eval: 2022-05-05 23:02:39.443894: total loss: 0.00011294726646473778, mse:0.0002258945382584372, ic :0.007773193499949163, sharpe5:0.3592298920825124, irr5:0.10969165712594986, ndcg5:0.8493237036228951, pnl5:0.9800505638122559 
train 38, step: 0, loss: 9.364200377603993e-05, grad_norm: 5.563734146886863e-06, ic: -0.04346772670382067
train 38, step: 500, loss: 0.00015140059986151755, grad_norm: 3.768445307196091e-06, ic: 0.0558263280981736
Epoch 38: 2022-05-05 23:03:51.495097: train loss: 0.00012566566462791183
Eval step 0: eval loss: 6.32525043329224e-05
Eval: 2022-05-05 23:04:08.085550: total loss: 0.00011268339487017381, mse:0.0002253667908499668, ic :0.006862214730037176, sharpe5:0.39157254064455627, irr5:0.11887326091527939, ndcg5:0.8512470924330469, pnl5:1.0026203393936157 
train 39, step: 0, loss: 0.00018866712343879044, grad_norm: 0.00014654765855353857, ic: 0.24021246051667586
train 39, step: 500, loss: 0.0001236968964803964, grad_norm: 2.1697147102558435e-05, ic: -0.25055326178683657
Epoch 39: 2022-05-05 23:05:21.246331: train loss: 0.00012567876014544257
Eval step 0: eval loss: 6.677196506643668e-05
Eval: 2022-05-05 23:05:38.130017: total loss: 0.00011298473804361007, mse:0.00022596947823628861, ic :0.008457112561083814, sharpe5:0.37430380951613185, irr5:0.11387716978788376, ndcg5:0.8532470974740485, pnl5:0.9826921820640564 
train 40, step: 0, loss: 0.00010322238085791469, grad_norm: 4.92303937449629e-06, ic: 0.07333205155606773
train 40, step: 500, loss: 0.0001617114176042378, grad_norm: 9.866094036916375e-06, ic: 0.10112437055410209
Epoch 40: 2022-05-05 23:06:49.962157: train loss: 0.00012585475475319262
Eval step 0: eval loss: 6.434352690121159e-05
Eval: 2022-05-05 23:07:06.079789: total loss: 0.0001126762401732244, mse:0.00022535248364444698, ic :0.008884943460781818, sharpe5:0.4137302296981215, irr5:0.12558066844940186, ndcg5:0.8503941238532964, pnl5:0.9888030886650085 
train 41, step: 0, loss: 6.037014100002125e-05, grad_norm: 4.6465017262248934e-07, ic: 0.02490519705150125
train 41, step: 500, loss: 0.00011178032582392916, grad_norm: 3.559305852351983e-05, ic: -0.26722251807030645
Epoch 41: 2022-05-05 23:08:18.076178: train loss: 0.0001256604894717413
Eval step 0: eval loss: 6.870027573313564e-05
Eval: 2022-05-05 23:08:34.234638: total loss: 0.00011359543715795302, mse:0.00022719087994859093, ic :0.009649947153086936, sharpe5:0.3902076289616525, irr5:0.11918053776025772, ndcg5:0.8560576689686666, pnl5:0.9851527214050293 
train 42, step: 0, loss: 4.5870867324993014e-05, grad_norm: 8.614986805799e-06, ic: 0.07493731334222298
train 42, step: 500, loss: 0.00015418091788887978, grad_norm: 8.999521777245601e-06, ic: 0.028547465390125402
Epoch 42: 2022-05-05 23:09:42.609843: train loss: 0.00012562265253697713
Eval step 0: eval loss: 6.748212763341144e-05
Eval: 2022-05-05 23:09:57.872803: total loss: 0.00011316388408250814, mse:0.00022632777114748204, ic :0.008776726813416603, sharpe5:0.47169977942481633, irr5:0.1441010981798172, ndcg5:0.8507913872681689, pnl5:0.9980780482292175 
train 43, step: 0, loss: 6.968082016101107e-05, grad_norm: 3.3372905654348203e-06, ic: -0.06441290810778075
train 43, step: 500, loss: 0.00015711986634414643, grad_norm: 0.00017465160613857407, ic: -0.10167823402977688
Epoch 43: 2022-05-05 23:11:08.164386: train loss: 0.00012575303912732406
Eval step 0: eval loss: 6.519405724247918e-05
Eval: 2022-05-05 23:11:25.036501: total loss: 0.00011271741435665833, mse:0.00022543483266069446, ic :0.008646033061288949, sharpe5:0.40537093637511135, irr5:0.12307243794202805, ndcg5:0.8516721183501177, pnl5:1.0049854516983032 
train 44, step: 0, loss: 0.00011524328147061169, grad_norm: 2.4751725195102e-08, ic: -0.03672877326735895
train 44, step: 500, loss: 0.0001976142666535452, grad_norm: 8.93533775315134e-05, ic: 0.3739238587044359
Epoch 44: 2022-05-05 23:12:36.966722: train loss: 0.0001256206083187493
Eval step 0: eval loss: 6.268522702157497e-05
Eval: 2022-05-05 23:12:53.121427: total loss: 0.00011277333914615441, mse:0.00022554668169019867, ic :0.00989981267685751, sharpe5:0.7113941920548678, irr5:0.22912126779556274, ndcg5:0.8460187807439636, pnl5:1.024429440498352 
train 45, step: 0, loss: 0.00021089469373691827, grad_norm: 2.2955528326431116e-05, ic: -0.04561044465965158
train 45, step: 500, loss: 0.00010758861026261002, grad_norm: 7.079201704486832e-07, ic: 0.005984526393969472
Epoch 45: 2022-05-05 23:14:02.522530: train loss: 0.00012572343431605852
Eval step 0: eval loss: 6.427092739613727e-05
Eval: 2022-05-05 23:14:18.662735: total loss: 0.00011269722637028014, mse:0.00022539445732987933, ic :0.008913274665337628, sharpe5:0.40432480165734885, irr5:0.1234460398554802, ndcg5:0.8599881499517699, pnl5:0.9875912666320801 
train 46, step: 0, loss: 0.0001013096552924253, grad_norm: 3.056735112397639e-05, ic: 0.18879345444394657
train 46, step: 500, loss: 5.037266600993462e-05, grad_norm: 4.67934017225977e-06, ic: 0.1601900253686662
Epoch 46: 2022-05-05 23:15:29.221112: train loss: 0.0001256532358915877
Eval step 0: eval loss: 6.475909322034568e-05
Eval: 2022-05-05 23:15:45.161965: total loss: 0.00011270372499190739, mse:0.0002254074519201383, ic :0.009299126297630706, sharpe5:0.4156565778516233, irr5:0.12692958116531372, ndcg5:0.864434983577524, pnl5:0.9893752932548523 
train 47, step: 0, loss: 9.03168911463581e-05, grad_norm: 2.436361347354348e-05, ic: 0.19924365908852015
train 47, step: 500, loss: 9.779928222997114e-05, grad_norm: 2.9954332566764664e-06, ic: 0.1419225548971102
Epoch 47: 2022-05-05 23:16:53.301646: train loss: 0.0001256702307582211
Eval step 0: eval loss: 6.521357863675803e-05
Eval: 2022-05-05 23:17:10.806122: total loss: 0.00011280009288996088, mse:0.0002256001918469001, ic :0.009962281396822719, sharpe5:0.40940465921536084, irr5:0.12482348829507828, ndcg5:0.8458300760571735, pnl5:1.005954623222351 
train 48, step: 0, loss: 0.0001885541423689574, grad_norm: 5.934029710654523e-05, ic: -0.09154974988051631
train 48, step: 500, loss: 9.080620657186955e-05, grad_norm: 1.0341614775522195e-05, ic: -0.07590582429507092
Epoch 48: 2022-05-05 23:18:23.336396: train loss: 0.00012560504269628988
Eval step 0: eval loss: 6.147357635200024e-05
Eval: 2022-05-05 23:18:39.535090: total loss: 0.00011326927586784485, mse:0.000226538557871886, ic :0.008770767503519622, sharpe5:0.4820629572495818, irr5:0.15070119500160217, ndcg5:0.8484497913394392, pnl5:1.0166903734207153 
train 49, step: 0, loss: 0.00011705871293088421, grad_norm: 8.600872896374057e-07, ic: -0.20154732609309617
train 49, step: 500, loss: 5.3193940402707085e-05, grad_norm: 4.101588724727631e-06, ic: 0.11172673130247318
Epoch 49: 2022-05-05 23:19:49.445279: train loss: 0.00012560519667325653
Eval step 0: eval loss: 6.344664870994166e-05
Eval: 2022-05-05 23:20:06.255180: total loss: 0.00011265897116441824, mse:0.00022531794564886978, ic :0.009373577612231872, sharpe5:0.558288429826498, irr5:0.173379585146904, ndcg5:0.851781669848625, pnl5:1.011857271194458 
train 50, step: 0, loss: 0.00014831624866928905, grad_norm: 1.2867051934734671e-05, ic: 0.2489021911237527
train 50, step: 500, loss: 9.242897795047611e-05, grad_norm: 6.025541522219695e-06, ic: 0.03934099930273949
Epoch 50: 2022-05-05 23:21:19.673417: train loss: 0.00012563673180677706
Eval step 0: eval loss: 6.4750638557598e-05
Eval: 2022-05-05 23:21:35.814294: total loss: 0.00011263625900854364, mse:0.00022527252293162836, ic :0.005965599862805376, sharpe5:0.42786558190360663, irr5:0.130874365568161, ndcg5:0.8498746275242333, pnl5:0.9911751747131348 
train 51, step: 0, loss: 8.950125629780814e-05, grad_norm: 2.8288008001418715e-05, ic: 0.08210421696975019
train 51, step: 500, loss: 0.0001254252129001543, grad_norm: 1.279584266200637e-05, ic: -0.06849835825497069
Epoch 51: 2022-05-05 23:22:45.150376: train loss: 0.00012562694894131224
Eval step 0: eval loss: 6.492091779364273e-05
Eval: 2022-05-05 23:23:01.487745: total loss: 0.00011271734320160559, mse:0.00022543468998896283, ic :0.008362341592542172, sharpe5:0.6077277101576328, irr5:0.18733295798301697, ndcg5:0.8615870613131296, pnl5:1.0027029514312744 
train 52, step: 0, loss: 8.385854016523808e-05, grad_norm: 1.5304827147993905e-05, ic: 0.11359844128036672
train 52, step: 500, loss: 0.00025087088579311967, grad_norm: 8.186811373413432e-05, ic: -0.052868418449683645
Epoch 52: 2022-05-05 23:24:12.031051: train loss: 0.00012562142185932823
Eval step 0: eval loss: 6.230956205399707e-05
Eval: 2022-05-05 23:24:29.409585: total loss: 0.00011286604463216324, mse:0.00022573209446402948, ic :0.008787566320237469, sharpe5:0.4209101310186088, irr5:0.13330253958702087, ndcg5:0.8569493900857352, pnl5:0.98967444896698 
train 53, step: 0, loss: 0.00012611837883014232, grad_norm: 4.3231132233839594e-05, ic: -0.06146155344226792
train 53, step: 500, loss: 9.384121949551627e-05, grad_norm: 9.074287074014034e-06, ic: -0.06867036543148616
Epoch 53: 2022-05-05 23:25:44.604757: train loss: 0.000125600880756126
Eval step 0: eval loss: 6.625524838455021e-05
Eval: 2022-05-05 23:26:01.974061: total loss: 0.0001129212784122088, mse:0.0002258425601028749, ic :0.01075609937628622, sharpe5:0.3988501383550465, irr5:0.12159615755081177, ndcg5:0.8493912190663491, pnl5:1.0039817094802856 
train 54, step: 0, loss: 0.00010722542356234044, grad_norm: 3.3631390820997076e-05, ic: 0.10271016983652373
train 54, step: 500, loss: 8.046387665672228e-05, grad_norm: 5.539478522697778e-06, ic: 0.07425108473284014
Epoch 54: 2022-05-05 23:27:17.394097: train loss: 0.00012570357595156084
Eval step 0: eval loss: 6.756714719813317e-05
Eval: 2022-05-05 23:27:34.946002: total loss: 0.00011318970617012622, mse:0.0002263794153733814, ic :0.008934203909470518, sharpe5:0.5901245056092739, irr5:0.18201404809951782, ndcg5:0.8649921960770748, pnl5:0.9997197985649109 
train 55, step: 0, loss: 6.249480065889657e-05, grad_norm: 9.73096746165352e-07, ic: 0.08831914269792643
train 55, step: 500, loss: 0.00020321054034866393, grad_norm: 5.943723567715861e-06, ic: 0.23022924212395768
Epoch 55: 2022-05-05 23:28:50.022290: train loss: 0.00012565189574871281
Eval step 0: eval loss: 6.407286127796397e-05
Eval: 2022-05-05 23:29:09.002671: total loss: 0.00011262116279449481, mse:0.00022524233063657076, ic :0.008281039006238293, sharpe5:0.4564256213419139, irr5:0.14348673820495605, ndcg5:0.8459820997820399, pnl5:0.9952080845832825 
train 56, step: 0, loss: 9.948441584128886e-05, grad_norm: 2.1655272988131844e-05, ic: 0.0927654742266812
train 56, step: 500, loss: 0.00011123400327051058, grad_norm: 1.3046973919285526e-06, ic: 0.12565833231551077
Epoch 56: 2022-05-05 23:30:26.664038: train loss: 0.00012562703135028671
Eval step 0: eval loss: 6.560532347066328e-05
Eval: 2022-05-05 23:30:43.931215: total loss: 0.00011275554493394493, mse:0.00022551109481246283, ic :0.008293510716343362, sharpe5:0.5082296272739768, irr5:0.15793567895889282, ndcg5:0.8548321041976555, pnl5:1.003631353378296 
train 57, step: 0, loss: 9.765155846253037e-05, grad_norm: 3.2083631598051885e-05, ic: -0.1407863046276749
train 57, step: 500, loss: 0.00016971952572930604, grad_norm: 6.184231292554364e-07, ic: -0.007465737068945224
Epoch 57: 2022-05-05 23:31:51.390640: train loss: 0.00012567467110589947
Eval step 0: eval loss: 6.444004975492135e-05
Eval: 2022-05-05 23:32:05.523380: total loss: 0.00011266924387927363, mse:0.00022533849271835234, ic :0.007315707433445383, sharpe5:0.36039527256041765, irr5:0.11432261019945145, ndcg5:0.8513856591960239, pnl5:0.9973104596138 
train 58, step: 0, loss: 0.00014066278527025133, grad_norm: 0.0001043709361133981, ic: 0.1711095635317968
train 58, step: 500, loss: 5.4312844440573826e-05, grad_norm: 1.2791722417077643e-05, ic: 0.17165359373240885
Epoch 58: 2022-05-05 23:33:09.082796: train loss: 0.00012563034615693097
Eval step 0: eval loss: 6.580154877156019e-05
Eval: 2022-05-05 23:33:23.124962: total loss: 0.00011284568912400986, mse:0.00022569138173851176, ic :0.008980070363429273, sharpe5:0.33442381795495746, irr5:0.10634389519691467, ndcg5:0.8583405302060003, pnl5:0.9931374192237854 
train 59, step: 0, loss: 7.833520794520155e-05, grad_norm: 7.736496643439958e-06, ic: 0.15888284698843977
train 59, step: 500, loss: 4.321778396843001e-05, grad_norm: 3.2979945468412265e-06, ic: 0.07569551014215248
Epoch 59: 2022-05-05 23:34:27.035995: train loss: 0.00012552266168269736
Eval step 0: eval loss: 6.568482058355585e-05
Eval: 2022-05-05 23:34:41.486484: total loss: 0.00011279423455260369, mse:0.00022558847337785757, ic :0.008102071307594168, sharpe5:0.491009581759572, irr5:0.15321648120880127, ndcg5:0.8539410703617956, pnl5:1.0182098150253296 
