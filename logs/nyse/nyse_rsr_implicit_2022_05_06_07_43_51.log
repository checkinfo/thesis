Namespace(adj_path='../Temporal_Relational_Stock_Ranking/data/relation/sector_industry/NYSE_industry_relation.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=1, dataset_type='NASDAQTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=False, label_cnt=1, lr=0.001, lstm_layers=1, market='NYSE', mask_adj=False, mask_type='soft', model_type='ReRaLSTM', normalize_adj=False, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1737, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=False)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
relation encoding shape: torch.Size([1737, 1737, 108]) torch.float32
relation mask shape: torch.Size([1737, 1737]) torch.float32
88105
ReRaLSTM(
  (rnn1): LSTM(5, 128, batch_first=True, dropout=0.3, bidirectional=True)
  (fc0): Linear(in_features=256, out_features=128, bias=True)
  (fc1): Linear(in_features=108, out_features=1, bias=True)
  (fc2): Linear(in_features=128, out_features=1, bias=True)
  (fc3): Linear(in_features=128, out_features=1, bias=True)
  (predict): Linear(in_features=256, out_features=1, bias=True)
  (relu): LeakyReLU(negative_slope=0.01)
  (dropout): Dropout(p=0.3, inplace=False)
)
train 0, step: 0, loss: 0.00011516037920955569, grad_norm: 5.1815583205451396e-11, ic: -0.021819092348144255
train 0, step: 500, loss: 7.017673488007858e-05, grad_norm: 7.957463418151521e-10, ic: 0.0556418700731864
Epoch 0: 2022-05-06 19:46:28.008187: train loss: 0.00012585525554432072
Eval step 0: eval loss: 6.628751725656912e-05
Eval: 2022-05-06 19:46:31.126779: total loss: 0.00011282821775461836, mse:0.00022565643766629136, ic :0.00654234408942372, sharpe5:0.3771048729121685, irr5:0.05227765068411827, ndcg5:0.8476002027196629, pnl5:1.0739103555679321 
train 1, step: 0, loss: 9.417119872523472e-05, grad_norm: 4.436414263820531e-09, ic: -0.00017190352436624763
train 1, step: 500, loss: 9.039079304784536e-05, grad_norm: 3.88433682868003e-09, ic: -0.010836271211286542
Epoch 1: 2022-05-06 19:46:40.640304: train loss: 0.00012585240832495255
Eval step 0: eval loss: 6.605865200981498e-05
Eval: 2022-05-06 19:46:43.663993: total loss: 0.0001127871941898616, mse:0.00022557439247386152, ic :0.011253674981202874, sharpe5:0.1698232699278742, irr5:0.043052636086940765, ndcg5:0.8552577879683408, pnl5:1.0929125547409058 
train 2, step: 0, loss: 8.021033136174083e-05, grad_norm: 4.5225798522818456e-10, ic: -0.00021562281663248077
train 2, step: 500, loss: 7.15872592991218e-05, grad_norm: 5.544546182008822e-11, ic: -0.0015105081354320074
Epoch 2: 2022-05-06 19:46:53.071596: train loss: 0.0001257827328161628
Eval step 0: eval loss: 6.678030331386253e-05
Eval: 2022-05-06 19:46:55.922533: total loss: 0.00011292549015905334, mse:0.00022585098590405736, ic :0.01047699774421501, sharpe5:0.4138446867093444, irr5:0.05796784162521362, ndcg5:0.852021900059516, pnl5:1.0218003988265991 
train 3, step: 0, loss: 0.00010275660315528512, grad_norm: 4.337037179429385e-11, ic: 0.026095878091053494
train 3, step: 500, loss: 0.00012881404836662114, grad_norm: 3.9853165548453856e-09, ic: -0.013185549811187608
Epoch 3: 2022-05-06 19:47:05.412381: train loss: 0.00012576812078673915
Eval step 0: eval loss: 6.674527685390785e-05
Eval: 2022-05-06 19:47:08.455961: total loss: 0.00011291830106811215, mse:0.00022583660813554063, ic :0.002454358610357615, sharpe5:0.10243727360386401, irr5:0.03241218253970146, ndcg5:0.8533778900529198, pnl5:1.062095046043396 
train 4, step: 0, loss: 7.421923510264605e-05, grad_norm: 7.789611723527667e-11, ic: -0.0066569791480305795
train 4, step: 500, loss: 8.028766751522198e-05, grad_norm: 8.329499110440755e-10, ic: 0.007379575945724534
Epoch 4: 2022-05-06 19:47:17.954562: train loss: 0.00012571452786789723
Eval step 0: eval loss: 6.62333332002163e-05
Eval: 2022-05-06 19:47:20.977758: total loss: 0.00011281844940024842, mse:0.00022563690309373733, ic :0.000348486760119211, sharpe5:0.1116339254938066, irr5:0.03523509204387665, ndcg5:0.8499340196664537, pnl5:1.0273011922836304 
train 5, step: 0, loss: 0.00016568033606745303, grad_norm: 1.1736931385547314e-08, ic: 0.0913312066977664
train 5, step: 500, loss: 0.00048217622679658234, grad_norm: 5.103233231651342e-08, ic: -0.11985113422347206
Epoch 5: 2022-05-06 19:47:30.546078: train loss: 0.00012567196303435706
Eval step 0: eval loss: 6.57972414046526e-05
Eval: 2022-05-06 19:47:33.476513: total loss: 0.00011274674283627798, mse:0.0002254934897158368, ic :0.0059763996505762355, sharpe5:0.9187399849668145, irr5:0.2183690220117569, ndcg5:0.8488821974904072, pnl5:1.1718025207519531 
train 6, step: 0, loss: 8.19726919871755e-05, grad_norm: 8.955857897233461e-10, ic: 0.08209996908902016
train 6, step: 500, loss: 7.794795965310186e-05, grad_norm: 2.670695399020596e-09, ic: -0.04945147012931955
Epoch 6: 2022-05-06 19:47:42.853320: train loss: 0.0001256364743857312
Eval step 0: eval loss: 6.555864820256829e-05
Eval: 2022-05-06 19:47:45.826687: total loss: 0.00011271345005591814, mse:0.00022542690435072184, ic :0.0019232954641884732, sharpe5:1.050894379466772, irr5:0.2845022678375244, ndcg5:0.8452278704221727, pnl5:1.2270888090133667 
train 7, step: 0, loss: 9.844800661085173e-05, grad_norm: 3.414477705052817e-13, ic: 0.022503259090553073
train 7, step: 500, loss: 0.00020115950610488653, grad_norm: 5.546103443893701e-10, ic: -0.06155928291364321
Epoch 7: 2022-05-06 19:47:55.123913: train loss: 0.00012570304308493776
Eval step 0: eval loss: 6.635355384787545e-05
Eval: 2022-05-06 19:47:58.144942: total loss: 0.00011283989013813225, mse:0.00022567978541430687, ic :0.010821097250047216, sharpe5:0.9508311650902033, irr5:0.2863815128803253, ndcg5:0.8532014618741321, pnl5:1.0474567413330078 
train 8, step: 0, loss: 9.153715654974803e-05, grad_norm: 7.264563326976393e-10, ic: 0.08536375492588288
train 8, step: 500, loss: 8.137795521179214e-05, grad_norm: 1.5472923480682554e-11, ic: -0.02750124231000263
Epoch 8: 2022-05-06 19:48:07.830759: train loss: 0.00012570432147458147
Eval step 0: eval loss: 6.633507291553542e-05
Eval: 2022-05-06 19:48:10.837929: total loss: 0.00011283681657029047, mse:0.00022567363583129825, ic :0.004424265456754137, sharpe5:0.4654698831215501, irr5:0.1504162847995758, ndcg5:0.8494232827932134, pnl5:1.0893423557281494 
train 9, step: 0, loss: 0.00011662241740850732, grad_norm: 7.237715782595278e-10, ic: -0.01353757387884786
train 9, step: 500, loss: 5.29017488588579e-05, grad_norm: 3.541395325884959e-10, ic: 0.014313416834138556
Epoch 9: 2022-05-06 19:48:20.203161: train loss: 0.0001256641277520921
Eval step 0: eval loss: 6.58141725580208e-05
Eval: 2022-05-06 19:48:23.236130: total loss: 0.00011274869325362333, mse:0.00022549738912871646, ic :0.01590343615862107, sharpe5:0.33986374804750086, irr5:0.11473508179187775, ndcg5:0.859545016224253, pnl5:0.995104968547821 
train 10, step: 0, loss: 5.2885130571667105e-05, grad_norm: 1.2996103886240087e-09, ic: 0.020839934681667407
train 10, step: 500, loss: 0.00013281585415825248, grad_norm: 5.2750640884266404e-09, ic: 0.10781657615784652
Epoch 10: 2022-05-06 19:48:32.823431: train loss: 0.00012622443184597085
Eval step 0: eval loss: 6.787920574424788e-05
Eval: 2022-05-06 19:48:35.822960: total loss: 0.00011319396996071998, mse:0.00022638794430185816, ic :0.0033352143722097994, sharpe5:0.2784935658238828, irr5:0.08974705636501312, ndcg5:0.8540482277819242, pnl5:1.092854619026184 
train 11, step: 0, loss: 9.586306987330317e-05, grad_norm: 4.5452251053129426e-11, ic: -0.005005615901223373
train 11, step: 500, loss: 8.550429629394785e-05, grad_norm: 3.7428557661857935e-10, ic: -0.012297891023976867
Epoch 11: 2022-05-06 19:48:45.121086: train loss: 0.00012598631611401414
Eval step 0: eval loss: 6.8199573433958e-05
Eval: 2022-05-06 19:48:48.036739: total loss: 0.00011328245332608442, mse:0.00022656491176251193, ic :0.004014307995851397, sharpe5:0.4210200062021613, irr5:0.12905925512313843, ndcg5:0.8500118510123642, pnl5:0.9892774820327759 
train 12, step: 0, loss: 8.154800161719322e-05, grad_norm: 3.8262325486961813e-10, ic: -0.1112896737656249
train 12, step: 500, loss: 8.048453310038894e-05, grad_norm: 5.802870357080431e-10, ic: 0.04271578884065912
Epoch 12: 2022-05-06 19:48:57.488667: train loss: 0.00012589001408269983
Eval step 0: eval loss: 6.656590267084539e-05
Eval: 2022-05-06 19:49:00.553134: total loss: 0.00011287958790585257, mse:0.00022575918112249056, ic :0.0006701763259117928, sharpe5:0.49898083861917253, irr5:0.16684900224208832, ndcg5:0.8623946028651053, pnl5:0.970249354839325 
train 13, step: 0, loss: 8.18528060335666e-05, grad_norm: 1.3089080790701285e-09, ic: 0.02023231473531608
train 13, step: 500, loss: 6.186713289935142e-05, grad_norm: 1.2454088256753885e-10, ic: -0.001372874655689079
Epoch 13: 2022-05-06 19:49:09.996914: train loss: 0.00012574315120306216
Eval step 0: eval loss: 6.662041414529085e-05
Eval: 2022-05-06 19:49:13.003184: total loss: 0.00011289222042981686, mse:0.00022578444462485956, ic :0.005447441547911648, sharpe5:0.2642880081944167, irr5:0.08457092195749283, ndcg5:0.8523514396195603, pnl5:1.0907511711120605 
train 14, step: 0, loss: 9.846212924458086e-05, grad_norm: 7.288424301223986e-12, ic: 0.027640172902956596
train 14, step: 500, loss: 0.00011715295840986073, grad_norm: 8.809847705016826e-10, ic: -0.020807417658881566
Epoch 14: 2022-05-06 19:49:22.276053: train loss: 0.00012571842817026707
Eval step 0: eval loss: 6.610554555663839e-05
Eval: 2022-05-06 19:49:25.283726: total loss: 0.00011279519726664609, mse:0.00022559039889029817, ic :0.0069253179408682855, sharpe5:0.3915877641364932, irr5:0.12786640226840973, ndcg5:0.8585033528970354, pnl5:1.1144181489944458 
train 15, step: 0, loss: 7.700489368289709e-05, grad_norm: 1.6119029711637422e-09, ic: -0.052212870499831324
train 15, step: 500, loss: 8.28107658890076e-05, grad_norm: 3.281555503353256e-09, ic: 0.06075883949393385
Epoch 15: 2022-05-06 19:49:34.674939: train loss: 0.00012574221946708085
Eval step 0: eval loss: 6.733199552400038e-05
Eval: 2022-05-06 19:49:37.692303: total loss: 0.0001130538900156849, mse:0.000226107786036729, ic :0.00580345979801322, sharpe5:0.403306305706501, irr5:0.13032041490077972, ndcg5:0.8571030561357464, pnl5:1.1571866273880005 
train 16, step: 0, loss: 0.0001150276220869273, grad_norm: 5.031283908249729e-09, ic: 0.03839525215192393
train 16, step: 500, loss: 9.366276935907081e-05, grad_norm: 2.1411973851209415e-09, ic: 0.0162810096898657
Epoch 16: 2022-05-06 19:49:47.111355: train loss: 0.00012627703874123862
Eval step 0: eval loss: 6.753698107786477e-05
Eval: 2022-05-06 19:49:49.998853: total loss: 0.0001131025092353725, mse:0.00022620501993073387, ic :0.010802426175172429, sharpe5:0.7118776192143559, irr5:0.1761275678873062, ndcg5:0.849660363746935, pnl5:1.0960992574691772 
train 17, step: 0, loss: 7.775483391014859e-05, grad_norm: 4.889744814308543e-10, ic: 0.0008250111721671231
train 17, step: 500, loss: 7.60604816605337e-05, grad_norm: 1.2959052382674663e-09, ic: -0.024299888845752654
Epoch 17: 2022-05-06 19:49:59.301744: train loss: 0.00012583049507633462
Eval step 0: eval loss: 6.697702337987721e-05
Eval: 2022-05-06 19:50:02.179858: total loss: 0.00011296799752668592, mse:0.00022593599921658043, ic :0.013465730232653302, sharpe5:-0.2692291398346424, irr5:-0.08479449152946472, ndcg5:0.8622133232388686, pnl5:0.9480469226837158 
train 18, step: 0, loss: 0.00020480556122493, grad_norm: 2.034114295944104e-08, ic: -0.013348967542751455
train 18, step: 500, loss: 0.0001761049934430048, grad_norm: 1.374720887374135e-08, ic: -0.009646508021535627
Epoch 18: 2022-05-06 19:50:11.402496: train loss: 0.0001259338905048721
Eval step 0: eval loss: 6.735435454174876e-05
Eval: 2022-05-06 19:50:14.044739: total loss: 0.00011305736616003737, mse:0.00022611473856534131, ic :0.008653291217420336, sharpe5:0.18629264948889612, irr5:0.06059262156486511, ndcg5:0.852260690975394, pnl5:0.987495481967926 
train 19, step: 0, loss: 0.00013807388313580304, grad_norm: 7.833607052542575e-09, ic: -0.021808441536102924
train 19, step: 500, loss: 0.00012033552047796547, grad_norm: 3.032193669953392e-09, ic: 0.0026719230147164994
Epoch 19: 2022-05-06 19:50:23.393180: train loss: 0.00012578860508786317
Eval step 0: eval loss: 6.75778355798684e-05
Eval: 2022-05-06 19:50:26.564889: total loss: 0.00011311635598639437, mse:0.00022623271523194275, ic :0.007326102633967482, sharpe5:0.5250116500630975, irr5:0.17320133745670319, ndcg5:0.8591262595808512, pnl5:1.0098376274108887 
train 20, step: 0, loss: 0.00011063758574891835, grad_norm: 2.989965664707682e-11, ic: -0.05798291108140774
train 20, step: 500, loss: 9.831849456531927e-05, grad_norm: 2.466513535595517e-09, ic: -0.0023943991300383657
Epoch 20: 2022-05-06 19:50:36.051767: train loss: 0.0001257596047258037
Eval step 0: eval loss: 6.683198444079608e-05
Eval: 2022-05-06 19:50:38.849586: total loss: 0.00011293788618262243, mse:0.00022587577714591682, ic :0.009761700138639452, sharpe5:0.583395190089941, irr5:0.19844204187393188, ndcg5:0.8527312727058537, pnl5:0.9842775464057922 
train 21, step: 0, loss: 0.00014823200763203204, grad_norm: 9.03986699942274e-09, ic: -0.07371305403606876
train 21, step: 500, loss: 9.378568211104721e-05, grad_norm: 5.845851068245287e-09, ic: 0.07246416763804668
Epoch 21: 2022-05-06 19:50:48.054523: train loss: 0.0001257187704807275
Eval step 0: eval loss: 6.63511164020747e-05
Eval: 2022-05-06 19:50:51.028866: total loss: 0.0001128394287343922, mse:0.00022567886112602725, ic :0.01170112692593267, sharpe5:0.6399575275182724, irr5:0.2074694186449051, ndcg5:0.8568063845154409, pnl5:0.9739676117897034 
train 22, step: 0, loss: 0.0001391516998410225, grad_norm: 7.817262019159347e-10, ic: -0.02343552477536653
train 22, step: 500, loss: 0.00012380248517729342, grad_norm: 9.612937824764393e-09, ic: 0.005785148597484117
Epoch 22: 2022-05-06 19:51:00.360568: train loss: 0.0001257237681297957
Eval step 0: eval loss: 6.64026229060255e-05
Eval: 2022-05-06 19:51:03.360533: total loss: 0.00011284913996137439, mse:0.00022569828538443479, ic :0.011725948672769434, sharpe5:0.8771306047216058, irr5:0.3100031316280365, ndcg5:0.8502640994911363, pnl5:1.053018569946289 
train 23, step: 0, loss: 8.491065818816423e-05, grad_norm: 4.197065128766644e-09, ic: -0.05100446215171552
train 23, step: 500, loss: 7.986167474882677e-05, grad_norm: 2.73369649406503e-09, ic: 0.06567217871999767
Epoch 23: 2022-05-06 19:51:12.788168: train loss: 0.00012595347081203502
Eval step 0: eval loss: 6.742487312294543e-05
Eval: 2022-05-06 19:51:15.639761: total loss: 0.00011307456201210814, mse:0.00022614912790982217, ic :0.0190720386349938, sharpe5:0.6079481108486652, irr5:0.19943645596504211, ndcg5:0.8481797317261517, pnl5:1.039426326751709 
train 24, step: 0, loss: 0.00010886873496929184, grad_norm: 9.490163405886227e-10, ic: 0.07273035140848302
train 24, step: 500, loss: 0.0001730738440528512, grad_norm: 5.005473701555918e-09, ic: -0.027038734286018218
Epoch 24: 2022-05-06 19:51:25.124320: train loss: 0.000125815872872243
Eval step 0: eval loss: 6.706110434606671e-05
Eval: 2022-05-06 19:51:28.162134: total loss: 0.00011298751493348582, mse:0.00022597503519914848, ic :0.00739624524044896, sharpe5:0.5382862985506653, irr5:0.18337124586105347, ndcg5:0.8516232354627918, pnl5:1.0851532220840454 
train 25, step: 0, loss: 0.00010382903565187007, grad_norm: 6.708707136137323e-09, ic: 0.03873241131613962
train 25, step: 500, loss: 8.919987158151343e-05, grad_norm: 4.134788448948262e-09, ic: 0.028941717722624043
Epoch 25: 2022-05-06 19:51:37.672689: train loss: 0.0001257579384391015
Eval step 0: eval loss: 6.633805605815724e-05
Eval: 2022-05-06 19:51:40.767294: total loss: 0.00011283802526889117, mse:0.00022567605327002732, ic :0.007389453355377047, sharpe5:0.3005122333578765, irr5:0.0964532271027565, ndcg5:0.8539896751256764, pnl5:0.9883246421813965 
train 26, step: 0, loss: 9.0533729235176e-05, grad_norm: 2.7086612256813156e-09, ic: 0.012294004913894721
train 26, step: 500, loss: 5.315233283909038e-05, grad_norm: 4.294988779119875e-10, ic: -0.0440521985495805
Epoch 26: 2022-05-06 19:51:50.086698: train loss: 0.00012567296544342666
Eval step 0: eval loss: 6.657643098151311e-05
Eval: 2022-05-06 19:51:53.158533: total loss: 0.00011288434102842544, mse:0.00022576868676676046, ic :0.005265699964010169, sharpe5:0.46416663397103547, irr5:0.1512734293937683, ndcg5:0.8541868404375139, pnl5:0.9649261236190796 
train 27, step: 0, loss: 9.553506242809817e-05, grad_norm: 1.4664266191440938e-09, ic: -0.04021956405461339
train 27, step: 500, loss: 0.00013591245806310326, grad_norm: 1.3926631507104243e-09, ic: -0.08337476896140432
Epoch 27: 2022-05-06 19:52:02.570113: train loss: 0.00012568378007469917
Eval step 0: eval loss: 6.700747326249257e-05
Eval: 2022-05-06 19:52:05.577018: total loss: 0.00011297639827109267, mse:0.00022595279970860147, ic :0.004515068031510469, sharpe5:0.427820147909224, irr5:0.13962385058403015, ndcg5:0.8510347163316577, pnl5:1.0281182527542114 
train 28, step: 0, loss: 0.00016865358338691294, grad_norm: 1.3319228127100573e-09, ic: -0.03754419670244906
train 28, step: 500, loss: 7.750172517262399e-05, grad_norm: 1.3778456315614136e-09, ic: -0.018392662981137224
Epoch 28: 2022-05-06 19:52:15.244206: train loss: 0.00012572133944821663
Eval step 0: eval loss: 6.578418833669275e-05
Eval: 2022-05-06 19:52:18.151151: total loss: 0.00011274457326645386, mse:0.00022548915024445029, ic :0.009596184856494442, sharpe5:0.4928880128636956, irr5:0.1273001730442047, ndcg5:0.8556827752495062, pnl5:1.174014925956726 
train 29, step: 0, loss: 0.00011502212873892859, grad_norm: 7.647276750962908e-12, ic: -0.01499754724061663
train 29, step: 500, loss: 9.558465535519645e-05, grad_norm: 4.643782070894784e-09, ic: 0.056799859484758276
Epoch 29: 2022-05-06 19:52:27.514393: train loss: 0.00012569974655573247
Eval step 0: eval loss: 6.61855228827335e-05
Eval: 2022-05-06 19:52:30.617294: total loss: 0.00011280998949499854, mse:0.00022561998268272855, ic :0.006334069063795529, sharpe5:0.27941002003848553, irr5:0.038018740713596344, ndcg5:0.8547129077324794, pnl5:1.0370107889175415 
train 30, step: 0, loss: 0.0001137132931035012, grad_norm: 1.372579882579662e-09, ic: 0.013564317589550682
train 30, step: 500, loss: 0.0001818685414036736, grad_norm: 4.709982004295529e-10, ic: 7.150931724532461e-05
Epoch 30: 2022-05-06 19:52:40.031765: train loss: 0.00012580121353450405
Eval step 0: eval loss: 6.69098662910983e-05
Eval: 2022-05-06 19:52:43.107148: total loss: 0.00011295405421830514, mse:0.00022590811287868877, ic :-0.0017651962929254182, sharpe5:-0.4674183422885835, irr5:-0.05408339202404022, ndcg5:0.8526642015337353, pnl5:0.9142611026763916 
train 31, step: 0, loss: 4.754016481456347e-05, grad_norm: 8.456052434642759e-10, ic: 0.007261184598770875
train 31, step: 500, loss: 6.542637129314244e-05, grad_norm: 1.8426952429029925e-10, ic: -0.02372403456757332
Epoch 31: 2022-05-06 19:52:52.398238: train loss: 0.00012575350828554556
Eval step 0: eval loss: 6.654054595855996e-05
Eval: 2022-05-06 19:52:55.362248: total loss: 0.00011287654541175117, mse:0.00022575309619026656, ic :-0.0020402321254960926, sharpe5:-1.4722083912044763, irr5:-0.13987188041210175, ndcg5:0.8405721333208287, pnl5:0.8888007402420044 
train 32, step: 0, loss: 9.161423076875508e-05, grad_norm: 3.456612667412687e-09, ic: 0.03987686589975446
train 32, step: 500, loss: 0.00014257364091463387, grad_norm: 6.545082447286495e-10, ic: -0.030366336838289924
Epoch 32: 2022-05-06 19:53:04.676593: train loss: 0.00012568721722540344
Eval step 0: eval loss: 6.575092993443832e-05
Eval: 2022-05-06 19:53:07.614970: total loss: 0.00011274016316238929, mse:0.00022548032820530708, ic :0.004870773994690037, sharpe5:1.5252141661942005, irr5:0.2345065474510193, ndcg5:0.8568553334699485, pnl5:1.0093210935592651 
train 33, step: 0, loss: 9.504777699476108e-05, grad_norm: 6.891832481449646e-11, ic: -0.02615936170821239
train 33, step: 500, loss: 5.4870859457878396e-05, grad_norm: 2.093699012428845e-10, ic: 0.023070705451745138
Epoch 33: 2022-05-06 19:53:17.086686: train loss: 0.000125665311539696
Eval step 0: eval loss: 6.567927630385384e-05
Eval: 2022-05-06 19:53:20.175864: total loss: 0.0001127299100513149, mse:0.00022545982253488136, ic :0.002254471613993263, sharpe5:0.35272623896598815, irr5:0.04430273920297623, ndcg5:0.8617240567820179, pnl5:1.129350185394287 
train 34, step: 0, loss: 7.637773524038494e-05, grad_norm: 1.2382786994998744e-09, ic: 0.05390614782180051
train 34, step: 500, loss: 9.276827040594071e-05, grad_norm: 1.6636938487060867e-09, ic: 0.0685113230449057
Epoch 34: 2022-05-06 19:53:29.518389: train loss: 0.0001257008948195433
Eval step 0: eval loss: 6.634387682424858e-05
Eval: 2022-05-06 19:53:32.380041: total loss: 0.00011283866083490922, mse:0.00022567732601384981, ic :-0.0028744770016877036, sharpe5:0.17200355479493737, irr5:0.057385727763175964, ndcg5:0.8426143265525398, pnl5:0.9677937626838684 
train 35, step: 0, loss: 0.00026072593755088747, grad_norm: 2.9121079864798244e-08, ic: 0.05907850024531979
train 35, step: 500, loss: 0.00017532662604935467, grad_norm: 8.512811194317292e-09, ic: -0.09495910313951704
Epoch 35: 2022-05-06 19:53:41.854141: train loss: 0.00012568272838268938
Eval step 0: eval loss: 6.649873103015125e-05
Eval: 2022-05-06 19:53:44.819316: total loss: 0.00011286812730354163, mse:0.0002257362579117122, ic :-0.010559941323937947, sharpe5:0.5684998752549291, irr5:0.09717324376106262, ndcg5:0.8606643036277752, pnl5:1.2158443927764893 
train 36, step: 0, loss: 0.00026484226691536605, grad_norm: 1.434526894826368e-08, ic: 0.004183999583042629
train 36, step: 500, loss: 0.0003306088037788868, grad_norm: 1.0030380172593706e-08, ic: 0.03731288193963687
Epoch 36: 2022-05-06 19:53:54.192345: train loss: 0.00012568206632404617
Eval step 0: eval loss: 6.588863470824435e-05
Eval: 2022-05-06 19:53:57.216520: total loss: 0.0001127607398405905, mse:0.00022552148465016718, ic :-0.0020042084876355803, sharpe5:0.08933993445709347, irr5:0.027129441499710083, ndcg5:0.849222310982006, pnl5:1.0056874752044678 
train 37, step: 0, loss: 0.00017796573229134083, grad_norm: 1.721647385223018e-08, ic: -0.06113386727336248
train 37, step: 500, loss: 9.427410986972973e-05, grad_norm: 1.644492046778134e-09, ic: 0.03167324950206291
Epoch 37: 2022-05-06 19:54:06.737812: train loss: 0.00012566136295628924
Eval step 0: eval loss: 6.613277219003066e-05
Eval: 2022-05-06 19:54:09.561446: total loss: 0.00011280093756827168, mse:0.00022560188018869116, ic :-0.0006098063126118364, sharpe5:0.18324543848633765, irr5:0.05636562407016754, ndcg5:0.856403399200625, pnl5:1.0583043098449707 
train 38, step: 0, loss: 9.380084520671517e-05, grad_norm: 6.451568687557533e-10, ic: -0.042072120796011456
train 38, step: 500, loss: 0.00015384618018288165, grad_norm: 8.507825611571858e-10, ic: 0.02728134945102301
Epoch 38: 2022-05-06 19:54:19.015733: train loss: 0.00012565959686835023
Eval step 0: eval loss: 6.610124546568841e-05
Eval: 2022-05-06 19:54:21.907709: total loss: 0.00011279501489111462, mse:0.00022559003463537106, ic :0.006414535392597638, sharpe5:0.2402688555791974, irr5:0.07653860747814178, ndcg5:0.855208606337439, pnl5:1.0125612020492554 
train 39, step: 0, loss: 0.00020149581541772932, grad_norm: 1.7303310338596907e-08, ic: -0.01577783875756146
train 39, step: 500, loss: 0.00012562521442305297, grad_norm: 2.8046264270752578e-09, ic: -0.06097510467795058
Epoch 39: 2022-05-06 19:54:31.350774: train loss: 0.0001256515310899735
Eval step 0: eval loss: 6.619744817726314e-05
Eval: 2022-05-06 19:54:34.248583: total loss: 0.0001128120939307043, mse:0.00022562419291918224, ic :-0.002399110146821876, sharpe5:0.3888591527380049, irr5:0.121577188372612, ndcg5:0.8530849856474473, pnl5:1.1132006645202637 
