Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQAdjSeqTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=True, label_cnt=1, lr=0.0004, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='RGCNModel', normalize_adj=True, num_days=8, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
75979
RGCNModel(
  (fc1): Linear(in_features=5, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (gnns): ModuleList(
    (0): RGCN(
      (lin_rel): ModuleList(
        (0): Linear(in_features=128, out_features=128, bias=True)
      )
      (lin_root): ModuleList(
        (0): Linear(in_features=128, out_features=128, bias=False)
      )
      (lin_gate): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): LeakyReLU(negative_slope=0.01)
)
train 0, step: 0, loss: 0.00024659110931679606, grad_norm: 0.00044960644238448047, ic: -0.03321967512438196
train 0, step: 500, loss: 7.108425779733807e-05, grad_norm: 1.0818524872064957e-05, ic: -0.01947496376972112
Epoch 0: 2022-05-05 15:57:46.174784: train loss: 0.0001333470506815599
Eval step 0: eval loss: 6.952995317988098e-05
Eval: 2022-05-05 15:58:02.797658: total loss: 0.00011399048476825127, mse:0.00022798097418542707, ic :0.009675515753249044, sharpe5:1.3704034911096095, irr5:0.40820375084877014, ndcg5:0.8523576930472283, pnl5:1.2654922008514404 
train 1, step: 0, loss: 9.58747768891044e-05, grad_norm: 6.660473139370698e-05, ic: 0.25879247150754503
train 1, step: 500, loss: 9.254603355657309e-05, grad_norm: 5.455324501012845e-05, ic: 0.062095387765878314
Epoch 1: 2022-05-05 15:58:49.441929: train loss: 0.00013004952987414296
Eval step 0: eval loss: 6.547140947077423e-05
Eval: 2022-05-05 15:59:05.934393: total loss: 0.0001127786397607082, mse:0.00022555728505978164, ic :0.006101505177258242, sharpe5:0.6559249900281429, irr5:0.21851465106010437, ndcg5:0.8594388461629633, pnl5:1.0850964784622192 
train 2, step: 0, loss: 7.95973464846611e-05, grad_norm: 4.541592606149537e-06, ic: 0.084606962737953
train 2, step: 500, loss: 7.138070213841274e-05, grad_norm: 9.049861534555755e-07, ic: 0.08877575199055614
Epoch 2: 2022-05-05 15:59:56.120600: train loss: 0.0001287676248972411
Eval step 0: eval loss: 6.113990093581378e-05
Eval: 2022-05-05 16:00:12.356881: total loss: 0.00011354270054057431, mse:0.00022708540391297547, ic :0.004470953438776806, sharpe5:-0.485968507155776, irr5:-0.14835119247436523, ndcg5:0.8557100497073694, pnl5:0.9328107833862305 
train 3, step: 0, loss: 0.00010821266914717853, grad_norm: 1.027152464184104e-05, ic: -0.2766218852504581
train 3, step: 500, loss: 0.00012385011359583586, grad_norm: 3.579493617690063e-05, ic: -0.0494018699436022
Epoch 3: 2022-05-05 16:01:01.897670: train loss: 0.00012996301111197292
Eval step 0: eval loss: 7.479608757421374e-05
Eval: 2022-05-05 16:01:18.299968: total loss: 0.00011594016892582841, mse:0.00023188034272292102, ic :0.0025266551282238357, sharpe5:-0.31910558564588426, irr5:-0.09099693596363068, ndcg5:0.8513611682213301, pnl5:0.9582156538963318 
train 4, step: 0, loss: 7.73489082348533e-05, grad_norm: 8.511089272728966e-06, ic: 0.020096515281338136
train 4, step: 500, loss: 7.852600538171828e-05, grad_norm: 5.787776835761203e-06, ic: 0.0372949286187177
Epoch 4: 2022-05-05 16:02:08.108116: train loss: 0.0001280916505327861
Eval step 0: eval loss: 6.003570888424292e-05
Eval: 2022-05-05 16:02:24.603005: total loss: 0.000116902178550682, mse:0.00023380436249049143, ic :-0.00337593326930775, sharpe5:1.3021094282716512, irr5:0.42021071910858154, ndcg5:0.8532796019910547, pnl5:1.0175414085388184 
train 5, step: 0, loss: 0.00013419671449810266, grad_norm: 6.37261297629135e-05, ic: -0.044635670447231296
train 5, step: 500, loss: 0.000546116556506604, grad_norm: 0.0007466589509790122, ic: -0.2576131750497921
Epoch 5: 2022-05-05 16:03:14.244050: train loss: 0.00012810132887931434
Eval step 0: eval loss: 8.417754725087434e-05
Eval: 2022-05-05 16:03:31.130448: total loss: 0.0001209246573395779, mse:0.00024184932108504796, ic :0.0005803158590160057, sharpe5:-0.25743835318833586, irr5:-0.07313834130764008, ndcg5:0.8589249593273235, pnl5:0.9677926301956177 
train 6, step: 0, loss: 9.855350072029978e-05, grad_norm: 5.064560850670758e-05, ic: 0.20927432423668407
train 6, step: 500, loss: 7.618289237143472e-05, grad_norm: 2.8007443858466594e-05, ic: 0.11628793091742248
Epoch 6: 2022-05-05 16:04:20.395208: train loss: 0.00012846656939857404
Eval step 0: eval loss: 7.436873420374468e-05
Eval: 2022-05-05 16:04:36.652631: total loss: 0.00011571970598034532, mse:0.00023143941506186908, ic :0.00028809567295762033, sharpe5:-0.20477792976424097, irr5:-0.05815872922539711, ndcg5:0.8635443145783503, pnl5:1.0105679035186768 
train 7, step: 0, loss: 0.0001003200450213626, grad_norm: 4.500571584537082e-06, ic: 0.026201653127223383
train 7, step: 500, loss: 0.00020187735208310187, grad_norm: 1.0792598844584224e-05, ic: 0.25141123571388857
Epoch 7: 2022-05-05 16:05:25.583141: train loss: 0.00012794577861814833
Eval step 0: eval loss: 6.764337740605697e-05
Eval: 2022-05-05 16:05:41.531946: total loss: 0.00011314998142734905, mse:0.00022629996648312032, ic :0.0009737557235875236, sharpe5:-0.028908622300950808, irr5:-0.008422831073403358, ndcg5:0.8530197187164856, pnl5:1.0398225784301758 
train 8, step: 0, loss: 9.041895827976987e-05, grad_norm: 6.086154972037534e-06, ic: 0.16540020684575304
train 8, step: 500, loss: 8.1036843766924e-05, grad_norm: 2.063814203773462e-07, ic: 0.10492017238463153
Epoch 8: 2022-05-05 16:06:28.405663: train loss: 0.0001283311856357925
Eval step 0: eval loss: 6.019691500114277e-05
Eval: 2022-05-05 16:06:44.462594: total loss: 0.00011842243268734605, mse:0.00023684486897558224, ic :-0.0022856449548219063, sharpe5:-0.027873343558749184, irr5:-0.008048013783991337, ndcg5:0.8643303913716932, pnl5:1.0769929885864258 
train 9, step: 0, loss: 0.00011380967043805867, grad_norm: 2.01283708493441e-06, ic: 0.02500456608531599
train 9, step: 500, loss: 5.254276766208932e-05, grad_norm: 3.1707660775746846e-06, ic: -0.005541672452686346
Epoch 9: 2022-05-05 16:07:32.896002: train loss: 0.00012763888796197374
Eval step 0: eval loss: 6.022465822752565e-05
Eval: 2022-05-05 16:07:49.588704: total loss: 0.0001164563138890192, mse:0.00023291263088379895, ic :-0.0031463212495541626, sharpe5:-0.6157012727111578, irr5:-0.18155226111412048, ndcg5:0.8491597356565905, pnl5:0.9625762104988098 
train 10, step: 0, loss: 4.64108343294356e-05, grad_norm: 1.9675084704766436e-07, ic: 0.04383141867227628
train 10, step: 500, loss: 0.00012500342563726008, grad_norm: 4.2953099512605e-05, ic: 0.16748442111336928
Epoch 10: 2022-05-05 16:08:38.323727: train loss: 0.00012857339747897835
Eval step 0: eval loss: 7.398290472337976e-05
Eval: 2022-05-05 16:08:54.853391: total loss: 0.000115519813946311, mse:0.00023103963018966016, ic :-0.00039281604592703934, sharpe5:0.8454558092728257, irr5:0.27336081862449646, ndcg5:0.8537953640766711, pnl5:1.2058558464050293 
train 11, step: 0, loss: 9.768077870830894e-05, grad_norm: 4.397436889292597e-06, ic: -0.02258884469527408
train 11, step: 500, loss: 8.51392833283171e-05, grad_norm: 2.582924720353677e-06, ic: -0.0031661452371405906
Epoch 11: 2022-05-05 16:09:44.127454: train loss: 0.0001279662120702504
Eval step 0: eval loss: 6.109209061833099e-05
Eval: 2022-05-05 16:10:00.675248: total loss: 0.00011364180685171458, mse:0.00022728361818361739, ic :-0.0014263255967043949, sharpe5:-0.3544048137031495, irr5:-0.1045466959476471, ndcg5:0.848023744263514, pnl5:0.9847320318222046 
train 12, step: 0, loss: 9.000392310554162e-05, grad_norm: 2.3090651005893928e-05, ic: -0.07643279356994845
train 12, step: 500, loss: 7.826626097084954e-05, grad_norm: 6.332091485363371e-07, ic: 0.07252060082331496
Epoch 12: 2022-05-05 16:10:49.526125: train loss: 0.00012727500729779227
Eval step 0: eval loss: 6.661460793111473e-05
Eval: 2022-05-05 16:11:05.944382: total loss: 0.00011290526283802221, mse:0.0002258105301549544, ic :1.3436546631263158e-06, sharpe5:0.5516485634073615, irr5:0.17209412157535553, ndcg5:0.8525031874424928, pnl5:1.087601661682129 
train 13, step: 0, loss: 8.178541611414403e-05, grad_norm: 1.2260889332767901e-05, ic: -0.01219483947871599
train 13, step: 500, loss: 6.348084571072832e-05, grad_norm: 2.9080746636383073e-06, ic: -0.06404573387334764
Epoch 13: 2022-05-05 16:11:53.996751: train loss: 0.0001279165489418338
Eval step 0: eval loss: 7.376087887678295e-05
Eval: 2022-05-05 16:12:09.893960: total loss: 0.0001154024820126884, mse:0.00023080496674379716, ic :-0.001529347545433491, sharpe5:0.9648130704089999, irr5:0.31227177381515503, ndcg5:0.8576916359969794, pnl5:1.17123281955719 
train 14, step: 0, loss: 0.00010014992585638538, grad_norm: 3.826281741571131e-06, ic: 0.017218856450030986
train 14, step: 500, loss: 0.00011584930325625464, grad_norm: 5.536074848924854e-06, ic: -0.010568975615510796
Epoch 14: 2022-05-05 16:12:56.837912: train loss: 0.00012729284151130884
Eval step 0: eval loss: 6.086952635087073e-05
Eval: 2022-05-05 16:13:12.273629: total loss: 0.00011391519916390768, mse:0.0002278304016886215, ic :-0.0018494147362350687, sharpe5:0.5613656444102525, irr5:0.16973668336868286, ndcg5:0.8484371615492534, pnl5:1.2504336833953857 
train 15, step: 0, loss: 7.098299101926386e-05, grad_norm: 2.8025944606399972e-06, ic: 0.10512386891219923
train 15, step: 500, loss: 7.605497376061976e-05, grad_norm: 1.8757977402007755e-05, ic: 0.04887422699462327
Epoch 15: 2022-05-05 16:14:02.276912: train loss: 0.00012718598214817766
Eval step 0: eval loss: 6.058265717001632e-05
Eval: 2022-05-05 16:14:18.843680: total loss: 0.00011453727214097953, mse:0.00022907454883945816, ic :-0.0015114273017419679, sharpe5:-0.26711727200075985, irr5:-0.08457385003566742, ndcg5:0.848567901817032, pnl5:1.053648591041565 
train 16, step: 0, loss: 9.850075002759695e-05, grad_norm: 1.8840304339738004e-05, ic: 0.16042422133769896
train 16, step: 500, loss: 8.859096124069765e-05, grad_norm: 9.33699533071552e-06, ic: 0.10732445606206634
Epoch 16: 2022-05-05 16:15:09.029430: train loss: 0.00012805164168576522
Eval step 0: eval loss: 9.034027607413009e-05
Eval: 2022-05-05 16:15:25.918282: total loss: 0.00012472844826246664, mse:0.0002494568997663521, ic :0.004031138194707511, sharpe5:-0.4109168988279998, irr5:-0.12568169832229614, ndcg5:0.8509289217652579, pnl5:0.9602673649787903 
train 17, step: 0, loss: 7.693935913266614e-05, grad_norm: 3.3126725344420743e-06, ic: 0.0584314201911244
train 17, step: 500, loss: 7.723496673861519e-05, grad_norm: 1.5083439354806796e-05, ic: 0.08153264890123446
Epoch 17: 2022-05-05 16:16:15.958903: train loss: 0.0001280078820096401
Eval step 0: eval loss: 7.406189979519695e-05
Eval: 2022-05-05 16:16:32.697324: total loss: 0.00011555898819458326, mse:0.0002311179820648559, ic :-0.0011549282348247377, sharpe5:-0.4866509629972279, irr5:-0.14879339933395386, ndcg5:0.8624702012078336, pnl5:0.9481964707374573 
train 18, step: 0, loss: 0.00022590231674257666, grad_norm: 0.00023751793472733118, ic: 0.20516858927710718
train 18, step: 500, loss: 0.00020164309535175562, grad_norm: 0.00019225798431624376, ic: -0.006961215853432
Epoch 18: 2022-05-05 16:17:22.318001: train loss: 0.00012712660788765108
Eval step 0: eval loss: 6.811883940827101e-05
Eval: 2022-05-05 16:17:38.776222: total loss: 0.00011334881109213985, mse:0.00022669762661511303, ic :-0.0008553827296208525, sharpe5:0.04866053590318188, irr5:0.014999537728726864, ndcg5:0.8487401085714953, pnl5:1.0530121326446533 
train 19, step: 0, loss: 0.00014030165039002895, grad_norm: 7.803369696616836e-05, ic: -0.14369019724794774
train 19, step: 500, loss: 0.00011909433669643477, grad_norm: 2.787805745010766e-05, ic: 0.022564279655355502
Epoch 19: 2022-05-05 16:18:28.344676: train loss: 0.00012687220546443552
Eval step 0: eval loss: 6.200962525326759e-05
Eval: 2022-05-05 16:18:45.106672: total loss: 0.00011309975026532251, mse:0.00022619950232789204, ic :-0.001818325952471, sharpe5:0.4117459140345454, irr5:0.12983594834804535, ndcg5:0.8434642653498804, pnl5:0.989124596118927 
train 20, step: 0, loss: 0.00011219926818739623, grad_norm: 2.202757273223888e-06, ic: -0.13651625360360417
train 20, step: 500, loss: 9.527246584184468e-05, grad_norm: 1.6980324678598003e-05, ic: 0.06430897636140465
Epoch 20: 2022-05-05 16:19:35.207898: train loss: 0.00012724593348552432
Eval step 0: eval loss: 6.142508937045932e-05
Eval: 2022-05-05 16:19:49.672922: total loss: 0.00011344743374273522, mse:0.00022689487169773916, ic :-5.5206930412964554e-05, sharpe5:-0.013395744530134833, irr5:-0.004238957539200783, ndcg5:0.8484729272059535, pnl5:0.9223549365997314 
train 21, step: 0, loss: 0.00016872858395799994, grad_norm: 0.00012975191613259703, ic: -0.045113349712984266
train 21, step: 500, loss: 8.714052819414064e-05, grad_norm: 1.145716852139432e-05, ic: 0.1511309445444774
Epoch 21: 2022-05-05 16:20:37.813781: train loss: 0.00012689780876164812
Eval step 0: eval loss: 6.741033575963229e-05
Eval: 2022-05-05 16:20:54.039207: total loss: 0.00011310864042114023, mse:0.0002262172834846877, ic :-0.00015500975375447974, sharpe5:0.3230085933767259, irr5:0.10079462826251984, ndcg5:0.8453979881312058, pnl5:0.9567418694496155 
train 22, step: 0, loss: 0.00013969642168376595, grad_norm: 8.95297018888437e-06, ic: 0.03338760983822193
train 22, step: 500, loss: 0.00010687582835089415, grad_norm: 5.7572734016149176e-05, ic: 0.1673168964253601
Epoch 22: 2022-05-05 16:21:43.123048: train loss: 0.000126944709375294
Eval step 0: eval loss: 6.347017915686592e-05
Eval: 2022-05-05 16:21:59.374566: total loss: 0.00011269853529599129, mse:0.00022539707790477135, ic :0.0022887000150463035, sharpe5:0.4809051441773772, irr5:0.14997164905071259, ndcg5:0.8487265449595286, pnl5:1.000260591506958 
train 23, step: 0, loss: 9.21461105463095e-05, grad_norm: 5.5302379704404556e-05, ic: 0.012214712591396943
train 23, step: 500, loss: 6.842109723947942e-05, grad_norm: 4.369150670399794e-06, ic: 0.09314448905678116
Epoch 23: 2022-05-05 16:22:48.161759: train loss: 0.00012734425531002696
Eval step 0: eval loss: 6.452901288866997e-05
Eval: 2022-05-05 16:23:04.336008: total loss: 0.00011267764023904217, mse:0.00022535528383212265, ic :0.0006285862808987278, sharpe5:-0.012782226720009929, irr5:-0.00404888391494751, ndcg5:0.855167114957139, pnl5:0.9892343282699585 
train 24, step: 0, loss: 0.0001062564697349444, grad_norm: 4.629239698582904e-06, ic: 0.09420717793801313
train 24, step: 500, loss: 0.00019505445379763842, grad_norm: 9.285749345399215e-05, ic: -0.12972981985730317
Epoch 24: 2022-05-05 16:23:53.861550: train loss: 0.00012666336002964762
Eval step 0: eval loss: 7.068794366205111e-05
Eval: 2022-05-05 16:24:10.019394: total loss: 0.00011422101439825283, mse:0.00022844203340346332, ic :0.004025520154901015, sharpe5:0.32239049004390835, irr5:0.09077899158000946, ndcg5:0.8620010057725344, pnl5:1.045189380645752 
train 25, step: 0, loss: 0.00010907492833212018, grad_norm: 7.725659011032941e-05, ic: 0.11591874139950001
train 25, step: 500, loss: 9.280285303248093e-05, grad_norm: 4.549758473905417e-05, ic: 0.02953501015563948
Epoch 25: 2022-05-05 16:24:58.343984: train loss: 0.0001273734331451435
Eval step 0: eval loss: 6.0879436205141246e-05
Eval: 2022-05-05 16:25:14.634678: total loss: 0.00011386055511770176, mse:0.0002277211118343972, ic :0.002482791903347002, sharpe5:0.2534533455222845, irr5:0.0856955349445343, ndcg5:0.8452950052919112, pnl5:0.9302589893341064 
train 26, step: 0, loss: 8.138015255099162e-05, grad_norm: 7.623457249586494e-06, ic: 0.11112462828436812
train 26, step: 500, loss: 5.14975909027271e-05, grad_norm: 1.368989949305155e-07, ic: -0.051808540973198904
Epoch 26: 2022-05-05 16:26:02.844625: train loss: 0.0001268249732548577
Eval step 0: eval loss: 7.503043161705136e-05
Eval: 2022-05-05 16:26:18.977024: total loss: 0.00011589780104052739, mse:0.00023179560647134471, ic :-0.005312699093074045, sharpe5:-0.4009818410687148, irr5:-0.1236603781580925, ndcg5:0.8523252485821529, pnl5:0.979048490524292 
train 27, step: 0, loss: 9.053715621121228e-05, grad_norm: 3.5971661047157334e-06, ic: -0.018152351215751705
train 27, step: 500, loss: 0.00013633209164254367, grad_norm: 1.0433499219301133e-05, ic: -0.26845607302869384
Epoch 27: 2022-05-05 16:27:05.889048: train loss: 0.00012722748311123355
Eval step 0: eval loss: 6.216622568899766e-05
Eval: 2022-05-05 16:27:22.465245: total loss: 0.00011292061696729347, mse:0.00022584123532290473, ic :0.006616682803131964, sharpe5:-0.48584116190671917, irr5:-0.1463586688041687, ndcg5:0.8558568535924304, pnl5:0.9823366403579712 
train 28, step: 0, loss: 0.00016461439372505993, grad_norm: 3.733327206857032e-06, ic: -0.08190381145138231
train 28, step: 500, loss: 8.101051935227588e-05, grad_norm: 2.095360690785185e-05, ic: 0.11836497193668706
Epoch 28: 2022-05-05 16:28:10.438113: train loss: 0.00012638524496388735
Eval step 0: eval loss: 6.803977157687768e-05
Eval: 2022-05-05 16:28:27.467203: total loss: 0.00011328992902303285, mse:0.0002265798613852268, ic :0.0034661942146980173, sharpe5:0.1880847944319248, irr5:0.055377669632434845, ndcg5:0.8549741347748939, pnl5:1.004151701927185 
train 29, step: 0, loss: 0.00011565934255486354, grad_norm: 8.245030212539344e-07, ic: -0.055299144583677406
train 29, step: 500, loss: 9.791513002710417e-05, grad_norm: 5.211252638484733e-05, ic: 0.24430374263557647
Epoch 29: 2022-05-05 16:29:17.028463: train loss: 0.00012658431628284126
Eval step 0: eval loss: 7.6635493314825e-05
Eval: 2022-05-05 16:29:33.606183: total loss: 0.00011683205369728775, mse:0.0002336641092531748, ic :0.0037942598533923025, sharpe5:-0.2279316490329802, irr5:-0.07307654619216919, ndcg5:0.8499609008226493, pnl5:1.0425978899002075 
train 30, step: 0, loss: 0.0001232228969456628, grad_norm: 3.37685370740339e-05, ic: 0.07058346352912483
train 30, step: 500, loss: 0.0001815313007682562, grad_norm: 4.323599433042355e-06, ic: 0.025210951019941016
Epoch 30: 2022-05-05 16:30:23.335804: train loss: 0.00012683258330829835
Eval step 0: eval loss: 7.184957212302834e-05
Eval: 2022-05-05 16:30:39.461997: total loss: 0.0001146635179328844, mse:0.00022932703859419938, ic :0.004532691786419677, sharpe5:-0.2528298622369766, irr5:-0.08051259815692902, ndcg5:0.853828464251092, pnl5:0.9352574348449707 
train 31, step: 0, loss: 5.048232196713798e-05, grad_norm: 1.563395243626297e-05, ic: 0.14115751517662942
train 31, step: 500, loss: 6.543078052345663e-05, grad_norm: 1.61344093706977e-06, ic: -0.020621371370935056
Epoch 31: 2022-05-05 16:31:28.654348: train loss: 0.00012682215264428907
Eval step 0: eval loss: 6.040499283699319e-05
Eval: 2022-05-05 16:31:45.733533: total loss: 0.00011437665899873886, mse:0.00022875332189982765, ic :0.005946494758441213, sharpe5:-0.3206254517845809, irr5:-0.10069160163402557, ndcg5:0.842133523999832, pnl5:0.991436779499054 
train 32, step: 0, loss: 7.911110878922045e-05, grad_norm: 1.0239054203304364e-05, ic: 0.14129131715769216
train 32, step: 500, loss: 0.00014365762763191015, grad_norm: 8.184034783757788e-06, ic: -0.010575124416921763
Epoch 32: 2022-05-05 16:32:34.504288: train loss: 0.00012651050766049243
Eval step 0: eval loss: 6.211225991137326e-05
Eval: 2022-05-05 16:32:51.093925: total loss: 0.00011300018139073714, mse:0.00022600036701979248, ic :0.003005013596151277, sharpe5:0.7164123279601335, irr5:0.20329974591732025, ndcg5:0.8446994064812041, pnl5:1.0379775762557983 
train 33, step: 0, loss: 9.69280008575879e-05, grad_norm: 4.8848282333342795e-06, ic: 0.051728176872537224
train 33, step: 500, loss: 5.5339096434181556e-05, grad_norm: 2.584814430325936e-06, ic: -0.03082192170197642
Epoch 33: 2022-05-05 16:33:40.989261: train loss: 0.0001266267326596099
Eval step 0: eval loss: 7.000099867582321e-05
Eval: 2022-05-05 16:33:57.417046: total loss: 0.00011400521408657718, mse:0.00022801043276821217, ic :0.004320611465640422, sharpe5:0.10093660680111498, irr5:0.03315558657050133, ndcg5:0.8560488013156872, pnl5:1.0264663696289062 
train 34, step: 0, loss: 7.431906124111265e-05, grad_norm: 6.439501618447549e-06, ic: -0.0711174453979487
train 34, step: 500, loss: 8.81242158357054e-05, grad_norm: 7.799527366277752e-06, ic: 0.08906348341646388
Epoch 34: 2022-05-05 16:34:45.035581: train loss: 0.0001262564321592815
Eval step 0: eval loss: 6.115649011917412e-05
Eval: 2022-05-05 16:35:01.245677: total loss: 0.00011385457132567802, mse:0.00022770914722093597, ic :-0.004224254453793779, sharpe5:0.14427256012335418, irr5:0.042034462094306946, ndcg5:0.8541323818414474, pnl5:0.9974989295005798 
train 35, step: 0, loss: 0.0002224717609351501, grad_norm: 0.00021366475267982593, ic: 0.2587148882227474
train 35, step: 500, loss: 0.00019069292466156185, grad_norm: 0.0001114186589383419, ic: -0.18243114271960997
Epoch 35: 2022-05-05 16:35:51.570947: train loss: 0.00012640704331949278
Eval step 0: eval loss: 6.60076693748124e-05
Eval: 2022-05-05 16:36:08.360815: total loss: 0.00011295220974716358, mse:0.00022590442204816519, ic :0.003766944108426784, sharpe5:0.1756513103842735, irr5:0.05705451965332031, ndcg5:0.8526002365129696, pnl5:1.0750329494476318 
train 36, step: 0, loss: 0.0002570041979197413, grad_norm: 0.00013007938749564073, ic: 0.17411955788435057
train 36, step: 500, loss: 0.00031802881858311594, grad_norm: 7.315086768260402e-05, ic: 0.08183169524661918
Epoch 36: 2022-05-05 16:36:57.923024: train loss: 0.00012613919656564212
Eval step 0: eval loss: 7.902253128122538e-05
Eval: 2022-05-05 16:37:14.561239: total loss: 0.00011791853422520675, mse:0.00023583707219170262, ic :0.002235206443680643, sharpe5:0.33333884116262197, irr5:0.10828845202922821, ndcg5:0.8461882783976172, pnl5:1.0836443901062012 
train 37, step: 0, loss: 0.00021145185746718198, grad_norm: 0.00023699479367408828, ic: 0.22425319339703653
train 37, step: 500, loss: 9.548863454256207e-05, grad_norm: 1.9341815403686652e-05, ic: 0.07613728445778062
Epoch 37: 2022-05-05 16:38:04.192454: train loss: 0.00012653016001714474
Eval step 0: eval loss: 6.665251567028463e-05
Eval: 2022-05-05 16:38:21.080883: total loss: 0.00011292789329029416, mse:0.00022585579143208915, ic :0.001193365677280003, sharpe5:-0.17771484732627868, irr5:-0.05941980332136154, ndcg5:0.8351422598793746, pnl5:1.1064634323120117 
train 38, step: 0, loss: 9.371066698804498e-05, grad_norm: 5.619778171259232e-06, ic: -0.06255626560928942
train 38, step: 500, loss: 0.00015000537678133696, grad_norm: 5.007126055818534e-07, ic: 0.01778680193534207
Epoch 38: 2022-05-05 16:39:11.211882: train loss: 0.0001261772420130098
Eval step 0: eval loss: 6.118226156104356e-05
Eval: 2022-05-05 16:39:27.936178: total loss: 0.00011373813865593468, mse:0.00022747628162491247, ic :0.00036269808295667934, sharpe5:0.31733312778174877, irr5:0.0902087464928627, ndcg5:0.8564089875355421, pnl5:1.1201908588409424 
train 39, step: 0, loss: 0.00017593300435692072, grad_norm: 0.00012117563695493775, ic: 0.17440865170878947
train 39, step: 500, loss: 0.00012368077295832336, grad_norm: 2.0954302962085465e-05, ic: -0.3073806842313386
Epoch 39: 2022-05-05 16:40:18.592257: train loss: 0.00012607268453233272
Eval step 0: eval loss: 7.04395497450605e-05
Eval: 2022-05-05 16:40:35.386006: total loss: 0.00011399733084068414, mse:0.0002279946653232075, ic :0.003115168228873402, sharpe5:-0.7967555925250053, irr5:-0.197781041264534, ndcg5:0.8488976025172216, pnl5:0.8289002776145935 
