Namespace(adj_path='./data/graphs/NYSE_1737_1737.npy', ann_embed_dim=128, ann_embed_num=89, ann_path=None, batch_size=1, dataset_type='NASDAQAdjSeqTimeDataset', dout=0.3, epochs=40, glstm_layers=1, gnn_layers=1, gpu=0, graph_attn=False, hidden_dim=128, inner_prod=False, input_dim=5, input_graph=True, label_cnt=1, lr=0.0004, lstm_layers=1, market='NYSE', mask_adj=True, mask_type='soft', model_type='RGCNModel', normalize_adj=True, num_days=1, num_heads=1, print_inteval=500, rank_loss=False, relation_num=1, rsr_data_path='../Temporal_Relational_Stock_Ranking/data/2013-01-01', seed=10086, shuffle=True, side_info=False, sparse_adj_path='../data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/NYSE/test_mask_237_1737.npy', test_path='./data/NYSE/test_237_1737_6.npy', top_stocks=5, train_mask_path='./data/NYSE/train_mask_756_1737.npy', train_path='./data/NYSE/train_756_1737_6.npy', use_adj=True)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
#tickers selected: 1737
single EOD data shape: (1245, 6)
(1737, 1245, 5) (1737, 1245) (1737, 1245) (1737, 1245)
29853
RGCNModel(
  (fc1): Linear(in_features=5, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (gnns): ModuleList(
    (0): RGCN(
      (lin_rel): ModuleList(
        (0): Linear(in_features=128, out_features=128, bias=True)
      )
      (lin_root): ModuleList(
        (0): Linear(in_features=128, out_features=128, bias=False)
      )
      (lin_gate): Linear(in_features=128, out_features=128, bias=True)
    )
  )
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): LeakyReLU(negative_slope=0.01)
)
train 0, step: 0, loss: 0.0005297833704389632, grad_norm: 0.001524751169801754, ic: 0.1829586644270535
train 0, step: 500, loss: 0.00023274141130968928, grad_norm: 8.275914188671556e-07, ic: -0.07812141436805826
Epoch 0: 2022-05-06 16:30:20.776767: train loss: 0.00013663993002723483
Eval step 0: eval loss: 0.00021280017972458154
Eval: 2022-05-06 16:30:24.833648: total loss: 0.00013059936375966417, mse:0.00026119872567893066, ic :0.009589241071991519, sharpe5:0.4094749828800559, irr5:0.11328621208667755, ndcg5:0.8473225086225155, pnl5:0.9651542901992798 
train 1, step: 0, loss: 0.00011055189679609612, grad_norm: 3.0196606179917883e-05, ic: 0.016815143437750563
train 1, step: 500, loss: 0.00026609745691530406, grad_norm: 7.648660844915618e-05, ic: -0.27265603234286895
Epoch 1: 2022-05-06 16:30:34.327757: train loss: 0.00012955216663721518
Eval step 0: eval loss: 8.85424597072415e-05
Eval: 2022-05-06 16:30:38.402774: total loss: 0.00013616145207703023, mse:0.0002723229012904531, ic :0.00546523765111625, sharpe5:0.3216991957090795, irr5:0.09841073304414749, ndcg5:0.8562431016677958, pnl5:0.9510294198989868 
train 2, step: 0, loss: 0.0001270961220143363, grad_norm: 2.0086381347362722e-05, ic: 0.3219167766036978
train 2, step: 500, loss: 0.00011339296906953678, grad_norm: 1.611380931451738e-05, ic: 0.05885577674254432
Epoch 2: 2022-05-06 16:30:47.913268: train loss: 0.0001298347722707372
Eval step 0: eval loss: 0.00015010395145509392
Eval: 2022-05-06 16:30:52.140215: total loss: 0.00011290489874227205, mse:0.00022580979613158686, ic :0.0075815410473095, sharpe5:0.1583261488750577, irr5:0.05694776773452759, ndcg5:0.8536891834175884, pnl5:1.1567637920379639 
train 3, step: 0, loss: 6.173161091282964e-05, grad_norm: 1.0897062643354174e-06, ic: 0.0555805787310251
train 3, step: 500, loss: 6.015349208610132e-05, grad_norm: 2.922029812493197e-05, ic: -0.08429780864249878
Epoch 3: 2022-05-06 16:31:01.598349: train loss: 0.00012844009887228954
Eval step 0: eval loss: 0.00019075183081440628
Eval: 2022-05-06 16:31:05.669906: total loss: 0.00012002414756753458, mse:0.00024004829365433707, ic :0.00493154429476659, sharpe5:-0.15342715526930986, irr5:-0.04863922297954559, ndcg5:0.8584213027908947, pnl5:0.9592478275299072 
train 4, step: 0, loss: 0.0001303232420468703, grad_norm: 0.00012341511047676525, ic: 0.15295607488743002
train 4, step: 500, loss: 0.00027448165928944945, grad_norm: 0.00029714189565284893, ic: -0.04215292158446318
Epoch 4: 2022-05-06 16:31:15.503444: train loss: 0.00012765074328408384
Eval step 0: eval loss: 0.00016355850675608963
Eval: 2022-05-06 16:31:19.801504: total loss: 0.0001144142595691492, mse:0.00022882851843894074, ic :0.003914204933156276, sharpe5:0.32416398251429196, irr5:0.1075606718659401, ndcg5:0.8683404454152448, pnl5:1.037142038345337 
train 5, step: 0, loss: 7.348421058850363e-05, grad_norm: 4.75672526479288e-05, ic: 0.14444920667274472
train 5, step: 500, loss: 6.952002149773762e-05, grad_norm: 7.858397165203479e-06, ic: 0.08337897751038484
Epoch 5: 2022-05-06 16:31:29.474370: train loss: 0.00012796417044264432
Eval step 0: eval loss: 0.0001447156973881647
Eval: 2022-05-06 16:31:33.654629: total loss: 0.00011264653884439721, mse:0.00022529307551141112, ic :0.0010173405054092392, sharpe5:0.28339411133900283, irr5:0.09322143346071243, ndcg5:0.8366141643850805, pnl5:1.0838162899017334 
train 6, step: 0, loss: 0.0001366612850688398, grad_norm: 9.755587809065019e-07, ic: 0.0559133205570958
train 6, step: 500, loss: 0.00019858952146023512, grad_norm: 0.00011314560604835407, ic: -0.10251442774720632
Epoch 6: 2022-05-06 16:31:43.063715: train loss: 0.00012790720304339315
Eval step 0: eval loss: 0.00014940260734874755
Eval: 2022-05-06 16:31:47.182519: total loss: 0.00011286290462799193, mse:0.00022572580713854298, ic :0.001767690497491063, sharpe5:0.3661371598765254, irr5:0.10857246071100235, ndcg5:0.8484434120726735, pnl5:1.0282589197158813 
train 7, step: 0, loss: 0.00040098399040289223, grad_norm: 0.0004078527220701284, ic: -0.293657220205082
train 7, step: 500, loss: 0.00016087081166915596, grad_norm: 4.236770447771465e-05, ic: 0.2880763473650739
Epoch 7: 2022-05-06 16:31:56.838760: train loss: 0.00012795905303036553
Eval step 0: eval loss: 0.00013468900579027832
Eval: 2022-05-06 16:32:01.280753: total loss: 0.00011278036454622436, mse:0.00022556072865717299, ic :0.001067117167282616, sharpe5:0.5512476091459393, irr5:0.19923743605613708, ndcg5:0.8445419522596539, pnl5:1.1745234727859497 
train 8, step: 0, loss: 0.00025584420654922724, grad_norm: 0.0002516403800395406, ic: 0.0572831861323642
train 8, step: 500, loss: 0.00013797737483400851, grad_norm: 5.667457039309532e-06, ic: 0.02365046368765968
Epoch 8: 2022-05-06 16:32:11.006564: train loss: 0.00012764840228086035
Eval step 0: eval loss: 0.00014685893256682903
Eval: 2022-05-06 16:32:15.292971: total loss: 0.00011271418339150595, mse:0.00022542836504156507, ic :0.0009129738937457235, sharpe5:1.439567096158862, irr5:0.45305296778678894, ndcg5:0.8533864949104565, pnl5:1.2956849336624146 
train 9, step: 0, loss: 0.00010647524322848767, grad_norm: 1.4491306455061769e-05, ic: -0.011213916754034128
train 9, step: 500, loss: 0.0001175670258817263, grad_norm: 5.965383238155104e-06, ic: -0.04941403931053938
Epoch 9: 2022-05-06 16:32:24.862762: train loss: 0.00012758100992808771
Eval step 0: eval loss: 0.00012505368795245886
Eval: 2022-05-06 16:32:28.937902: total loss: 0.00011382499283403592, mse:0.00022764998445636182, ic :-0.0002653524069610569, sharpe5:0.2070568865071982, irr5:0.06360320746898651, ndcg5:0.8425025557107274, pnl5:0.9658927321434021 
train 10, step: 0, loss: 0.00011615360563155264, grad_norm: 1.0254547601323827e-06, ic: 0.10781852209599163
train 10, step: 500, loss: 0.00010066884715342894, grad_norm: 6.927356375040257e-06, ic: 0.1295770521607827
Epoch 10: 2022-05-06 16:32:37.320854: train loss: 0.0001282679477925505
Eval step 0: eval loss: 0.0001416066661477089
Eval: 2022-05-06 16:32:41.018937: total loss: 0.00011262530480993426, mse:0.00022525060725701082, ic :0.00024898219225349445, sharpe5:0.2502225066907704, irr5:0.08738819509744644, ndcg5:0.8651520260670271, pnl5:1.1752609014511108 
train 11, step: 0, loss: 0.0002577019913587719, grad_norm: 2.0930251362299074e-06, ic: -0.05492099749629784
train 11, step: 500, loss: 7.909364649094641e-05, grad_norm: 4.496811951378293e-05, ic: 0.04495369648869074
Epoch 11: 2022-05-06 16:32:50.647820: train loss: 0.00012707888584415156
Eval step 0: eval loss: 0.0001262026053154841
Eval: 2022-05-06 16:32:54.811042: total loss: 0.00011365758693839672, mse:0.00022731516832218073, ic :0.0005436414556811751, sharpe5:0.47290512526407835, irr5:0.16129760444164276, ndcg5:0.8602682506973663, pnl5:1.0821996927261353 
train 12, step: 0, loss: 0.00034827447962015867, grad_norm: 0.00046838706543850993, ic: -0.12655808955428113
train 12, step: 500, loss: 0.00012863070878665894, grad_norm: 2.7313458536218795e-06, ic: 0.04137373089407389
Epoch 12: 2022-05-06 16:33:03.757766: train loss: 0.000127498110813522
Eval step 0: eval loss: 0.00011145714961457998
Eval: 2022-05-06 16:33:07.459919: total loss: 0.00011995465222953808, mse:0.00023990930015357098, ic :-0.005632153614289459, sharpe5:-2.6963508385419845, irr5:-0.31637096405029297, ndcg5:0.8457724089213924, pnl5:0.827998697757721 
train 13, step: 0, loss: 0.0002297124156029895, grad_norm: 8.482559623789876e-05, ic: -0.14249639978695175
train 13, step: 500, loss: 5.026323924539611e-05, grad_norm: 3.267660387112088e-07, ic: -0.11452380991884466
Epoch 13: 2022-05-06 16:33:17.147153: train loss: 0.00012712379802243525
Eval step 0: eval loss: 0.0001370511163258925
Eval: 2022-05-06 16:33:21.260871: total loss: 0.00011266825471065497, mse:0.00022533650690549265, ic :0.0012727669964732928, sharpe5:0.6823896266520023, irr5:0.22737205028533936, ndcg5:0.8533926093177596, pnl5:1.0661860704421997 
train 14, step: 0, loss: 6.46354237687774e-05, grad_norm: 4.480456303199766e-06, ic: 0.040222283287827336
train 14, step: 500, loss: 6.653455056948587e-05, grad_norm: 1.8903522656391343e-05, ic: -0.007698269185688644
Epoch 14: 2022-05-06 16:33:30.802946: train loss: 0.00012657800927856128
Eval step 0: eval loss: 0.00013457334716804326
Eval: 2022-05-06 16:33:34.826937: total loss: 0.0001127889617529976, mse:0.00022557792150838514, ic :0.0013067232452497295, sharpe5:0.6113950641453266, irr5:0.198381707072258, ndcg5:0.8461566757823776, pnl5:1.0149214267730713 
train 15, step: 0, loss: 0.0001689874188741669, grad_norm: 9.637428377022358e-05, ic: -0.0739901223223737
train 15, step: 500, loss: 8.57044942677021e-05, grad_norm: 4.89041712618621e-06, ic: 0.13758057537081644
Epoch 15: 2022-05-06 16:33:44.382095: train loss: 0.0001269339322168781
Eval step 0: eval loss: 0.0001888000115286559
Eval: 2022-05-06 16:33:48.328326: total loss: 0.00011978544770792754, mse:0.00023957089133774353, ic :0.0016623895457146636, sharpe5:0.3716670120321214, irr5:0.1239696815609932, ndcg5:0.8505295226264727, pnl5:1.0449001789093018 
train 16, step: 0, loss: 0.0001327198842773214, grad_norm: 5.690209501401571e-05, ic: 0.09447635266259279
train 16, step: 500, loss: 0.00010026030213339254, grad_norm: 1.58353865051254e-06, ic: 0.06763882789413861
Epoch 16: 2022-05-06 16:33:57.805741: train loss: 0.0001265058399223189
Eval step 0: eval loss: 9.822359425015748e-05
Eval: 2022-05-06 16:34:01.983750: total loss: 0.00012498016083986455, mse:0.0002499603185085623, ic :0.002912657837050863, sharpe5:0.3757368869706988, irr5:0.12505628168582916, ndcg5:0.8669271044135521, pnl5:1.0636281967163086 
train 17, step: 0, loss: 0.00013699806004296988, grad_norm: 0.00015475131763147538, ic: 0.02456194344155229
train 17, step: 500, loss: 0.00016925008094403893, grad_norm: 0.0001149692651793862, ic: 0.007560058937206824
Epoch 17: 2022-05-06 16:34:11.439345: train loss: 0.00012668932701629857
Eval step 0: eval loss: 0.00014145472960080951
Eval: 2022-05-06 16:34:15.701836: total loss: 0.00011264922983882261, mse:0.00022529845893306754, ic :0.003018008703809175, sharpe5:0.3267050641402602, irr5:0.109079509973526, ndcg5:0.8529891436509729, pnl5:0.9856456518173218 
train 18, step: 0, loss: 0.00011290881229797378, grad_norm: 1.3386328988500759e-05, ic: 0.09690680679790237
train 18, step: 500, loss: 8.801663352642208e-05, grad_norm: 2.4515193454766693e-05, ic: 0.22915441199906136
Epoch 18: 2022-05-06 16:34:25.068097: train loss: 0.00012683396331544979
Eval step 0: eval loss: 0.00010885299707297236
Eval: 2022-05-06 16:34:29.338200: total loss: 0.00011838782994361235, mse:0.00023677565954562934, ic :0.0028143658634553668, sharpe5:0.5418937636166811, irr5:0.1808132380247116, ndcg5:0.8510510286632879, pnl5:1.0378530025482178 
train 19, step: 0, loss: 0.00014737156743649393, grad_norm: 0.00017931491827248978, ic: -0.20530636332257873
train 19, step: 500, loss: 7.184525748016313e-05, grad_norm: 2.4816712049866333e-06, ic: 0.029610643579519487
Epoch 19: 2022-05-06 16:34:38.809033: train loss: 0.0001273195208052238
Eval step 0: eval loss: 0.0001375837018713355
Eval: 2022-05-06 16:34:42.938081: total loss: 0.00011265719823020814, mse:0.00022531439481778825, ic :0.002516136280233584, sharpe5:0.5005323932692408, irr5:0.1477982997894287, ndcg5:0.8529909920366731, pnl5:1.0133599042892456 
train 20, step: 0, loss: 0.00011546249879756942, grad_norm: 1.5760658949348356e-05, ic: 0.17655780370826307
train 20, step: 500, loss: 8.050110773183405e-05, grad_norm: 1.6783519599528473e-06, ic: 0.0945714061976613
Epoch 20: 2022-05-06 16:34:52.524377: train loss: 0.00012712868109587518
Eval step 0: eval loss: 0.000151348504005
Eval: 2022-05-06 16:34:56.707194: total loss: 0.00011311180615093227, mse:0.00022622361067494497, ic :0.01008227875505829, sharpe5:0.36985704230144617, irr5:0.12173251062631607, ndcg5:0.8522381950263809, pnl5:0.9759674668312073 
train 21, step: 0, loss: 9.141545160673559e-05, grad_norm: 4.357369824738632e-05, ic: 0.03840554124208632
train 21, step: 500, loss: 0.00010892449063248932, grad_norm: 1.441255169680144e-05, ic: 0.25691822402013753
Epoch 21: 2022-05-06 16:35:06.132983: train loss: 0.00012672001302060332
Eval step 0: eval loss: 0.00013897947792429477
Eval: 2022-05-06 16:35:10.056412: total loss: 0.00011266341303873283, mse:0.00022532682326686582, ic :0.0026621330168140884, sharpe5:0.07928761885967105, irr5:0.026708567515015602, ndcg5:0.8556471584393813, pnl5:0.9959964156150818 
train 22, step: 0, loss: 0.00010815925634233281, grad_norm: 4.707509037645188e-05, ic: -0.20083909152501211
train 22, step: 500, loss: 9.52563204918988e-05, grad_norm: 6.518740120202582e-05, ic: 0.12649768905674566
Epoch 22: 2022-05-06 16:35:19.915395: train loss: 0.00012638922251197385
Eval step 0: eval loss: 0.00014206299965735525
Eval: 2022-05-06 16:35:24.033595: total loss: 0.00011266709589108359, mse:0.00022533418998332442, ic :0.004510775038853954, sharpe5:0.32440560741350055, irr5:0.10838507115840912, ndcg5:0.864337645611169, pnl5:1.0364148616790771 
train 23, step: 0, loss: 9.01620151125826e-05, grad_norm: 1.2467306471100741e-05, ic: 0.09179148937829115
train 23, step: 500, loss: 0.00013613401097245514, grad_norm: 9.831148698833101e-06, ic: -0.4642586406208641
Epoch 23: 2022-05-06 16:35:33.684985: train loss: 0.00012660610592374363
Eval step 0: eval loss: 0.00016770332877058536
Eval: 2022-05-06 16:35:37.937652: total loss: 0.00011523887441383569, mse:0.0002304777472023144, ic :0.002826382899047194, sharpe5:0.005016011267434805, irr5:0.0016729086637496948, ndcg5:0.8511609913631764, pnl5:0.9674583673477173 
train 24, step: 0, loss: 0.00034563220106065273, grad_norm: 8.475558487665148e-07, ic: 0.05554161115948424
train 24, step: 500, loss: 0.0001382691116305068, grad_norm: 8.356944728612437e-06, ic: 0.16405644241845097
Epoch 24: 2022-05-06 16:35:47.229154: train loss: 0.00012700460857071062
Eval step 0: eval loss: 0.00016232641064561903
Eval: 2022-05-06 16:35:51.343698: total loss: 0.00011434015196770768, mse:0.0002286802988150035, ic :0.0025271646031705683, sharpe5:0.3899592052213847, irr5:0.1363464593887329, ndcg5:0.8551946181599992, pnl5:1.031248927116394 
train 25, step: 0, loss: 6.728711014147848e-05, grad_norm: 1.4303514902366363e-07, ic: 0.11863829790326838
train 25, step: 500, loss: 8.064448047662154e-05, grad_norm: 1.7692093484965595e-06, ic: 0.02142553476263777
Epoch 25: 2022-05-06 16:36:00.925920: train loss: 0.0001260589172567136
Eval step 0: eval loss: 0.00012326202704571187
Eval: 2022-05-06 16:36:04.972030: total loss: 0.00011402275222126726, mse:0.00022804550378922758, ic :0.0047132298171051, sharpe5:0.17256209436804054, irr5:0.061058543622493744, ndcg5:0.8548087871633224, pnl5:1.0116866827011108 
train 26, step: 0, loss: 0.0001270718639716506, grad_norm: 8.257489045160092e-05, ic: -0.16502775569028239
train 26, step: 500, loss: 0.00016046407108660787, grad_norm: 2.125947039363449e-05, ic: -0.06659483061116023
Epoch 26: 2022-05-06 16:36:14.522166: train loss: 0.00012634461316771942
Eval step 0: eval loss: 0.00013598242367152125
Eval: 2022-05-06 16:36:18.872949: total loss: 0.00011275228223246936, mse:0.00022550456152088037, ic :0.005359116762251123, sharpe5:0.19149699973873793, irr5:0.06774934381246567, ndcg5:0.8541594602256898, pnl5:1.0324583053588867 
train 27, step: 0, loss: 0.00012119904567953199, grad_norm: 4.522443260609626e-05, ic: -0.0960613508382256
train 27, step: 500, loss: 7.974125037435442e-05, grad_norm: 1.455958614579396e-07, ic: 0.10221436089036623
Epoch 27: 2022-05-06 16:36:28.559346: train loss: 0.00012644256615185561
Eval step 0: eval loss: 0.00016838996089063585
Eval: 2022-05-06 16:36:32.419074: total loss: 0.00011530713715528382, mse:0.00023061427179517596, ic :0.003702127939569368, sharpe5:0.024767455601831898, irr5:0.008343561552464962, ndcg5:0.856022437253142, pnl5:0.9871683120727539 
train 28, step: 0, loss: 6.724934064550325e-05, grad_norm: 1.7337171719869024e-05, ic: -0.10563424581093579
train 28, step: 500, loss: 9.47091102716513e-05, grad_norm: 1.2306669937395842e-05, ic: 0.1870088105550057
Epoch 28: 2022-05-06 16:36:41.803397: train loss: 0.0001262699481724709
Eval step 0: eval loss: 0.0001610283215995878
Eval: 2022-05-06 16:36:45.863597: total loss: 0.00011417878733667194, mse:0.00022835757429304335, ic :0.007011953917873406, sharpe5:0.09220910450443626, irr5:0.03284267708659172, ndcg5:0.8556490916273148, pnl5:1.032921314239502 
train 29, step: 0, loss: 0.00010793760156957433, grad_norm: 2.940993733896014e-05, ic: 0.02511756179538161
train 29, step: 500, loss: 6.127240339992568e-05, grad_norm: 5.0813983562503945e-06, ic: 0.10977192729993258
Epoch 29: 2022-05-06 16:36:55.357618: train loss: 0.0001264752378131784
Eval step 0: eval loss: 0.00017413792375009507
Eval: 2022-05-06 16:36:59.283504: total loss: 0.00011646781698245678, mse:0.00023293563335767827, ic :0.010465894675807453, sharpe5:0.5211176286265253, irr5:0.1836318075656891, ndcg5:0.8580866496354163, pnl5:1.0908416509628296 
train 30, step: 0, loss: 0.00017406071128789335, grad_norm: 1.1395941480146848e-05, ic: 0.3397556801666307
train 30, step: 500, loss: 0.0004311148659326136, grad_norm: 8.733096490580117e-05, ic: -0.08202549731902956
Epoch 30: 2022-05-06 16:37:08.729839: train loss: 0.000126328127881179
Eval step 0: eval loss: 0.00014076165098231286
Eval: 2022-05-06 16:37:12.879558: total loss: 0.0001126392616844002, mse:0.00022527852344628115, ic :0.0072648234310989995, sharpe5:0.17331519903615117, irr5:0.06105074658989906, ndcg5:0.8501056160329592, pnl5:1.0294287204742432 
train 31, step: 0, loss: 8.868754230206832e-05, grad_norm: 3.496527408358721e-08, ic: 0.021756943712192126
train 31, step: 500, loss: 0.00024038355331867933, grad_norm: 0.0002300467145882846, ic: -0.2451961178536931
Epoch 31: 2022-05-06 16:37:22.924962: train loss: 0.00012623369266353824
Eval step 0: eval loss: 0.00017053165356628597
Eval: 2022-05-06 16:37:27.045070: total loss: 0.00011570372273620136, mse:0.00023140744227568788, ic :0.008911735918480067, sharpe5:0.057124771554954344, irr5:0.017966706305742264, ndcg5:0.8511550001749405, pnl5:0.9592519402503967 
train 32, step: 0, loss: 0.00014024217671249062, grad_norm: 0.00012341562845634763, ic: 0.15763609851180468
train 32, step: 500, loss: 8.637980499770492e-05, grad_norm: 4.262342123845302e-07, ic: 0.12173694724514048
Epoch 32: 2022-05-06 16:37:36.498068: train loss: 0.00012615995851864988
Eval step 0: eval loss: 0.00014488122542388737
Eval: 2022-05-06 16:37:40.537321: total loss: 0.00011282125777112107, mse:0.00022564251357233523, ic :0.0050485359530899705, sharpe5:-0.03621029862435535, irr5:-0.011630484834313393, ndcg5:0.8479274631202984, pnl5:1.119288682937622 
train 33, step: 0, loss: 0.00012174455332569778, grad_norm: 6.454173335580881e-05, ic: 0.10490687372408862
train 33, step: 500, loss: 0.00014067818119656295, grad_norm: 1.0719934568528678e-06, ic: 0.04276081074794624
Epoch 33: 2022-05-06 16:37:50.194983: train loss: 0.0001261085873426922
Eval step 0: eval loss: 0.00014697811275254935
Eval: 2022-05-06 16:37:54.416590: total loss: 0.00011282843507168286, mse:0.0002256568666075867, ic :0.00664713859041466, sharpe5:0.036135441167280076, irr5:0.011360391043126583, ndcg5:0.8507199253160201, pnl5:1.0766688585281372 
train 34, step: 0, loss: 6.721558747813106e-05, grad_norm: 1.51405404674677e-07, ic: -0.05526185000446838
train 34, step: 500, loss: 0.00013894372386857867, grad_norm: 7.732646890474225e-05, ic: 0.09865806693084395
Epoch 34: 2022-05-06 16:38:04.173494: train loss: 0.00012608982831457884
Eval step 0: eval loss: 0.000140311210998334
Eval: 2022-05-06 16:38:08.255680: total loss: 0.00011262571645648538, mse:0.0002252514308502109, ic :0.00763122146319554, sharpe5:0.04637262612115592, irr5:0.014578798785805702, ndcg5:0.846588725556599, pnl5:1.0603978633880615 
train 35, step: 0, loss: 0.00020486023277044296, grad_norm: 0.00020618728391911541, ic: -0.04089594795765081
train 35, step: 500, loss: 8.091014751698822e-05, grad_norm: 9.5896429703565e-06, ic: 0.02624338234129557
Epoch 35: 2022-05-06 16:38:17.620021: train loss: 0.00012578659099973861
Eval step 0: eval loss: 0.00015016112593002617
Eval: 2022-05-06 16:38:22.058723: total loss: 0.0001130670155562565, mse:0.00022613403168633524, ic :0.009692696632044015, sharpe5:0.005060176483530085, irr5:0.0015969499945640564, ndcg5:0.8539948986436015, pnl5:1.1080851554870605 
train 36, step: 0, loss: 0.00010923159425146878, grad_norm: 6.033189344027361e-05, ic: -0.19119562553927544
train 36, step: 500, loss: 0.00010571512393653393, grad_norm: 8.385144216140606e-06, ic: 0.01125080773124986
Epoch 36: 2022-05-06 16:38:31.841465: train loss: 0.00012613199259014184
Eval step 0: eval loss: 0.00016822160978335887
Eval: 2022-05-06 16:38:35.931760: total loss: 0.0001153020510913447, mse:0.00023060409966748916, ic :0.010053033369197176, sharpe5:0.16941854674369095, irr5:0.052699532359838486, ndcg5:0.8502236835602448, pnl5:1.0464414358139038 
train 37, step: 0, loss: 0.0001458464830648154, grad_norm: 1.1166458572911047e-06, ic: 0.17379775502272124
train 37, step: 500, loss: 7.256074604811147e-05, grad_norm: 1.1825174428823691e-06, ic: 0.12257359887555017
Epoch 37: 2022-05-06 16:38:45.341647: train loss: 0.00012570663680733392
Eval step 0: eval loss: 0.00014861086674500257
Eval: 2022-05-06 16:38:49.335870: total loss: 0.00011291653973492399, mse:0.00022583307973318725, ic :0.009338889059500649, sharpe5:0.11361406578216701, irr5:0.03792200982570648, ndcg5:0.8524503780974984, pnl5:1.0723514556884766 
train 38, step: 0, loss: 0.0001526761188870296, grad_norm: 0.00016777687160354722, ic: -0.0745374290889373
train 38, step: 500, loss: 0.00013190593745093793, grad_norm: 1.364495547361189e-05, ic: -0.05982535950807239
Epoch 38: 2022-05-06 16:38:59.004114: train loss: 0.00012593393052433963
Eval step 0: eval loss: 0.0001868547115009278
Eval: 2022-05-06 16:39:03.067221: total loss: 0.00011907894121716293, mse:0.0002381578812382871, ic :0.007899213645527054, sharpe5:0.22386379896663128, irr5:0.07117334753274918, ndcg5:0.8542892333424871, pnl5:1.1305315494537354 
train 39, step: 0, loss: 7.81820053816773e-05, grad_norm: 2.7290426262303342e-05, ic: 0.050188720236613485
train 39, step: 500, loss: 0.0001348834775853902, grad_norm: 3.4504047637094404e-05, ic: 0.2856778700616335
Epoch 39: 2022-05-06 16:39:12.675820: train loss: 0.0001260248233287808
Eval step 0: eval loss: 0.0001429434196325019
Eval: 2022-05-06 16:39:16.660590: total loss: 0.00011263751244861574, mse:0.0002252750236274696, ic :0.006437288898028754, sharpe5:0.12051261332351713, irr5:0.037752628326416016, ndcg5:0.8452992973559219, pnl5:1.1297465562820435 
