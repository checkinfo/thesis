Namespace(adj_path='./data/concepts_graph_1931_233_3.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=256, dataset_type='TimeDataset', dout=0.3, epochs=40, gnn_layers=2, gpu=0, hidden_dim=128, input_dim=9, input_graph=False, label_cnt=3, lr=0.0004, lstm_layers=3, mask_adj=False, mask_type='soft', model_type='MlpModel', normalize_adj=False, num_days=1, num_heads=1, print_inteval=500, relation_num=1, seed=10086, shuffle=True, side_info=False, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
53332
MlpModel(
  (fc1): Linear(in_features=9, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): ReLU()
)
train 0, step: 0, loss: 1.603295724966667, grad_norm: 0.00026295952916860374, ic: 0.05461870856753019
Epoch 0: 2022-04-04 00:49:06.062471: train loss: 1.6022079995116811
Eval step 0: eval loss: 1.0905582970528789
Eval: 2022-04-04 00:49:07.483131: total loss: 1.0905582970528789, mse:0.03878695810246342, ic :0.007396068590498637, sharpe5:6.804009124338626, irr5:203.6887664794922, ndcg5:0.8521758866196429, pnl5:2.398127555847168 
train 1, step: 0, loss: 1.6213171246594875, grad_norm: 0.0023352032013937507, ic: 0.05284782778767824
Epoch 1: 2022-04-04 00:49:08.918769: train loss: 1.6760345623260533
Eval step 0: eval loss: 1.0897264232383055
Eval: 2022-04-04 00:49:10.238661: total loss: 1.0897264232383055, mse:0.03880251168830189, ic :0.006649107290081342, sharpe5:6.640163912773132, irr5:199.81280517578125, ndcg5:0.8541090828510036, pnl5:2.509683847427368 
train 2, step: 0, loss: 1.6485681287148433, grad_norm: 0.0009477251444551419, ic: 0.04544556226885177
Epoch 2: 2022-04-04 00:49:11.628837: train loss: 1.5797694941310605
Eval step 0: eval loss: 1.0897266826314502
Eval: 2022-04-04 00:49:12.904550: total loss: 1.0897266826314502, mse:0.038832550053091, ic :0.00712370031378567, sharpe5:6.648560895323753, irr5:200.65945434570312, ndcg5:0.8517468718627768, pnl5:2.517756223678589 
train 3, step: 0, loss: 1.7178175242158384, grad_norm: 0.005941122301729696, ic: 0.061756582887663974
Epoch 3: 2022-04-04 00:49:14.341760: train loss: 1.5729203380000367
Eval step 0: eval loss: 1.0899030699697445
Eval: 2022-04-04 00:49:15.610938: total loss: 1.0899030699697445, mse:0.038788990082855246, ic :0.009313709020026808, sharpe5:6.564674784243106, irr5:198.117431640625, ndcg5:0.8547836059048946, pnl5:2.4328927993774414 
train 4, step: 0, loss: 1.5565671629436695, grad_norm: 0.0036570237317554936, ic: 0.04257228060864109
Epoch 4: 2022-04-04 00:49:17.053654: train loss: 1.5763142886039856
Eval step 0: eval loss: 1.0905004523816442
Eval: 2022-04-04 00:49:18.344510: total loss: 1.0905004523816442, mse:0.038783886435517896, ic :0.01167930528400254, sharpe5:6.582121911048889, irr5:198.69725036621094, ndcg5:0.8564200421551439, pnl5:2.2716636657714844 
train 5, step: 0, loss: 1.5902975238843373, grad_norm: 0.0035409195997519673, ic: 0.07128696638842552
Epoch 5: 2022-04-04 00:49:19.779156: train loss: 1.5567204293323766
Eval step 0: eval loss: 1.091906103831963
Eval: 2022-04-04 00:49:21.081936: total loss: 1.091906103831963, mse:0.03879403838470058, ic :0.018837429908272973, sharpe5:6.4609100443124765, irr5:194.04884338378906, ndcg5:0.8519526584315833, pnl5:2.359043598175049 
train 6, step: 0, loss: 1.7005730818295262, grad_norm: 6.971348364334784e-05, ic: 0.05202411385856252
Epoch 6: 2022-04-04 00:49:22.549938: train loss: 1.5348879325829565
Eval step 0: eval loss: 1.093156638181841
Eval: 2022-04-04 00:49:23.857970: total loss: 1.093156638181841, mse:0.038810887064264915, ic :0.027162535223389364, sharpe5:6.872993594706058, irr5:205.34771728515625, ndcg5:0.8622299776439923, pnl5:2.540404796600342 
train 7, step: 0, loss: 1.6150980401640613, grad_norm: 0.0018645787356794546, ic: 0.05613787187567004
Epoch 7: 2022-04-04 00:49:25.302139: train loss: 1.6525189573338657
Eval step 0: eval loss: 1.0917367201085717
Eval: 2022-04-04 00:49:26.588387: total loss: 1.0917367201085717, mse:0.0387877855029761, ic :0.023581452592569226, sharpe5:6.695762588381767, irr5:199.8101806640625, ndcg5:0.8620361019644542, pnl5:2.3857531547546387 
train 8, step: 0, loss: 1.6740179060328428, grad_norm: 0.00045483795488989224, ic: 0.05058484398671123
Epoch 8: 2022-04-04 00:49:28.019367: train loss: 1.6039750053162194
Eval step 0: eval loss: 1.0896086587506797
Eval: 2022-04-04 00:49:29.351223: total loss: 1.0896086587506797, mse:0.03878486904424789, ic :0.017510528804917668, sharpe5:6.726833883225917, irr5:199.4792938232422, ndcg5:0.8499611843704036, pnl5:2.3162384033203125 
train 9, step: 0, loss: 1.6630207339253837, grad_norm: 0.0012797834562593587, ic: 0.05384048456443817
Epoch 9: 2022-04-04 00:49:30.806515: train loss: 1.6844791627606397
Eval step 0: eval loss: 1.0894130763196885
Eval: 2022-04-04 00:49:32.107497: total loss: 1.0894130763196885, mse:0.038800283984503234, ic :0.016426331468824537, sharpe5:6.797561694681644, irr5:201.34225463867188, ndcg5:0.8613970545774513, pnl5:2.213684320449829 
train 10, step: 0, loss: 1.6075384592031616, grad_norm: 0.005321368322454702, ic: 0.048161965263039244
Epoch 10: 2022-04-04 00:49:33.538162: train loss: 2.3035627723467065
Eval step 0: eval loss: 1.0895142396460633
Eval: 2022-04-04 00:49:34.849656: total loss: 1.0895142396460633, mse:0.03884064031818133, ic :0.015783864714046796, sharpe5:6.934114584624767, irr5:201.83352661132812, ndcg5:0.84867090715714, pnl5:2.432314872741699 
train 11, step: 0, loss: 1.6709704414565953, grad_norm: 4.058771697803385e-05, ic: 0.055337544296860566
Epoch 11: 2022-04-04 00:49:36.316438: train loss: 1.564541526146658
Eval step 0: eval loss: 1.0912334974081437
Eval: 2022-04-04 00:49:37.625017: total loss: 1.0912334974081437, mse:0.038956848658852974, ic :0.013810336159650978, sharpe5:6.81556076914072, irr5:200.0856475830078, ndcg5:0.8554045938415905, pnl5:2.481896162033081 
train 12, step: 0, loss: 1.6517374533354303, grad_norm: 0.023090524092081535, ic: 0.0666809755949559
Epoch 12: 2022-04-04 00:49:39.014870: train loss: 1.5960016730366395
Eval step 0: eval loss: 1.090310057813544
Eval: 2022-04-04 00:49:40.324565: total loss: 1.090310057813544, mse:0.038898672343093105, ic :0.01440985149253837, sharpe5:6.815572120249271, irr5:200.5737762451172, ndcg5:0.8594178009892897, pnl5:2.4671730995178223 
train 13, step: 0, loss: 1.638254639662166, grad_norm: 0.0017470648919193604, ic: 0.05709353412399402
Epoch 13: 2022-04-04 00:49:41.763093: train loss: 1.5900122181785434
Eval step 0: eval loss: 1.0896170890278776
Eval: 2022-04-04 00:49:43.006914: total loss: 1.0896170890278776, mse:0.03883777393439661, ic :0.016094961967194576, sharpe5:6.7560700821876525, irr5:199.76316833496094, ndcg5:0.8529439711041351, pnl5:2.5266547203063965 
train 14, step: 0, loss: 1.562770574715181, grad_norm: 0.0024909370498688464, ic: 0.05326695182696457
Epoch 14: 2022-04-04 00:49:44.411461: train loss: 1.5540091433181482
Eval step 0: eval loss: 1.0904387168132412
Eval: 2022-04-04 00:49:45.702855: total loss: 1.0904387168132412, mse:0.03877643728845866, ic :0.022155983221509964, sharpe5:6.7653898152709, irr5:199.75039672851562, ndcg5:0.8497607208425382, pnl5:2.660997152328491 
train 15, step: 0, loss: 1.6795165345715128, grad_norm: 0.00010582305711853585, ic: 0.05744187591968605
Epoch 15: 2022-04-04 00:49:47.130411: train loss: 1.5574710214350174
Eval step 0: eval loss: 1.091480958468045
Eval: 2022-04-04 00:49:48.378488: total loss: 1.091480958468045, mse:0.038780667747226605, ic :0.02599626630232635, sharpe5:6.689537924230098, irr5:197.55247497558594, ndcg5:0.8528518795834192, pnl5:2.6977765560150146 
train 16, step: 0, loss: 1.6093667859000498, grad_norm: 0.0010056842159144295, ic: 0.04821663954022855
Epoch 16: 2022-04-04 00:49:49.788067: train loss: 1.713240551788947
Eval step 0: eval loss: 1.0913360873968134
Eval: 2022-04-04 00:49:51.129023: total loss: 1.0913360873968134, mse:0.03878196622311894, ic :0.024283240615139718, sharpe5:6.957014973163604, irr5:206.35243225097656, ndcg5:0.8524599695944515, pnl5:2.498487949371338 
train 17, step: 0, loss: 1.4980775842073, grad_norm: 0.0009396627371042843, ic: 0.04308936392111101
Epoch 17: 2022-04-04 00:49:52.514729: train loss: 1.639985325764555
Eval step 0: eval loss: 1.0936134295093942
Eval: 2022-04-04 00:49:53.782886: total loss: 1.0936134295093942, mse:0.03880848026237733, ic :0.03334743260345375, sharpe5:6.676493608653545, irr5:197.1798095703125, ndcg5:0.8494539248479588, pnl5:2.5248541831970215 
train 18, step: 0, loss: 1.5752655833197986, grad_norm: 0.0024452239587818064, ic: 0.05602541438497471
Epoch 18: 2022-04-04 00:49:55.249504: train loss: 1.7513795631683187
Eval step 0: eval loss: 1.0906921439154669
Eval: 2022-04-04 00:49:56.503780: total loss: 1.0906921439154669, mse:0.038770083426913814, ic :0.026588826655451404, sharpe5:6.812321446537971, irr5:199.795166015625, ndcg5:0.8434722094797107, pnl5:2.363701105117798 
train 19, step: 0, loss: 1.574490201252986, grad_norm: 2.2518212676351648e-05, ic: 0.06165542591624047
Epoch 19: 2022-04-04 00:49:57.929557: train loss: 1.6239741864311945
Eval step 0: eval loss: 1.0896589810207225
Eval: 2022-04-04 00:49:59.264049: total loss: 1.0896589810207225, mse:0.03878493384613055, ic :0.021839614532573277, sharpe5:6.56975582420826, irr5:194.99588012695312, ndcg5:0.8579901438516051, pnl5:2.791355609893799 
train 20, step: 0, loss: 1.775112040551407, grad_norm: 0.001454432550652838, ic: 0.04993260515573028
Epoch 20: 2022-04-04 00:50:00.691902: train loss: 1.5890914341320077
Eval step 0: eval loss: 1.0904540210087696
Eval: 2022-04-04 00:50:02.006048: total loss: 1.0904540210087696, mse:0.03877531008728427, ic :0.02419472248987052, sharpe5:6.753610202372074, irr5:197.78041076660156, ndcg5:0.8455207222377868, pnl5:2.508274793624878 
train 21, step: 0, loss: 1.8440323654711992, grad_norm: 0.0005204950958909045, ic: 0.05633662677305197
Epoch 21: 2022-04-04 00:50:03.445088: train loss: 1.567623529689329
Eval step 0: eval loss: 1.0901868460698827
Eval: 2022-04-04 00:50:04.778763: total loss: 1.0901868460698827, mse:0.03877432283825386, ic :0.025198579570941102, sharpe5:6.623847640156746, irr5:196.34388732910156, ndcg5:0.8558391591988881, pnl5:2.656738042831421 
train 22, step: 0, loss: 1.6484308986877816, grad_norm: 0.00025266202231473504, ic: 0.062133501304650465
Epoch 22: 2022-04-04 00:50:06.187791: train loss: 1.5453808674321565
Eval step 0: eval loss: 1.0911440067732738
Eval: 2022-04-04 00:50:07.468856: total loss: 1.0911440067732738, mse:0.03877725661026054, ic :0.02742839728737767, sharpe5:6.755403677523136, irr5:200.88821411132812, ndcg5:0.8529116347176948, pnl5:2.8069827556610107 
train 23, step: 0, loss: 1.6489750238880327, grad_norm: 0.0025166999789416793, ic: 0.04759745427841455
Epoch 23: 2022-04-04 00:50:08.880632: train loss: 1.5911873029572845
Eval step 0: eval loss: 1.0918092204924734
Eval: 2022-04-04 00:50:10.198273: total loss: 1.0918092204924734, mse:0.03878518532489965, ic :0.029109146004133137, sharpe5:6.8152419921755785, irr5:203.83128356933594, ndcg5:0.8505371467953645, pnl5:2.674867630004883 
train 24, step: 0, loss: 1.5434823729940967, grad_norm: 0.0002666468213125954, ic: 0.0568672842536941
Epoch 24: 2022-04-04 00:50:11.618727: train loss: 1.5690506114116733
Eval step 0: eval loss: 1.0944805807916265
Eval: 2022-04-04 00:50:12.926505: total loss: 1.0944805807916265, mse:0.03882693590312771, ic :0.031112449666179248, sharpe5:6.556565363109112, irr5:194.1473846435547, ndcg5:0.8543130553811631, pnl5:2.6895835399627686 
train 25, step: 0, loss: 1.6052598378455027, grad_norm: 0.008817571985994654, ic: 0.05780477688494223
Epoch 25: 2022-04-04 00:50:14.363838: train loss: 1.5861697856309702
Eval step 0: eval loss: 1.0971193872511382
Eval: 2022-04-04 00:50:15.684620: total loss: 1.0971193872511382, mse:0.038876549464979815, ic :0.033186609783929545, sharpe5:6.67711555480957, irr5:196.530029296875, ndcg5:0.8530157064085101, pnl5:2.444554567337036 
train 26, step: 0, loss: 1.6579230421191182, grad_norm: 0.005694669400663073, ic: 0.03979378518836696
Epoch 26: 2022-04-04 00:50:17.143760: train loss: 1.7220407424305049
Eval step 0: eval loss: 1.0988949333255862
Eval: 2022-04-04 00:50:18.438697: total loss: 1.0988949333255862, mse:0.03891522226704429, ic :0.032984928655381655, sharpe5:6.853823464214801, irr5:201.0722198486328, ndcg5:0.8518266095801647, pnl5:2.551673650741577 
train 27, step: 0, loss: 1.6376929351148857, grad_norm: 0.008055930913378976, ic: 0.0554280314982294
Epoch 27: 2022-04-04 00:50:19.862564: train loss: 1.578499291835312
Eval step 0: eval loss: 1.0920819723839683
Eval: 2022-04-04 00:50:21.143681: total loss: 1.0920819723839683, mse:0.0388132157741139, ic :0.03010757295664743, sharpe5:6.9936043256521225, irr5:202.36732482910156, ndcg5:0.8475929199577376, pnl5:3.299722194671631 
train 28, step: 0, loss: 1.6098675179901, grad_norm: 0.0011364962162961766, ic: 0.05115824738639203
Epoch 28: 2022-04-04 00:50:22.550253: train loss: 1.5716003147217232
Eval step 0: eval loss: 1.0903248432227834
Eval: 2022-04-04 00:50:23.823495: total loss: 1.0903248432227834, mse:0.03881685417463195, ic :0.028906087525657403, sharpe5:0.45933721024543045, irr5:5.092199325561523, ndcg5:0.8486539565338623, pnl5:1.201735258102417 
train 29, step: 0, loss: 1.7204161066308243, grad_norm: 0.005870163870301215, ic: 0.04731778315597586
Epoch 29: 2022-04-04 00:50:25.248842: train loss: 1.6735882350469882
Eval step 0: eval loss: 1.0900820512394842
Eval: 2022-04-04 00:50:26.497503: total loss: 1.0900820512394842, mse:0.03880014691955888, ic :0.030039939231767527, sharpe5:2.060842709094286, irr5:35.08663558959961, ndcg5:0.8597132943589633, pnl5:1.6626049280166626 
train 30, step: 0, loss: 1.7633347290695216, grad_norm: 0.010871295170926124, ic: 0.04301316073297651
Epoch 30: 2022-04-04 00:50:27.856437: train loss: 1.6174766582228206
Eval step 0: eval loss: 1.0891051766571072
Eval: 2022-04-04 00:50:29.063462: total loss: 1.0891051766571072, mse:0.03883035084191743, ic :0.03079246234607993, sharpe5:-0.5786617187038063, irr5:-5.789921283721924, ndcg5:0.8508243511827762, pnl5:0.9454550743103027 
train 31, step: 0, loss: 1.4912459687764668, grad_norm: 0.0007639511474048003, ic: 0.053977438514036136
Epoch 31: 2022-04-04 00:50:30.421265: train loss: 1.688703578681352
Eval step 0: eval loss: 1.0888968839620332
Eval: 2022-04-04 00:50:31.691359: total loss: 1.0888968839620332, mse:0.038796247871059404, ic :0.03331551899048126, sharpe5:1.3001248761266468, irr5:18.309274673461914, ndcg5:0.8412305634010587, pnl5:1.30569326877594 
train 32, step: 0, loss: 1.5682463301791072, grad_norm: 0.008993222627274956, ic: 0.05065505177377353
Epoch 32: 2022-04-04 00:50:33.095906: train loss: 1.6825739049172217
Eval step 0: eval loss: 1.0913249334915978
Eval: 2022-04-04 00:50:34.367512: total loss: 1.0913249334915978, mse:0.03875813056309318, ic :0.04023677023231814, sharpe5:6.929939741492271, irr5:203.26019287109375, ndcg5:0.8460327347322392, pnl5:2.904627799987793 
train 33, step: 0, loss: 1.6991600606399377, grad_norm: 0.0018648501880400873, ic: 0.061765799076426396
Epoch 33: 2022-04-04 00:50:35.803968: train loss: 1.8604057411826442
Eval step 0: eval loss: 1.090430156839471
Eval: 2022-04-04 00:50:37.096243: total loss: 1.090430156839471, mse:0.03874937210153226, ic :0.0387451142086948, sharpe5:6.757950109541416, irr5:198.97723388671875, ndcg5:0.8475794928476781, pnl5:2.5985662937164307 
train 34, step: 0, loss: 1.5740007159871674, grad_norm: 0.0021796525136714732, ic: 0.05645696875670566
Epoch 34: 2022-04-04 00:50:38.524876: train loss: 1.5326233855935851
Eval step 0: eval loss: 1.0890910397307292
Eval: 2022-04-04 00:50:39.802854: total loss: 1.0890910397307292, mse:0.03875571074523815, ic :0.03469648376944433, sharpe5:6.959040673077106, irr5:204.61904907226562, ndcg5:0.853354105060738, pnl5:2.837059259414673 
train 35, step: 0, loss: 1.6900424601275474, grad_norm: 0.0007771609717746977, ic: 0.05529411464654725
Epoch 35: 2022-04-04 00:50:41.153098: train loss: 1.5618284235719548
Eval step 0: eval loss: 1.0887503268353622
Eval: 2022-04-04 00:50:42.386321: total loss: 1.0887503268353622, mse:0.03877340832391054, ic :0.03346103176613514, sharpe5:7.07413760304451, irr5:207.14744567871094, ndcg5:0.8594779296570797, pnl5:2.897444486618042 
train 36, step: 0, loss: 1.6484286732007591, grad_norm: 0.0007491404654009989, ic: 0.04366392419315482
Epoch 36: 2022-04-04 00:50:43.730142: train loss: 1.6557085370001137
Eval step 0: eval loss: 1.0887630370994452
Eval: 2022-04-04 00:50:44.960228: total loss: 1.0887630370994452, mse:0.0387846417431641, ic :0.03239957834958788, sharpe5:7.080560911595821, irr5:207.35015869140625, ndcg5:0.8485729004663648, pnl5:2.8996870517730713 
train 37, step: 0, loss: 1.6161577525819675, grad_norm: 0.005590746085007718, ic: 0.056726809192508706
Epoch 37: 2022-04-04 00:50:46.277392: train loss: 2.337569011039368
Eval step 0: eval loss: 1.0888140078523494
Eval: 2022-04-04 00:50:47.544755: total loss: 1.0888140078523494, mse:0.03876598840993532, ic :0.03413711045722756, sharpe5:6.742642193734645, irr5:198.92539978027344, ndcg5:0.8416626967192923, pnl5:2.601238965988159 
train 38, step: 0, loss: 1.6392979013461952, grad_norm: 0.0021897193458346367, ic: 0.06040621078598354
Epoch 38: 2022-04-04 00:50:48.948100: train loss: 1.6014920448521095
Eval step 0: eval loss: 1.090486704544983
Eval: 2022-04-04 00:50:50.179614: total loss: 1.090486704544983, mse:0.03874782778914916, ic :0.04125782640847717, sharpe5:6.5958335772156715, irr5:198.26527404785156, ndcg5:0.8455751372045088, pnl5:2.4487648010253906 
train 39, step: 0, loss: 1.4278914375386054, grad_norm: 0.0017314837074707567, ic: 0.0561656028733938
Epoch 39: 2022-04-04 00:50:51.601804: train loss: 1.6193032264665959
Eval step 0: eval loss: 1.0922516155005044
Eval: 2022-04-04 00:50:52.892940: total loss: 1.0922516155005044, mse:0.03877095429153784, ic :0.045098624701869774, sharpe5:6.580762142837047, irr5:199.56219482421875, ndcg5:0.8574383039267103, pnl5:2.5897176265716553 
