Namespace(adj_path='./data/concepts_graph_1931_233_3.npy', ann_embed_dim=128, ann_embed_num=89, ann_path='./data/ann_type_2431_1931_25.npz', batch_size=32, dataset_type='AnnTimeDataset', dout=0.3, epochs=40, gnn_layers=2, gpu=0, hidden_dim=128, input_dim=9, input_graph=False, label_cnt=3, lr=0.0004, lstm_layers=3, mask_adj=False, mask_type='soft', model_type='MlpModel', normalize_adj=False, num_days=1, num_heads=1, print_inteval=500, relation_num=1, seed=10086, shuffle=True, side_info=True, sparse_adj_path='./data/icgraph_window_250_0.8/', stock_num=1931, test_mask_path='./data/test_mask_126_1931.npy', test_path='./data/test_126_1931_12.npy', top_stocks=5, train_mask_path='./data/train_mask_2305_1931.npy', train_path='./data/train_2305_1931_12.npy', use_adj=False)
88236
MlpModel(
  (fc1): Linear(in_features=9, out_features=128, bias=True)
  (fc2): Linear(in_features=128, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=128, bias=True)
  (fc4): Linear(in_features=128, out_features=1, bias=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (relu): ReLU()
  (type_embed): Embedding(89, 128)
  (fuse_type): Linear(in_features=256, out_features=128, bias=True)
)
train 0, step: 0, loss: 1.5644392638437254, grad_norm: 0.5066338517206422, ic: -0.010181041009086131
Epoch 0: 2022-04-04 00:51:09.464890: train loss: 1.6278320392673238
Eval step 0: eval loss: 1.1493887732564823
Eval: 2022-04-04 00:51:11.031762: total loss: 1.088929767796665, mse:0.15538551086225474, ic :0.005124353884689716, sharpe5:5.280211718380451, irr5:138.77452087402344, ndcg5:0.8506592417460298, pnl5:2.348623514175415 
train 1, step: 0, loss: 1.7324658588416526, grad_norm: 1.3640528632654174, ic: 0.029520105217318272
Epoch 1: 2022-04-04 00:51:14.261756: train loss: 1.6348832878635198
Eval step 0: eval loss: 1.144724134604332
Eval: 2022-04-04 00:51:15.702455: total loss: 1.0932973716553884, mse:0.15630760224764217, ic :0.012886075735180273, sharpe5:2.5783515720069405, irr5:42.74928283691406, ndcg5:0.8340459579950776, pnl5:1.6516361236572266 
train 2, step: 0, loss: 1.8118608891137284, grad_norm: 3.1143645593511273, ic: 0.03259681098219448
Epoch 2: 2022-04-04 00:51:18.943164: train loss: 1.6182178999787813
Eval step 0: eval loss: 1.2458662269898353
Eval: 2022-04-04 00:51:20.437390: total loss: 1.129371229030183, mse:0.1588277066686656, ic :0.020709016973072356, sharpe5:6.74265827447176, irr5:204.03306579589844, ndcg5:0.8541593859260773, pnl5:2.856592893600464 
train 3, step: 0, loss: 1.9403976221674117, grad_norm: 0.44944802775401366, ic: 0.024131812943868305
Epoch 3: 2022-04-04 00:51:23.730819: train loss: 1.6237791129914074
Eval step 0: eval loss: 1.1779500632215052
Eval: 2022-04-04 00:51:25.167372: total loss: 1.091826446216433, mse:0.1549014952417817, ic :0.0373513105455909, sharpe5:6.484673117101192, irr5:194.00091552734375, ndcg5:0.8731950813741265, pnl5:2.5797431468963623 
train 4, step: 0, loss: 1.5178434154057163, grad_norm: 0.9181969650776527, ic: 0.026818577401119658
Epoch 4: 2022-04-04 00:51:28.500197: train loss: 1.6219713534127014
Eval step 0: eval loss: 1.169364357029082
Eval: 2022-04-04 00:51:30.020145: total loss: 1.0888748938307105, mse:0.15471782998555558, ic :0.0407648452667244, sharpe5:6.671866140067577, irr5:198.16204833984375, ndcg5:0.837995468559638, pnl5:2.406782627105713 
train 5, step: 0, loss: 1.9251491467418953, grad_norm: 1.3464541973336737, ic: 0.05017062864164935
Epoch 5: 2022-04-04 00:51:33.281116: train loss: 1.6206277434643328
Eval step 0: eval loss: 1.1983305314711727
Eval: 2022-04-04 00:51:34.753586: total loss: 1.1008067421996133, mse:0.15564266247957245, ic :0.0447068858725035, sharpe5:6.82641763150692, irr5:199.93165588378906, ndcg5:0.8564242041985147, pnl5:2.6346194744110107 
train 6, step: 0, loss: 1.9260413835281327, grad_norm: 0.35058358921750077, ic: 0.022432666704029658
Epoch 6: 2022-04-04 00:51:38.038576: train loss: 1.6132758896959167
Eval step 0: eval loss: 1.1891442979539222
Eval: 2022-04-04 00:51:39.543374: total loss: 1.096548951224648, mse:0.1552400380906991, ic :0.04109196361351373, sharpe5:6.666626657545566, irr5:201.38973999023438, ndcg5:0.8594502822065698, pnl5:2.7817811965942383 
train 7, step: 0, loss: 1.6933414697516682, grad_norm: 0.25103236428046694, ic: 0.035697490244753174
Epoch 7: 2022-04-04 00:51:42.793070: train loss: 1.6277392226076959
Eval step 0: eval loss: 1.1425433262311773
Eval: 2022-04-04 00:51:44.176666: total loss: 1.0994803144770582, mse:0.1579757046808535, ic :0.03663530094044409, sharpe5:0.8900518908351659, irr5:7.55635929107666, ndcg5:0.8655537072036849, pnl5:1.079540491104126 
train 8, step: 0, loss: 1.89258480321645, grad_norm: 2.9825213242749267, ic: 0.012999033402559642
Epoch 8: 2022-04-04 00:51:47.612252: train loss: 1.6274968203891813
Eval step 0: eval loss: 1.169301494737015
Eval: 2022-04-04 00:51:49.001071: total loss: 1.088644053861216, mse:0.15465476199792483, ic :0.04503144097470674, sharpe5:6.564614717960358, irr5:192.75453186035156, ndcg5:0.8505813354773939, pnl5:2.7581429481506348 
train 9, step: 0, loss: 1.672352455179848, grad_norm: 0.05455533608235362, ic: 0.053449504340034426
Epoch 9: 2022-04-04 00:51:52.424684: train loss: 1.6342270728186303
Eval step 0: eval loss: 1.142991572860732
Eval: 2022-04-04 00:51:53.955862: total loss: 1.0911095420837582, mse:0.1560395127211199, ic :0.044730953635155175, sharpe5:1.349818255752325, irr5:13.379098892211914, ndcg5:0.8607453023804384, pnl5:1.1638303995132446 
train 10, step: 0, loss: 1.4027923781005778, grad_norm: 0.05247834232779326, ic: 0.04240806739619359
Epoch 10: 2022-04-04 00:51:57.240411: train loss: 1.7230463290434577
Eval step 0: eval loss: 1.1604268785818679
Eval: 2022-04-04 00:51:58.733625: total loss: 1.0883555124562252, mse:0.1552655278820293, ic :0.04007699711770848, sharpe5:2.011320896744728, irr5:17.95199966430664, ndcg5:0.8406134473910944, pnl5:1.2358479499816895 
train 11, step: 0, loss: 1.9000047934699245, grad_norm: 1.0059150243569857, ic: 0.06761569998100125
Epoch 11: 2022-04-04 00:52:02.027772: train loss: 1.6218188777740385
Eval step 0: eval loss: 1.1545647774110384
Eval: 2022-04-04 00:52:03.460180: total loss: 1.0866856551824722, mse:0.1548794628775954, ic :0.040868588345169314, sharpe5:5.623631940186024, irr5:140.19839477539062, ndcg5:0.8337282552478681, pnl5:2.650838851928711 
train 12, step: 0, loss: 1.675761694408652, grad_norm: 1.8537848468620968, ic: 0.044866761117146256
Epoch 12: 2022-04-04 00:52:06.724731: train loss: 1.6229005549067301
Eval step 0: eval loss: 1.1661476037407426
Eval: 2022-04-04 00:52:08.181396: total loss: 1.0883561282978782, mse:0.154801801520091, ic :0.03986344329235543, sharpe5:6.846802803575993, irr5:203.69760131835938, ndcg5:0.8513334428001764, pnl5:2.6332619190216064 
train 13, step: 0, loss: 1.4651819873004683, grad_norm: 0.08379101343726796, ic: 0.04384691822627006
Epoch 13: 2022-04-04 00:52:11.447662: train loss: 1.619534818736775
Eval step 0: eval loss: 1.1827372191979901
Eval: 2022-04-04 00:52:12.929748: total loss: 1.0938421680949986, mse:0.15508654401670227, ic :0.04084455189052533, sharpe5:6.939698384106159, irr5:205.8484344482422, ndcg5:0.8417939862334294, pnl5:2.741152763366699 
train 14, step: 0, loss: 1.5388129485763862, grad_norm: 0.2318902420687693, ic: 0.06343936467371537
Epoch 14: 2022-04-04 00:52:16.174113: train loss: 1.6170137066654247
Eval step 0: eval loss: 1.1668796287173424
Eval: 2022-04-04 00:52:17.618910: total loss: 1.0881665565838323, mse:0.15472683463837353, ic :0.042831025961110235, sharpe5:6.666542470157146, irr5:200.3988800048828, ndcg5:0.84806266682212, pnl5:2.8324592113494873 
train 15, step: 0, loss: 1.6738189048630092, grad_norm: 0.18019306988540051, ic: 0.05575214965710748
Epoch 15: 2022-04-04 00:52:20.901132: train loss: 1.61713379222638
Eval step 0: eval loss: 1.1678938925562836
Eval: 2022-04-04 00:52:22.344734: total loss: 1.088586165714301, mse:0.1547821374737541, ic :0.041919382234474833, sharpe5:6.656896865665912, irr5:197.18746948242188, ndcg5:0.8461056301855847, pnl5:2.4708847999572754 
train 16, step: 0, loss: 1.9129366386891378, grad_norm: 0.3594442111917795, ic: 0.020144912769626638
Epoch 16: 2022-04-04 00:52:25.701332: train loss: 1.640033510052076
Eval step 0: eval loss: 1.1426858568566596
Eval: 2022-04-04 00:52:27.216756: total loss: 1.093297966983461, mse:0.15651757181898215, ic :0.0401341351191254, sharpe5:2.7390052302181718, irr5:40.25392532348633, ndcg5:0.8567486079419598, pnl5:1.4205574989318848 
train 17, step: 0, loss: 1.6435097961485647, grad_norm: 0.2890927527127467, ic: 0.028811133003572124
Epoch 17: 2022-04-04 00:52:30.600239: train loss: 1.6266708780249435
Eval step 0: eval loss: 1.1500027710724667
Eval: 2022-04-04 00:52:32.013738: total loss: 1.0869728168832, mse:0.15497554140297065, ic :0.04724243893061102, sharpe5:5.95227443754673, irr5:159.06301879882812, ndcg5:0.8366979436956634, pnl5:2.9540834426879883 
train 18, step: 0, loss: 1.5515037933526012, grad_norm: 0.08248363840641364, ic: 0.06817093173765792
Epoch 18: 2022-04-04 00:52:35.326550: train loss: 1.641961610764091
Eval step 0: eval loss: 1.1543533548450664
Eval: 2022-04-04 00:52:36.781284: total loss: 1.0865291042420604, mse:0.15491219596777403, ic :0.041666799937514695, sharpe5:6.225824329555034, irr5:170.1953887939453, ndcg5:0.855190827014914, pnl5:2.902353525161743 
train 19, step: 0, loss: 1.697359267979452, grad_norm: 0.7444198573220173, ic: 0.049003788188530704
Epoch 19: 2022-04-04 00:52:40.056457: train loss: 1.6238827062558872
Eval step 0: eval loss: 1.1871094840468333
Eval: 2022-04-04 00:52:41.482875: total loss: 1.0955595533779092, mse:0.1551883189867775, ic :0.04270306836679698, sharpe5:6.723131529986858, irr5:199.24449157714844, ndcg5:0.8415523326598799, pnl5:2.7222471237182617 
train 20, step: 0, loss: 1.7017702302491027, grad_norm: 0.05219818997559533, ic: 0.05076997224558115
Epoch 20: 2022-04-04 00:52:44.757356: train loss: 1.6210501874846828
Eval step 0: eval loss: 1.1761538694434865
Eval: 2022-04-04 00:52:46.107464: total loss: 1.0909790532559853, mse:0.15481353979116202, ic :0.044070535835153475, sharpe5:6.786420108675957, irr5:200.62921142578125, ndcg5:0.8543671314957336, pnl5:2.379999876022339 
train 21, step: 0, loss: 1.6434835535087329, grad_norm: 0.12295050073481487, ic: 0.054228960868715675
Epoch 21: 2022-04-04 00:52:49.419181: train loss: 1.6167412129293004
Eval step 0: eval loss: 1.161749552523113
Eval: 2022-04-04 00:52:50.832295: total loss: 1.0870580451984146, mse:0.15473624368167174, ic :0.043621888309284165, sharpe5:6.949987218081951, irr5:202.08412170410156, ndcg5:0.8444724219462494, pnl5:2.863877773284912 
train 22, step: 0, loss: 1.8974751333629696, grad_norm: 0.06662249890011408, ic: 0.06435209287780204
Epoch 22: 2022-04-04 00:52:54.037431: train loss: 1.615005662073526
Eval step 0: eval loss: 1.1670240836987045
Eval: 2022-04-04 00:52:55.469263: total loss: 1.088309217309053, mse:0.15476582917937243, ic :0.04297418129129552, sharpe5:6.749478871822357, irr5:196.3893585205078, ndcg5:0.8497943978293555, pnl5:3.014930248260498 
train 23, step: 0, loss: 1.4516091469789998, grad_norm: 0.003076297105971805, ic: 0.05549997713049014
Epoch 23: 2022-04-04 00:52:58.723422: train loss: 1.618532045933389
Eval step 0: eval loss: 1.212924846462059
Eval: 2022-04-04 00:53:00.228760: total loss: 1.1087997200789022, mse:0.15641313738778695, ic :0.0431357376920428, sharpe5:6.654139019250869, irr5:200.0876007080078, ndcg5:0.8614830623752243, pnl5:2.7825348377227783 
train 24, step: 0, loss: 1.4683421509621193, grad_norm: 0.24259606806899497, ic: 0.059901004357115394
Epoch 24: 2022-04-04 00:53:03.479229: train loss: 1.6209420732953888
Eval step 0: eval loss: 1.1678161485787477
Eval: 2022-04-04 00:53:04.945164: total loss: 1.0883838973970315, mse:0.1547057350213898, ic :0.043082487163799844, sharpe5:6.628922531604767, irr5:195.54151916503906, ndcg5:0.8441316563620066, pnl5:2.869062900543213 
train 25, step: 0, loss: 1.4144470126000728, grad_norm: 0.016877129719750677, ic: 0.07162772897238626
Epoch 25: 2022-04-04 00:53:08.203007: train loss: 1.6199010321774605
Eval step 0: eval loss: 1.168358303775227
Eval: 2022-04-04 00:53:09.653978: total loss: 1.0886401475493805, mse:0.154752609843158, ic :0.042872561745127116, sharpe5:6.688299707472324, irr5:197.03231811523438, ndcg5:0.8614598798491021, pnl5:2.748400926589966 
train 26, step: 0, loss: 1.4281673570351932, grad_norm: 0.2341451395360665, ic: 0.054049685069462665
Epoch 26: 2022-04-04 00:53:12.956894: train loss: 1.6361254507045884
Eval step 0: eval loss: 1.1571372563508877
Eval: 2022-04-04 00:53:14.385290: total loss: 1.087148776846122, mse:0.1550062899640075, ic :0.04145740163493387, sharpe5:7.216196726560592, irr5:209.56373596191406, ndcg5:0.8339057614025113, pnl5:2.438814878463745 
train 27, step: 0, loss: 1.5499654796106992, grad_norm: 0.1660541970629076, ic: 0.05864194866788099
Epoch 27: 2022-04-04 00:53:17.652095: train loss: 1.619149992558679
Eval step 0: eval loss: 1.1636615925250835
Eval: 2022-04-04 00:53:19.082113: total loss: 1.0871396685359673, mse:0.15460203641711662, ic :0.04660578725798823, sharpe5:6.7081598907709115, irr5:201.29086303710938, ndcg5:0.8425434798036239, pnl5:2.738905906677246 
train 28, step: 0, loss: 1.5419312039066604, grad_norm: 0.021046107262269294, ic: 0.07555646434789454
Epoch 28: 2022-04-04 00:53:22.348308: train loss: 1.61756273232345
Eval step 0: eval loss: 1.180222599224921
Eval: 2022-04-04 00:53:23.811454: total loss: 1.0925246597526377, mse:0.1549186178929841, ic :0.04539622980315829, sharpe5:6.596347687840462, irr5:195.80401611328125, ndcg5:0.8485981253654602, pnl5:2.7537758350372314 
train 29, step: 0, loss: 1.4641854346707266, grad_norm: 0.1410815507044998, ic: 0.0808070618017854
Epoch 29: 2022-04-04 00:53:27.122206: train loss: 1.6319393775753497
Eval step 0: eval loss: 1.1628469485360526
Eval: 2022-04-04 00:53:28.589402: total loss: 1.0877763787879626, mse:0.1548794877857406, ic :0.04231200456288962, sharpe5:6.796836642622948, irr5:198.29859924316406, ndcg5:0.847894615406351, pnl5:2.986649990081787 
train 30, step: 0, loss: 1.6507275080942032, grad_norm: 0.00546704597490536, ic: 0.05674231829403695
Epoch 30: 2022-04-04 00:53:31.848308: train loss: 1.6243459874821649
Eval step 0: eval loss: 1.1630148806591458
Eval: 2022-04-04 00:53:33.370984: total loss: 1.0874003338015388, mse:0.1547513825199246, ic :0.04443827766413433, sharpe5:6.720550098717212, irr5:198.4420928955078, ndcg5:0.8758871020261652, pnl5:2.6542530059814453 
train 31, step: 0, loss: 1.6379729583886118, grad_norm: 0.01306695528151501, ic: 0.026675601320958055
Epoch 31: 2022-04-04 00:53:36.632725: train loss: 1.6324021901075072
Eval step 0: eval loss: 1.1784380798725718
Eval: 2022-04-04 00:53:38.078394: total loss: 1.0917569260716424, mse:0.15481712964644137, ic :0.04688566885146773, sharpe5:6.638031323254108, irr5:199.54052734375, ndcg5:0.8549838438488242, pnl5:2.987029790878296 
train 32, step: 0, loss: 1.3521488749600037, grad_norm: 0.05227196754109997, ic: 0.04691858915313758
Epoch 32: 2022-04-04 00:53:41.374418: train loss: 1.63282079390211
Eval step 0: eval loss: 1.176666902720988
Eval: 2022-04-04 00:53:42.876086: total loss: 1.0912981775405455, mse:0.15482213147961213, ic :0.04460303903150022, sharpe5:6.6014916318655015, irr5:198.16355895996094, ndcg5:0.8604098185579548, pnl5:2.7324559688568115 
train 33, step: 0, loss: 1.6469154294506088, grad_norm: 0.02091226935301867, ic: 0.10071406718960219
Epoch 33: 2022-04-04 00:53:46.319527: train loss: 1.6559572976036792
Eval step 0: eval loss: 1.1843716387917305
Eval: 2022-04-04 00:53:47.898673: total loss: 1.0943853003844561, mse:0.15506507020875918, ic :0.04498808576300032, sharpe5:6.643092498779296, irr5:197.06930541992188, ndcg5:0.8509985238105128, pnl5:2.6863505840301514 
train 34, step: 0, loss: 1.5377534732933762, grad_norm: 0.05596214343080988, ic: 0.04674270708642718
Epoch 34: 2022-04-04 00:53:51.161660: train loss: 1.612084117608511
Eval step 0: eval loss: 1.153849173604611
Eval: 2022-04-04 00:53:52.556604: total loss: 1.0865404854293972, mse:0.1549610570295396, ic :0.04546741857517279, sharpe5:7.082368102669715, irr5:206.71710205078125, ndcg5:0.8576372504721044, pnl5:2.865452527999878 
train 35, step: 0, loss: 1.5580828772467366, grad_norm: 0.082292469212746, ic: 0.06558787842799889
Epoch 35: 2022-04-04 00:53:56.021320: train loss: 1.6173722354071438
Eval step 0: eval loss: 1.1692043789102913
Eval: 2022-04-04 00:53:57.444989: total loss: 1.0889888455823455, mse:0.15476851545112627, ic :0.04475805295651261, sharpe5:6.551559051275253, irr5:192.71119689941406, ndcg5:0.8583734375498556, pnl5:2.538477897644043 
train 36, step: 0, loss: 1.7938731535713486, grad_norm: 0.08622909148764724, ic: 0.06063965648099506
Epoch 36: 2022-04-04 00:54:00.730581: train loss: 1.6288263035898052
Eval step 0: eval loss: 1.1722244630277354
Eval: 2022-04-04 00:54:02.183711: total loss: 1.0897707673006003, mse:0.15476776159956945, ic :0.04564823180385212, sharpe5:6.551638981997966, irr5:192.71322631835938, ndcg5:0.8543450565887551, pnl5:2.5384979248046875 
train 37, step: 0, loss: 1.9343167597389492, grad_norm: 0.008570252184795337, ic: 0.06661381598757754
Epoch 37: 2022-04-04 00:54:05.555087: train loss: 1.7188749790636775
Eval step 0: eval loss: 1.1632756950260277
Eval: 2022-04-04 00:54:07.074236: total loss: 1.0873210690371125, mse:0.15465715254487314, ic :0.046217313921859945, sharpe5:6.6792259150743485, irr5:198.05215454101562, ndcg5:0.8435045550198942, pnl5:2.610800266265869 
train 38, step: 0, loss: 1.722015451840197, grad_norm: 0.07882733522896447, ic: 0.04040009140882873
Epoch 38: 2022-04-04 00:54:10.342153: train loss: 1.62263738363747
Eval step 0: eval loss: 1.1599776056291773
Eval: 2022-04-04 00:54:11.784374: total loss: 1.086516733126345, mse:0.15456652963538067, ic :0.04844039556531264, sharpe5:6.613329419195652, irr5:200.84909057617188, ndcg5:0.8457368927589086, pnl5:2.9258241653442383 
train 39, step: 0, loss: 1.459670134213125, grad_norm: 0.0004071834801570871, ic: 0.07158177290279756
Epoch 39: 2022-04-04 00:54:15.068046: train loss: 1.6229304207888242
Eval step 0: eval loss: 1.1649877303069118
Eval: 2022-04-04 00:54:16.524722: total loss: 1.087504603634929, mse:0.15460750950060334, ic :0.0466522839373268, sharpe5:6.657513136267662, irr5:195.99087524414062, ndcg5:0.8218456412074799, pnl5:2.7121400833129883 
